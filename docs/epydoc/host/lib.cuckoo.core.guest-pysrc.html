<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>lib.cuckoo.core.guest</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://cuckoosandbox.org">Cuckoo Sandbox</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="lib-module.html">Package&nbsp;lib</a> ::
        <a href="lib.cuckoo-module.html">Package&nbsp;cuckoo</a> ::
        <a href="lib.cuckoo.core-module.html">Package&nbsp;core</a> ::
        Module&nbsp;guest
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="lib.cuckoo.core.guest-pysrc.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<h1 class="epydoc">Source Code for <a href="lib.cuckoo.core.guest-module.html">Module lib.cuckoo.core.guest</a></h1>
<pre class="py-src">
<a name="L1"></a><tt class="py-lineno">  1</tt>  <tt class="py-line"><tt class="py-comment"># Copyright (C) 2010-2013 Claudio Guarnieri.</tt> </tt>
<a name="L2"></a><tt class="py-lineno">  2</tt>  <tt class="py-line"><tt class="py-comment"># Copyright (C) 2014-2015 Cuckoo Foundation.</tt> </tt>
<a name="L3"></a><tt class="py-lineno">  3</tt>  <tt class="py-line"><tt class="py-comment"># This file is part of Cuckoo Sandbox - http://www.cuckoosandbox.org</tt> </tt>
<a name="L4"></a><tt class="py-lineno">  4</tt>  <tt class="py-line"><tt class="py-comment"># See the file 'docs/LICENSE' for copying permission.</tt> </tt>
<a name="L5"></a><tt class="py-lineno">  5</tt>  <tt class="py-line"> </tt>
<a name="L6"></a><tt class="py-lineno">  6</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">datetime</tt> </tt>
<a name="L7"></a><tt class="py-lineno">  7</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">os</tt> </tt>
<a name="L8"></a><tt class="py-lineno">  8</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">time</tt> </tt>
<a name="L9"></a><tt class="py-lineno">  9</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">socket</tt> </tt>
<a name="L10"></a><tt class="py-lineno"> 10</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">logging</tt> </tt>
<a name="L11"></a><tt class="py-lineno"> 11</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">requests</tt> </tt>
<a name="L12"></a><tt class="py-lineno"> 12</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">xmlrpclib</tt> </tt>
<a name="L13"></a><tt class="py-lineno"> 13</tt>  <tt class="py-line"> </tt>
<a name="L14"></a><tt class="py-lineno"> 14</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt class="py-name">StringIO</tt> <tt class="py-keyword">import</tt> <tt class="py-name">StringIO</tt> </tt>
<a name="L15"></a><tt class="py-lineno"> 15</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt class="py-name">zipfile</tt> <tt class="py-keyword">import</tt> <tt class="py-name">ZipFile</tt><tt class="py-op">,</tt> <tt class="py-name">ZIP_STORED</tt> </tt>
<a name="L16"></a><tt class="py-lineno"> 16</tt>  <tt class="py-line"> </tt>
<a name="L17"></a><tt class="py-lineno"> 17</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-0" class="py-name" targets="Package lib=lib-module.html"><a title="lib" class="py-name" href="#" onclick="return doclink('link-0', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-1" class="py-name" targets="Package lib.cuckoo=lib.cuckoo-module.html"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-1', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-2" class="py-name" targets="Package lib.cuckoo.common=lib.cuckoo.common-module.html"><a title="lib.cuckoo.common" class="py-name" href="#" onclick="return doclink('link-2', 'common', 'link-2');">common</a></tt><tt class="py-op">.</tt><tt id="link-3" class="py-name" targets="Module lib.cuckoo.common.config=lib.cuckoo.common.config-module.html"><a title="lib.cuckoo.common.config" class="py-name" href="#" onclick="return doclink('link-3', 'config', 'link-3');">config</a></tt> <tt class="py-keyword">import</tt> <tt id="link-4" class="py-name" targets="Class lib.cuckoo.common.config.Config=lib.cuckoo.common.config.Config-class.html"><a title="lib.cuckoo.common.config.Config" class="py-name" href="#" onclick="return doclink('link-4', 'Config', 'link-4');">Config</a></tt> </tt>
<a name="L18"></a><tt class="py-lineno"> 18</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-5" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-5', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-6" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-6', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-7" class="py-name"><a title="lib.cuckoo.common" class="py-name" href="#" onclick="return doclink('link-7', 'common', 'link-2');">common</a></tt><tt class="py-op">.</tt><tt id="link-8" class="py-name" targets="Module lib.cuckoo.common.constants=lib.cuckoo.common.constants-module.html"><a title="lib.cuckoo.common.constants" class="py-name" href="#" onclick="return doclink('link-8', 'constants', 'link-8');">constants</a></tt> <tt class="py-keyword">import</tt> <tt id="link-9" class="py-name" targets="Variable lib.cuckoo.common.constants.CUCKOO_ROOT=lib.cuckoo.common.constants-module.html#CUCKOO_ROOT"><a title="lib.cuckoo.common.constants.CUCKOO_ROOT" class="py-name" href="#" onclick="return doclink('link-9', 'CUCKOO_ROOT', 'link-9');">CUCKOO_ROOT</a></tt> </tt>
<a name="L19"></a><tt class="py-lineno"> 19</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-10" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-10', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-11" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-11', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-12" class="py-name"><a title="lib.cuckoo.common" class="py-name" href="#" onclick="return doclink('link-12', 'common', 'link-2');">common</a></tt><tt class="py-op">.</tt><tt id="link-13" class="py-name"><a title="lib.cuckoo.common.constants" class="py-name" href="#" onclick="return doclink('link-13', 'constants', 'link-8');">constants</a></tt> <tt class="py-keyword">import</tt> <tt id="link-14" class="py-name" targets="Variable lib.cuckoo.common.constants.CUCKOO_GUEST_PORT=lib.cuckoo.common.constants-module.html#CUCKOO_GUEST_PORT"><a title="lib.cuckoo.common.constants.CUCKOO_GUEST_PORT" class="py-name" href="#" onclick="return doclink('link-14', 'CUCKOO_GUEST_PORT', 'link-14');">CUCKOO_GUEST_PORT</a></tt><tt class="py-op">,</tt> <tt id="link-15" class="py-name" targets="Variable lib.cuckoo.common.constants.CUCKOO_GUEST_INIT=lib.cuckoo.common.constants-module.html#CUCKOO_GUEST_INIT"><a title="lib.cuckoo.common.constants.CUCKOO_GUEST_INIT" class="py-name" href="#" onclick="return doclink('link-15', 'CUCKOO_GUEST_INIT', 'link-15');">CUCKOO_GUEST_INIT</a></tt> </tt>
<a name="L20"></a><tt class="py-lineno"> 20</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-16" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-16', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-17" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-17', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-18" class="py-name"><a title="lib.cuckoo.common" class="py-name" href="#" onclick="return doclink('link-18', 'common', 'link-2');">common</a></tt><tt class="py-op">.</tt><tt id="link-19" class="py-name"><a title="lib.cuckoo.common.constants" class="py-name" href="#" onclick="return doclink('link-19', 'constants', 'link-8');">constants</a></tt> <tt class="py-keyword">import</tt> <tt id="link-20" class="py-name" targets="Variable lib.cuckoo.common.constants.CUCKOO_GUEST_COMPLETED=lib.cuckoo.common.constants-module.html#CUCKOO_GUEST_COMPLETED"><a title="lib.cuckoo.common.constants.CUCKOO_GUEST_COMPLETED" class="py-name" href="#" onclick="return doclink('link-20', 'CUCKOO_GUEST_COMPLETED', 'link-20');">CUCKOO_GUEST_COMPLETED</a></tt> </tt>
<a name="L21"></a><tt class="py-lineno"> 21</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-21" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-21', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-22" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-22', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-23" class="py-name"><a title="lib.cuckoo.common" class="py-name" href="#" onclick="return doclink('link-23', 'common', 'link-2');">common</a></tt><tt class="py-op">.</tt><tt id="link-24" class="py-name"><a title="lib.cuckoo.common.constants" class="py-name" href="#" onclick="return doclink('link-24', 'constants', 'link-8');">constants</a></tt> <tt class="py-keyword">import</tt> <tt id="link-25" class="py-name" targets="Variable lib.cuckoo.common.constants.CUCKOO_GUEST_FAILED=lib.cuckoo.common.constants-module.html#CUCKOO_GUEST_FAILED"><a title="lib.cuckoo.common.constants.CUCKOO_GUEST_FAILED" class="py-name" href="#" onclick="return doclink('link-25', 'CUCKOO_GUEST_FAILED', 'link-25');">CUCKOO_GUEST_FAILED</a></tt> </tt>
<a name="L22"></a><tt class="py-lineno"> 22</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-26" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-26', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-27" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-27', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-28" class="py-name"><a title="lib.cuckoo.common" class="py-name" href="#" onclick="return doclink('link-28', 'common', 'link-2');">common</a></tt><tt class="py-op">.</tt><tt id="link-29" class="py-name" targets="Module lib.cuckoo.common.exceptions=lib.cuckoo.common.exceptions-module.html"><a title="lib.cuckoo.common.exceptions" class="py-name" href="#" onclick="return doclink('link-29', 'exceptions', 'link-29');">exceptions</a></tt> <tt class="py-keyword">import</tt> <tt id="link-30" class="py-name" targets="Class lib.cuckoo.common.exceptions.CuckooGuestError=lib.cuckoo.common.exceptions.CuckooGuestError-class.html"><a title="lib.cuckoo.common.exceptions.CuckooGuestError" class="py-name" href="#" onclick="return doclink('link-30', 'CuckooGuestError', 'link-30');">CuckooGuestError</a></tt> </tt>
<a name="L23"></a><tt class="py-lineno"> 23</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-31" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-31', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-32" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-32', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-33" class="py-name"><a title="lib.cuckoo.common" class="py-name" href="#" onclick="return doclink('link-33', 'common', 'link-2');">common</a></tt><tt class="py-op">.</tt><tt id="link-34" class="py-name" targets="Module lib.cuckoo.common.utils=lib.cuckoo.common.utils-module.html"><a title="lib.cuckoo.common.utils" class="py-name" href="#" onclick="return doclink('link-34', 'utils', 'link-34');">utils</a></tt> <tt class="py-keyword">import</tt> <tt id="link-35" class="py-name" targets="Class lib.cuckoo.common.utils.TimeoutServer=lib.cuckoo.common.utils.TimeoutServer-class.html"><a title="lib.cuckoo.common.utils.TimeoutServer" class="py-name" href="#" onclick="return doclink('link-35', 'TimeoutServer', 'link-35');">TimeoutServer</a></tt> </tt>
<a name="L24"></a><tt class="py-lineno"> 24</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-36" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-36', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-37" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-37', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-38" class="py-name" targets="Package lib.cuckoo.core=lib.cuckoo.core-module.html"><a title="lib.cuckoo.core" class="py-name" href="#" onclick="return doclink('link-38', 'core', 'link-38');">core</a></tt><tt class="py-op">.</tt><tt id="link-39" class="py-name" targets="Module lib.cuckoo.core.database=lib.cuckoo.core.database-module.html"><a title="lib.cuckoo.core.database" class="py-name" href="#" onclick="return doclink('link-39', 'database', 'link-39');">database</a></tt> <tt class="py-keyword">import</tt> <tt id="link-40" class="py-name" targets="Class lib.cuckoo.core.database.Database=lib.cuckoo.core.database.Database-class.html"><a title="lib.cuckoo.core.database.Database" class="py-name" href="#" onclick="return doclink('link-40', 'Database', 'link-40');">Database</a></tt> </tt>
<a name="L25"></a><tt class="py-lineno"> 25</tt>  <tt class="py-line"> </tt>
<a name="L26"></a><tt class="py-lineno"> 26</tt>  <tt class="py-line"><tt id="link-41" class="py-name" targets="Variable lib.cuckoo.common.abstracts.log=lib.cuckoo.common.abstracts-module.html#log,Variable lib.cuckoo.common.irc.log=lib.cuckoo.common.irc-module.html#log,Variable lib.cuckoo.common.netlog.log=lib.cuckoo.common.netlog-module.html#log,Variable lib.cuckoo.common.objects.log=lib.cuckoo.common.objects-module.html#log,Variable lib.cuckoo.core.database.log=lib.cuckoo.core.database-module.html#log,Variable lib.cuckoo.core.guest.log=lib.cuckoo.core.guest-module.html#log,Variable lib.cuckoo.core.plugins.log=lib.cuckoo.core.plugins-module.html#log,Variable lib.cuckoo.core.resultserver.log=lib.cuckoo.core.resultserver-module.html#log,Variable lib.cuckoo.core.rooter.log=lib.cuckoo.core.rooter-module.html#log,Variable lib.cuckoo.core.scheduler.log=lib.cuckoo.core.scheduler-module.html#log,Variable lib.cuckoo.core.startup.log=lib.cuckoo.core.startup-module.html#log,Variable modules.auxiliary.mitm.log=modules.auxiliary.mitm-module.html#log,Variable modules.auxiliary.services.log=modules.auxiliary.services-module.html#log,Variable modules.auxiliary.sniffer.log=modules.auxiliary.sniffer-module.html#log,Variable modules.machinery.avd.log=modules.machinery.avd-module.html#log,Variable modules.machinery.physical.log=modules.machinery.physical-module.html#log,Variable modules.machinery.qemu.log=modules.machinery.qemu-module.html#log,Variable modules.machinery.virtualbox.log=modules.machinery.virtualbox-module.html#log,Variable modules.machinery.vmware.log=modules.machinery.vmware-module.html#log,Variable modules.machinery.vsphere.log=modules.machinery.vsphere-module.html#log,Variable modules.machinery.xenserver.log=modules.machinery.xenserver-module.html#log,Variable modules.processing.analysisinfo.log=modules.processing.analysisinfo-module.html#log,Variable modules.processing.apkinfo.log=modules.processing.apkinfo-module.html#log,Variable modules.processing.baseline.log=modules.processing.baseline-module.html#log,Variable modules.processing.behavior.log=modules.processing.behavior-module.html#log,Variable modules.processing.droidmon.log=modules.processing.droidmon-module.html#log,Variable modules.processing.dumptls.log=modules.processing.dumptls-module.html#log,Variable modules.processing.googleplay.log=modules.processing.googleplay-module.html#log,Variable modules.processing.memory.log=modules.processing.memory-module.html#log,Variable modules.processing.network.log=modules.processing.network-module.html#log,Variable modules.processing.platform.linux.log=modules.processing.platform.linux-module.html#log,Variable modules.processing.platform.windows.log=modules.processing.platform.windows-module.html#log,Variable modules.processing.screenshots.log=modules.processing.screenshots-module.html#log,Variable modules.processing.snort.log=modules.processing.snort-module.html#log,Variable modules.processing.static.log=modules.processing.static-module.html#log,Variable modules.processing.suricata.log=modules.processing.suricata-module.html#log,Variable modules.processing.virustotal.log=modules.processing.virustotal-module.html#log,Variable modules.reporting.moloch.log=modules.reporting.moloch-module.html#log"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-41', 'log', 'link-41');">log</a></tt> <tt class="py-op">=</tt> <tt class="py-name">logging</tt><tt class="py-op">.</tt><tt class="py-name">getLogger</tt><tt class="py-op">(</tt><tt class="py-name">__name__</tt><tt class="py-op">)</tt> </tt>
<a name="L27"></a><tt class="py-lineno"> 27</tt>  <tt class="py-line"><tt id="link-42" class="py-name" targets="Variable lib.cuckoo.core.guest.db=lib.cuckoo.core.guest-module.html#db,Variable modules.auxiliary.services.db=modules.auxiliary.services-module.html#db"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-42', 'db', 'link-42');">db</a></tt> <tt class="py-op">=</tt> <tt id="link-43" class="py-name"><a title="lib.cuckoo.core.database.Database" class="py-name" href="#" onclick="return doclink('link-43', 'Database', 'link-40');">Database</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="OldGuestManager"></a><div id="OldGuestManager-def"><a name="L28"></a><tt class="py-lineno"> 28</tt>  <tt class="py-line"> </tt>
<a name="L29"></a><tt class="py-lineno"> 29</tt> <a class="py-toggle" href="#" id="OldGuestManager-toggle" onclick="return toggle('OldGuestManager');">-</a><tt class="py-line"><tt class="py-keyword">class</tt> <a class="py-def-name" href="lib.cuckoo.core.guest.OldGuestManager-class.html">OldGuestManager</a><tt class="py-op">(</tt><tt class="py-base-class">object</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="OldGuestManager-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="OldGuestManager-expanded"><a name="L30"></a><tt class="py-lineno"> 30</tt>  <tt class="py-line">    <tt class="py-docstring">"""Old and deprecated Guest Manager.</tt> </tt>
<a name="L31"></a><tt class="py-lineno"> 31</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L32"></a><tt class="py-lineno"> 32</tt>  <tt class="py-line"><tt class="py-docstring">    This class handles the communications with the old agent running in the</tt> </tt>
<a name="L33"></a><tt class="py-lineno"> 33</tt>  <tt class="py-line"><tt class="py-docstring">    virtual machine.</tt> </tt>
<a name="L34"></a><tt class="py-lineno"> 34</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L35"></a><tt class="py-lineno"> 35</tt>  <tt class="py-line"> </tt>
<a name="OldGuestManager.__init__"></a><div id="OldGuestManager.__init__-def"><a name="L36"></a><tt class="py-lineno"> 36</tt> <a class="py-toggle" href="#" id="OldGuestManager.__init__-toggle" onclick="return toggle('OldGuestManager.__init__');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.guest.OldGuestManager-class.html#__init__">__init__</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">vm_id</tt><tt class="py-op">,</tt> <tt class="py-param">ip</tt><tt class="py-op">,</tt> <tt class="py-param">platform</tt><tt class="py-op">,</tt> <tt class="py-param">task_id</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="OldGuestManager.__init__-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="OldGuestManager.__init__-expanded"><a name="L37"></a><tt class="py-lineno"> 37</tt>  <tt class="py-line">        <tt class="py-docstring">"""@param ip: guest's IP address.</tt> </tt>
<a name="L38"></a><tt class="py-lineno"> 38</tt>  <tt class="py-line"><tt class="py-docstring">        @param platform: guest's operating system type.</tt> </tt>
<a name="L39"></a><tt class="py-lineno"> 39</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L40"></a><tt class="py-lineno"> 40</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-44" class="py-name" targets="Variable lib.cuckoo.core.database.Error.id=lib.cuckoo.core.database.Error-class.html#id,Variable lib.cuckoo.core.database.Guest.id=lib.cuckoo.core.database.Guest-class.html#id,Variable lib.cuckoo.core.database.Machine.id=lib.cuckoo.core.database.Machine-class.html#id,Variable lib.cuckoo.core.database.Sample.id=lib.cuckoo.core.database.Sample-class.html#id,Variable lib.cuckoo.core.database.Tag.id=lib.cuckoo.core.database.Tag-class.html#id,Variable lib.cuckoo.core.database.Task.id=lib.cuckoo.core.database.Task-class.html#id"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-44', 'id', 'link-44');">id</a></tt> <tt class="py-op">=</tt> <tt class="py-name">vm_id</tt> </tt>
<a name="L41"></a><tt class="py-lineno"> 41</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-45" class="py-name" targets="Variable lib.cuckoo.core.database.Machine.ip=lib.cuckoo.core.database.Machine-class.html#ip"><a title="lib.cuckoo.core.database.Machine.ip" class="py-name" href="#" onclick="return doclink('link-45', 'ip', 'link-45');">ip</a></tt> <tt class="py-op">=</tt> <tt id="link-46" class="py-name"><a title="lib.cuckoo.core.database.Machine.ip" class="py-name" href="#" onclick="return doclink('link-46', 'ip', 'link-45');">ip</a></tt> </tt>
<a name="L42"></a><tt class="py-lineno"> 42</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-47" class="py-name" targets="Variable lib.cuckoo.common.abstracts.Signature.platform=lib.cuckoo.common.abstracts.Signature-class.html#platform,Variable lib.cuckoo.core.database.Machine.platform=lib.cuckoo.core.database.Machine-class.html#platform,Variable lib.cuckoo.core.database.Task.platform=lib.cuckoo.core.database.Task-class.html#platform,Package modules.processing.platform=modules.processing.platform-module.html"><a title="lib.cuckoo.common.abstracts.Signature.platform
lib.cuckoo.core.database.Machine.platform
lib.cuckoo.core.database.Task.platform
modules.processing.platform" class="py-name" href="#" onclick="return doclink('link-47', 'platform', 'link-47');">platform</a></tt> <tt class="py-op">=</tt> <tt id="link-48" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.platform
lib.cuckoo.core.database.Machine.platform
lib.cuckoo.core.database.Task.platform
modules.processing.platform" class="py-name" href="#" onclick="return doclink('link-48', 'platform', 'link-47');">platform</a></tt> </tt>
<a name="L43"></a><tt class="py-lineno"> 43</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-49" class="py-name" targets="Variable lib.cuckoo.core.database.Error.task_id=lib.cuckoo.core.database.Error-class.html#task_id,Variable lib.cuckoo.core.database.Guest.task_id=lib.cuckoo.core.database.Guest-class.html#task_id"><a title="lib.cuckoo.core.database.Error.task_id
lib.cuckoo.core.database.Guest.task_id" class="py-name" href="#" onclick="return doclink('link-49', 'task_id', 'link-49');">task_id</a></tt> <tt class="py-op">=</tt> <tt id="link-50" class="py-name"><a title="lib.cuckoo.core.database.Error.task_id
lib.cuckoo.core.database.Guest.task_id" class="py-name" href="#" onclick="return doclink('link-50', 'task_id', 'link-49');">task_id</a></tt> </tt>
<a name="L44"></a><tt class="py-lineno"> 44</tt>  <tt class="py-line"> </tt>
<a name="L45"></a><tt class="py-lineno"> 45</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-51" class="py-name" targets="Variable lib.cuckoo.core.rooter.cfg=lib.cuckoo.core.rooter-module.html#cfg,Variable modules.auxiliary.services.cfg=modules.auxiliary.services-module.html#cfg,Variable modules.processing.network.cfg=modules.processing.network-module.html#cfg"><a title="lib.cuckoo.core.rooter.cfg
modules.auxiliary.services.cfg
modules.processing.network.cfg" class="py-name" href="#" onclick="return doclink('link-51', 'cfg', 'link-51');">cfg</a></tt> <tt class="py-op">=</tt> <tt id="link-52" class="py-name"><a title="lib.cuckoo.common.config.Config" class="py-name" href="#" onclick="return doclink('link-52', 'Config', 'link-4');">Config</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L46"></a><tt class="py-lineno"> 46</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-53" class="py-name" targets="Variable lib.cuckoo.core.database.Task.timeout=lib.cuckoo.core.database.Task-class.html#timeout"><a title="lib.cuckoo.core.database.Task.timeout" class="py-name" href="#" onclick="return doclink('link-53', 'timeout', 'link-53');">timeout</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-54" class="py-name"><a title="lib.cuckoo.core.rooter.cfg
modules.auxiliary.services.cfg
modules.processing.network.cfg" class="py-name" href="#" onclick="return doclink('link-54', 'cfg', 'link-51');">cfg</a></tt><tt class="py-op">.</tt><tt class="py-name">timeouts</tt><tt class="py-op">.</tt><tt class="py-name">critical</tt> </tt>
<a name="L47"></a><tt class="py-lineno"> 47</tt>  <tt class="py-line"> </tt>
<a name="L48"></a><tt class="py-lineno"> 48</tt>  <tt class="py-line">        <tt class="py-name">url</tt> <tt class="py-op">=</tt> <tt class="py-string">"http://{0}:{1}"</tt><tt class="py-op">.</tt><tt class="py-name">format</tt><tt class="py-op">(</tt><tt id="link-55" class="py-name"><a title="lib.cuckoo.core.database.Machine.ip" class="py-name" href="#" onclick="return doclink('link-55', 'ip', 'link-45');">ip</a></tt><tt class="py-op">,</tt> <tt id="link-56" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_GUEST_PORT" class="py-name" href="#" onclick="return doclink('link-56', 'CUCKOO_GUEST_PORT', 'link-14');">CUCKOO_GUEST_PORT</a></tt><tt class="py-op">)</tt> </tt>
<a name="L49"></a><tt class="py-lineno"> 49</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-57" class="py-name" targets="Variable lib.cuckoo.core.guest.GuestManager.server=lib.cuckoo.core.guest.GuestManager-class.html#server"><a title="lib.cuckoo.core.guest.GuestManager.server" class="py-name" href="#" onclick="return doclink('link-57', 'server', 'link-57');">server</a></tt> <tt class="py-op">=</tt> <tt id="link-58" class="py-name"><a title="lib.cuckoo.common.utils.TimeoutServer" class="py-name" href="#" onclick="return doclink('link-58', 'TimeoutServer', 'link-35');">TimeoutServer</a></tt><tt class="py-op">(</tt><tt class="py-name">url</tt><tt class="py-op">,</tt> <tt class="py-name">allow_none</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">,</tt> </tt>
<a name="L50"></a><tt class="py-lineno"> 50</tt>  <tt class="py-line">                                    <tt id="link-59" class="py-name"><a title="lib.cuckoo.core.database.Task.timeout" class="py-name" href="#" onclick="return doclink('link-59', 'timeout', 'link-53');">timeout</a></tt><tt class="py-op">=</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-60" class="py-name"><a title="lib.cuckoo.core.database.Task.timeout" class="py-name" href="#" onclick="return doclink('link-60', 'timeout', 'link-53');">timeout</a></tt><tt class="py-op">)</tt> </tt>
</div><a name="L51"></a><tt class="py-lineno"> 51</tt>  <tt class="py-line"> </tt>
<a name="OldGuestManager.wait"></a><div id="OldGuestManager.wait-def"><a name="L52"></a><tt class="py-lineno"> 52</tt> <a class="py-toggle" href="#" id="OldGuestManager.wait-toggle" onclick="return toggle('OldGuestManager.wait');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.guest.OldGuestManager-class.html#wait">wait</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">status</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="OldGuestManager.wait-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="OldGuestManager.wait-expanded"><a name="L53"></a><tt class="py-lineno"> 53</tt>  <tt class="py-line">        <tt class="py-docstring">"""Waiting for status.</tt> </tt>
<a name="L54"></a><tt class="py-lineno"> 54</tt>  <tt class="py-line"><tt class="py-docstring">        @param status: status.</tt> </tt>
<a name="L55"></a><tt class="py-lineno"> 55</tt>  <tt class="py-line"><tt class="py-docstring">        @return: always True.</tt> </tt>
<a name="L56"></a><tt class="py-lineno"> 56</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L57"></a><tt class="py-lineno"> 57</tt>  <tt class="py-line">        <tt id="link-61" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-61', 'log', 'link-41');">log</a></tt><tt class="py-op">.</tt><tt id="link-62" class="py-name" targets="Module modules.processing.debug=modules.processing.debug-module.html"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-62', 'debug', 'link-62');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"%s: waiting for status 0x%.04x"</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-63" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-63', 'id', 'link-44');">id</a></tt><tt class="py-op">,</tt> <tt id="link-64" class="py-name" targets="Variable lib.cuckoo.core.database.Guest.status=lib.cuckoo.core.database.Guest-class.html#status,Variable lib.cuckoo.core.database.Machine.status=lib.cuckoo.core.database.Machine-class.html#status,Variable lib.cuckoo.core.database.Task.status=lib.cuckoo.core.database.Task-class.html#status"><a title="lib.cuckoo.core.database.Guest.status
lib.cuckoo.core.database.Machine.status
lib.cuckoo.core.database.Task.status" class="py-name" href="#" onclick="return doclink('link-64', 'status', 'link-64');">status</a></tt><tt class="py-op">)</tt> </tt>
<a name="L58"></a><tt class="py-lineno"> 58</tt>  <tt class="py-line"> </tt>
<a name="L59"></a><tt class="py-lineno"> 59</tt>  <tt class="py-line">        <tt class="py-name">end</tt> <tt class="py-op">=</tt> <tt class="py-name">time</tt><tt class="py-op">.</tt><tt class="py-name">time</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-65" class="py-name"><a title="lib.cuckoo.core.database.Task.timeout" class="py-name" href="#" onclick="return doclink('link-65', 'timeout', 'link-53');">timeout</a></tt> </tt>
<a name="L60"></a><tt class="py-lineno"> 60</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-66" class="py-name"><a title="lib.cuckoo.core.guest.GuestManager.server" class="py-name" href="#" onclick="return doclink('link-66', 'server', 'link-57');">server</a></tt><tt class="py-op">.</tt><tt id="link-67" class="py-name" targets="Method lib.cuckoo.common.utils.TimeoutServer._set_timeout()=lib.cuckoo.common.utils.TimeoutServer-class.html#_set_timeout"><a title="lib.cuckoo.common.utils.TimeoutServer._set_timeout" class="py-name" href="#" onclick="return doclink('link-67', '_set_timeout', 'link-67');">_set_timeout</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-68" class="py-name"><a title="lib.cuckoo.core.database.Task.timeout" class="py-name" href="#" onclick="return doclink('link-68', 'timeout', 'link-53');">timeout</a></tt><tt class="py-op">)</tt> </tt>
<a name="L61"></a><tt class="py-lineno"> 61</tt>  <tt class="py-line"> </tt>
<a name="L62"></a><tt class="py-lineno"> 62</tt>  <tt class="py-line">        <tt class="py-keyword">while</tt> <tt id="link-69" class="py-name"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-69', 'db', 'link-42');">db</a></tt><tt class="py-op">.</tt><tt id="link-70" class="py-name" targets="Method lib.cuckoo.core.database.Database.guest_get_status()=lib.cuckoo.core.database.Database-class.html#guest_get_status"><a title="lib.cuckoo.core.database.Database.guest_get_status" class="py-name" href="#" onclick="return doclink('link-70', 'guest_get_status', 'link-70');">guest_get_status</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-71" class="py-name"><a title="lib.cuckoo.core.database.Error.task_id
lib.cuckoo.core.database.Guest.task_id" class="py-name" href="#" onclick="return doclink('link-71', 'task_id', 'link-49');">task_id</a></tt><tt class="py-op">)</tt> <tt class="py-op">==</tt> <tt class="py-string">"starting"</tt><tt class="py-op">:</tt> </tt>
<a name="L63"></a><tt class="py-lineno"> 63</tt>  <tt class="py-line">            <tt class="py-comment"># Check if we've passed the timeout.</tt> </tt>
<a name="L64"></a><tt class="py-lineno"> 64</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">time</tt><tt class="py-op">.</tt><tt class="py-name">time</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> <tt class="py-op">&gt;</tt> <tt class="py-name">end</tt><tt class="py-op">:</tt> </tt>
<a name="L65"></a><tt class="py-lineno"> 65</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-72" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooGuestError" class="py-name" href="#" onclick="return doclink('link-72', 'CuckooGuestError', 'link-30');">CuckooGuestError</a></tt><tt class="py-op">(</tt><tt class="py-string">"{0}: the guest initialization hit the "</tt> </tt>
<a name="L66"></a><tt class="py-lineno"> 66</tt>  <tt class="py-line">                                       <tt class="py-string">"critical timeout, analysis "</tt> </tt>
<a name="L67"></a><tt class="py-lineno"> 67</tt>  <tt class="py-line">                                       <tt class="py-string">"aborted."</tt><tt class="py-op">.</tt><tt class="py-name">format</tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-73" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-73', 'id', 'link-44');">id</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L68"></a><tt class="py-lineno"> 68</tt>  <tt class="py-line"> </tt>
<a name="L69"></a><tt class="py-lineno"> 69</tt>  <tt class="py-line">            <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L70"></a><tt class="py-lineno"> 70</tt>  <tt class="py-line">                <tt class="py-comment"># If the server returns the given status, break the loop</tt> </tt>
<a name="L71"></a><tt class="py-lineno"> 71</tt>  <tt class="py-line">                <tt class="py-comment"># and return.</tt> </tt>
<a name="L72"></a><tt class="py-lineno"> 72</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-74" class="py-name"><a title="lib.cuckoo.core.guest.GuestManager.server" class="py-name" href="#" onclick="return doclink('link-74', 'server', 'link-57');">server</a></tt><tt class="py-op">.</tt><tt class="py-name">get_status</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> <tt class="py-op">==</tt> <tt id="link-75" class="py-name"><a title="lib.cuckoo.core.database.Guest.status
lib.cuckoo.core.database.Machine.status
lib.cuckoo.core.database.Task.status" class="py-name" href="#" onclick="return doclink('link-75', 'status', 'link-64');">status</a></tt><tt class="py-op">:</tt> </tt>
<a name="L73"></a><tt class="py-lineno"> 73</tt>  <tt class="py-line">                    <tt id="link-76" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-76', 'log', 'link-41');">log</a></tt><tt class="py-op">.</tt><tt id="link-77" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-77', 'debug', 'link-62');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"%s: status ready"</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-78" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-78', 'id', 'link-44');">id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L74"></a><tt class="py-lineno"> 74</tt>  <tt class="py-line">                    <tt class="py-keyword">break</tt> </tt>
<a name="L75"></a><tt class="py-lineno"> 75</tt>  <tt class="py-line">            <tt class="py-keyword">except</tt><tt class="py-op">:</tt> </tt>
<a name="L76"></a><tt class="py-lineno"> 76</tt>  <tt class="py-line">                <tt class="py-keyword">pass</tt> </tt>
<a name="L77"></a><tt class="py-lineno"> 77</tt>  <tt class="py-line"> </tt>
<a name="L78"></a><tt class="py-lineno"> 78</tt>  <tt class="py-line">            <tt id="link-79" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-79', 'log', 'link-41');">log</a></tt><tt class="py-op">.</tt><tt id="link-80" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-80', 'debug', 'link-62');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"%s: not ready yet"</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-81" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-81', 'id', 'link-44');">id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L79"></a><tt class="py-lineno"> 79</tt>  <tt class="py-line">            <tt class="py-name">time</tt><tt class="py-op">.</tt><tt class="py-name">sleep</tt><tt class="py-op">(</tt><tt class="py-number">1</tt><tt class="py-op">)</tt> </tt>
<a name="L80"></a><tt class="py-lineno"> 80</tt>  <tt class="py-line"> </tt>
<a name="L81"></a><tt class="py-lineno"> 81</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-82" class="py-name"><a title="lib.cuckoo.core.guest.GuestManager.server" class="py-name" href="#" onclick="return doclink('link-82', 'server', 'link-57');">server</a></tt><tt class="py-op">.</tt><tt id="link-83" class="py-name"><a title="lib.cuckoo.common.utils.TimeoutServer._set_timeout" class="py-name" href="#" onclick="return doclink('link-83', '_set_timeout', 'link-67');">_set_timeout</a></tt><tt class="py-op">(</tt><tt class="py-name">None</tt><tt class="py-op">)</tt> </tt>
<a name="L82"></a><tt class="py-lineno"> 82</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">True</tt> </tt>
</div><a name="L83"></a><tt class="py-lineno"> 83</tt>  <tt class="py-line"> </tt>
<a name="OldGuestManager.upload_analyzer"></a><div id="OldGuestManager.upload_analyzer-def"><a name="L84"></a><tt class="py-lineno"> 84</tt> <a class="py-toggle" href="#" id="OldGuestManager.upload_analyzer-toggle" onclick="return toggle('OldGuestManager.upload_analyzer');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.guest.OldGuestManager-class.html#upload_analyzer">upload_analyzer</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">monitor</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="OldGuestManager.upload_analyzer-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="OldGuestManager.upload_analyzer-expanded"><a name="L85"></a><tt class="py-lineno"> 85</tt>  <tt class="py-line">        <tt class="py-docstring">"""Upload analyzer to guest.</tt> </tt>
<a name="L86"></a><tt class="py-lineno"> 86</tt>  <tt class="py-line"><tt class="py-docstring">        @return: operation status.</tt> </tt>
<a name="L87"></a><tt class="py-lineno"> 87</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L88"></a><tt class="py-lineno"> 88</tt>  <tt class="py-line">        <tt class="py-name">zip_data</tt> <tt class="py-op">=</tt> <tt class="py-name">StringIO</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L89"></a><tt class="py-lineno"> 89</tt>  <tt class="py-line">        <tt class="py-name">zip_file</tt> <tt class="py-op">=</tt> <tt class="py-name">ZipFile</tt><tt class="py-op">(</tt><tt class="py-name">zip_data</tt><tt class="py-op">,</tt> <tt class="py-string">"w"</tt><tt class="py-op">,</tt> <tt class="py-name">ZIP_STORED</tt><tt class="py-op">)</tt> </tt>
<a name="L90"></a><tt class="py-lineno"> 90</tt>  <tt class="py-line"> </tt>
<a name="L91"></a><tt class="py-lineno"> 91</tt>  <tt class="py-line">        <tt class="py-comment"># Select the proper analyzer's folder according to the operating</tt> </tt>
<a name="L92"></a><tt class="py-lineno"> 92</tt>  <tt class="py-line">        <tt class="py-comment"># system associated with the current machine.</tt> </tt>
<a name="L93"></a><tt class="py-lineno"> 93</tt>  <tt class="py-line">        <tt class="py-name">root</tt> <tt class="py-op">=</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt id="link-84" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_ROOT" class="py-name" href="#" onclick="return doclink('link-84', 'CUCKOO_ROOT', 'link-9');">CUCKOO_ROOT</a></tt><tt class="py-op">,</tt> <tt class="py-string">"analyzer"</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-85" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.platform
lib.cuckoo.core.database.Machine.platform
lib.cuckoo.core.database.Task.platform
modules.processing.platform" class="py-name" href="#" onclick="return doclink('link-85', 'platform', 'link-47');">platform</a></tt><tt class="py-op">)</tt> </tt>
<a name="L94"></a><tt class="py-lineno"> 94</tt>  <tt class="py-line">        <tt class="py-name">root_len</tt> <tt class="py-op">=</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">abspath</tt><tt class="py-op">(</tt><tt class="py-name">root</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L95"></a><tt class="py-lineno"> 95</tt>  <tt class="py-line"> </tt>
<a name="L96"></a><tt class="py-lineno"> 96</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">exists</tt><tt class="py-op">(</tt><tt class="py-name">root</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L97"></a><tt class="py-lineno"> 97</tt>  <tt class="py-line">            <tt id="link-86" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-86', 'log', 'link-41');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">error</tt><tt class="py-op">(</tt><tt class="py-string">"No valid analyzer found at path: %s"</tt><tt class="py-op">,</tt> <tt class="py-name">root</tt><tt class="py-op">)</tt> </tt>
<a name="L98"></a><tt class="py-lineno"> 98</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-name">False</tt> </tt>
<a name="L99"></a><tt class="py-lineno"> 99</tt>  <tt class="py-line"> </tt>
<a name="L100"></a><tt class="py-lineno">100</tt>  <tt class="py-line">        <tt class="py-comment"># Walk through everything inside the analyzer's folder and write</tt> </tt>
<a name="L101"></a><tt class="py-lineno">101</tt>  <tt class="py-line">        <tt class="py-comment"># them to the zip archive.</tt> </tt>
<a name="L102"></a><tt class="py-lineno">102</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">root</tt><tt class="py-op">,</tt> <tt class="py-name">dirs</tt><tt class="py-op">,</tt> <tt class="py-name">files</tt> <tt class="py-keyword">in</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">walk</tt><tt class="py-op">(</tt><tt class="py-name">root</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L103"></a><tt class="py-lineno">103</tt>  <tt class="py-line">            <tt class="py-name">archive_root</tt> <tt class="py-op">=</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">abspath</tt><tt class="py-op">(</tt><tt class="py-name">root</tt><tt class="py-op">)</tt><tt class="py-op">[</tt><tt class="py-name">root_len</tt><tt class="py-op">:</tt><tt class="py-op">]</tt> </tt>
<a name="L104"></a><tt class="py-lineno">104</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-87" class="py-name" targets="Variable lib.cuckoo.common.abstracts.Signature.name=lib.cuckoo.common.abstracts.Signature-class.html#name,Variable lib.cuckoo.core.database.Guest.name=lib.cuckoo.core.database.Guest-class.html#name,Variable lib.cuckoo.core.database.Machine.name=lib.cuckoo.core.database.Machine-class.html#name,Variable lib.cuckoo.core.database.Tag.name=lib.cuckoo.core.database.Tag-class.html#name,Variable modules.signatures.creates_exe.CreatesExe.name=modules.signatures.creates_exe.CreatesExe-class.html#name,Variable modules.signatures.generic_metrics.SystemMetrics.name=modules.signatures.generic_metrics.SystemMetrics-class.html#name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-87', 'name', 'link-87');">name</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">files</tt><tt class="py-op">:</tt> </tt>
<a name="L105"></a><tt class="py-lineno">105</tt>  <tt class="py-line">                <tt class="py-name">path</tt> <tt class="py-op">=</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt class="py-name">root</tt><tt class="py-op">,</tt> <tt id="link-88" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-88', 'name', 'link-87');">name</a></tt><tt class="py-op">)</tt> </tt>
<a name="L106"></a><tt class="py-lineno">106</tt>  <tt class="py-line">                <tt class="py-name">archive_name</tt> <tt class="py-op">=</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt class="py-name">archive_root</tt><tt class="py-op">,</tt> <tt id="link-89" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-89', 'name', 'link-87');">name</a></tt><tt class="py-op">)</tt> </tt>
<a name="L107"></a><tt class="py-lineno">107</tt>  <tt class="py-line">                <tt class="py-name">zip_file</tt><tt class="py-op">.</tt><tt id="link-90" class="py-name" targets="Method modules.processing.network.SortCap.write()=modules.processing.network.SortCap-class.html#write"><a title="modules.processing.network.SortCap.write" class="py-name" href="#" onclick="return doclink('link-90', 'write', 'link-90');">write</a></tt><tt class="py-op">(</tt><tt class="py-name">path</tt><tt class="py-op">,</tt> <tt class="py-name">archive_name</tt><tt class="py-op">)</tt> </tt>
<a name="L108"></a><tt class="py-lineno">108</tt>  <tt class="py-line"> </tt>
<a name="L109"></a><tt class="py-lineno">109</tt>  <tt class="py-line">        <tt class="py-comment"># Include the chosen monitoring component.</tt> </tt>
<a name="L110"></a><tt class="py-lineno">110</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-91" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.platform
lib.cuckoo.core.database.Machine.platform
lib.cuckoo.core.database.Task.platform
modules.processing.platform" class="py-name" href="#" onclick="return doclink('link-91', 'platform', 'link-47');">platform</a></tt> <tt class="py-op">==</tt> <tt class="py-string">"windows"</tt><tt class="py-op">:</tt> </tt>
<a name="L111"></a><tt class="py-lineno">111</tt>  <tt class="py-line">            <tt class="py-name">dirpath</tt> <tt class="py-op">=</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt id="link-92" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_ROOT" class="py-name" href="#" onclick="return doclink('link-92', 'CUCKOO_ROOT', 'link-9');">CUCKOO_ROOT</a></tt><tt class="py-op">,</tt> <tt class="py-string">"data"</tt><tt class="py-op">,</tt> <tt class="py-string">"monitor"</tt><tt class="py-op">,</tt> <tt class="py-name">monitor</tt><tt class="py-op">)</tt> </tt>
<a name="L112"></a><tt class="py-lineno">112</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-93" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-93', 'name', 'link-87');">name</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">listdir</tt><tt class="py-op">(</tt><tt class="py-name">dirpath</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L113"></a><tt class="py-lineno">113</tt>  <tt class="py-line">                <tt class="py-name">path</tt> <tt class="py-op">=</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt class="py-name">dirpath</tt><tt class="py-op">,</tt> <tt id="link-94" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-94', 'name', 'link-87');">name</a></tt><tt class="py-op">)</tt> </tt>
<a name="L114"></a><tt class="py-lineno">114</tt>  <tt class="py-line">                <tt class="py-name">archive_name</tt> <tt class="py-op">=</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt class="py-string">"/bin"</tt><tt class="py-op">,</tt> <tt id="link-95" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-95', 'name', 'link-87');">name</a></tt><tt class="py-op">)</tt> </tt>
<a name="L115"></a><tt class="py-lineno">115</tt>  <tt class="py-line">                <tt class="py-name">zip_file</tt><tt class="py-op">.</tt><tt id="link-96" class="py-name"><a title="modules.processing.network.SortCap.write" class="py-name" href="#" onclick="return doclink('link-96', 'write', 'link-90');">write</a></tt><tt class="py-op">(</tt><tt class="py-name">path</tt><tt class="py-op">,</tt> <tt class="py-name">archive_name</tt><tt class="py-op">)</tt> </tt>
<a name="L116"></a><tt class="py-lineno">116</tt>  <tt class="py-line"> </tt>
<a name="L117"></a><tt class="py-lineno">117</tt>  <tt class="py-line">        <tt class="py-name">zip_file</tt><tt class="py-op">.</tt><tt id="link-97" class="py-name" targets="Method lib.cuckoo.common.netlog.BsonParser.close()=lib.cuckoo.common.netlog.BsonParser-class.html#close,Method lib.cuckoo.core.resultserver.FileUpload.close()=lib.cuckoo.core.resultserver.FileUpload-class.html#close,Method lib.cuckoo.core.resultserver.LogHandler.close()=lib.cuckoo.core.resultserver.LogHandler-class.html#close,Method modules.processing.network.SortCap.close()=modules.processing.network.SortCap-class.html#close"><a title="lib.cuckoo.common.netlog.BsonParser.close
lib.cuckoo.core.resultserver.FileUpload.close
lib.cuckoo.core.resultserver.LogHandler.close
modules.processing.network.SortCap.close" class="py-name" href="#" onclick="return doclink('link-97', 'close', 'link-97');">close</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L118"></a><tt class="py-lineno">118</tt>  <tt class="py-line">        <tt class="py-name">data</tt> <tt class="py-op">=</tt> <tt class="py-name">xmlrpclib</tt><tt class="py-op">.</tt><tt class="py-name">Binary</tt><tt class="py-op">(</tt><tt class="py-name">zip_data</tt><tt class="py-op">.</tt><tt class="py-name">getvalue</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L119"></a><tt class="py-lineno">119</tt>  <tt class="py-line">        <tt class="py-name">zip_data</tt><tt class="py-op">.</tt><tt id="link-98" class="py-name"><a title="lib.cuckoo.common.netlog.BsonParser.close
lib.cuckoo.core.resultserver.FileUpload.close
lib.cuckoo.core.resultserver.LogHandler.close
modules.processing.network.SortCap.close" class="py-name" href="#" onclick="return doclink('link-98', 'close', 'link-97');">close</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L120"></a><tt class="py-lineno">120</tt>  <tt class="py-line"> </tt>
<a name="L121"></a><tt class="py-lineno">121</tt>  <tt class="py-line">        <tt id="link-99" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-99', 'log', 'link-41');">log</a></tt><tt class="py-op">.</tt><tt id="link-100" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-100', 'debug', 'link-62');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"Uploading analyzer to guest (id=%s, ip=%s)"</tt><tt class="py-op">,</tt> </tt>
<a name="L122"></a><tt class="py-lineno">122</tt>  <tt class="py-line">                  <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-101" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-101', 'id', 'link-44');">id</a></tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-102" class="py-name"><a title="lib.cuckoo.core.database.Machine.ip" class="py-name" href="#" onclick="return doclink('link-102', 'ip', 'link-45');">ip</a></tt><tt class="py-op">)</tt> </tt>
<a name="L123"></a><tt class="py-lineno">123</tt>  <tt class="py-line"> </tt>
<a name="L124"></a><tt class="py-lineno">124</tt>  <tt class="py-line">        <tt class="py-comment"># Send the zip containing the analyzer to the agent running inside</tt> </tt>
<a name="L125"></a><tt class="py-lineno">125</tt>  <tt class="py-line">        <tt class="py-comment"># the guest.</tt> </tt>
<a name="L126"></a><tt class="py-lineno">126</tt>  <tt class="py-line">        <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L127"></a><tt class="py-lineno">127</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-103" class="py-name"><a title="lib.cuckoo.core.guest.GuestManager.server" class="py-name" href="#" onclick="return doclink('link-103', 'server', 'link-57');">server</a></tt><tt class="py-op">.</tt><tt class="py-name">add_analyzer</tt><tt class="py-op">(</tt><tt class="py-name">data</tt><tt class="py-op">)</tt> </tt>
<a name="L128"></a><tt class="py-lineno">128</tt>  <tt class="py-line">        <tt class="py-keyword">except</tt> <tt class="py-name">socket</tt><tt class="py-op">.</tt><tt id="link-104" class="py-name"><a title="lib.cuckoo.core.database.Task.timeout" class="py-name" href="#" onclick="return doclink('link-104', 'timeout', 'link-53');">timeout</a></tt><tt class="py-op">:</tt> </tt>
<a name="L129"></a><tt class="py-lineno">129</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-105" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooGuestError" class="py-name" href="#" onclick="return doclink('link-105', 'CuckooGuestError', 'link-30');">CuckooGuestError</a></tt><tt class="py-op">(</tt><tt class="py-string">"{0}: guest communication timeout: unable "</tt> </tt>
<a name="L130"></a><tt class="py-lineno">130</tt>  <tt class="py-line">                                   <tt class="py-string">"to upload agent, check networking or try "</tt> </tt>
<a name="L131"></a><tt class="py-lineno">131</tt>  <tt class="py-line">                                   <tt class="py-string">"to increase timeout"</tt><tt class="py-op">.</tt><tt class="py-name">format</tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-106" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-106', 'id', 'link-44');">id</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
</div><a name="L132"></a><tt class="py-lineno">132</tt>  <tt class="py-line"> </tt>
<a name="OldGuestManager.start_analysis"></a><div id="OldGuestManager.start_analysis-def"><a name="L133"></a><tt class="py-lineno">133</tt> <a class="py-toggle" href="#" id="OldGuestManager.start_analysis-toggle" onclick="return toggle('OldGuestManager.start_analysis');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.guest.OldGuestManager-class.html#start_analysis">start_analysis</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">options</tt><tt class="py-op">,</tt> <tt class="py-param">monitor</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="OldGuestManager.start_analysis-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="OldGuestManager.start_analysis-expanded"><a name="L134"></a><tt class="py-lineno">134</tt>  <tt class="py-line">        <tt class="py-docstring">"""Start analysis.</tt> </tt>
<a name="L135"></a><tt class="py-lineno">135</tt>  <tt class="py-line"><tt class="py-docstring">        @param options: options.</tt> </tt>
<a name="L136"></a><tt class="py-lineno">136</tt>  <tt class="py-line"><tt class="py-docstring">        @return: operation status.</tt> </tt>
<a name="L137"></a><tt class="py-lineno">137</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L138"></a><tt class="py-lineno">138</tt>  <tt class="py-line">        <tt class="py-comment"># TODO Deal with unicode URLs, should probably try URL encoding.</tt> </tt>
<a name="L139"></a><tt class="py-lineno">139</tt>  <tt class="py-line">        <tt class="py-comment"># Unicode files are being taken care of.</tt> </tt>
<a name="L140"></a><tt class="py-lineno">140</tt>  <tt class="py-line"> </tt>
<a name="L141"></a><tt class="py-lineno">141</tt>  <tt class="py-line">        <tt class="py-comment"># If the analysis timeout is higher than the critical timeout,</tt> </tt>
<a name="L142"></a><tt class="py-lineno">142</tt>  <tt class="py-line">        <tt class="py-comment"># automatically increase the critical timeout by one minute.</tt> </tt>
<a name="L143"></a><tt class="py-lineno">143</tt>  <tt class="py-line">        <tt class="py-comment"># if options["timeout"] &gt; self.timeout:</tt> </tt>
<a name="L144"></a><tt class="py-lineno">144</tt>  <tt class="py-line">        <tt class="py-comment">#     log.debug("Automatically increased critical timeout to %s",</tt> </tt>
<a name="L145"></a><tt class="py-lineno">145</tt>  <tt class="py-line">        <tt class="py-comment">#               self.timeout)</tt> </tt>
<a name="L146"></a><tt class="py-lineno">146</tt>  <tt class="py-line">        <tt class="py-comment">#     self.timeout = options["timeout"] + 60</tt> </tt>
<a name="L147"></a><tt class="py-lineno">147</tt>  <tt class="py-line"> </tt>
<a name="L148"></a><tt class="py-lineno">148</tt>  <tt class="py-line">        <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L149"></a><tt class="py-lineno">149</tt>  <tt class="py-line">            <tt class="py-comment"># Wait for the agent to respond. This is done to check the</tt> </tt>
<a name="L150"></a><tt class="py-lineno">150</tt>  <tt class="py-line">            <tt class="py-comment"># availability of the agent and verify that it's ready to receive</tt> </tt>
<a name="L151"></a><tt class="py-lineno">151</tt>  <tt class="py-line">            <tt class="py-comment"># data.</tt> </tt>
<a name="L152"></a><tt class="py-lineno">152</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-107" class="py-name" targets="Method lib.cuckoo.core.guest.OldGuestManager.wait()=lib.cuckoo.core.guest.OldGuestManager-class.html#wait"><a title="lib.cuckoo.core.guest.OldGuestManager.wait" class="py-name" href="#" onclick="return doclink('link-107', 'wait', 'link-107');">wait</a></tt><tt class="py-op">(</tt><tt id="link-108" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_GUEST_INIT" class="py-name" href="#" onclick="return doclink('link-108', 'CUCKOO_GUEST_INIT', 'link-15');">CUCKOO_GUEST_INIT</a></tt><tt class="py-op">)</tt> </tt>
<a name="L153"></a><tt class="py-lineno">153</tt>  <tt class="py-line"> </tt>
<a name="L154"></a><tt class="py-lineno">154</tt>  <tt class="py-line">            <tt class="py-comment"># Invoke the upload of the analyzer to the guest.</tt> </tt>
<a name="L155"></a><tt class="py-lineno">155</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-109" class="py-name" targets="Method lib.cuckoo.core.guest.GuestManager.upload_analyzer()=lib.cuckoo.core.guest.GuestManager-class.html#upload_analyzer,Method lib.cuckoo.core.guest.OldGuestManager.upload_analyzer()=lib.cuckoo.core.guest.OldGuestManager-class.html#upload_analyzer"><a title="lib.cuckoo.core.guest.GuestManager.upload_analyzer
lib.cuckoo.core.guest.OldGuestManager.upload_analyzer" class="py-name" href="#" onclick="return doclink('link-109', 'upload_analyzer', 'link-109');">upload_analyzer</a></tt><tt class="py-op">(</tt><tt class="py-name">monitor</tt><tt class="py-op">)</tt> </tt>
<a name="L156"></a><tt class="py-lineno">156</tt>  <tt class="py-line"> </tt>
<a name="L157"></a><tt class="py-lineno">157</tt>  <tt class="py-line">            <tt class="py-comment"># Give the analysis options to the guest, so it can generate the</tt> </tt>
<a name="L158"></a><tt class="py-lineno">158</tt>  <tt class="py-line">            <tt class="py-comment"># analysis.conf inside the guest.</tt> </tt>
<a name="L159"></a><tt class="py-lineno">159</tt>  <tt class="py-line">            <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L160"></a><tt class="py-lineno">160</tt>  <tt class="py-line">                <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-110" class="py-name"><a title="lib.cuckoo.core.guest.GuestManager.server" class="py-name" href="#" onclick="return doclink('link-110', 'server', 'link-57');">server</a></tt><tt class="py-op">.</tt><tt id="link-111" class="py-name" targets="Method lib.cuckoo.core.guest.GuestManager.add_config()=lib.cuckoo.core.guest.GuestManager-class.html#add_config"><a title="lib.cuckoo.core.guest.GuestManager.add_config" class="py-name" href="#" onclick="return doclink('link-111', 'add_config', 'link-111');">add_config</a></tt><tt class="py-op">(</tt><tt id="link-112" class="py-name" targets="Variable lib.cuckoo.core.database.Machine.options=lib.cuckoo.core.database.Machine-class.html#options,Variable lib.cuckoo.core.database.Task.options=lib.cuckoo.core.database.Task-class.html#options"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-112', 'options', 'link-112');">options</a></tt><tt class="py-op">)</tt> </tt>
<a name="L161"></a><tt class="py-lineno">161</tt>  <tt class="py-line">            <tt class="py-keyword">except</tt><tt class="py-op">:</tt> </tt>
<a name="L162"></a><tt class="py-lineno">162</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-113" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooGuestError" class="py-name" href="#" onclick="return doclink('link-113', 'CuckooGuestError', 'link-30');">CuckooGuestError</a></tt><tt class="py-op">(</tt><tt class="py-string">"{0}: unable to upload config to "</tt> </tt>
<a name="L163"></a><tt class="py-lineno">163</tt>  <tt class="py-line">                                       <tt class="py-string">"analysis machine"</tt><tt class="py-op">.</tt><tt class="py-name">format</tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-114" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-114', 'id', 'link-44');">id</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L164"></a><tt class="py-lineno">164</tt>  <tt class="py-line"> </tt>
<a name="L165"></a><tt class="py-lineno">165</tt>  <tt class="py-line">            <tt class="py-comment"># If the target of the analysis is a file, upload it to the guest.</tt> </tt>
<a name="L166"></a><tt class="py-lineno">166</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-115" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-115', 'options', 'link-112');">options</a></tt><tt class="py-op">[</tt><tt class="py-string">"category"</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-string">"file"</tt><tt class="py-op">:</tt> </tt>
<a name="L167"></a><tt class="py-lineno">167</tt>  <tt class="py-line">                <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L168"></a><tt class="py-lineno">168</tt>  <tt class="py-line">                    <tt id="link-116" class="py-name" targets="Variable lib.cuckoo.common.objects.File.file_data=lib.cuckoo.common.objects.File-class.html#file_data"><a title="lib.cuckoo.common.objects.File.file_data" class="py-name" href="#" onclick="return doclink('link-116', 'file_data', 'link-116');">file_data</a></tt> <tt class="py-op">=</tt> <tt class="py-name">open</tt><tt class="py-op">(</tt><tt id="link-117" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-117', 'options', 'link-112');">options</a></tt><tt class="py-op">[</tt><tt class="py-string">"target"</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-string">"rb"</tt><tt class="py-op">)</tt><tt class="py-op">.</tt><tt id="link-118" class="py-name" targets="Method lib.cuckoo.core.resultserver.ResultHandler.read()=lib.cuckoo.core.resultserver.ResultHandler-class.html#read"><a title="lib.cuckoo.core.resultserver.ResultHandler.read" class="py-name" href="#" onclick="return doclink('link-118', 'read', 'link-118');">read</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L169"></a><tt class="py-lineno">169</tt>  <tt class="py-line">                <tt class="py-keyword">except</tt> <tt class="py-op">(</tt><tt class="py-name">IOError</tt><tt class="py-op">,</tt> <tt class="py-name">OSError</tt><tt class="py-op">)</tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L170"></a><tt class="py-lineno">170</tt>  <tt class="py-line">                    <tt class="py-keyword">raise</tt> <tt id="link-119" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooGuestError" class="py-name" href="#" onclick="return doclink('link-119', 'CuckooGuestError', 'link-30');">CuckooGuestError</a></tt><tt class="py-op">(</tt><tt class="py-string">"Unable to read {0}, error: "</tt> </tt>
<a name="L171"></a><tt class="py-lineno">171</tt>  <tt class="py-line">                                           <tt class="py-string">"{1}"</tt><tt class="py-op">.</tt><tt class="py-name">format</tt><tt class="py-op">(</tt><tt id="link-120" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-120', 'options', 'link-112');">options</a></tt><tt class="py-op">[</tt><tt class="py-string">"target"</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-name">e</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L172"></a><tt class="py-lineno">172</tt>  <tt class="py-line"> </tt>
<a name="L173"></a><tt class="py-lineno">173</tt>  <tt class="py-line">                <tt class="py-name">data</tt> <tt class="py-op">=</tt> <tt class="py-name">xmlrpclib</tt><tt class="py-op">.</tt><tt class="py-name">Binary</tt><tt class="py-op">(</tt><tt id="link-121" class="py-name"><a title="lib.cuckoo.common.objects.File.file_data" class="py-name" href="#" onclick="return doclink('link-121', 'file_data', 'link-116');">file_data</a></tt><tt class="py-op">)</tt> </tt>
<a name="L174"></a><tt class="py-lineno">174</tt>  <tt class="py-line"> </tt>
<a name="L175"></a><tt class="py-lineno">175</tt>  <tt class="py-line">                <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L176"></a><tt class="py-lineno">176</tt>  <tt class="py-line">                    <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-122" class="py-name"><a title="lib.cuckoo.core.guest.GuestManager.server" class="py-name" href="#" onclick="return doclink('link-122', 'server', 'link-57');">server</a></tt><tt class="py-op">.</tt><tt class="py-name">add_malware</tt><tt class="py-op">(</tt><tt class="py-name">data</tt><tt class="py-op">,</tt> <tt id="link-123" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-123', 'options', 'link-112');">options</a></tt><tt class="py-op">[</tt><tt class="py-string">"file_name"</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L177"></a><tt class="py-lineno">177</tt>  <tt class="py-line">                <tt class="py-keyword">except</tt> <tt class="py-name">Exception</tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L178"></a><tt class="py-lineno">178</tt>  <tt class="py-line">                    <tt class="py-keyword">raise</tt> <tt id="link-124" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooGuestError" class="py-name" href="#" onclick="return doclink('link-124', 'CuckooGuestError', 'link-30');">CuckooGuestError</a></tt><tt class="py-op">(</tt><tt class="py-string">"{0}: unable to upload malware to "</tt> </tt>
<a name="L179"></a><tt class="py-lineno">179</tt>  <tt class="py-line">                                           <tt class="py-string">"analysis machine: {1}"</tt><tt class="py-op">.</tt><tt class="py-name">format</tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-125" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-125', 'id', 'link-44');">id</a></tt><tt class="py-op">,</tt> <tt class="py-name">e</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L180"></a><tt class="py-lineno">180</tt>  <tt class="py-line"> </tt>
<a name="L181"></a><tt class="py-lineno">181</tt>  <tt class="py-line">            <tt class="py-comment"># Launch the analyzer.</tt> </tt>
<a name="L182"></a><tt class="py-lineno">182</tt>  <tt class="py-line">            <tt class="py-name">pid</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-126" class="py-name"><a title="lib.cuckoo.core.guest.GuestManager.server" class="py-name" href="#" onclick="return doclink('link-126', 'server', 'link-57');">server</a></tt><tt class="py-op">.</tt><tt class="py-name">execute</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L183"></a><tt class="py-lineno">183</tt>  <tt class="py-line">            <tt id="link-127" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-127', 'log', 'link-41');">log</a></tt><tt class="py-op">.</tt><tt id="link-128" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-128', 'debug', 'link-62');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"%s: analyzer started with PID %d"</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-129" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-129', 'id', 'link-44');">id</a></tt><tt class="py-op">,</tt> <tt class="py-name">pid</tt><tt class="py-op">)</tt> </tt>
<a name="L184"></a><tt class="py-lineno">184</tt>  <tt class="py-line">        <tt class="py-comment"># If something goes wrong when establishing the connection, raise an</tt> </tt>
<a name="L185"></a><tt class="py-lineno">185</tt>  <tt class="py-line">        <tt class="py-comment"># exception and abort the analysis.</tt> </tt>
<a name="L186"></a><tt class="py-lineno">186</tt>  <tt class="py-line">        <tt class="py-keyword">except</tt> <tt class="py-op">(</tt><tt class="py-name">socket</tt><tt class="py-op">.</tt><tt id="link-130" class="py-name"><a title="lib.cuckoo.core.database.Task.timeout" class="py-name" href="#" onclick="return doclink('link-130', 'timeout', 'link-53');">timeout</a></tt><tt class="py-op">,</tt> <tt class="py-name">socket</tt><tt class="py-op">.</tt><tt class="py-name">error</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L187"></a><tt class="py-lineno">187</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-131" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooGuestError" class="py-name" href="#" onclick="return doclink('link-131', 'CuckooGuestError', 'link-30');">CuckooGuestError</a></tt><tt class="py-op">(</tt><tt class="py-string">"{0}: guest communication timeout, check "</tt> </tt>
<a name="L188"></a><tt class="py-lineno">188</tt>  <tt class="py-line">                                   <tt class="py-string">"networking or try to increase "</tt> </tt>
<a name="L189"></a><tt class="py-lineno">189</tt>  <tt class="py-line">                                   <tt class="py-string">"timeout"</tt><tt class="py-op">.</tt><tt class="py-name">format</tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-132" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-132', 'id', 'link-44');">id</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
</div><a name="L190"></a><tt class="py-lineno">190</tt>  <tt class="py-line"> </tt>
<a name="OldGuestManager.wait_for_completion"></a><div id="OldGuestManager.wait_for_completion-def"><a name="L191"></a><tt class="py-lineno">191</tt> <a class="py-toggle" href="#" id="OldGuestManager.wait_for_completion-toggle" onclick="return toggle('OldGuestManager.wait_for_completion');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.guest.OldGuestManager-class.html#wait_for_completion">wait_for_completion</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="OldGuestManager.wait_for_completion-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="OldGuestManager.wait_for_completion-expanded"><a name="L192"></a><tt class="py-lineno">192</tt>  <tt class="py-line">        <tt class="py-docstring">"""Wait for analysis completion.</tt> </tt>
<a name="L193"></a><tt class="py-lineno">193</tt>  <tt class="py-line"><tt class="py-docstring">        @return: operation status.</tt> </tt>
<a name="L194"></a><tt class="py-lineno">194</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L195"></a><tt class="py-lineno">195</tt>  <tt class="py-line">        <tt id="link-133" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-133', 'log', 'link-41');">log</a></tt><tt class="py-op">.</tt><tt id="link-134" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-134', 'debug', 'link-62');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"%s: waiting for completion"</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-135" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-135', 'id', 'link-44');">id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L196"></a><tt class="py-lineno">196</tt>  <tt class="py-line"> </tt>
<a name="L197"></a><tt class="py-lineno">197</tt>  <tt class="py-line">        <tt class="py-name">end</tt> <tt class="py-op">=</tt> <tt class="py-name">time</tt><tt class="py-op">.</tt><tt class="py-name">time</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-136" class="py-name"><a title="lib.cuckoo.core.database.Task.timeout" class="py-name" href="#" onclick="return doclink('link-136', 'timeout', 'link-53');">timeout</a></tt> </tt>
<a name="L198"></a><tt class="py-lineno">198</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-137" class="py-name"><a title="lib.cuckoo.core.guest.GuestManager.server" class="py-name" href="#" onclick="return doclink('link-137', 'server', 'link-57');">server</a></tt><tt class="py-op">.</tt><tt id="link-138" class="py-name"><a title="lib.cuckoo.common.utils.TimeoutServer._set_timeout" class="py-name" href="#" onclick="return doclink('link-138', '_set_timeout', 'link-67');">_set_timeout</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-139" class="py-name"><a title="lib.cuckoo.core.database.Task.timeout" class="py-name" href="#" onclick="return doclink('link-139', 'timeout', 'link-53');">timeout</a></tt><tt class="py-op">)</tt> </tt>
<a name="L199"></a><tt class="py-lineno">199</tt>  <tt class="py-line"> </tt>
<a name="L200"></a><tt class="py-lineno">200</tt>  <tt class="py-line">        <tt class="py-keyword">while</tt> <tt id="link-140" class="py-name"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-140', 'db', 'link-42');">db</a></tt><tt class="py-op">.</tt><tt id="link-141" class="py-name"><a title="lib.cuckoo.core.database.Database.guest_get_status" class="py-name" href="#" onclick="return doclink('link-141', 'guest_get_status', 'link-70');">guest_get_status</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-142" class="py-name"><a title="lib.cuckoo.core.database.Error.task_id
lib.cuckoo.core.database.Guest.task_id" class="py-name" href="#" onclick="return doclink('link-142', 'task_id', 'link-49');">task_id</a></tt><tt class="py-op">)</tt> <tt class="py-op">==</tt> <tt class="py-string">"running"</tt><tt class="py-op">:</tt> </tt>
<a name="L201"></a><tt class="py-lineno">201</tt>  <tt class="py-line">            <tt class="py-name">time</tt><tt class="py-op">.</tt><tt class="py-name">sleep</tt><tt class="py-op">(</tt><tt class="py-number">1</tt><tt class="py-op">)</tt> </tt>
<a name="L202"></a><tt class="py-lineno">202</tt>  <tt class="py-line"> </tt>
<a name="L203"></a><tt class="py-lineno">203</tt>  <tt class="py-line">            <tt class="py-comment"># If the analysis hits the critical timeout, just return straight</tt> </tt>
<a name="L204"></a><tt class="py-lineno">204</tt>  <tt class="py-line">            <tt class="py-comment"># away and try to recover the analysis results from the guest.</tt> </tt>
<a name="L205"></a><tt class="py-lineno">205</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">time</tt><tt class="py-op">.</tt><tt class="py-name">time</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> <tt class="py-op">&gt;</tt> <tt class="py-name">end</tt><tt class="py-op">:</tt> </tt>
<a name="L206"></a><tt class="py-lineno">206</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-143" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooGuestError" class="py-name" href="#" onclick="return doclink('link-143', 'CuckooGuestError', 'link-30');">CuckooGuestError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The analysis hit the critical timeout, terminating."</tt><tt class="py-op">)</tt> </tt>
<a name="L207"></a><tt class="py-lineno">207</tt>  <tt class="py-line"> </tt>
<a name="L208"></a><tt class="py-lineno">208</tt>  <tt class="py-line">            <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L209"></a><tt class="py-lineno">209</tt>  <tt class="py-line">                <tt id="link-144" class="py-name"><a title="lib.cuckoo.core.database.Guest.status
lib.cuckoo.core.database.Machine.status
lib.cuckoo.core.database.Task.status" class="py-name" href="#" onclick="return doclink('link-144', 'status', 'link-64');">status</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-145" class="py-name"><a title="lib.cuckoo.core.guest.GuestManager.server" class="py-name" href="#" onclick="return doclink('link-145', 'server', 'link-57');">server</a></tt><tt class="py-op">.</tt><tt class="py-name">get_status</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L210"></a><tt class="py-lineno">210</tt>  <tt class="py-line">            <tt class="py-keyword">except</tt> <tt class="py-name">Exception</tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L211"></a><tt class="py-lineno">211</tt>  <tt class="py-line">                <tt id="link-146" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-146', 'log', 'link-41');">log</a></tt><tt class="py-op">.</tt><tt id="link-147" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-147', 'debug', 'link-62');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"%s: error retrieving status: %s"</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-148" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-148', 'id', 'link-44');">id</a></tt><tt class="py-op">,</tt> <tt class="py-name">e</tt><tt class="py-op">)</tt> </tt>
<a name="L212"></a><tt class="py-lineno">212</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L213"></a><tt class="py-lineno">213</tt>  <tt class="py-line"> </tt>
<a name="L214"></a><tt class="py-lineno">214</tt>  <tt class="py-line">            <tt class="py-comment"># React according to the returned status.</tt> </tt>
<a name="L215"></a><tt class="py-lineno">215</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-149" class="py-name"><a title="lib.cuckoo.core.database.Guest.status
lib.cuckoo.core.database.Machine.status
lib.cuckoo.core.database.Task.status" class="py-name" href="#" onclick="return doclink('link-149', 'status', 'link-64');">status</a></tt> <tt class="py-op">==</tt> <tt id="link-150" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_GUEST_COMPLETED" class="py-name" href="#" onclick="return doclink('link-150', 'CUCKOO_GUEST_COMPLETED', 'link-20');">CUCKOO_GUEST_COMPLETED</a></tt><tt class="py-op">:</tt> </tt>
<a name="L216"></a><tt class="py-lineno">216</tt>  <tt class="py-line">                <tt id="link-151" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-151', 'log', 'link-41');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">"%s: analysis completed successfully"</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-152" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-152', 'id', 'link-44');">id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L217"></a><tt class="py-lineno">217</tt>  <tt class="py-line">                <tt class="py-keyword">break</tt> </tt>
<a name="L218"></a><tt class="py-lineno">218</tt>  <tt class="py-line">            <tt class="py-keyword">elif</tt> <tt id="link-153" class="py-name"><a title="lib.cuckoo.core.database.Guest.status
lib.cuckoo.core.database.Machine.status
lib.cuckoo.core.database.Task.status" class="py-name" href="#" onclick="return doclink('link-153', 'status', 'link-64');">status</a></tt> <tt class="py-op">==</tt> <tt id="link-154" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_GUEST_FAILED" class="py-name" href="#" onclick="return doclink('link-154', 'CUCKOO_GUEST_FAILED', 'link-25');">CUCKOO_GUEST_FAILED</a></tt><tt class="py-op">:</tt> </tt>
<a name="L219"></a><tt class="py-lineno">219</tt>  <tt class="py-line">                <tt class="py-name">error</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-155" class="py-name"><a title="lib.cuckoo.core.guest.GuestManager.server" class="py-name" href="#" onclick="return doclink('link-155', 'server', 'link-57');">server</a></tt><tt class="py-op">.</tt><tt class="py-name">get_error</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L220"></a><tt class="py-lineno">220</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">error</tt><tt class="py-op">:</tt> </tt>
<a name="L221"></a><tt class="py-lineno">221</tt>  <tt class="py-line">                    <tt class="py-name">error</tt> <tt class="py-op">=</tt> <tt class="py-string">"unknown error"</tt> </tt>
<a name="L222"></a><tt class="py-lineno">222</tt>  <tt class="py-line"> </tt>
<a name="L223"></a><tt class="py-lineno">223</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-156" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooGuestError" class="py-name" href="#" onclick="return doclink('link-156', 'CuckooGuestError', 'link-30');">CuckooGuestError</a></tt><tt class="py-op">(</tt><tt class="py-string">"Analysis failed: {0}"</tt><tt class="py-op">.</tt><tt class="py-name">format</tt><tt class="py-op">(</tt><tt class="py-name">error</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L224"></a><tt class="py-lineno">224</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L225"></a><tt class="py-lineno">225</tt>  <tt class="py-line">                <tt id="link-157" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-157', 'log', 'link-41');">log</a></tt><tt class="py-op">.</tt><tt id="link-158" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-158', 'debug', 'link-62');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"%s: analysis not completed yet (status=%s)"</tt><tt class="py-op">,</tt> </tt>
<a name="L226"></a><tt class="py-lineno">226</tt>  <tt class="py-line">                          <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-159" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-159', 'id', 'link-44');">id</a></tt><tt class="py-op">,</tt> <tt id="link-160" class="py-name"><a title="lib.cuckoo.core.database.Guest.status
lib.cuckoo.core.database.Machine.status
lib.cuckoo.core.database.Task.status" class="py-name" href="#" onclick="return doclink('link-160', 'status', 'link-64');">status</a></tt><tt class="py-op">)</tt> </tt>
<a name="L227"></a><tt class="py-lineno">227</tt>  <tt class="py-line"> </tt>
<a name="L228"></a><tt class="py-lineno">228</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-161" class="py-name"><a title="lib.cuckoo.core.guest.GuestManager.server" class="py-name" href="#" onclick="return doclink('link-161', 'server', 'link-57');">server</a></tt><tt class="py-op">.</tt><tt id="link-162" class="py-name"><a title="lib.cuckoo.common.utils.TimeoutServer._set_timeout" class="py-name" href="#" onclick="return doclink('link-162', '_set_timeout', 'link-67');">_set_timeout</a></tt><tt class="py-op">(</tt><tt class="py-name">None</tt><tt class="py-op">)</tt> </tt>
</div></div><a name="L229"></a><tt class="py-lineno">229</tt>  <tt class="py-line"> </tt>
<a name="GuestManager"></a><div id="GuestManager-def"><a name="L230"></a><tt class="py-lineno">230</tt> <a class="py-toggle" href="#" id="GuestManager-toggle" onclick="return toggle('GuestManager');">-</a><tt class="py-line"><tt class="py-keyword">class</tt> <a class="py-def-name" href="lib.cuckoo.core.guest.GuestManager-class.html">GuestManager</a><tt class="py-op">(</tt><tt class="py-base-class">object</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="GuestManager-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="GuestManager-expanded"><a name="L231"></a><tt class="py-lineno">231</tt>  <tt class="py-line">    <tt class="py-docstring">"""This class represents the new Guest Manager. It operates on the new</tt> </tt>
<a name="L232"></a><tt class="py-lineno">232</tt>  <tt class="py-line"><tt class="py-docstring">    Cuckoo Agent which features a more abstract but more feature-rich API."""</tt> </tt>
<a name="L233"></a><tt class="py-lineno">233</tt>  <tt class="py-line"> </tt>
<a name="GuestManager.__init__"></a><div id="GuestManager.__init__-def"><a name="L234"></a><tt class="py-lineno">234</tt> <a class="py-toggle" href="#" id="GuestManager.__init__-toggle" onclick="return toggle('GuestManager.__init__');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.guest.GuestManager-class.html#__init__">__init__</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">vmid</tt><tt class="py-op">,</tt> <tt class="py-param">ipaddr</tt><tt class="py-op">,</tt> <tt class="py-param">platform</tt><tt class="py-op">,</tt> <tt class="py-param">task_id</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="GuestManager.__init__-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="GuestManager.__init__-expanded"><a name="L235"></a><tt class="py-lineno">235</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">vmid</tt> <tt class="py-op">=</tt> <tt class="py-name">vmid</tt> </tt>
<a name="L236"></a><tt class="py-lineno">236</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">ipaddr</tt> <tt class="py-op">=</tt> <tt class="py-name">ipaddr</tt> </tt>
<a name="L237"></a><tt class="py-lineno">237</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">port</tt> <tt class="py-op">=</tt> <tt id="link-163" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_GUEST_PORT" class="py-name" href="#" onclick="return doclink('link-163', 'CUCKOO_GUEST_PORT', 'link-14');">CUCKOO_GUEST_PORT</a></tt> </tt>
<a name="L238"></a><tt class="py-lineno">238</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-164" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.platform
lib.cuckoo.core.database.Machine.platform
lib.cuckoo.core.database.Task.platform
modules.processing.platform" class="py-name" href="#" onclick="return doclink('link-164', 'platform', 'link-47');">platform</a></tt> <tt class="py-op">=</tt> <tt id="link-165" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.platform
lib.cuckoo.core.database.Machine.platform
lib.cuckoo.core.database.Task.platform
modules.processing.platform" class="py-name" href="#" onclick="return doclink('link-165', 'platform', 'link-47');">platform</a></tt> </tt>
<a name="L239"></a><tt class="py-lineno">239</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-166" class="py-name"><a title="lib.cuckoo.core.database.Error.task_id
lib.cuckoo.core.database.Guest.task_id" class="py-name" href="#" onclick="return doclink('link-166', 'task_id', 'link-49');">task_id</a></tt> <tt class="py-op">=</tt> <tt id="link-167" class="py-name"><a title="lib.cuckoo.core.database.Error.task_id
lib.cuckoo.core.database.Guest.task_id" class="py-name" href="#" onclick="return doclink('link-167', 'task_id', 'link-49');">task_id</a></tt> </tt>
<a name="L240"></a><tt class="py-lineno">240</tt>  <tt class="py-line"> </tt>
<a name="L241"></a><tt class="py-lineno">241</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-168" class="py-name"><a title="lib.cuckoo.core.database.Task.timeout" class="py-name" href="#" onclick="return doclink('link-168', 'timeout', 'link-53');">timeout</a></tt> <tt class="py-op">=</tt> <tt id="link-169" class="py-name"><a title="lib.cuckoo.common.config.Config" class="py-name" href="#" onclick="return doclink('link-169', 'Config', 'link-4');">Config</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">.</tt><tt class="py-name">timeouts</tt><tt class="py-op">.</tt><tt class="py-name">critical</tt> </tt>
<a name="L242"></a><tt class="py-lineno">242</tt>  <tt class="py-line"> </tt>
<a name="L243"></a><tt class="py-lineno">243</tt>  <tt class="py-line">        <tt class="py-comment"># Just in case we have an old agent inside the Virtual Machine. This</tt> </tt>
<a name="L244"></a><tt class="py-lineno">244</tt>  <tt class="py-line">        <tt class="py-comment"># allows us to remain backwards compatible (for now).</tt> </tt>
<a name="L245"></a><tt class="py-lineno">245</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">old</tt> <tt class="py-op">=</tt> <tt id="link-170" class="py-name" targets="Class lib.cuckoo.core.guest.OldGuestManager=lib.cuckoo.core.guest.OldGuestManager-class.html"><a title="lib.cuckoo.core.guest.OldGuestManager" class="py-name" href="#" onclick="return doclink('link-170', 'OldGuestManager', 'link-170');">OldGuestManager</a></tt><tt class="py-op">(</tt><tt class="py-name">vmid</tt><tt class="py-op">,</tt> <tt class="py-name">ipaddr</tt><tt class="py-op">,</tt> <tt id="link-171" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.platform
lib.cuckoo.core.database.Machine.platform
lib.cuckoo.core.database.Task.platform
modules.processing.platform" class="py-name" href="#" onclick="return doclink('link-171', 'platform', 'link-47');">platform</a></tt><tt class="py-op">,</tt> <tt id="link-172" class="py-name"><a title="lib.cuckoo.core.database.Error.task_id
lib.cuckoo.core.database.Guest.task_id" class="py-name" href="#" onclick="return doclink('link-172', 'task_id', 'link-49');">task_id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L246"></a><tt class="py-lineno">246</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">is_old</tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L247"></a><tt class="py-lineno">247</tt>  <tt class="py-line"> </tt>
<a name="L248"></a><tt class="py-lineno">248</tt>  <tt class="py-line">        <tt class="py-comment"># We maintain the path of the Cuckoo Analyzer on the host.</tt> </tt>
<a name="L249"></a><tt class="py-lineno">249</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">analyzer_path</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L250"></a><tt class="py-lineno">250</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">environ</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt> </tt>
</div><a name="L251"></a><tt class="py-lineno">251</tt>  <tt class="py-line"> </tt>
<a name="GuestManager.get"></a><div id="GuestManager.get-def"><a name="L252"></a><tt class="py-lineno">252</tt> <a class="py-toggle" href="#" id="GuestManager.get-toggle" onclick="return toggle('GuestManager.get');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.guest.GuestManager-class.html#get">get</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">method</tt><tt class="py-op">,</tt> <tt class="py-op">*</tt><tt class="py-param">args</tt><tt class="py-op">,</tt> <tt class="py-op">**</tt><tt class="py-param">kwargs</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="GuestManager.get-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="GuestManager.get-expanded"><a name="L253"></a><tt class="py-lineno">253</tt>  <tt class="py-line">        <tt class="py-docstring">"""Simple wrapper around requests.get()."""</tt> </tt>
<a name="L254"></a><tt class="py-lineno">254</tt>  <tt class="py-line">        <tt class="py-name">url</tt> <tt class="py-op">=</tt> <tt class="py-string">"http://%s:%s%s"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">ipaddr</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">port</tt><tt class="py-op">,</tt> <tt class="py-name">method</tt><tt class="py-op">)</tt> </tt>
<a name="L255"></a><tt class="py-lineno">255</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">requests</tt><tt class="py-op">.</tt><tt id="link-173" class="py-name" targets="Method lib.cuckoo.common.config.Config.get()=lib.cuckoo.common.config.Config-class.html#get,Method lib.cuckoo.core.guest.GuestManager.get()=lib.cuckoo.core.guest.GuestManager-class.html#get"><a title="lib.cuckoo.common.config.Config.get
lib.cuckoo.core.guest.GuestManager.get" class="py-name" href="#" onclick="return doclink('link-173', 'get', 'link-173');">get</a></tt><tt class="py-op">(</tt><tt class="py-name">url</tt><tt class="py-op">,</tt> <tt class="py-op">*</tt><tt class="py-name">args</tt><tt class="py-op">,</tt> <tt class="py-op">**</tt><tt class="py-name">kwargs</tt><tt class="py-op">)</tt> </tt>
</div><a name="L256"></a><tt class="py-lineno">256</tt>  <tt class="py-line"> </tt>
<a name="GuestManager.post"></a><div id="GuestManager.post-def"><a name="L257"></a><tt class="py-lineno">257</tt> <a class="py-toggle" href="#" id="GuestManager.post-toggle" onclick="return toggle('GuestManager.post');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.guest.GuestManager-class.html#post">post</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">method</tt><tt class="py-op">,</tt> <tt class="py-op">*</tt><tt class="py-param">args</tt><tt class="py-op">,</tt> <tt class="py-op">**</tt><tt class="py-param">kwargs</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="GuestManager.post-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="GuestManager.post-expanded"><a name="L258"></a><tt class="py-lineno">258</tt>  <tt class="py-line">        <tt class="py-docstring">"""Simple wrapper around requests.post()."""</tt> </tt>
<a name="L259"></a><tt class="py-lineno">259</tt>  <tt class="py-line">        <tt class="py-name">url</tt> <tt class="py-op">=</tt> <tt class="py-string">"http://%s:%s%s"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">ipaddr</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">port</tt><tt class="py-op">,</tt> <tt class="py-name">method</tt><tt class="py-op">)</tt> </tt>
<a name="L260"></a><tt class="py-lineno">260</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">requests</tt><tt class="py-op">.</tt><tt id="link-174" class="py-name" targets="Method lib.cuckoo.core.guest.GuestManager.post()=lib.cuckoo.core.guest.GuestManager-class.html#post"><a title="lib.cuckoo.core.guest.GuestManager.post" class="py-name" href="#" onclick="return doclink('link-174', 'post', 'link-174');">post</a></tt><tt class="py-op">(</tt><tt class="py-name">url</tt><tt class="py-op">,</tt> <tt class="py-op">*</tt><tt class="py-name">args</tt><tt class="py-op">,</tt> <tt class="py-op">**</tt><tt class="py-name">kwargs</tt><tt class="py-op">)</tt> </tt>
</div><a name="L261"></a><tt class="py-lineno">261</tt>  <tt class="py-line"> </tt>
<a name="GuestManager.wait_available"></a><div id="GuestManager.wait_available-def"><a name="L262"></a><tt class="py-lineno">262</tt> <a class="py-toggle" href="#" id="GuestManager.wait_available-toggle" onclick="return toggle('GuestManager.wait_available');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.guest.GuestManager-class.html#wait_available">wait_available</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="GuestManager.wait_available-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="GuestManager.wait_available-expanded"><a name="L263"></a><tt class="py-lineno">263</tt>  <tt class="py-line">        <tt class="py-docstring">"""Wait until the Virtual Machine is available for usage."""</tt> </tt>
<a name="L264"></a><tt class="py-lineno">264</tt>  <tt class="py-line">        <tt class="py-name">end</tt> <tt class="py-op">=</tt> <tt class="py-name">time</tt><tt class="py-op">.</tt><tt class="py-name">time</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-175" class="py-name"><a title="lib.cuckoo.core.database.Task.timeout" class="py-name" href="#" onclick="return doclink('link-175', 'timeout', 'link-53');">timeout</a></tt> </tt>
<a name="L265"></a><tt class="py-lineno">265</tt>  <tt class="py-line"> </tt>
<a name="L266"></a><tt class="py-lineno">266</tt>  <tt class="py-line">        <tt class="py-keyword">while</tt> <tt id="link-176" class="py-name"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-176', 'db', 'link-42');">db</a></tt><tt class="py-op">.</tt><tt id="link-177" class="py-name"><a title="lib.cuckoo.core.database.Database.guest_get_status" class="py-name" href="#" onclick="return doclink('link-177', 'guest_get_status', 'link-70');">guest_get_status</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-178" class="py-name"><a title="lib.cuckoo.core.database.Error.task_id
lib.cuckoo.core.database.Guest.task_id" class="py-name" href="#" onclick="return doclink('link-178', 'task_id', 'link-49');">task_id</a></tt><tt class="py-op">)</tt> <tt class="py-op">==</tt> <tt class="py-string">"starting"</tt><tt class="py-op">:</tt> </tt>
<a name="L267"></a><tt class="py-lineno">267</tt>  <tt class="py-line">            <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L268"></a><tt class="py-lineno">268</tt>  <tt class="py-line">                <tt class="py-name">socket</tt><tt class="py-op">.</tt><tt class="py-name">create_connection</tt><tt class="py-op">(</tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">ipaddr</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">port</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-number">1</tt><tt class="py-op">)</tt><tt class="py-op">.</tt><tt id="link-179" class="py-name"><a title="lib.cuckoo.common.netlog.BsonParser.close
lib.cuckoo.core.resultserver.FileUpload.close
lib.cuckoo.core.resultserver.LogHandler.close
modules.processing.network.SortCap.close" class="py-name" href="#" onclick="return doclink('link-179', 'close', 'link-97');">close</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L269"></a><tt class="py-lineno">269</tt>  <tt class="py-line">                <tt class="py-keyword">break</tt> </tt>
<a name="L270"></a><tt class="py-lineno">270</tt>  <tt class="py-line">            <tt class="py-keyword">except</tt> <tt class="py-name">socket</tt><tt class="py-op">.</tt><tt id="link-180" class="py-name"><a title="lib.cuckoo.core.database.Task.timeout" class="py-name" href="#" onclick="return doclink('link-180', 'timeout', 'link-53');">timeout</a></tt><tt class="py-op">:</tt> </tt>
<a name="L271"></a><tt class="py-lineno">271</tt>  <tt class="py-line">                <tt id="link-181" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-181', 'log', 'link-41');">log</a></tt><tt class="py-op">.</tt><tt id="link-182" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-182', 'debug', 'link-62');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"%s: not ready yet"</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">vmid</tt><tt class="py-op">)</tt> </tt>
<a name="L272"></a><tt class="py-lineno">272</tt>  <tt class="py-line">            <tt class="py-keyword">except</tt> <tt class="py-name">socket</tt><tt class="py-op">.</tt><tt class="py-name">error</tt><tt class="py-op">:</tt> </tt>
<a name="L273"></a><tt class="py-lineno">273</tt>  <tt class="py-line">                <tt id="link-183" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-183', 'log', 'link-41');">log</a></tt><tt class="py-op">.</tt><tt id="link-184" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-184', 'debug', 'link-62');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"%s: not ready yet"</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">vmid</tt><tt class="py-op">)</tt> </tt>
<a name="L274"></a><tt class="py-lineno">274</tt>  <tt class="py-line">                <tt class="py-name">time</tt><tt class="py-op">.</tt><tt class="py-name">sleep</tt><tt class="py-op">(</tt><tt class="py-number">1</tt><tt class="py-op">)</tt> </tt>
<a name="L275"></a><tt class="py-lineno">275</tt>  <tt class="py-line"> </tt>
<a name="L276"></a><tt class="py-lineno">276</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">time</tt><tt class="py-op">.</tt><tt class="py-name">time</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> <tt class="py-op">&gt;</tt> <tt class="py-name">end</tt><tt class="py-op">:</tt> </tt>
<a name="L277"></a><tt class="py-lineno">277</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-185" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooGuestError" class="py-name" href="#" onclick="return doclink('link-185', 'CuckooGuestError', 'link-30');">CuckooGuestError</a></tt><tt class="py-op">(</tt><tt class="py-string">"{0}: the guest initialization hit the "</tt> </tt>
<a name="L278"></a><tt class="py-lineno">278</tt>  <tt class="py-line">                                       <tt class="py-string">"critical timeout, analysis "</tt> </tt>
<a name="L279"></a><tt class="py-lineno">279</tt>  <tt class="py-line">                                       <tt class="py-string">"aborted."</tt><tt class="py-op">.</tt><tt class="py-name">format</tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">vmid</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
</div><a name="L280"></a><tt class="py-lineno">280</tt>  <tt class="py-line"> </tt>
<a name="GuestManager.query_environ"></a><div id="GuestManager.query_environ-def"><a name="L281"></a><tt class="py-lineno">281</tt> <a class="py-toggle" href="#" id="GuestManager.query_environ-toggle" onclick="return toggle('GuestManager.query_environ');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.guest.GuestManager-class.html#query_environ">query_environ</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="GuestManager.query_environ-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="GuestManager.query_environ-expanded"><a name="L282"></a><tt class="py-lineno">282</tt>  <tt class="py-line">        <tt class="py-docstring">"""Query the environment of the Agent in the Virtual Machine."""</tt> </tt>
<a name="L283"></a><tt class="py-lineno">283</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">environ</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-186" class="py-name"><a title="lib.cuckoo.common.config.Config.get
lib.cuckoo.core.guest.GuestManager.get" class="py-name" href="#" onclick="return doclink('link-186', 'get', 'link-173');">get</a></tt><tt class="py-op">(</tt><tt class="py-string">"/environ"</tt><tt class="py-op">)</tt><tt class="py-op">.</tt><tt class="py-name">json</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">[</tt><tt class="py-string">"environ"</tt><tt class="py-op">]</tt> </tt>
</div><a name="L284"></a><tt class="py-lineno">284</tt>  <tt class="py-line"> </tt>
<a name="GuestManager.determine_analyzer_path"></a><div id="GuestManager.determine_analyzer_path-def"><a name="L285"></a><tt class="py-lineno">285</tt> <a class="py-toggle" href="#" id="GuestManager.determine_analyzer_path-toggle" onclick="return toggle('GuestManager.determine_analyzer_path');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.guest.GuestManager-class.html#determine_analyzer_path">determine_analyzer_path</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="GuestManager.determine_analyzer_path-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="GuestManager.determine_analyzer_path-expanded"><a name="L286"></a><tt class="py-lineno">286</tt>  <tt class="py-line">        <tt class="py-docstring">"""Determine the path of the analyzer. Basically creating a temporary</tt> </tt>
<a name="L287"></a><tt class="py-lineno">287</tt>  <tt class="py-line"><tt class="py-docstring">        directory in the systemdrive, i.e., C:\\."""</tt> </tt>
<a name="L288"></a><tt class="py-lineno">288</tt>  <tt class="py-line">        <tt class="py-name">systemdrive</tt> <tt class="py-op">=</tt> <tt class="py-string">"%s\\"</tt> <tt class="py-op">%</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">environ</tt><tt class="py-op">[</tt><tt class="py-string">"SYSTEMDRIVE"</tt><tt class="py-op">]</tt> </tt>
<a name="L289"></a><tt class="py-lineno">289</tt>  <tt class="py-line"> </tt>
<a name="L290"></a><tt class="py-lineno">290</tt>  <tt class="py-line">        <tt class="py-name">r</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-187" class="py-name"><a title="lib.cuckoo.core.guest.GuestManager.post" class="py-name" href="#" onclick="return doclink('link-187', 'post', 'link-174');">post</a></tt><tt class="py-op">(</tt><tt class="py-string">"/mkdtemp"</tt><tt class="py-op">,</tt> <tt class="py-name">data</tt><tt class="py-op">=</tt><tt class="py-op">{</tt><tt class="py-string">"dirpath"</tt><tt class="py-op">:</tt> <tt class="py-name">systemdrive</tt><tt class="py-op">}</tt><tt class="py-op">)</tt> </tt>
<a name="L291"></a><tt class="py-lineno">291</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">analyzer_path</tt> <tt class="py-op">=</tt> <tt class="py-name">r</tt><tt class="py-op">.</tt><tt class="py-name">json</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">[</tt><tt class="py-string">"dirpath"</tt><tt class="py-op">]</tt> </tt>
</div><a name="L292"></a><tt class="py-lineno">292</tt>  <tt class="py-line"> </tt>
<a name="GuestManager.upload_analyzer"></a><div id="GuestManager.upload_analyzer-def"><a name="L293"></a><tt class="py-lineno">293</tt> <a class="py-toggle" href="#" id="GuestManager.upload_analyzer-toggle" onclick="return toggle('GuestManager.upload_analyzer');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.guest.GuestManager-class.html#upload_analyzer">upload_analyzer</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">monitor</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="GuestManager.upload_analyzer-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="GuestManager.upload_analyzer-expanded"><a name="L294"></a><tt class="py-lineno">294</tt>  <tt class="py-line">        <tt class="py-docstring">"""Upload the analyzer to the Virtual Machine."""</tt> </tt>
<a name="L295"></a><tt class="py-lineno">295</tt>  <tt class="py-line">        <tt class="py-name">zip_data</tt> <tt class="py-op">=</tt> <tt class="py-name">StringIO</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L296"></a><tt class="py-lineno">296</tt>  <tt class="py-line">        <tt class="py-name">zip_file</tt> <tt class="py-op">=</tt> <tt class="py-name">ZipFile</tt><tt class="py-op">(</tt><tt class="py-name">zip_data</tt><tt class="py-op">,</tt> <tt class="py-string">"w"</tt><tt class="py-op">,</tt> <tt class="py-name">ZIP_STORED</tt><tt class="py-op">)</tt> </tt>
<a name="L297"></a><tt class="py-lineno">297</tt>  <tt class="py-line"> </tt>
<a name="L298"></a><tt class="py-lineno">298</tt>  <tt class="py-line">        <tt class="py-comment"># Select the proper analyzer's folder according to the operating</tt> </tt>
<a name="L299"></a><tt class="py-lineno">299</tt>  <tt class="py-line">        <tt class="py-comment"># system associated with the current machine.</tt> </tt>
<a name="L300"></a><tt class="py-lineno">300</tt>  <tt class="py-line">        <tt class="py-name">root</tt> <tt class="py-op">=</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt id="link-188" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_ROOT" class="py-name" href="#" onclick="return doclink('link-188', 'CUCKOO_ROOT', 'link-9');">CUCKOO_ROOT</a></tt><tt class="py-op">,</tt> <tt class="py-string">"analyzer"</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-189" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.platform
lib.cuckoo.core.database.Machine.platform
lib.cuckoo.core.database.Task.platform
modules.processing.platform" class="py-name" href="#" onclick="return doclink('link-189', 'platform', 'link-47');">platform</a></tt><tt class="py-op">)</tt> </tt>
<a name="L301"></a><tt class="py-lineno">301</tt>  <tt class="py-line">        <tt class="py-name">root_len</tt> <tt class="py-op">=</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">abspath</tt><tt class="py-op">(</tt><tt class="py-name">root</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L302"></a><tt class="py-lineno">302</tt>  <tt class="py-line"> </tt>
<a name="L303"></a><tt class="py-lineno">303</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">exists</tt><tt class="py-op">(</tt><tt class="py-name">root</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L304"></a><tt class="py-lineno">304</tt>  <tt class="py-line">            <tt id="link-190" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-190', 'log', 'link-41');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">error</tt><tt class="py-op">(</tt><tt class="py-string">"No valid analyzer found at path: %s"</tt><tt class="py-op">,</tt> <tt class="py-name">root</tt><tt class="py-op">)</tt> </tt>
<a name="L305"></a><tt class="py-lineno">305</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-name">False</tt> </tt>
<a name="L306"></a><tt class="py-lineno">306</tt>  <tt class="py-line"> </tt>
<a name="L307"></a><tt class="py-lineno">307</tt>  <tt class="py-line">        <tt class="py-comment"># Walk through everything inside the analyzer's folder and write</tt> </tt>
<a name="L308"></a><tt class="py-lineno">308</tt>  <tt class="py-line">        <tt class="py-comment"># them to the zip archive.</tt> </tt>
<a name="L309"></a><tt class="py-lineno">309</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">root</tt><tt class="py-op">,</tt> <tt class="py-name">dirs</tt><tt class="py-op">,</tt> <tt class="py-name">files</tt> <tt class="py-keyword">in</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">walk</tt><tt class="py-op">(</tt><tt class="py-name">root</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L310"></a><tt class="py-lineno">310</tt>  <tt class="py-line">            <tt class="py-name">archive_root</tt> <tt class="py-op">=</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">abspath</tt><tt class="py-op">(</tt><tt class="py-name">root</tt><tt class="py-op">)</tt><tt class="py-op">[</tt><tt class="py-name">root_len</tt><tt class="py-op">:</tt><tt class="py-op">]</tt> </tt>
<a name="L311"></a><tt class="py-lineno">311</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-191" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-191', 'name', 'link-87');">name</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">files</tt><tt class="py-op">:</tt> </tt>
<a name="L312"></a><tt class="py-lineno">312</tt>  <tt class="py-line">                <tt class="py-name">path</tt> <tt class="py-op">=</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt class="py-name">root</tt><tt class="py-op">,</tt> <tt id="link-192" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-192', 'name', 'link-87');">name</a></tt><tt class="py-op">)</tt> </tt>
<a name="L313"></a><tt class="py-lineno">313</tt>  <tt class="py-line">                <tt class="py-name">archive_name</tt> <tt class="py-op">=</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt class="py-name">archive_root</tt><tt class="py-op">,</tt> <tt id="link-193" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-193', 'name', 'link-87');">name</a></tt><tt class="py-op">)</tt> </tt>
<a name="L314"></a><tt class="py-lineno">314</tt>  <tt class="py-line">                <tt class="py-name">zip_file</tt><tt class="py-op">.</tt><tt id="link-194" class="py-name"><a title="modules.processing.network.SortCap.write" class="py-name" href="#" onclick="return doclink('link-194', 'write', 'link-90');">write</a></tt><tt class="py-op">(</tt><tt class="py-name">path</tt><tt class="py-op">,</tt> <tt class="py-name">archive_name</tt><tt class="py-op">)</tt> </tt>
<a name="L315"></a><tt class="py-lineno">315</tt>  <tt class="py-line"> </tt>
<a name="L316"></a><tt class="py-lineno">316</tt>  <tt class="py-line">        <tt class="py-comment"># Include the chosen monitoring component.</tt> </tt>
<a name="L317"></a><tt class="py-lineno">317</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-195" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.platform
lib.cuckoo.core.database.Machine.platform
lib.cuckoo.core.database.Task.platform
modules.processing.platform" class="py-name" href="#" onclick="return doclink('link-195', 'platform', 'link-47');">platform</a></tt> <tt class="py-op">==</tt> <tt class="py-string">"windows"</tt><tt class="py-op">:</tt> </tt>
<a name="L318"></a><tt class="py-lineno">318</tt>  <tt class="py-line">            <tt class="py-name">dirpath</tt> <tt class="py-op">=</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt id="link-196" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_ROOT" class="py-name" href="#" onclick="return doclink('link-196', 'CUCKOO_ROOT', 'link-9');">CUCKOO_ROOT</a></tt><tt class="py-op">,</tt> <tt class="py-string">"data"</tt><tt class="py-op">,</tt> <tt class="py-string">"monitor"</tt><tt class="py-op">,</tt> <tt class="py-name">monitor</tt><tt class="py-op">)</tt> </tt>
<a name="L319"></a><tt class="py-lineno">319</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-197" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-197', 'name', 'link-87');">name</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">listdir</tt><tt class="py-op">(</tt><tt class="py-name">dirpath</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L320"></a><tt class="py-lineno">320</tt>  <tt class="py-line">                <tt class="py-name">path</tt> <tt class="py-op">=</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt class="py-name">dirpath</tt><tt class="py-op">,</tt> <tt id="link-198" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-198', 'name', 'link-87');">name</a></tt><tt class="py-op">)</tt> </tt>
<a name="L321"></a><tt class="py-lineno">321</tt>  <tt class="py-line">                <tt class="py-name">archive_name</tt> <tt class="py-op">=</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt class="py-string">"/bin"</tt><tt class="py-op">,</tt> <tt id="link-199" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-199', 'name', 'link-87');">name</a></tt><tt class="py-op">)</tt> </tt>
<a name="L322"></a><tt class="py-lineno">322</tt>  <tt class="py-line">                <tt class="py-name">zip_file</tt><tt class="py-op">.</tt><tt id="link-200" class="py-name"><a title="modules.processing.network.SortCap.write" class="py-name" href="#" onclick="return doclink('link-200', 'write', 'link-90');">write</a></tt><tt class="py-op">(</tt><tt class="py-name">path</tt><tt class="py-op">,</tt> <tt class="py-name">archive_name</tt><tt class="py-op">)</tt> </tt>
<a name="L323"></a><tt class="py-lineno">323</tt>  <tt class="py-line"> </tt>
<a name="L324"></a><tt class="py-lineno">324</tt>  <tt class="py-line">        <tt class="py-name">zip_file</tt><tt class="py-op">.</tt><tt id="link-201" class="py-name"><a title="lib.cuckoo.common.netlog.BsonParser.close
lib.cuckoo.core.resultserver.FileUpload.close
lib.cuckoo.core.resultserver.LogHandler.close
modules.processing.network.SortCap.close" class="py-name" href="#" onclick="return doclink('link-201', 'close', 'link-97');">close</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L325"></a><tt class="py-lineno">325</tt>  <tt class="py-line">        <tt class="py-name">zip_data</tt><tt class="py-op">.</tt><tt id="link-202" class="py-name" targets="Method lib.cuckoo.core.resultserver.ResultHandler.seek()=lib.cuckoo.core.resultserver.ResultHandler-class.html#seek"><a title="lib.cuckoo.core.resultserver.ResultHandler.seek" class="py-name" href="#" onclick="return doclink('link-202', 'seek', 'link-202');">seek</a></tt><tt class="py-op">(</tt><tt class="py-number">0</tt><tt class="py-op">)</tt> </tt>
<a name="L326"></a><tt class="py-lineno">326</tt>  <tt class="py-line"> </tt>
<a name="L327"></a><tt class="py-lineno">327</tt>  <tt class="py-line">        <tt id="link-203" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-203', 'log', 'link-41');">log</a></tt><tt class="py-op">.</tt><tt id="link-204" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-204', 'debug', 'link-62');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"Uploading analyzer to guest (id=%s, ip=%s)"</tt><tt class="py-op">,</tt> </tt>
<a name="L328"></a><tt class="py-lineno">328</tt>  <tt class="py-line">                  <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">vmid</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">ipaddr</tt><tt class="py-op">)</tt> </tt>
<a name="L329"></a><tt class="py-lineno">329</tt>  <tt class="py-line"> </tt>
<a name="L330"></a><tt class="py-lineno">330</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-205" class="py-name" targets="Method lib.cuckoo.core.guest.GuestManager.determine_analyzer_path()=lib.cuckoo.core.guest.GuestManager-class.html#determine_analyzer_path"><a title="lib.cuckoo.core.guest.GuestManager.determine_analyzer_path" class="py-name" href="#" onclick="return doclink('link-205', 'determine_analyzer_path', 'link-205');">determine_analyzer_path</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L331"></a><tt class="py-lineno">331</tt>  <tt class="py-line">        <tt class="py-name">data</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt> </tt>
<a name="L332"></a><tt class="py-lineno">332</tt>  <tt class="py-line">            <tt class="py-string">"dirpath"</tt><tt class="py-op">:</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">analyzer_path</tt><tt class="py-op">,</tt> </tt>
<a name="L333"></a><tt class="py-lineno">333</tt>  <tt class="py-line">        <tt class="py-op">}</tt> </tt>
<a name="L334"></a><tt class="py-lineno">334</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-206" class="py-name"><a title="lib.cuckoo.core.guest.GuestManager.post" class="py-name" href="#" onclick="return doclink('link-206', 'post', 'link-174');">post</a></tt><tt class="py-op">(</tt><tt class="py-string">"/extract"</tt><tt class="py-op">,</tt> <tt class="py-name">files</tt><tt class="py-op">=</tt><tt class="py-op">{</tt><tt class="py-string">"zipfile"</tt><tt class="py-op">:</tt> <tt class="py-name">zip_data</tt><tt class="py-op">}</tt><tt class="py-op">,</tt> <tt class="py-name">data</tt><tt class="py-op">=</tt><tt class="py-name">data</tt><tt class="py-op">)</tt> </tt>
<a name="L335"></a><tt class="py-lineno">335</tt>  <tt class="py-line"> </tt>
<a name="L336"></a><tt class="py-lineno">336</tt>  <tt class="py-line">        <tt class="py-name">zip_data</tt><tt class="py-op">.</tt><tt id="link-207" class="py-name"><a title="lib.cuckoo.common.netlog.BsonParser.close
lib.cuckoo.core.resultserver.FileUpload.close
lib.cuckoo.core.resultserver.LogHandler.close
modules.processing.network.SortCap.close" class="py-name" href="#" onclick="return doclink('link-207', 'close', 'link-97');">close</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
</div><a name="L337"></a><tt class="py-lineno">337</tt>  <tt class="py-line"> </tt>
<a name="GuestManager.add_config"></a><div id="GuestManager.add_config-def"><a name="L338"></a><tt class="py-lineno">338</tt> <a class="py-toggle" href="#" id="GuestManager.add_config-toggle" onclick="return toggle('GuestManager.add_config');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.guest.GuestManager-class.html#add_config">add_config</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">options</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="GuestManager.add_config-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="GuestManager.add_config-expanded"><a name="L339"></a><tt class="py-lineno">339</tt>  <tt class="py-line">        <tt class="py-docstring">"""Upload the analysis.conf for this task to the Virtual Machine."""</tt> </tt>
<a name="L340"></a><tt class="py-lineno">340</tt>  <tt class="py-line">        <tt id="link-208" class="py-name"><a title="lib.cuckoo.common.config" class="py-name" href="#" onclick="return doclink('link-208', 'config', 'link-3');">config</a></tt> <tt class="py-op">=</tt> <tt class="py-name">StringIO</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L341"></a><tt class="py-lineno">341</tt>  <tt class="py-line">        <tt id="link-209" class="py-name"><a title="lib.cuckoo.common.config" class="py-name" href="#" onclick="return doclink('link-209', 'config', 'link-3');">config</a></tt><tt class="py-op">.</tt><tt id="link-210" class="py-name"><a title="modules.processing.network.SortCap.write" class="py-name" href="#" onclick="return doclink('link-210', 'write', 'link-90');">write</a></tt><tt class="py-op">(</tt><tt class="py-string">"[analysis]\n"</tt><tt class="py-op">)</tt> </tt>
<a name="L342"></a><tt class="py-lineno">342</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-211" class="py-name" targets="Variable lib.cuckoo.common.abstracts.BehaviorHandler.key=lib.cuckoo.common.abstracts.BehaviorHandler-class.html#key,Variable modules.processing.behavior.Anomaly.key=modules.processing.behavior.Anomaly-class.html#key,Variable modules.processing.behavior.ApiStats.key=modules.processing.behavior.ApiStats-class.html#key,Variable modules.processing.behavior.BehaviorAnalysis.key=modules.processing.behavior.BehaviorAnalysis-class.html#key,Variable modules.processing.behavior.GenericBehavior.key=modules.processing.behavior.GenericBehavior-class.html#key,Variable modules.processing.behavior.PlatformInfo.key=modules.processing.behavior.PlatformInfo-class.html#key,Variable modules.processing.behavior.ProcessTree.key=modules.processing.behavior.ProcessTree-class.html#key,Variable modules.processing.behavior.Summary.key=modules.processing.behavior.Summary-class.html#key,Variable modules.processing.dumptls.TLSMasterSecrets.key=modules.processing.dumptls.TLSMasterSecrets-class.html#key,Variable modules.processing.network.Keyed.key=modules.processing.network.Keyed-class.html#key,Variable modules.processing.network.NetworkAnalysis.key=modules.processing.network.NetworkAnalysis-class.html#key,Variable modules.processing.platform.linux.LinuxSystemTap.key=modules.processing.platform.linux.LinuxSystemTap-class.html#key,Variable modules.processing.platform.windows.WindowsMonitor.key=modules.processing.platform.windows.WindowsMonitor-class.html#key"><a title="lib.cuckoo.common.abstracts.BehaviorHandler.key
modules.processing.behavior.Anomaly.key
modules.processing.behavior.ApiStats.key
modules.processing.behavior.BehaviorAnalysis.key
modules.processing.behavior.GenericBehavior.key
modules.processing.behavior.PlatformInfo.key
modules.processing.behavior.ProcessTree.key
modules.processing.behavior.Summary.key
modules.processing.dumptls.TLSMasterSecrets.key
modules.processing.network.Keyed.key
modules.processing.network.NetworkAnalysis.key
modules.processing.platform.linux.LinuxSystemTap.key
modules.processing.platform.windows.WindowsMonitor.key" class="py-name" href="#" onclick="return doclink('link-211', 'key', 'link-211');">key</a></tt><tt class="py-op">,</tt> <tt class="py-name">value</tt> <tt class="py-keyword">in</tt> <tt id="link-212" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-212', 'options', 'link-112');">options</a></tt><tt class="py-op">.</tt><tt class="py-name">items</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L343"></a><tt class="py-lineno">343</tt>  <tt class="py-line">            <tt class="py-comment"># Encode datetime objects the way xmlrpc encodes them.</tt> </tt>
<a name="L344"></a><tt class="py-lineno">344</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">isinstance</tt><tt class="py-op">(</tt><tt class="py-name">value</tt><tt class="py-op">,</tt> <tt class="py-name">datetime</tt><tt class="py-op">.</tt><tt class="py-name">datetime</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L345"></a><tt class="py-lineno">345</tt>  <tt class="py-line">                <tt id="link-213" class="py-name"><a title="lib.cuckoo.common.config" class="py-name" href="#" onclick="return doclink('link-213', 'config', 'link-3');">config</a></tt><tt class="py-op">.</tt><tt id="link-214" class="py-name"><a title="modules.processing.network.SortCap.write" class="py-name" href="#" onclick="return doclink('link-214', 'write', 'link-90');">write</a></tt><tt class="py-op">(</tt><tt class="py-string">"%s = %s\n"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt id="link-215" class="py-name"><a title="lib.cuckoo.common.abstracts.BehaviorHandler.key
modules.processing.behavior.Anomaly.key
modules.processing.behavior.ApiStats.key
modules.processing.behavior.BehaviorAnalysis.key
modules.processing.behavior.GenericBehavior.key
modules.processing.behavior.PlatformInfo.key
modules.processing.behavior.ProcessTree.key
modules.processing.behavior.Summary.key
modules.processing.dumptls.TLSMasterSecrets.key
modules.processing.network.Keyed.key
modules.processing.network.NetworkAnalysis.key
modules.processing.platform.linux.LinuxSystemTap.key
modules.processing.platform.windows.WindowsMonitor.key" class="py-name" href="#" onclick="return doclink('link-215', 'key', 'link-211');">key</a></tt><tt class="py-op">,</tt> <tt class="py-name">value</tt><tt class="py-op">.</tt><tt class="py-name">strftime</tt><tt class="py-op">(</tt><tt class="py-string">"%Y%m%dT%H:%M:%S"</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L346"></a><tt class="py-lineno">346</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L347"></a><tt class="py-lineno">347</tt>  <tt class="py-line">                <tt id="link-216" class="py-name"><a title="lib.cuckoo.common.config" class="py-name" href="#" onclick="return doclink('link-216', 'config', 'link-3');">config</a></tt><tt class="py-op">.</tt><tt id="link-217" class="py-name"><a title="modules.processing.network.SortCap.write" class="py-name" href="#" onclick="return doclink('link-217', 'write', 'link-90');">write</a></tt><tt class="py-op">(</tt><tt class="py-string">"%s = %s\n"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt id="link-218" class="py-name"><a title="lib.cuckoo.common.abstracts.BehaviorHandler.key
modules.processing.behavior.Anomaly.key
modules.processing.behavior.ApiStats.key
modules.processing.behavior.BehaviorAnalysis.key
modules.processing.behavior.GenericBehavior.key
modules.processing.behavior.PlatformInfo.key
modules.processing.behavior.ProcessTree.key
modules.processing.behavior.Summary.key
modules.processing.dumptls.TLSMasterSecrets.key
modules.processing.network.Keyed.key
modules.processing.network.NetworkAnalysis.key
modules.processing.platform.linux.LinuxSystemTap.key
modules.processing.platform.windows.WindowsMonitor.key" class="py-name" href="#" onclick="return doclink('link-218', 'key', 'link-211');">key</a></tt><tt class="py-op">,</tt> <tt class="py-name">value</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L348"></a><tt class="py-lineno">348</tt>  <tt class="py-line"> </tt>
<a name="L349"></a><tt class="py-lineno">349</tt>  <tt class="py-line">        <tt id="link-219" class="py-name"><a title="lib.cuckoo.common.config" class="py-name" href="#" onclick="return doclink('link-219', 'config', 'link-3');">config</a></tt><tt class="py-op">.</tt><tt id="link-220" class="py-name"><a title="lib.cuckoo.core.resultserver.ResultHandler.seek" class="py-name" href="#" onclick="return doclink('link-220', 'seek', 'link-202');">seek</a></tt><tt class="py-op">(</tt><tt class="py-number">0</tt><tt class="py-op">)</tt> </tt>
<a name="L350"></a><tt class="py-lineno">350</tt>  <tt class="py-line"> </tt>
<a name="L351"></a><tt class="py-lineno">351</tt>  <tt class="py-line">        <tt class="py-name">data</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt> </tt>
<a name="L352"></a><tt class="py-lineno">352</tt>  <tt class="py-line">            <tt class="py-string">"filepath"</tt><tt class="py-op">:</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">analyzer_path</tt><tt class="py-op">,</tt> <tt class="py-string">"analysis.conf"</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> </tt>
<a name="L353"></a><tt class="py-lineno">353</tt>  <tt class="py-line">        <tt class="py-op">}</tt> </tt>
<a name="L354"></a><tt class="py-lineno">354</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-221" class="py-name"><a title="lib.cuckoo.core.guest.GuestManager.post" class="py-name" href="#" onclick="return doclink('link-221', 'post', 'link-174');">post</a></tt><tt class="py-op">(</tt><tt class="py-string">"/store"</tt><tt class="py-op">,</tt> <tt class="py-name">files</tt><tt class="py-op">=</tt><tt class="py-op">{</tt><tt class="py-string">"file"</tt><tt class="py-op">:</tt> <tt id="link-222" class="py-name"><a title="lib.cuckoo.common.config" class="py-name" href="#" onclick="return doclink('link-222', 'config', 'link-3');">config</a></tt><tt class="py-op">}</tt><tt class="py-op">,</tt> <tt class="py-name">data</tt><tt class="py-op">=</tt><tt class="py-name">data</tt><tt class="py-op">)</tt> </tt>
</div><a name="L355"></a><tt class="py-lineno">355</tt>  <tt class="py-line"> </tt>
<a name="GuestManager.start_analysis"></a><div id="GuestManager.start_analysis-def"><a name="L356"></a><tt class="py-lineno">356</tt> <a class="py-toggle" href="#" id="GuestManager.start_analysis-toggle" onclick="return toggle('GuestManager.start_analysis');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.guest.GuestManager-class.html#start_analysis">start_analysis</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">options</tt><tt class="py-op">,</tt> <tt class="py-param">monitor</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="GuestManager.start_analysis-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="GuestManager.start_analysis-expanded"><a name="L357"></a><tt class="py-lineno">357</tt>  <tt class="py-line">        <tt class="py-docstring">"""Start the analysis by uploading all required files.</tt> </tt>
<a name="L358"></a><tt class="py-lineno">358</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L359"></a><tt class="py-lineno">359</tt>  <tt class="py-line"><tt class="py-docstring">        @param options: the task options</tt> </tt>
<a name="L360"></a><tt class="py-lineno">360</tt>  <tt class="py-line"><tt class="py-docstring">        @param monitor: identifier of the monitor to be used.</tt> </tt>
<a name="L361"></a><tt class="py-lineno">361</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L362"></a><tt class="py-lineno">362</tt>  <tt class="py-line">        <tt id="link-223" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-223', 'log', 'link-41');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">"Starting analysis on guest (id=%s, ip=%s)"</tt><tt class="py-op">,</tt> </tt>
<a name="L363"></a><tt class="py-lineno">363</tt>  <tt class="py-line">                 <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">vmid</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">ipaddr</tt><tt class="py-op">)</tt> </tt>
<a name="L364"></a><tt class="py-lineno">364</tt>  <tt class="py-line"> </tt>
<a name="L365"></a><tt class="py-lineno">365</tt>  <tt class="py-line">        <tt class="py-comment"># If the analysis timeout is higher than the critical timeout,</tt> </tt>
<a name="L366"></a><tt class="py-lineno">366</tt>  <tt class="py-line">        <tt class="py-comment"># automatically increase the critical timeout by one minute.</tt> </tt>
<a name="L367"></a><tt class="py-lineno">367</tt>  <tt class="py-line">        <tt class="py-comment"># if options["timeout"] &gt; self.timeout:</tt> </tt>
<a name="L368"></a><tt class="py-lineno">368</tt>  <tt class="py-line">        <tt class="py-comment">#     log.debug("Automatically increased critical timeout to %s",</tt> </tt>
<a name="L369"></a><tt class="py-lineno">369</tt>  <tt class="py-line">        <tt class="py-comment">#               self.timeout)</tt> </tt>
<a name="L370"></a><tt class="py-lineno">370</tt>  <tt class="py-line">        <tt class="py-comment">#     self.timeout = options["timeout"] + 60</tt> </tt>
<a name="L371"></a><tt class="py-lineno">371</tt>  <tt class="py-line"> </tt>
<a name="L372"></a><tt class="py-lineno">372</tt>  <tt class="py-line">        <tt class="py-comment"># Wait for the agent to come alive.</tt> </tt>
<a name="L373"></a><tt class="py-lineno">373</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-224" class="py-name" targets="Method lib.cuckoo.core.guest.GuestManager.wait_available()=lib.cuckoo.core.guest.GuestManager-class.html#wait_available"><a title="lib.cuckoo.core.guest.GuestManager.wait_available" class="py-name" href="#" onclick="return doclink('link-224', 'wait_available', 'link-224');">wait_available</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L374"></a><tt class="py-lineno">374</tt>  <tt class="py-line"> </tt>
<a name="L375"></a><tt class="py-lineno">375</tt>  <tt class="py-line">        <tt class="py-comment"># Could be beautified a bit, but basically we have to perform the</tt> </tt>
<a name="L376"></a><tt class="py-lineno">376</tt>  <tt class="py-line">        <tt class="py-comment"># same check here as we did in wait_available().</tt> </tt>
<a name="L377"></a><tt class="py-lineno">377</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-225" class="py-name"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-225', 'db', 'link-42');">db</a></tt><tt class="py-op">.</tt><tt id="link-226" class="py-name"><a title="lib.cuckoo.core.database.Database.guest_get_status" class="py-name" href="#" onclick="return doclink('link-226', 'guest_get_status', 'link-70');">guest_get_status</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-227" class="py-name"><a title="lib.cuckoo.core.database.Error.task_id
lib.cuckoo.core.database.Guest.task_id" class="py-name" href="#" onclick="return doclink('link-227', 'task_id', 'link-49');">task_id</a></tt><tt class="py-op">)</tt> <tt class="py-op">!=</tt> <tt class="py-string">"starting"</tt><tt class="py-op">:</tt> </tt>
<a name="L378"></a><tt class="py-lineno">378</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> </tt>
<a name="L379"></a><tt class="py-lineno">379</tt>  <tt class="py-line"> </tt>
<a name="L380"></a><tt class="py-lineno">380</tt>  <tt class="py-line">        <tt class="py-comment"># Check whether this is the new Agent or the old one (by looking at</tt> </tt>
<a name="L381"></a><tt class="py-lineno">381</tt>  <tt class="py-line">        <tt class="py-comment"># the status code of the index page).</tt> </tt>
<a name="L382"></a><tt class="py-lineno">382</tt>  <tt class="py-line">        <tt class="py-name">r</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-228" class="py-name"><a title="lib.cuckoo.common.config.Config.get
lib.cuckoo.core.guest.GuestManager.get" class="py-name" href="#" onclick="return doclink('link-228', 'get', 'link-173');">get</a></tt><tt class="py-op">(</tt><tt class="py-string">"/"</tt><tt class="py-op">)</tt> </tt>
<a name="L383"></a><tt class="py-lineno">383</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">r</tt><tt class="py-op">.</tt><tt class="py-name">status_code</tt> <tt class="py-op">==</tt> <tt class="py-number">501</tt><tt class="py-op">:</tt> </tt>
<a name="L384"></a><tt class="py-lineno">384</tt>  <tt class="py-line">            <tt class="py-comment"># log.info("Cuckoo 2.0 features a new Agent which is more "</tt> </tt>
<a name="L385"></a><tt class="py-lineno">385</tt>  <tt class="py-line">            <tt class="py-comment">#          "feature-rich. It is recommended to make new Virtual "</tt> </tt>
<a name="L386"></a><tt class="py-lineno">386</tt>  <tt class="py-line">            <tt class="py-comment">#          "Machines with the new Agent, but for now falling back "</tt> </tt>
<a name="L387"></a><tt class="py-lineno">387</tt>  <tt class="py-line">            <tt class="py-comment">#          "to backwards compatibility with the old agent.")</tt> </tt>
<a name="L388"></a><tt class="py-lineno">388</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">is_old</tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L389"></a><tt class="py-lineno">389</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">old</tt><tt class="py-op">.</tt><tt id="link-229" class="py-name" targets="Method lib.cuckoo.core.guest.GuestManager.start_analysis()=lib.cuckoo.core.guest.GuestManager-class.html#start_analysis,Method lib.cuckoo.core.guest.OldGuestManager.start_analysis()=lib.cuckoo.core.guest.OldGuestManager-class.html#start_analysis"><a title="lib.cuckoo.core.guest.GuestManager.start_analysis
lib.cuckoo.core.guest.OldGuestManager.start_analysis" class="py-name" href="#" onclick="return doclink('link-229', 'start_analysis', 'link-229');">start_analysis</a></tt><tt class="py-op">(</tt><tt id="link-230" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-230', 'options', 'link-112');">options</a></tt><tt class="py-op">,</tt> <tt class="py-name">monitor</tt><tt class="py-op">)</tt> </tt>
<a name="L390"></a><tt class="py-lineno">390</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> </tt>
<a name="L391"></a><tt class="py-lineno">391</tt>  <tt class="py-line"> </tt>
<a name="L392"></a><tt class="py-lineno">392</tt>  <tt class="py-line">        <tt id="link-231" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-231', 'log', 'link-41');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">"Guest is running Cuckoo Agent %s (id=%s, ip=%s)"</tt><tt class="py-op">,</tt> </tt>
<a name="L393"></a><tt class="py-lineno">393</tt>  <tt class="py-line">                 <tt class="py-name">r</tt><tt class="py-op">.</tt><tt class="py-name">json</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">.</tt><tt id="link-232" class="py-name"><a title="lib.cuckoo.common.config.Config.get
lib.cuckoo.core.guest.GuestManager.get" class="py-name" href="#" onclick="return doclink('link-232', 'get', 'link-173');">get</a></tt><tt class="py-op">(</tt><tt class="py-string">"version"</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">vmid</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">ipaddr</tt><tt class="py-op">)</tt> </tt>
<a name="L394"></a><tt class="py-lineno">394</tt>  <tt class="py-line"> </tt>
<a name="L395"></a><tt class="py-lineno">395</tt>  <tt class="py-line">        <tt class="py-comment"># Obtain the environment variables.</tt> </tt>
<a name="L396"></a><tt class="py-lineno">396</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-233" class="py-name" targets="Method lib.cuckoo.core.guest.GuestManager.query_environ()=lib.cuckoo.core.guest.GuestManager-class.html#query_environ"><a title="lib.cuckoo.core.guest.GuestManager.query_environ" class="py-name" href="#" onclick="return doclink('link-233', 'query_environ', 'link-233');">query_environ</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L397"></a><tt class="py-lineno">397</tt>  <tt class="py-line"> </tt>
<a name="L398"></a><tt class="py-lineno">398</tt>  <tt class="py-line">        <tt class="py-comment"># Upload the analyzer.</tt> </tt>
<a name="L399"></a><tt class="py-lineno">399</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-234" class="py-name"><a title="lib.cuckoo.core.guest.GuestManager.upload_analyzer
lib.cuckoo.core.guest.OldGuestManager.upload_analyzer" class="py-name" href="#" onclick="return doclink('link-234', 'upload_analyzer', 'link-109');">upload_analyzer</a></tt><tt class="py-op">(</tt><tt class="py-name">monitor</tt><tt class="py-op">)</tt> </tt>
<a name="L400"></a><tt class="py-lineno">400</tt>  <tt class="py-line"> </tt>
<a name="L401"></a><tt class="py-lineno">401</tt>  <tt class="py-line">        <tt class="py-comment"># Pass along the analysis.conf file.</tt> </tt>
<a name="L402"></a><tt class="py-lineno">402</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-235" class="py-name"><a title="lib.cuckoo.core.guest.GuestManager.add_config" class="py-name" href="#" onclick="return doclink('link-235', 'add_config', 'link-111');">add_config</a></tt><tt class="py-op">(</tt><tt id="link-236" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-236', 'options', 'link-112');">options</a></tt><tt class="py-op">)</tt> </tt>
<a name="L403"></a><tt class="py-lineno">403</tt>  <tt class="py-line"> </tt>
<a name="L404"></a><tt class="py-lineno">404</tt>  <tt class="py-line">        <tt class="py-comment"># If the target is a file, upload it to the guest.</tt> </tt>
<a name="L405"></a><tt class="py-lineno">405</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-237" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-237', 'options', 'link-112');">options</a></tt><tt class="py-op">[</tt><tt class="py-string">"category"</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-string">"file"</tt><tt class="py-op">:</tt> </tt>
<a name="L406"></a><tt class="py-lineno">406</tt>  <tt class="py-line">            <tt class="py-name">data</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt> </tt>
<a name="L407"></a><tt class="py-lineno">407</tt>  <tt class="py-line">                <tt class="py-string">"filepath"</tt><tt class="py-op">:</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">environ</tt><tt class="py-op">[</tt><tt class="py-string">"TEMP"</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt id="link-238" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-238', 'options', 'link-112');">options</a></tt><tt class="py-op">[</tt><tt class="py-string">"file_name"</tt><tt class="py-op">]</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> </tt>
<a name="L408"></a><tt class="py-lineno">408</tt>  <tt class="py-line">            <tt class="py-op">}</tt> </tt>
<a name="L409"></a><tt class="py-lineno">409</tt>  <tt class="py-line">            <tt class="py-name">files</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt> </tt>
<a name="L410"></a><tt class="py-lineno">410</tt>  <tt class="py-line">                <tt class="py-string">"file"</tt><tt class="py-op">:</tt> <tt class="py-name">open</tt><tt class="py-op">(</tt><tt id="link-239" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-239', 'options', 'link-112');">options</a></tt><tt class="py-op">[</tt><tt class="py-string">"target"</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt class="py-string">"rb"</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> </tt>
<a name="L411"></a><tt class="py-lineno">411</tt>  <tt class="py-line">            <tt class="py-op">}</tt> </tt>
<a name="L412"></a><tt class="py-lineno">412</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-240" class="py-name"><a title="lib.cuckoo.core.guest.GuestManager.post" class="py-name" href="#" onclick="return doclink('link-240', 'post', 'link-174');">post</a></tt><tt class="py-op">(</tt><tt class="py-string">"/store"</tt><tt class="py-op">,</tt> <tt class="py-name">files</tt><tt class="py-op">=</tt><tt class="py-name">files</tt><tt class="py-op">,</tt> <tt class="py-name">data</tt><tt class="py-op">=</tt><tt class="py-name">data</tt><tt class="py-op">)</tt> </tt>
<a name="L413"></a><tt class="py-lineno">413</tt>  <tt class="py-line"> </tt>
<a name="L414"></a><tt class="py-lineno">414</tt>  <tt class="py-line">        <tt class="py-comment"># Execute the analyzer that we just uploaded. TODO Improve this.</tt> </tt>
<a name="L415"></a><tt class="py-lineno">415</tt>  <tt class="py-line">        <tt class="py-name">data</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt> </tt>
<a name="L416"></a><tt class="py-lineno">416</tt>  <tt class="py-line">            <tt class="py-string">"command"</tt><tt class="py-op">:</tt> <tt class="py-string">"C:\\Python27\\python.exe %s\\analyzer.py"</tt> <tt class="py-op">%</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">analyzer_path</tt><tt class="py-op">,</tt> </tt>
<a name="L417"></a><tt class="py-lineno">417</tt>  <tt class="py-line">            <tt class="py-string">"async"</tt><tt class="py-op">:</tt> <tt class="py-string">"yes"</tt><tt class="py-op">,</tt> </tt>
<a name="L418"></a><tt class="py-lineno">418</tt>  <tt class="py-line">            <tt class="py-string">"cwd"</tt><tt class="py-op">:</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">analyzer_path</tt><tt class="py-op">,</tt> </tt>
<a name="L419"></a><tt class="py-lineno">419</tt>  <tt class="py-line">        <tt class="py-op">}</tt> </tt>
<a name="L420"></a><tt class="py-lineno">420</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-241" class="py-name"><a title="lib.cuckoo.core.guest.GuestManager.post" class="py-name" href="#" onclick="return doclink('link-241', 'post', 'link-174');">post</a></tt><tt class="py-op">(</tt><tt class="py-string">"/execute"</tt><tt class="py-op">,</tt> <tt class="py-name">data</tt><tt class="py-op">=</tt><tt class="py-name">data</tt><tt class="py-op">)</tt> </tt>
</div><a name="L421"></a><tt class="py-lineno">421</tt>  <tt class="py-line"> </tt>
<a name="GuestManager.wait_for_completion"></a><div id="GuestManager.wait_for_completion-def"><a name="L422"></a><tt class="py-lineno">422</tt> <a class="py-toggle" href="#" id="GuestManager.wait_for_completion-toggle" onclick="return toggle('GuestManager.wait_for_completion');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.guest.GuestManager-class.html#wait_for_completion">wait_for_completion</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="GuestManager.wait_for_completion-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="GuestManager.wait_for_completion-expanded"><a name="L423"></a><tt class="py-lineno">423</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">is_old</tt><tt class="py-op">:</tt> </tt>
<a name="L424"></a><tt class="py-lineno">424</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">old</tt><tt class="py-op">.</tt><tt id="link-242" class="py-name" targets="Method lib.cuckoo.core.guest.GuestManager.wait_for_completion()=lib.cuckoo.core.guest.GuestManager-class.html#wait_for_completion,Method lib.cuckoo.core.guest.OldGuestManager.wait_for_completion()=lib.cuckoo.core.guest.OldGuestManager-class.html#wait_for_completion"><a title="lib.cuckoo.core.guest.GuestManager.wait_for_completion
lib.cuckoo.core.guest.OldGuestManager.wait_for_completion" class="py-name" href="#" onclick="return doclink('link-242', 'wait_for_completion', 'link-242');">wait_for_completion</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L425"></a><tt class="py-lineno">425</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> </tt>
<a name="L426"></a><tt class="py-lineno">426</tt>  <tt class="py-line"> </tt>
<a name="L427"></a><tt class="py-lineno">427</tt>  <tt class="py-line">        <tt class="py-name">end</tt> <tt class="py-op">=</tt> <tt class="py-name">time</tt><tt class="py-op">.</tt><tt class="py-name">time</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-243" class="py-name"><a title="lib.cuckoo.core.database.Task.timeout" class="py-name" href="#" onclick="return doclink('link-243', 'timeout', 'link-53');">timeout</a></tt> </tt>
<a name="L428"></a><tt class="py-lineno">428</tt>  <tt class="py-line"> </tt>
<a name="L429"></a><tt class="py-lineno">429</tt>  <tt class="py-line">        <tt class="py-keyword">while</tt> <tt id="link-244" class="py-name"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-244', 'db', 'link-42');">db</a></tt><tt class="py-op">.</tt><tt id="link-245" class="py-name"><a title="lib.cuckoo.core.database.Database.guest_get_status" class="py-name" href="#" onclick="return doclink('link-245', 'guest_get_status', 'link-70');">guest_get_status</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-246" class="py-name"><a title="lib.cuckoo.core.database.Error.task_id
lib.cuckoo.core.database.Guest.task_id" class="py-name" href="#" onclick="return doclink('link-246', 'task_id', 'link-49');">task_id</a></tt><tt class="py-op">)</tt> <tt class="py-op">==</tt> <tt class="py-string">"running"</tt><tt class="py-op">:</tt> </tt>
<a name="L430"></a><tt class="py-lineno">430</tt>  <tt class="py-line">            <tt class="py-name">time</tt><tt class="py-op">.</tt><tt class="py-name">sleep</tt><tt class="py-op">(</tt><tt class="py-number">1</tt><tt class="py-op">)</tt> </tt>
<a name="L431"></a><tt class="py-lineno">431</tt>  <tt class="py-line"> </tt>
<a name="L432"></a><tt class="py-lineno">432</tt>  <tt class="py-line">            <tt class="py-comment"># If the analysis hits the critical timeout, just return straight</tt> </tt>
<a name="L433"></a><tt class="py-lineno">433</tt>  <tt class="py-line">            <tt class="py-comment"># away and try to recover the analysis results from the guest.</tt> </tt>
<a name="L434"></a><tt class="py-lineno">434</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">time</tt><tt class="py-op">.</tt><tt class="py-name">time</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> <tt class="py-op">&gt;</tt> <tt class="py-name">end</tt><tt class="py-op">:</tt> </tt>
<a name="L435"></a><tt class="py-lineno">435</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-247" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooGuestError" class="py-name" href="#" onclick="return doclink('link-247', 'CuckooGuestError', 'link-30');">CuckooGuestError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The analysis hit the critical timeout, terminating."</tt><tt class="py-op">)</tt> </tt>
<a name="L436"></a><tt class="py-lineno">436</tt>  <tt class="py-line"> </tt>
<a name="L437"></a><tt class="py-lineno">437</tt>  <tt class="py-line">            <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L438"></a><tt class="py-lineno">438</tt>  <tt class="py-line">                <tt id="link-248" class="py-name"><a title="lib.cuckoo.core.database.Guest.status
lib.cuckoo.core.database.Machine.status
lib.cuckoo.core.database.Task.status" class="py-name" href="#" onclick="return doclink('link-248', 'status', 'link-64');">status</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-249" class="py-name"><a title="lib.cuckoo.common.config.Config.get
lib.cuckoo.core.guest.GuestManager.get" class="py-name" href="#" onclick="return doclink('link-249', 'get', 'link-173');">get</a></tt><tt class="py-op">(</tt><tt class="py-string">"/status"</tt><tt class="py-op">,</tt> <tt id="link-250" class="py-name"><a title="lib.cuckoo.core.database.Task.timeout" class="py-name" href="#" onclick="return doclink('link-250', 'timeout', 'link-53');">timeout</a></tt><tt class="py-op">=</tt><tt class="py-number">5</tt><tt class="py-op">)</tt><tt class="py-op">.</tt><tt class="py-name">json</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L439"></a><tt class="py-lineno">439</tt>  <tt class="py-line">            <tt class="py-keyword">except</tt><tt class="py-op">:</tt> </tt>
<a name="L440"></a><tt class="py-lineno">440</tt>  <tt class="py-line">                <tt id="link-251" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-251', 'log', 'link-41');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">"Virtual Machine stopped abruptly"</tt><tt class="py-op">)</tt> </tt>
<a name="L441"></a><tt class="py-lineno">441</tt>  <tt class="py-line">                <tt class="py-keyword">break</tt> </tt>
<a name="L442"></a><tt class="py-lineno">442</tt>  <tt class="py-line"> </tt>
<a name="L443"></a><tt class="py-lineno">443</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-252" class="py-name"><a title="lib.cuckoo.core.database.Guest.status
lib.cuckoo.core.database.Machine.status
lib.cuckoo.core.database.Task.status" class="py-name" href="#" onclick="return doclink('link-252', 'status', 'link-64');">status</a></tt><tt class="py-op">[</tt><tt class="py-string">"status"</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-string">"complete"</tt><tt class="py-op">:</tt> </tt>
<a name="L444"></a><tt class="py-lineno">444</tt>  <tt class="py-line">                <tt id="link-253" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-253', 'log', 'link-41');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">"%s: analysis completed successfully"</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">vmid</tt><tt class="py-op">)</tt> </tt>
<a name="L445"></a><tt class="py-lineno">445</tt>  <tt class="py-line">                <tt class="py-keyword">return</tt> </tt>
<a name="L446"></a><tt class="py-lineno">446</tt>  <tt class="py-line">            <tt class="py-keyword">elif</tt> <tt id="link-254" class="py-name"><a title="lib.cuckoo.core.database.Guest.status
lib.cuckoo.core.database.Machine.status
lib.cuckoo.core.database.Task.status" class="py-name" href="#" onclick="return doclink('link-254', 'status', 'link-64');">status</a></tt><tt class="py-op">[</tt><tt class="py-string">"status"</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-string">"exception"</tt><tt class="py-op">:</tt> </tt>
<a name="L447"></a><tt class="py-lineno">447</tt>  <tt class="py-line">                <tt id="link-255" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-255', 'log', 'link-41');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">"%s: analysis caught an exception\n%s"</tt><tt class="py-op">,</tt> </tt>
<a name="L448"></a><tt class="py-lineno">448</tt>  <tt class="py-line">                         <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">vmid</tt><tt class="py-op">,</tt> <tt id="link-256" class="py-name"><a title="lib.cuckoo.core.database.Guest.status
lib.cuckoo.core.database.Machine.status
lib.cuckoo.core.database.Task.status" class="py-name" href="#" onclick="return doclink('link-256', 'status', 'link-64');">status</a></tt><tt class="py-op">[</tt><tt class="py-string">"description"</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L449"></a><tt class="py-lineno">449</tt>  <tt class="py-line">                <tt class="py-keyword">return</tt> </tt>
<a name="L450"></a><tt class="py-lineno">450</tt>  <tt class="py-line"> </tt>
<a name="L451"></a><tt class="py-lineno">451</tt>  <tt class="py-line">            <tt id="link-257" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-257', 'log', 'link-41');">log</a></tt><tt class="py-op">.</tt><tt id="link-258" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-258', 'debug', 'link-62');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"%s: analysis still processing"</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">vmid</tt><tt class="py-op">)</tt> </tt>
</div><a name="L452"></a><tt class="py-lineno">452</tt>  <tt class="py-line"> </tt>
<a name="L453"></a><tt class="py-lineno">453</tt>  <tt class="py-line">    <tt class="py-decorator">@</tt><tt class="py-decorator">property</tt> </tt>
<a name="GuestManager.server"></a><div id="GuestManager.server-def"><a name="L454"></a><tt class="py-lineno">454</tt> <a class="py-toggle" href="#" id="GuestManager.server-toggle" onclick="return toggle('GuestManager.server');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.guest.GuestManager-class.html#server">server</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="GuestManager.server-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="GuestManager.server-expanded"><a name="L455"></a><tt class="py-lineno">455</tt>  <tt class="py-line">        <tt class="py-docstring">"""Currently the Physical machine manager is using GuestManager in</tt> </tt>
<a name="L456"></a><tt class="py-lineno">456</tt>  <tt class="py-line"><tt class="py-docstring">        an incorrect way. This should be fixed up later but for now this</tt> </tt>
<a name="L457"></a><tt class="py-lineno">457</tt>  <tt class="py-line"><tt class="py-docstring">        workaround will do."""</tt> </tt>
<a name="L458"></a><tt class="py-lineno">458</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">old</tt><tt class="py-op">.</tt><tt id="link-259" class="py-name"><a title="lib.cuckoo.core.guest.GuestManager.server" class="py-name" href="#" onclick="return doclink('link-259', 'server', 'link-57');">server</a></tt> </tt>
</div></div><a name="L459"></a><tt class="py-lineno">459</tt>  <tt class="py-line"> </tt><script type="text/javascript">
<!--
expandto(location.href);
// -->
</script>
</pre>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://cuckoosandbox.org">Cuckoo Sandbox</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Mon Jan 11 19:29:09 2016
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
