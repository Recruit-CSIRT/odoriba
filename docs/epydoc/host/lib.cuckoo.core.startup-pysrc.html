<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>lib.cuckoo.core.startup</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://cuckoosandbox.org">Cuckoo Sandbox</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="lib-module.html">Package&nbsp;lib</a> ::
        <a href="lib.cuckoo-module.html">Package&nbsp;cuckoo</a> ::
        <a href="lib.cuckoo.core-module.html">Package&nbsp;core</a> ::
        Module&nbsp;startup
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="lib.cuckoo.core.startup-pysrc.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<h1 class="epydoc">Source Code for <a href="lib.cuckoo.core.startup-module.html">Module lib.cuckoo.core.startup</a></h1>
<pre class="py-src">
<a name="L1"></a><tt class="py-lineno">  1</tt>  <tt class="py-line"><tt class="py-comment"># Copyright (C) 2010-2013 Claudio Guarnieri.</tt> </tt>
<a name="L2"></a><tt class="py-lineno">  2</tt>  <tt class="py-line"><tt class="py-comment"># Copyright (C) 2014-2015 Cuckoo Foundation.</tt> </tt>
<a name="L3"></a><tt class="py-lineno">  3</tt>  <tt class="py-line"><tt class="py-comment"># This file is part of Cuckoo Sandbox - http://www.cuckoosandbox.org</tt> </tt>
<a name="L4"></a><tt class="py-lineno">  4</tt>  <tt class="py-line"><tt class="py-comment"># See the file 'docs/LICENSE' for copying permission.</tt> </tt>
<a name="L5"></a><tt class="py-lineno">  5</tt>  <tt class="py-line"> </tt>
<a name="L6"></a><tt class="py-lineno">  6</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">os</tt> </tt>
<a name="L7"></a><tt class="py-lineno">  7</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">shutil</tt> </tt>
<a name="L8"></a><tt class="py-lineno">  8</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">sys</tt> </tt>
<a name="L9"></a><tt class="py-lineno">  9</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">copy</tt> </tt>
<a name="L10"></a><tt class="py-lineno"> 10</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">json</tt> </tt>
<a name="L11"></a><tt class="py-lineno"> 11</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">urllib</tt> </tt>
<a name="L12"></a><tt class="py-lineno"> 12</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">urllib2</tt> </tt>
<a name="L13"></a><tt class="py-lineno"> 13</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">logging</tt> </tt>
<a name="L14"></a><tt class="py-lineno"> 14</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">logging</tt><tt class="py-op">.</tt><tt class="py-name">handlers</tt> </tt>
<a name="L15"></a><tt class="py-lineno"> 15</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">socket</tt> </tt>
<a name="L16"></a><tt class="py-lineno"> 16</tt>  <tt class="py-line"> </tt>
<a name="L17"></a><tt class="py-lineno"> 17</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-0" class="py-name" targets="Package lib=lib-module.html"><a title="lib" class="py-name" href="#" onclick="return doclink('link-0', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-1" class="py-name" targets="Package lib.cuckoo=lib.cuckoo-module.html"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-1', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-2" class="py-name" targets="Package lib.cuckoo.common=lib.cuckoo.common-module.html"><a title="lib.cuckoo.common" class="py-name" href="#" onclick="return doclink('link-2', 'common', 'link-2');">common</a></tt><tt class="py-op">.</tt><tt id="link-3" class="py-name" targets="Module lib.cuckoo.common.colors=lib.cuckoo.common.colors-module.html"><a title="lib.cuckoo.common.colors" class="py-name" href="#" onclick="return doclink('link-3', 'colors', 'link-3');">colors</a></tt> <tt class="py-keyword">import</tt> <tt id="link-4" class="py-name" targets="Function lib.cuckoo.common.colors.red()=lib.cuckoo.common.colors-module.html#red"><a title="lib.cuckoo.common.colors.red" class="py-name" href="#" onclick="return doclink('link-4', 'red', 'link-4');">red</a></tt><tt class="py-op">,</tt> <tt id="link-5" class="py-name" targets="Function lib.cuckoo.common.colors.green()=lib.cuckoo.common.colors-module.html#green"><a title="lib.cuckoo.common.colors.green" class="py-name" href="#" onclick="return doclink('link-5', 'green', 'link-5');">green</a></tt><tt class="py-op">,</tt> <tt id="link-6" class="py-name" targets="Function lib.cuckoo.common.colors.yellow()=lib.cuckoo.common.colors-module.html#yellow"><a title="lib.cuckoo.common.colors.yellow" class="py-name" href="#" onclick="return doclink('link-6', 'yellow', 'link-6');">yellow</a></tt><tt class="py-op">,</tt> <tt id="link-7" class="py-name" targets="Function lib.cuckoo.common.colors.cyan()=lib.cuckoo.common.colors-module.html#cyan"><a title="lib.cuckoo.common.colors.cyan" class="py-name" href="#" onclick="return doclink('link-7', 'cyan', 'link-7');">cyan</a></tt> </tt>
<a name="L18"></a><tt class="py-lineno"> 18</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-8" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-8', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-9" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-9', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-10" class="py-name"><a title="lib.cuckoo.common" class="py-name" href="#" onclick="return doclink('link-10', 'common', 'link-2');">common</a></tt><tt class="py-op">.</tt><tt id="link-11" class="py-name" targets="Module lib.cuckoo.common.config=lib.cuckoo.common.config-module.html"><a title="lib.cuckoo.common.config" class="py-name" href="#" onclick="return doclink('link-11', 'config', 'link-11');">config</a></tt> <tt class="py-keyword">import</tt> <tt id="link-12" class="py-name" targets="Class lib.cuckoo.common.config.Config=lib.cuckoo.common.config.Config-class.html"><a title="lib.cuckoo.common.config.Config" class="py-name" href="#" onclick="return doclink('link-12', 'Config', 'link-12');">Config</a></tt> </tt>
<a name="L19"></a><tt class="py-lineno"> 19</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-13" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-13', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-14" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-14', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-15" class="py-name"><a title="lib.cuckoo.common" class="py-name" href="#" onclick="return doclink('link-15', 'common', 'link-2');">common</a></tt><tt class="py-op">.</tt><tt id="link-16" class="py-name" targets="Module lib.cuckoo.common.constants=lib.cuckoo.common.constants-module.html"><a title="lib.cuckoo.common.constants" class="py-name" href="#" onclick="return doclink('link-16', 'constants', 'link-16');">constants</a></tt> <tt class="py-keyword">import</tt> <tt id="link-17" class="py-name" targets="Variable lib.cuckoo.common.constants.CUCKOO_ROOT=lib.cuckoo.common.constants-module.html#CUCKOO_ROOT"><a title="lib.cuckoo.common.constants.CUCKOO_ROOT" class="py-name" href="#" onclick="return doclink('link-17', 'CUCKOO_ROOT', 'link-17');">CUCKOO_ROOT</a></tt><tt class="py-op">,</tt> <tt id="link-18" class="py-name" targets="Variable lib.cuckoo.common.constants.CUCKOO_VERSION=lib.cuckoo.common.constants-module.html#CUCKOO_VERSION"><a title="lib.cuckoo.common.constants.CUCKOO_VERSION" class="py-name" href="#" onclick="return doclink('link-18', 'CUCKOO_VERSION', 'link-18');">CUCKOO_VERSION</a></tt> </tt>
<a name="L20"></a><tt class="py-lineno"> 20</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-19" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-19', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-20" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-20', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-21" class="py-name"><a title="lib.cuckoo.common" class="py-name" href="#" onclick="return doclink('link-21', 'common', 'link-2');">common</a></tt><tt class="py-op">.</tt><tt id="link-22" class="py-name" targets="Module lib.cuckoo.common.exceptions=lib.cuckoo.common.exceptions-module.html"><a title="lib.cuckoo.common.exceptions" class="py-name" href="#" onclick="return doclink('link-22', 'exceptions', 'link-22');">exceptions</a></tt> <tt class="py-keyword">import</tt> <tt id="link-23" class="py-name" targets="Class lib.cuckoo.common.exceptions.CuckooStartupError=lib.cuckoo.common.exceptions.CuckooStartupError-class.html"><a title="lib.cuckoo.common.exceptions.CuckooStartupError" class="py-name" href="#" onclick="return doclink('link-23', 'CuckooStartupError', 'link-23');">CuckooStartupError</a></tt><tt class="py-op">,</tt> <tt id="link-24" class="py-name" targets="Class lib.cuckoo.common.exceptions.CuckooDatabaseError=lib.cuckoo.common.exceptions.CuckooDatabaseError-class.html"><a title="lib.cuckoo.common.exceptions.CuckooDatabaseError" class="py-name" href="#" onclick="return doclink('link-24', 'CuckooDatabaseError', 'link-24');">CuckooDatabaseError</a></tt> </tt>
<a name="L21"></a><tt class="py-lineno"> 21</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-25" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-25', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-26" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-26', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-27" class="py-name"><a title="lib.cuckoo.common" class="py-name" href="#" onclick="return doclink('link-27', 'common', 'link-2');">common</a></tt><tt class="py-op">.</tt><tt id="link-28" class="py-name"><a title="lib.cuckoo.common.exceptions" class="py-name" href="#" onclick="return doclink('link-28', 'exceptions', 'link-22');">exceptions</a></tt> <tt class="py-keyword">import</tt> <tt id="link-29" class="py-name" targets="Class lib.cuckoo.common.exceptions.CuckooOperationalError=lib.cuckoo.common.exceptions.CuckooOperationalError-class.html"><a title="lib.cuckoo.common.exceptions.CuckooOperationalError" class="py-name" href="#" onclick="return doclink('link-29', 'CuckooOperationalError', 'link-29');">CuckooOperationalError</a></tt> </tt>
<a name="L22"></a><tt class="py-lineno"> 22</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-30" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-30', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-31" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-31', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-32" class="py-name"><a title="lib.cuckoo.common" class="py-name" href="#" onclick="return doclink('link-32', 'common', 'link-2');">common</a></tt><tt class="py-op">.</tt><tt id="link-33" class="py-name" targets="Module lib.cuckoo.common.utils=lib.cuckoo.common.utils-module.html"><a title="lib.cuckoo.common.utils" class="py-name" href="#" onclick="return doclink('link-33', 'utils', 'link-33');">utils</a></tt> <tt class="py-keyword">import</tt> <tt id="link-34" class="py-name" targets="Function lib.cuckoo.common.utils.create_folders()=lib.cuckoo.common.utils-module.html#create_folders,Method lib.cuckoo.core.resultserver.ResultHandler.create_folders()=lib.cuckoo.core.resultserver.ResultHandler-class.html#create_folders"><a title="lib.cuckoo.common.utils.create_folders
lib.cuckoo.core.resultserver.ResultHandler.create_folders" class="py-name" href="#" onclick="return doclink('link-34', 'create_folders', 'link-34');">create_folders</a></tt> </tt>
<a name="L23"></a><tt class="py-lineno"> 23</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-35" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-35', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-36" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-36', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-37" class="py-name" targets="Package lib.cuckoo.core=lib.cuckoo.core-module.html"><a title="lib.cuckoo.core" class="py-name" href="#" onclick="return doclink('link-37', 'core', 'link-37');">core</a></tt><tt class="py-op">.</tt><tt id="link-38" class="py-name" targets="Module lib.cuckoo.core.database=lib.cuckoo.core.database-module.html"><a title="lib.cuckoo.core.database" class="py-name" href="#" onclick="return doclink('link-38', 'database', 'link-38');">database</a></tt> <tt class="py-keyword">import</tt> <tt id="link-39" class="py-name" targets="Class lib.cuckoo.core.database.Database=lib.cuckoo.core.database.Database-class.html"><a title="lib.cuckoo.core.database.Database" class="py-name" href="#" onclick="return doclink('link-39', 'Database', 'link-39');">Database</a></tt><tt class="py-op">,</tt> <tt id="link-40" class="py-name" targets="Variable lib.cuckoo.core.database.TASK_RUNNING=lib.cuckoo.core.database-module.html#TASK_RUNNING"><a title="lib.cuckoo.core.database.TASK_RUNNING" class="py-name" href="#" onclick="return doclink('link-40', 'TASK_RUNNING', 'link-40');">TASK_RUNNING</a></tt> </tt>
<a name="L24"></a><tt class="py-lineno"> 24</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-41" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-41', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-42" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-42', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-43" class="py-name"><a title="lib.cuckoo.core" class="py-name" href="#" onclick="return doclink('link-43', 'core', 'link-37');">core</a></tt><tt class="py-op">.</tt><tt id="link-44" class="py-name"><a title="lib.cuckoo.core.database" class="py-name" href="#" onclick="return doclink('link-44', 'database', 'link-38');">database</a></tt> <tt class="py-keyword">import</tt> <tt id="link-45" class="py-name" targets="Variable lib.cuckoo.core.database.TASK_FAILED_ANALYSIS=lib.cuckoo.core.database-module.html#TASK_FAILED_ANALYSIS"><a title="lib.cuckoo.core.database.TASK_FAILED_ANALYSIS" class="py-name" href="#" onclick="return doclink('link-45', 'TASK_FAILED_ANALYSIS', 'link-45');">TASK_FAILED_ANALYSIS</a></tt><tt class="py-op">,</tt> <tt id="link-46" class="py-name" targets="Variable lib.cuckoo.core.database.TASK_PENDING=lib.cuckoo.core.database-module.html#TASK_PENDING"><a title="lib.cuckoo.core.database.TASK_PENDING" class="py-name" href="#" onclick="return doclink('link-46', 'TASK_PENDING', 'link-46');">TASK_PENDING</a></tt> </tt>
<a name="L25"></a><tt class="py-lineno"> 25</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-47" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-47', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-48" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-48', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-49" class="py-name"><a title="lib.cuckoo.core" class="py-name" href="#" onclick="return doclink('link-49', 'core', 'link-37');">core</a></tt><tt class="py-op">.</tt><tt id="link-50" class="py-name" targets="Module lib.cuckoo.core.plugins=lib.cuckoo.core.plugins-module.html"><a title="lib.cuckoo.core.plugins" class="py-name" href="#" onclick="return doclink('link-50', 'plugins', 'link-50');">plugins</a></tt> <tt class="py-keyword">import</tt> <tt id="link-51" class="py-name" targets="Function lib.cuckoo.core.plugins.import_plugin()=lib.cuckoo.core.plugins-module.html#import_plugin"><a title="lib.cuckoo.core.plugins.import_plugin" class="py-name" href="#" onclick="return doclink('link-51', 'import_plugin', 'link-51');">import_plugin</a></tt><tt class="py-op">,</tt> <tt id="link-52" class="py-name" targets="Function lib.cuckoo.core.plugins.import_package()=lib.cuckoo.core.plugins-module.html#import_package"><a title="lib.cuckoo.core.plugins.import_package" class="py-name" href="#" onclick="return doclink('link-52', 'import_package', 'link-52');">import_package</a></tt><tt class="py-op">,</tt> <tt id="link-53" class="py-name" targets="Function lib.cuckoo.core.plugins.list_plugins()=lib.cuckoo.core.plugins-module.html#list_plugins"><a title="lib.cuckoo.core.plugins.list_plugins" class="py-name" href="#" onclick="return doclink('link-53', 'list_plugins', 'link-53');">list_plugins</a></tt> </tt>
<a name="L26"></a><tt class="py-lineno"> 26</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-54" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-54', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-55" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-55', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-56" class="py-name"><a title="lib.cuckoo.core" class="py-name" href="#" onclick="return doclink('link-56', 'core', 'link-37');">core</a></tt><tt class="py-op">.</tt><tt id="link-57" class="py-name" targets="Module lib.cuckoo.core.rooter=lib.cuckoo.core.rooter-module.html,Function lib.cuckoo.core.rooter.rooter()=lib.cuckoo.core.rooter-module.html#rooter"><a title="lib.cuckoo.core.rooter
lib.cuckoo.core.rooter.rooter" class="py-name" href="#" onclick="return doclink('link-57', 'rooter', 'link-57');">rooter</a></tt> <tt class="py-keyword">import</tt> <tt id="link-58" class="py-name"><a title="lib.cuckoo.core.rooter
lib.cuckoo.core.rooter.rooter" class="py-name" href="#" onclick="return doclink('link-58', 'rooter', 'link-57');">rooter</a></tt><tt class="py-op">,</tt> <tt id="link-59" class="py-name" targets="Variable lib.cuckoo.core.rooter.vpns=lib.cuckoo.core.rooter-module.html#vpns"><a title="lib.cuckoo.core.rooter.vpns" class="py-name" href="#" onclick="return doclink('link-59', 'vpns', 'link-59');">vpns</a></tt> </tt>
<a name="L27"></a><tt class="py-lineno"> 27</tt>  <tt class="py-line"> </tt>
<a name="L28"></a><tt class="py-lineno"> 28</tt>  <tt class="py-line"><tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L29"></a><tt class="py-lineno"> 29</tt>  <tt class="py-line">    <tt class="py-keyword">import</tt> <tt class="py-name">pwd</tt> </tt>
<a name="L30"></a><tt class="py-lineno"> 30</tt>  <tt class="py-line">    <tt id="link-60" class="py-name" targets="Variable lib.cuckoo.core.startup.HAVE_PWD=lib.cuckoo.core.startup-module.html#HAVE_PWD"><a title="lib.cuckoo.core.startup.HAVE_PWD" class="py-name" href="#" onclick="return doclink('link-60', 'HAVE_PWD', 'link-60');">HAVE_PWD</a></tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L31"></a><tt class="py-lineno"> 31</tt>  <tt class="py-line"><tt class="py-keyword">except</tt> <tt class="py-name">ImportError</tt><tt class="py-op">:</tt> </tt>
<a name="L32"></a><tt class="py-lineno"> 32</tt>  <tt class="py-line">    <tt id="link-61" class="py-name"><a title="lib.cuckoo.core.startup.HAVE_PWD" class="py-name" href="#" onclick="return doclink('link-61', 'HAVE_PWD', 'link-60');">HAVE_PWD</a></tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L33"></a><tt class="py-lineno"> 33</tt>  <tt class="py-line"> </tt>
<a name="L34"></a><tt class="py-lineno"> 34</tt>  <tt class="py-line"><tt id="link-62" class="py-name" targets="Variable lib.cuckoo.common.abstracts.log=lib.cuckoo.common.abstracts-module.html#log,Variable lib.cuckoo.common.irc.log=lib.cuckoo.common.irc-module.html#log,Variable lib.cuckoo.common.netlog.log=lib.cuckoo.common.netlog-module.html#log,Variable lib.cuckoo.common.objects.log=lib.cuckoo.common.objects-module.html#log,Variable lib.cuckoo.core.database.log=lib.cuckoo.core.database-module.html#log,Variable lib.cuckoo.core.guest.log=lib.cuckoo.core.guest-module.html#log,Variable lib.cuckoo.core.plugins.log=lib.cuckoo.core.plugins-module.html#log,Variable lib.cuckoo.core.resultserver.log=lib.cuckoo.core.resultserver-module.html#log,Variable lib.cuckoo.core.rooter.log=lib.cuckoo.core.rooter-module.html#log,Variable lib.cuckoo.core.scheduler.log=lib.cuckoo.core.scheduler-module.html#log,Variable lib.cuckoo.core.startup.log=lib.cuckoo.core.startup-module.html#log,Variable modules.auxiliary.mitm.log=modules.auxiliary.mitm-module.html#log,Variable modules.auxiliary.services.log=modules.auxiliary.services-module.html#log,Variable modules.auxiliary.sniffer.log=modules.auxiliary.sniffer-module.html#log,Variable modules.machinery.avd.log=modules.machinery.avd-module.html#log,Variable modules.machinery.physical.log=modules.machinery.physical-module.html#log,Variable modules.machinery.qemu.log=modules.machinery.qemu-module.html#log,Variable modules.machinery.virtualbox.log=modules.machinery.virtualbox-module.html#log,Variable modules.machinery.vmware.log=modules.machinery.vmware-module.html#log,Variable modules.machinery.vsphere.log=modules.machinery.vsphere-module.html#log,Variable modules.machinery.xenserver.log=modules.machinery.xenserver-module.html#log,Variable modules.processing.analysisinfo.log=modules.processing.analysisinfo-module.html#log,Variable modules.processing.apkinfo.log=modules.processing.apkinfo-module.html#log,Variable modules.processing.baseline.log=modules.processing.baseline-module.html#log,Variable modules.processing.behavior.log=modules.processing.behavior-module.html#log,Variable modules.processing.droidmon.log=modules.processing.droidmon-module.html#log,Variable modules.processing.dumptls.log=modules.processing.dumptls-module.html#log,Variable modules.processing.googleplay.log=modules.processing.googleplay-module.html#log,Variable modules.processing.memory.log=modules.processing.memory-module.html#log,Variable modules.processing.network.log=modules.processing.network-module.html#log,Variable modules.processing.platform.linux.log=modules.processing.platform.linux-module.html#log,Variable modules.processing.platform.windows.log=modules.processing.platform.windows-module.html#log,Variable modules.processing.screenshots.log=modules.processing.screenshots-module.html#log,Variable modules.processing.snort.log=modules.processing.snort-module.html#log,Variable modules.processing.static.log=modules.processing.static-module.html#log,Variable modules.processing.suricata.log=modules.processing.suricata-module.html#log,Variable modules.processing.virustotal.log=modules.processing.virustotal-module.html#log,Variable modules.reporting.moloch.log=modules.reporting.moloch-module.html#log"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-62', 'log', 'link-62');">log</a></tt> <tt class="py-op">=</tt> <tt class="py-name">logging</tt><tt class="py-op">.</tt><tt class="py-name">getLogger</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L35"></a><tt class="py-lineno"> 35</tt>  <tt class="py-line"> </tt>
<a name="check_python_version"></a><div id="check_python_version-def"><a name="L36"></a><tt class="py-lineno"> 36</tt> <a class="py-toggle" href="#" id="check_python_version-toggle" onclick="return toggle('check_python_version');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.startup-module.html#check_python_version">check_python_version</a><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="check_python_version-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="check_python_version-expanded"><a name="L37"></a><tt class="py-lineno"> 37</tt>  <tt class="py-line">    <tt class="py-docstring">"""Checks if Python version is supported by Cuckoo.</tt> </tt>
<a name="L38"></a><tt class="py-lineno"> 38</tt>  <tt class="py-line"><tt class="py-docstring">    @raise CuckooStartupError: if version is not supported.</tt> </tt>
<a name="L39"></a><tt class="py-lineno"> 39</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L40"></a><tt class="py-lineno"> 40</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">sys</tt><tt class="py-op">.</tt><tt class="py-name">version_info</tt><tt class="py-op">[</tt><tt class="py-op">:</tt><tt class="py-number">2</tt><tt class="py-op">]</tt> <tt class="py-op">!=</tt> <tt class="py-op">(</tt><tt class="py-number">2</tt><tt class="py-op">,</tt> <tt class="py-number">7</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L41"></a><tt class="py-lineno"> 41</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-63" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooStartupError" class="py-name" href="#" onclick="return doclink('link-63', 'CuckooStartupError', 'link-23');">CuckooStartupError</a></tt><tt class="py-op">(</tt><tt class="py-string">"You are running an incompatible version "</tt> </tt>
<a name="L42"></a><tt class="py-lineno"> 42</tt>  <tt class="py-line">                                 <tt class="py-string">"of Python, please use 2.7"</tt><tt class="py-op">)</tt> </tt>
</div><a name="L43"></a><tt class="py-lineno"> 43</tt>  <tt class="py-line"> </tt>
<a name="L44"></a><tt class="py-lineno"> 44</tt>  <tt class="py-line"> </tt>
<a name="check_working_directory"></a><div id="check_working_directory-def"><a name="L45"></a><tt class="py-lineno"> 45</tt> <a class="py-toggle" href="#" id="check_working_directory-toggle" onclick="return toggle('check_working_directory');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.startup-module.html#check_working_directory">check_working_directory</a><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="check_working_directory-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="check_working_directory-expanded"><a name="L46"></a><tt class="py-lineno"> 46</tt>  <tt class="py-line">    <tt class="py-docstring">"""Checks if working directories are ready.</tt> </tt>
<a name="L47"></a><tt class="py-lineno"> 47</tt>  <tt class="py-line"><tt class="py-docstring">    @raise CuckooStartupError: if directories are not properly configured.</tt> </tt>
<a name="L48"></a><tt class="py-lineno"> 48</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L49"></a><tt class="py-lineno"> 49</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">exists</tt><tt class="py-op">(</tt><tt id="link-64" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_ROOT" class="py-name" href="#" onclick="return doclink('link-64', 'CUCKOO_ROOT', 'link-17');">CUCKOO_ROOT</a></tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L50"></a><tt class="py-lineno"> 50</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-65" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooStartupError" class="py-name" href="#" onclick="return doclink('link-65', 'CuckooStartupError', 'link-23');">CuckooStartupError</a></tt><tt class="py-op">(</tt><tt class="py-string">"You specified a non-existing root "</tt> </tt>
<a name="L51"></a><tt class="py-lineno"> 51</tt>  <tt class="py-line">                                 <tt class="py-string">"directory: {0}"</tt><tt class="py-op">.</tt><tt class="py-name">format</tt><tt class="py-op">(</tt><tt id="link-66" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_ROOT" class="py-name" href="#" onclick="return doclink('link-66', 'CUCKOO_ROOT', 'link-17');">CUCKOO_ROOT</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L52"></a><tt class="py-lineno"> 52</tt>  <tt class="py-line"> </tt>
<a name="L53"></a><tt class="py-lineno"> 53</tt>  <tt class="py-line">    <tt class="py-name">cwd</tt> <tt class="py-op">=</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">getcwd</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-string">"cuckoo.py"</tt><tt class="py-op">)</tt> </tt>
<a name="L54"></a><tt class="py-lineno"> 54</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">exists</tt><tt class="py-op">(</tt><tt class="py-name">cwd</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L55"></a><tt class="py-lineno"> 55</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-67" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooStartupError" class="py-name" href="#" onclick="return doclink('link-67', 'CuckooStartupError', 'link-23');">CuckooStartupError</a></tt><tt class="py-op">(</tt><tt class="py-string">"You are not running Cuckoo from it's "</tt> </tt>
<a name="L56"></a><tt class="py-lineno"> 56</tt>  <tt class="py-line">                                 <tt class="py-string">"root directory"</tt><tt class="py-op">)</tt> </tt>
</div><a name="L57"></a><tt class="py-lineno"> 57</tt>  <tt class="py-line"> </tt>
<a name="L58"></a><tt class="py-lineno"> 58</tt>  <tt class="py-line"> </tt>
<a name="check_configs"></a><div id="check_configs-def"><a name="L59"></a><tt class="py-lineno"> 59</tt> <a class="py-toggle" href="#" id="check_configs-toggle" onclick="return toggle('check_configs');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.startup-module.html#check_configs">check_configs</a><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="check_configs-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="check_configs-expanded"><a name="L60"></a><tt class="py-lineno"> 60</tt>  <tt class="py-line">    <tt class="py-docstring">"""Checks if config files exist.</tt> </tt>
<a name="L61"></a><tt class="py-lineno"> 61</tt>  <tt class="py-line"><tt class="py-docstring">    @raise CuckooStartupError: if config files do not exist.</tt> </tt>
<a name="L62"></a><tt class="py-lineno"> 62</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L63"></a><tt class="py-lineno"> 63</tt>  <tt class="py-line">    <tt class="py-name">configs</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt> </tt>
<a name="L64"></a><tt class="py-lineno"> 64</tt>  <tt class="py-line">        <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt id="link-68" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_ROOT" class="py-name" href="#" onclick="return doclink('link-68', 'CUCKOO_ROOT', 'link-17');">CUCKOO_ROOT</a></tt><tt class="py-op">,</tt> <tt class="py-string">"conf"</tt><tt class="py-op">,</tt> <tt class="py-string">"auxiliary.conf"</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> </tt>
<a name="L65"></a><tt class="py-lineno"> 65</tt>  <tt class="py-line">        <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt id="link-69" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_ROOT" class="py-name" href="#" onclick="return doclink('link-69', 'CUCKOO_ROOT', 'link-17');">CUCKOO_ROOT</a></tt><tt class="py-op">,</tt> <tt class="py-string">"conf"</tt><tt class="py-op">,</tt> <tt class="py-string">"avd.conf"</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> </tt>
<a name="L66"></a><tt class="py-lineno"> 66</tt>  <tt class="py-line">        <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt id="link-70" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_ROOT" class="py-name" href="#" onclick="return doclink('link-70', 'CUCKOO_ROOT', 'link-17');">CUCKOO_ROOT</a></tt><tt class="py-op">,</tt> <tt class="py-string">"conf"</tt><tt class="py-op">,</tt> <tt class="py-string">"cuckoo.conf"</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> </tt>
<a name="L67"></a><tt class="py-lineno"> 67</tt>  <tt class="py-line">        <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt id="link-71" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_ROOT" class="py-name" href="#" onclick="return doclink('link-71', 'CUCKOO_ROOT', 'link-17');">CUCKOO_ROOT</a></tt><tt class="py-op">,</tt> <tt class="py-string">"conf"</tt><tt class="py-op">,</tt> <tt class="py-string">"esx.conf"</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> </tt>
<a name="L68"></a><tt class="py-lineno"> 68</tt>  <tt class="py-line">        <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt id="link-72" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_ROOT" class="py-name" href="#" onclick="return doclink('link-72', 'CUCKOO_ROOT', 'link-17');">CUCKOO_ROOT</a></tt><tt class="py-op">,</tt> <tt class="py-string">"conf"</tt><tt class="py-op">,</tt> <tt class="py-string">"kvm.conf"</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> </tt>
<a name="L69"></a><tt class="py-lineno"> 69</tt>  <tt class="py-line">        <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt id="link-73" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_ROOT" class="py-name" href="#" onclick="return doclink('link-73', 'CUCKOO_ROOT', 'link-17');">CUCKOO_ROOT</a></tt><tt class="py-op">,</tt> <tt class="py-string">"conf"</tt><tt class="py-op">,</tt> <tt class="py-string">"memory.conf"</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> </tt>
<a name="L70"></a><tt class="py-lineno"> 70</tt>  <tt class="py-line">        <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt id="link-74" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_ROOT" class="py-name" href="#" onclick="return doclink('link-74', 'CUCKOO_ROOT', 'link-17');">CUCKOO_ROOT</a></tt><tt class="py-op">,</tt> <tt class="py-string">"conf"</tt><tt class="py-op">,</tt> <tt class="py-string">"physical.conf"</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> </tt>
<a name="L71"></a><tt class="py-lineno"> 71</tt>  <tt class="py-line">        <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt id="link-75" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_ROOT" class="py-name" href="#" onclick="return doclink('link-75', 'CUCKOO_ROOT', 'link-17');">CUCKOO_ROOT</a></tt><tt class="py-op">,</tt> <tt class="py-string">"conf"</tt><tt class="py-op">,</tt> <tt class="py-string">"processing.conf"</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> </tt>
<a name="L72"></a><tt class="py-lineno"> 72</tt>  <tt class="py-line">        <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt id="link-76" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_ROOT" class="py-name" href="#" onclick="return doclink('link-76', 'CUCKOO_ROOT', 'link-17');">CUCKOO_ROOT</a></tt><tt class="py-op">,</tt> <tt class="py-string">"conf"</tt><tt class="py-op">,</tt> <tt class="py-string">"qemu.conf"</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> </tt>
<a name="L73"></a><tt class="py-lineno"> 73</tt>  <tt class="py-line">        <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt id="link-77" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_ROOT" class="py-name" href="#" onclick="return doclink('link-77', 'CUCKOO_ROOT', 'link-17');">CUCKOO_ROOT</a></tt><tt class="py-op">,</tt> <tt class="py-string">"conf"</tt><tt class="py-op">,</tt> <tt class="py-string">"reporting.conf"</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> </tt>
<a name="L74"></a><tt class="py-lineno"> 74</tt>  <tt class="py-line">        <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt id="link-78" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_ROOT" class="py-name" href="#" onclick="return doclink('link-78', 'CUCKOO_ROOT', 'link-17');">CUCKOO_ROOT</a></tt><tt class="py-op">,</tt> <tt class="py-string">"conf"</tt><tt class="py-op">,</tt> <tt class="py-string">"virtualbox.conf"</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> </tt>
<a name="L75"></a><tt class="py-lineno"> 75</tt>  <tt class="py-line">        <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt id="link-79" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_ROOT" class="py-name" href="#" onclick="return doclink('link-79', 'CUCKOO_ROOT', 'link-17');">CUCKOO_ROOT</a></tt><tt class="py-op">,</tt> <tt class="py-string">"conf"</tt><tt class="py-op">,</tt> <tt class="py-string">"vmware.conf"</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> </tt>
<a name="L76"></a><tt class="py-lineno"> 76</tt>  <tt class="py-line">        <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt id="link-80" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_ROOT" class="py-name" href="#" onclick="return doclink('link-80', 'CUCKOO_ROOT', 'link-17');">CUCKOO_ROOT</a></tt><tt class="py-op">,</tt> <tt class="py-string">"conf"</tt><tt class="py-op">,</tt> <tt class="py-string">"xenserver.conf"</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> </tt>
<a name="L77"></a><tt class="py-lineno"> 77</tt>  <tt class="py-line">    <tt class="py-op">]</tt> </tt>
<a name="L78"></a><tt class="py-lineno"> 78</tt>  <tt class="py-line"> </tt>
<a name="L79"></a><tt class="py-lineno"> 79</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-81" class="py-name"><a title="lib.cuckoo.common.config" class="py-name" href="#" onclick="return doclink('link-81', 'config', 'link-11');">config</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">configs</tt><tt class="py-op">:</tt> </tt>
<a name="L80"></a><tt class="py-lineno"> 80</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">exists</tt><tt class="py-op">(</tt><tt id="link-82" class="py-name"><a title="lib.cuckoo.common.config" class="py-name" href="#" onclick="return doclink('link-82', 'config', 'link-11');">config</a></tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L81"></a><tt class="py-lineno"> 81</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-83" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooStartupError" class="py-name" href="#" onclick="return doclink('link-83', 'CuckooStartupError', 'link-23');">CuckooStartupError</a></tt><tt class="py-op">(</tt><tt class="py-string">"Config file does not exist at "</tt> </tt>
<a name="L82"></a><tt class="py-lineno"> 82</tt>  <tt class="py-line">                                     <tt class="py-string">"path: {0}"</tt><tt class="py-op">.</tt><tt class="py-name">format</tt><tt class="py-op">(</tt><tt id="link-84" class="py-name"><a title="lib.cuckoo.common.config" class="py-name" href="#" onclick="return doclink('link-84', 'config', 'link-11');">config</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L83"></a><tt class="py-lineno"> 83</tt>  <tt class="py-line"> </tt>
<a name="L84"></a><tt class="py-lineno"> 84</tt>  <tt class="py-line">    <tt class="py-keyword">return</tt> <tt class="py-name">True</tt> </tt>
</div><a name="L85"></a><tt class="py-lineno"> 85</tt>  <tt class="py-line"> </tt>
<a name="create_structure"></a><div id="create_structure-def"><a name="L86"></a><tt class="py-lineno"> 86</tt> <a class="py-toggle" href="#" id="create_structure-toggle" onclick="return toggle('create_structure');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.startup-module.html#create_structure">create_structure</a><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="create_structure-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="create_structure-expanded"><a name="L87"></a><tt class="py-lineno"> 87</tt>  <tt class="py-line">    <tt class="py-docstring">"""Creates Cuckoo directories."""</tt> </tt>
<a name="L88"></a><tt class="py-lineno"> 88</tt>  <tt class="py-line">    <tt class="py-name">folders</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt> </tt>
<a name="L89"></a><tt class="py-lineno"> 89</tt>  <tt class="py-line">        <tt class="py-string">"log"</tt><tt class="py-op">,</tt> </tt>
<a name="L90"></a><tt class="py-lineno"> 90</tt>  <tt class="py-line">        <tt class="py-string">"storage"</tt><tt class="py-op">,</tt> </tt>
<a name="L91"></a><tt class="py-lineno"> 91</tt>  <tt class="py-line">        <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt class="py-string">"storage"</tt><tt class="py-op">,</tt> <tt class="py-string">"analyses"</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> </tt>
<a name="L92"></a><tt class="py-lineno"> 92</tt>  <tt class="py-line">        <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt class="py-string">"storage"</tt><tt class="py-op">,</tt> <tt class="py-string">"binaries"</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> </tt>
<a name="L93"></a><tt class="py-lineno"> 93</tt>  <tt class="py-line">        <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt class="py-string">"storage"</tt><tt class="py-op">,</tt> <tt class="py-string">"baseline"</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> </tt>
<a name="L94"></a><tt class="py-lineno"> 94</tt>  <tt class="py-line">    <tt class="py-op">]</tt> </tt>
<a name="L95"></a><tt class="py-lineno"> 95</tt>  <tt class="py-line"> </tt>
<a name="L96"></a><tt class="py-lineno"> 96</tt>  <tt class="py-line">    <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L97"></a><tt class="py-lineno"> 97</tt>  <tt class="py-line">        <tt id="link-85" class="py-name"><a title="lib.cuckoo.common.utils.create_folders
lib.cuckoo.core.resultserver.ResultHandler.create_folders" class="py-name" href="#" onclick="return doclink('link-85', 'create_folders', 'link-34');">create_folders</a></tt><tt class="py-op">(</tt><tt class="py-name">root</tt><tt class="py-op">=</tt><tt id="link-86" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_ROOT" class="py-name" href="#" onclick="return doclink('link-86', 'CUCKOO_ROOT', 'link-17');">CUCKOO_ROOT</a></tt><tt class="py-op">,</tt> <tt class="py-name">folders</tt><tt class="py-op">=</tt><tt class="py-name">folders</tt><tt class="py-op">)</tt> </tt>
<a name="L98"></a><tt class="py-lineno"> 98</tt>  <tt class="py-line">    <tt class="py-keyword">except</tt> <tt id="link-87" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooOperationalError" class="py-name" href="#" onclick="return doclink('link-87', 'CuckooOperationalError', 'link-29');">CuckooOperationalError</a></tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L99"></a><tt class="py-lineno"> 99</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-88" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooStartupError" class="py-name" href="#" onclick="return doclink('link-88', 'CuckooStartupError', 'link-23');">CuckooStartupError</a></tt><tt class="py-op">(</tt><tt class="py-name">e</tt><tt class="py-op">)</tt> </tt>
</div><a name="L100"></a><tt class="py-lineno">100</tt>  <tt class="py-line"> </tt>
<a name="check_version"></a><div id="check_version-def"><a name="L101"></a><tt class="py-lineno">101</tt> <a class="py-toggle" href="#" id="check_version-toggle" onclick="return toggle('check_version');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.startup-module.html#check_version">check_version</a><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="check_version-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="check_version-expanded"><a name="L102"></a><tt class="py-lineno">102</tt>  <tt class="py-line">    <tt class="py-docstring">"""Checks version of Cuckoo."""</tt> </tt>
<a name="L103"></a><tt class="py-lineno">103</tt>  <tt class="py-line">    <tt id="link-89" class="py-name" targets="Variable lib.cuckoo.core.rooter.cfg=lib.cuckoo.core.rooter-module.html#cfg,Variable modules.auxiliary.services.cfg=modules.auxiliary.services-module.html#cfg,Variable modules.processing.network.cfg=modules.processing.network-module.html#cfg"><a title="lib.cuckoo.core.rooter.cfg
modules.auxiliary.services.cfg
modules.processing.network.cfg" class="py-name" href="#" onclick="return doclink('link-89', 'cfg', 'link-89');">cfg</a></tt> <tt class="py-op">=</tt> <tt id="link-90" class="py-name"><a title="lib.cuckoo.common.config.Config" class="py-name" href="#" onclick="return doclink('link-90', 'Config', 'link-12');">Config</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L104"></a><tt class="py-lineno">104</tt>  <tt class="py-line"> </tt>
<a name="L105"></a><tt class="py-lineno">105</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-91" class="py-name"><a title="lib.cuckoo.core.rooter.cfg
modules.auxiliary.services.cfg
modules.processing.network.cfg" class="py-name" href="#" onclick="return doclink('link-91', 'cfg', 'link-89');">cfg</a></tt><tt class="py-op">.</tt><tt id="link-92" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-92', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt class="py-name">version_check</tt><tt class="py-op">:</tt> </tt>
<a name="L106"></a><tt class="py-lineno">106</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> </tt>
<a name="L107"></a><tt class="py-lineno">107</tt>  <tt class="py-line"> </tt>
<a name="L108"></a><tt class="py-lineno">108</tt>  <tt class="py-line">    <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt class="py-string">" Checking for updates..."</tt><tt class="py-op">)</tt> </tt>
<a name="L109"></a><tt class="py-lineno">109</tt>  <tt class="py-line"> </tt>
<a name="L110"></a><tt class="py-lineno">110</tt>  <tt class="py-line">    <tt class="py-name">url</tt> <tt class="py-op">=</tt> <tt class="py-string">"http://api.cuckoosandbox.org/checkversion.php"</tt> </tt>
<a name="L111"></a><tt class="py-lineno">111</tt>  <tt class="py-line">    <tt class="py-name">data</tt> <tt class="py-op">=</tt> <tt class="py-name">urllib</tt><tt class="py-op">.</tt><tt class="py-name">urlencode</tt><tt class="py-op">(</tt><tt class="py-op">{</tt><tt class="py-string">"version"</tt><tt class="py-op">:</tt> <tt id="link-93" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_VERSION" class="py-name" href="#" onclick="return doclink('link-93', 'CUCKOO_VERSION', 'link-18');">CUCKOO_VERSION</a></tt><tt class="py-op">}</tt><tt class="py-op">)</tt> </tt>
<a name="L112"></a><tt class="py-lineno">112</tt>  <tt class="py-line"> </tt>
<a name="L113"></a><tt class="py-lineno">113</tt>  <tt class="py-line">    <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L114"></a><tt class="py-lineno">114</tt>  <tt class="py-line">        <tt class="py-name">request</tt> <tt class="py-op">=</tt> <tt class="py-name">urllib2</tt><tt class="py-op">.</tt><tt class="py-name">Request</tt><tt class="py-op">(</tt><tt class="py-name">url</tt><tt class="py-op">,</tt> <tt class="py-name">data</tt><tt class="py-op">)</tt> </tt>
<a name="L115"></a><tt class="py-lineno">115</tt>  <tt class="py-line">        <tt class="py-name">response</tt> <tt class="py-op">=</tt> <tt class="py-name">urllib2</tt><tt class="py-op">.</tt><tt class="py-name">urlopen</tt><tt class="py-op">(</tt><tt class="py-name">request</tt><tt class="py-op">)</tt> </tt>
<a name="L116"></a><tt class="py-lineno">116</tt>  <tt class="py-line">    <tt class="py-keyword">except</tt> <tt class="py-op">(</tt><tt class="py-name">urllib2</tt><tt class="py-op">.</tt><tt class="py-name">URLError</tt><tt class="py-op">,</tt> <tt class="py-name">urllib2</tt><tt class="py-op">.</tt><tt class="py-name">HTTPError</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L117"></a><tt class="py-lineno">117</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt id="link-94" class="py-name"><a title="lib.cuckoo.common.colors.red" class="py-name" href="#" onclick="return doclink('link-94', 'red', 'link-4');">red</a></tt><tt class="py-op">(</tt><tt class="py-string">" Failed! "</tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-string">"Unable to establish connection.\n"</tt><tt class="py-op">)</tt> </tt>
<a name="L118"></a><tt class="py-lineno">118</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> </tt>
<a name="L119"></a><tt class="py-lineno">119</tt>  <tt class="py-line"> </tt>
<a name="L120"></a><tt class="py-lineno">120</tt>  <tt class="py-line">    <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L121"></a><tt class="py-lineno">121</tt>  <tt class="py-line">        <tt class="py-name">r</tt> <tt class="py-op">=</tt> <tt class="py-name">json</tt><tt class="py-op">.</tt><tt class="py-name">loads</tt><tt class="py-op">(</tt><tt class="py-name">response</tt><tt class="py-op">.</tt><tt id="link-95" class="py-name" targets="Method lib.cuckoo.core.resultserver.ResultHandler.read()=lib.cuckoo.core.resultserver.ResultHandler-class.html#read"><a title="lib.cuckoo.core.resultserver.ResultHandler.read" class="py-name" href="#" onclick="return doclink('link-95', 'read', 'link-95');">read</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L122"></a><tt class="py-lineno">122</tt>  <tt class="py-line">    <tt class="py-keyword">except</tt> <tt class="py-name">ValueError</tt><tt class="py-op">:</tt> </tt>
<a name="L123"></a><tt class="py-lineno">123</tt>  <tt class="py-line">        <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt id="link-96" class="py-name"><a title="lib.cuckoo.common.colors.red" class="py-name" href="#" onclick="return doclink('link-96', 'red', 'link-4');">red</a></tt><tt class="py-op">(</tt><tt class="py-string">" Failed! "</tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-string">"Invalid response.\n"</tt><tt class="py-op">)</tt> </tt>
<a name="L124"></a><tt class="py-lineno">124</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> </tt>
<a name="L125"></a><tt class="py-lineno">125</tt>  <tt class="py-line"> </tt>
<a name="L126"></a><tt class="py-lineno">126</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">r</tt><tt class="py-op">[</tt><tt class="py-string">"error"</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L127"></a><tt class="py-lineno">127</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">r</tt><tt class="py-op">[</tt><tt class="py-string">"response"</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-string">"NEW_VERSION"</tt> <tt class="py-keyword">and</tt> <tt class="py-name">r</tt><tt class="py-op">[</tt><tt class="py-string">"current"</tt><tt class="py-op">]</tt> <tt class="py-op">!=</tt> <tt class="py-string">"1.2"</tt><tt class="py-op">:</tt> </tt>
<a name="L128"></a><tt class="py-lineno">128</tt>  <tt class="py-line">            <tt class="py-name">msg</tt> <tt class="py-op">=</tt> <tt class="py-string">"Cuckoo Sandbox version %s is available now."</tt> <tt class="py-op">%</tt> <tt class="py-name">r</tt><tt class="py-op">[</tt><tt class="py-string">"current"</tt><tt class="py-op">]</tt> </tt>
<a name="L129"></a><tt class="py-lineno">129</tt>  <tt class="py-line">            <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt id="link-97" class="py-name"><a title="lib.cuckoo.common.colors.red" class="py-name" href="#" onclick="return doclink('link-97', 'red', 'link-4');">red</a></tt><tt class="py-op">(</tt><tt class="py-string">" Outdated! "</tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-name">msg</tt><tt class="py-op">)</tt> </tt>
<a name="L130"></a><tt class="py-lineno">130</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt class="py-name">r</tt><tt class="py-op">[</tt><tt class="py-string">"current"</tt><tt class="py-op">]</tt> <tt class="py-op">==</tt> <tt class="py-string">"1.2"</tt><tt class="py-op">:</tt> </tt>
<a name="L131"></a><tt class="py-lineno">131</tt>  <tt class="py-line">            <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt id="link-98" class="py-name"><a title="lib.cuckoo.common.colors.yellow" class="py-name" href="#" onclick="return doclink('link-98', 'yellow', 'link-6');">yellow</a></tt><tt class="py-op">(</tt><tt class="py-string">" Okay! "</tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-string">"You are running a development version."</tt><tt class="py-op">)</tt> </tt>
<a name="L132"></a><tt class="py-lineno">132</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L133"></a><tt class="py-lineno">133</tt>  <tt class="py-line">            <tt class="py-keyword">print</tt><tt class="py-op">(</tt><tt id="link-99" class="py-name"><a title="lib.cuckoo.common.colors.green" class="py-name" href="#" onclick="return doclink('link-99', 'green', 'link-5');">green</a></tt><tt class="py-op">(</tt><tt class="py-string">" Good! "</tt><tt class="py-op">)</tt> <tt class="py-op">+</tt> <tt class="py-string">"You have the latest version "</tt> </tt>
<a name="L134"></a><tt class="py-lineno">134</tt>  <tt class="py-line">                                     <tt class="py-string">"available.\n"</tt><tt class="py-op">)</tt> </tt>
</div><a name="L135"></a><tt class="py-lineno">135</tt>  <tt class="py-line"> </tt>
<a name="L136"></a><tt class="py-lineno">136</tt>  <tt class="py-line"> </tt>
<a name="DatabaseHandler"></a><div id="DatabaseHandler-def"><a name="L137"></a><tt class="py-lineno">137</tt> <a class="py-toggle" href="#" id="DatabaseHandler-toggle" onclick="return toggle('DatabaseHandler');">-</a><tt class="py-line"><tt class="py-keyword">class</tt> <a class="py-def-name" href="lib.cuckoo.core.startup.DatabaseHandler-class.html">DatabaseHandler</a><tt class="py-op">(</tt><tt class="py-base-class">logging</tt><tt class="py-op">.</tt><tt class="py-base-class">Handler</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="DatabaseHandler-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="DatabaseHandler-expanded"><a name="L138"></a><tt class="py-lineno">138</tt>  <tt class="py-line">    <tt class="py-docstring">"""Logging to database handler.</tt> </tt>
<a name="L139"></a><tt class="py-lineno">139</tt>  <tt class="py-line"><tt class="py-docstring">    Used to log errors related to tasks in database.</tt> </tt>
<a name="L140"></a><tt class="py-lineno">140</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L141"></a><tt class="py-lineno">141</tt>  <tt class="py-line"> </tt>
<a name="DatabaseHandler.emit"></a><div id="DatabaseHandler.emit-def"><a name="L142"></a><tt class="py-lineno">142</tt> <a class="py-toggle" href="#" id="DatabaseHandler.emit-toggle" onclick="return toggle('DatabaseHandler.emit');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.startup.DatabaseHandler-class.html#emit">emit</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">record</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="DatabaseHandler.emit-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="DatabaseHandler.emit-expanded"><a name="L143"></a><tt class="py-lineno">143</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">record</tt><tt class="py-op">,</tt> <tt class="py-string">"task_id"</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L144"></a><tt class="py-lineno">144</tt>  <tt class="py-line">            <tt id="link-100" class="py-name" targets="Variable lib.cuckoo.core.guest.db=lib.cuckoo.core.guest-module.html#db,Variable modules.auxiliary.services.db=modules.auxiliary.services-module.html#db"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-100', 'db', 'link-100');">db</a></tt> <tt class="py-op">=</tt> <tt id="link-101" class="py-name"><a title="lib.cuckoo.core.database.Database" class="py-name" href="#" onclick="return doclink('link-101', 'Database', 'link-39');">Database</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L145"></a><tt class="py-lineno">145</tt>  <tt class="py-line">            <tt id="link-102" class="py-name"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-102', 'db', 'link-100');">db</a></tt><tt class="py-op">.</tt><tt id="link-103" class="py-name" targets="Method lib.cuckoo.core.database.Database.add_error()=lib.cuckoo.core.database.Database-class.html#add_error"><a title="lib.cuckoo.core.database.Database.add_error" class="py-name" href="#" onclick="return doclink('link-103', 'add_error', 'link-103');">add_error</a></tt><tt class="py-op">(</tt><tt class="py-name">record</tt><tt class="py-op">.</tt><tt class="py-name">msg</tt><tt class="py-op">,</tt> <tt class="py-name">int</tt><tt class="py-op">(</tt><tt class="py-name">record</tt><tt class="py-op">.</tt><tt id="link-104" class="py-name" targets="Variable lib.cuckoo.core.database.Error.task_id=lib.cuckoo.core.database.Error-class.html#task_id,Variable lib.cuckoo.core.database.Guest.task_id=lib.cuckoo.core.database.Guest-class.html#task_id"><a title="lib.cuckoo.core.database.Error.task_id
lib.cuckoo.core.database.Guest.task_id" class="py-name" href="#" onclick="return doclink('link-104', 'task_id', 'link-104');">task_id</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
</div></div><a name="L146"></a><tt class="py-lineno">146</tt>  <tt class="py-line"> </tt>
<a name="ConsoleHandler"></a><div id="ConsoleHandler-def"><a name="L147"></a><tt class="py-lineno">147</tt> <a class="py-toggle" href="#" id="ConsoleHandler-toggle" onclick="return toggle('ConsoleHandler');">-</a><tt class="py-line"><tt class="py-keyword">class</tt> <a class="py-def-name" href="lib.cuckoo.core.startup.ConsoleHandler-class.html">ConsoleHandler</a><tt class="py-op">(</tt><tt class="py-base-class">logging</tt><tt class="py-op">.</tt><tt class="py-base-class">StreamHandler</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="ConsoleHandler-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="ConsoleHandler-expanded"><a name="L148"></a><tt class="py-lineno">148</tt>  <tt class="py-line">    <tt class="py-docstring">"""Logging to console handler."""</tt> </tt>
<a name="L149"></a><tt class="py-lineno">149</tt>  <tt class="py-line"> </tt>
<a name="ConsoleHandler.emit"></a><div id="ConsoleHandler.emit-def"><a name="L150"></a><tt class="py-lineno">150</tt> <a class="py-toggle" href="#" id="ConsoleHandler.emit-toggle" onclick="return toggle('ConsoleHandler.emit');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.startup.ConsoleHandler-class.html#emit">emit</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">record</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="ConsoleHandler.emit-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="ConsoleHandler.emit-expanded"><a name="L151"></a><tt class="py-lineno">151</tt>  <tt class="py-line">        <tt class="py-name">colored</tt> <tt class="py-op">=</tt> <tt class="py-name">copy</tt><tt class="py-op">.</tt><tt class="py-name">copy</tt><tt class="py-op">(</tt><tt class="py-name">record</tt><tt class="py-op">)</tt> </tt>
<a name="L152"></a><tt class="py-lineno">152</tt>  <tt class="py-line"> </tt>
<a name="L153"></a><tt class="py-lineno">153</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">record</tt><tt class="py-op">.</tt><tt class="py-name">levelname</tt> <tt class="py-op">==</tt> <tt class="py-string">"WARNING"</tt><tt class="py-op">:</tt> </tt>
<a name="L154"></a><tt class="py-lineno">154</tt>  <tt class="py-line">            <tt class="py-name">colored</tt><tt class="py-op">.</tt><tt class="py-name">msg</tt> <tt class="py-op">=</tt> <tt id="link-105" class="py-name"><a title="lib.cuckoo.common.colors.yellow" class="py-name" href="#" onclick="return doclink('link-105', 'yellow', 'link-6');">yellow</a></tt><tt class="py-op">(</tt><tt class="py-name">record</tt><tt class="py-op">.</tt><tt class="py-name">msg</tt><tt class="py-op">)</tt> </tt>
<a name="L155"></a><tt class="py-lineno">155</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt class="py-name">record</tt><tt class="py-op">.</tt><tt class="py-name">levelname</tt> <tt class="py-op">==</tt> <tt class="py-string">"ERROR"</tt> <tt class="py-keyword">or</tt> <tt class="py-name">record</tt><tt class="py-op">.</tt><tt class="py-name">levelname</tt> <tt class="py-op">==</tt> <tt class="py-string">"CRITICAL"</tt><tt class="py-op">:</tt> </tt>
<a name="L156"></a><tt class="py-lineno">156</tt>  <tt class="py-line">            <tt class="py-name">colored</tt><tt class="py-op">.</tt><tt class="py-name">msg</tt> <tt class="py-op">=</tt> <tt id="link-106" class="py-name"><a title="lib.cuckoo.common.colors.red" class="py-name" href="#" onclick="return doclink('link-106', 'red', 'link-4');">red</a></tt><tt class="py-op">(</tt><tt class="py-name">record</tt><tt class="py-op">.</tt><tt class="py-name">msg</tt><tt class="py-op">)</tt> </tt>
<a name="L157"></a><tt class="py-lineno">157</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L158"></a><tt class="py-lineno">158</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-string">"analysis procedure completed"</tt> <tt class="py-keyword">in</tt> <tt class="py-name">record</tt><tt class="py-op">.</tt><tt class="py-name">msg</tt><tt class="py-op">:</tt> </tt>
<a name="L159"></a><tt class="py-lineno">159</tt>  <tt class="py-line">                <tt class="py-name">colored</tt><tt class="py-op">.</tt><tt class="py-name">msg</tt> <tt class="py-op">=</tt> <tt id="link-107" class="py-name"><a title="lib.cuckoo.common.colors.cyan" class="py-name" href="#" onclick="return doclink('link-107', 'cyan', 'link-7');">cyan</a></tt><tt class="py-op">(</tt><tt class="py-name">record</tt><tt class="py-op">.</tt><tt class="py-name">msg</tt><tt class="py-op">)</tt> </tt>
<a name="L160"></a><tt class="py-lineno">160</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L161"></a><tt class="py-lineno">161</tt>  <tt class="py-line">                <tt class="py-name">colored</tt><tt class="py-op">.</tt><tt class="py-name">msg</tt> <tt class="py-op">=</tt> <tt class="py-name">record</tt><tt class="py-op">.</tt><tt class="py-name">msg</tt> </tt>
<a name="L162"></a><tt class="py-lineno">162</tt>  <tt class="py-line"> </tt>
<a name="L163"></a><tt class="py-lineno">163</tt>  <tt class="py-line">        <tt class="py-name">logging</tt><tt class="py-op">.</tt><tt class="py-name">StreamHandler</tt><tt class="py-op">.</tt><tt id="link-108" class="py-name" targets="Method lib.cuckoo.core.startup.ConsoleHandler.emit()=lib.cuckoo.core.startup.ConsoleHandler-class.html#emit,Method lib.cuckoo.core.startup.DatabaseHandler.emit()=lib.cuckoo.core.startup.DatabaseHandler-class.html#emit"><a title="lib.cuckoo.core.startup.ConsoleHandler.emit
lib.cuckoo.core.startup.DatabaseHandler.emit" class="py-name" href="#" onclick="return doclink('link-108', 'emit', 'link-108');">emit</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">,</tt> <tt class="py-name">colored</tt><tt class="py-op">)</tt> </tt>
</div></div><a name="L164"></a><tt class="py-lineno">164</tt>  <tt class="py-line"> </tt>
<a name="init_logging"></a><div id="init_logging-def"><a name="L165"></a><tt class="py-lineno">165</tt> <a class="py-toggle" href="#" id="init_logging-toggle" onclick="return toggle('init_logging');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.startup-module.html#init_logging">init_logging</a><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="init_logging-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="init_logging-expanded"><a name="L166"></a><tt class="py-lineno">166</tt>  <tt class="py-line">    <tt class="py-docstring">"""Initializes logging."""</tt> </tt>
<a name="L167"></a><tt class="py-lineno">167</tt>  <tt class="py-line">    <tt class="py-name">formatter</tt> <tt class="py-op">=</tt> <tt class="py-name">logging</tt><tt class="py-op">.</tt><tt class="py-name">Formatter</tt><tt class="py-op">(</tt><tt class="py-string">"%(asctime)s [%(name)s] %(levelname)s: %(message)s"</tt><tt class="py-op">)</tt> </tt>
<a name="L168"></a><tt class="py-lineno">168</tt>  <tt class="py-line"> </tt>
<a name="L169"></a><tt class="py-lineno">169</tt>  <tt class="py-line">    <tt class="py-name">fh</tt> <tt class="py-op">=</tt> <tt class="py-name">logging</tt><tt class="py-op">.</tt><tt class="py-name">handlers</tt><tt class="py-op">.</tt><tt class="py-name">WatchedFileHandler</tt><tt class="py-op">(</tt><tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt id="link-109" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_ROOT" class="py-name" href="#" onclick="return doclink('link-109', 'CUCKOO_ROOT', 'link-17');">CUCKOO_ROOT</a></tt><tt class="py-op">,</tt> <tt class="py-string">"log"</tt><tt class="py-op">,</tt> <tt class="py-string">"cuckoo.log"</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L170"></a><tt class="py-lineno">170</tt>  <tt class="py-line">    <tt class="py-name">fh</tt><tt class="py-op">.</tt><tt class="py-name">setFormatter</tt><tt class="py-op">(</tt><tt class="py-name">formatter</tt><tt class="py-op">)</tt> </tt>
<a name="L171"></a><tt class="py-lineno">171</tt>  <tt class="py-line">    <tt id="link-110" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-110', 'log', 'link-62');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">addHandler</tt><tt class="py-op">(</tt><tt class="py-name">fh</tt><tt class="py-op">)</tt> </tt>
<a name="L172"></a><tt class="py-lineno">172</tt>  <tt class="py-line"> </tt>
<a name="L173"></a><tt class="py-lineno">173</tt>  <tt class="py-line">    <tt class="py-name">ch</tt> <tt class="py-op">=</tt> <tt id="link-111" class="py-name" targets="Class lib.cuckoo.core.startup.ConsoleHandler=lib.cuckoo.core.startup.ConsoleHandler-class.html"><a title="lib.cuckoo.core.startup.ConsoleHandler" class="py-name" href="#" onclick="return doclink('link-111', 'ConsoleHandler', 'link-111');">ConsoleHandler</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L174"></a><tt class="py-lineno">174</tt>  <tt class="py-line">    <tt class="py-name">ch</tt><tt class="py-op">.</tt><tt class="py-name">setFormatter</tt><tt class="py-op">(</tt><tt class="py-name">formatter</tt><tt class="py-op">)</tt> </tt>
<a name="L175"></a><tt class="py-lineno">175</tt>  <tt class="py-line">    <tt id="link-112" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-112', 'log', 'link-62');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">addHandler</tt><tt class="py-op">(</tt><tt class="py-name">ch</tt><tt class="py-op">)</tt> </tt>
<a name="L176"></a><tt class="py-lineno">176</tt>  <tt class="py-line"> </tt>
<a name="L177"></a><tt class="py-lineno">177</tt>  <tt class="py-line">    <tt class="py-name">dh</tt> <tt class="py-op">=</tt> <tt id="link-113" class="py-name" targets="Class lib.cuckoo.core.startup.DatabaseHandler=lib.cuckoo.core.startup.DatabaseHandler-class.html"><a title="lib.cuckoo.core.startup.DatabaseHandler" class="py-name" href="#" onclick="return doclink('link-113', 'DatabaseHandler', 'link-113');">DatabaseHandler</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L178"></a><tt class="py-lineno">178</tt>  <tt class="py-line">    <tt class="py-name">dh</tt><tt class="py-op">.</tt><tt class="py-name">setLevel</tt><tt class="py-op">(</tt><tt class="py-name">logging</tt><tt class="py-op">.</tt><tt id="link-114" class="py-name" targets="Variable lib.cuckoo.common.abstracts.LibVirtMachinery.ERROR=lib.cuckoo.common.abstracts.LibVirtMachinery-class.html#ERROR,Variable modules.machinery.physical.Physical.ERROR=modules.machinery.physical.Physical-class.html#ERROR,Variable modules.machinery.qemu.QEMU.ERROR=modules.machinery.qemu.QEMU-class.html#ERROR,Variable modules.machinery.virtualbox.VirtualBox.ERROR=modules.machinery.virtualbox.VirtualBox-class.html#ERROR"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery.ERROR
modules.machinery.physical.Physical.ERROR
modules.machinery.qemu.QEMU.ERROR
modules.machinery.virtualbox.VirtualBox.ERROR" class="py-name" href="#" onclick="return doclink('link-114', 'ERROR', 'link-114');">ERROR</a></tt><tt class="py-op">)</tt> </tt>
<a name="L179"></a><tt class="py-lineno">179</tt>  <tt class="py-line">    <tt id="link-115" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-115', 'log', 'link-62');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">addHandler</tt><tt class="py-op">(</tt><tt class="py-name">dh</tt><tt class="py-op">)</tt> </tt>
<a name="L180"></a><tt class="py-lineno">180</tt>  <tt class="py-line"> </tt>
<a name="L181"></a><tt class="py-lineno">181</tt>  <tt class="py-line">    <tt id="link-116" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-116', 'log', 'link-62');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">setLevel</tt><tt class="py-op">(</tt><tt class="py-name">logging</tt><tt class="py-op">.</tt><tt class="py-name">INFO</tt><tt class="py-op">)</tt> </tt>
</div><a name="L182"></a><tt class="py-lineno">182</tt>  <tt class="py-line"> </tt>
<a name="init_console_logging"></a><div id="init_console_logging-def"><a name="L183"></a><tt class="py-lineno">183</tt> <a class="py-toggle" href="#" id="init_console_logging-toggle" onclick="return toggle('init_console_logging');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.startup-module.html#init_console_logging">init_console_logging</a><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="init_console_logging-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="init_console_logging-expanded"><a name="L184"></a><tt class="py-lineno">184</tt>  <tt class="py-line">    <tt class="py-docstring">"""Initializes logging only to console."""</tt> </tt>
<a name="L185"></a><tt class="py-lineno">185</tt>  <tt class="py-line">    <tt class="py-name">formatter</tt> <tt class="py-op">=</tt> <tt class="py-name">logging</tt><tt class="py-op">.</tt><tt class="py-name">Formatter</tt><tt class="py-op">(</tt><tt class="py-string">"%(asctime)s [%(name)s] %(levelname)s: %(message)s"</tt><tt class="py-op">)</tt> </tt>
<a name="L186"></a><tt class="py-lineno">186</tt>  <tt class="py-line"> </tt>
<a name="L187"></a><tt class="py-lineno">187</tt>  <tt class="py-line">    <tt class="py-name">ch</tt> <tt class="py-op">=</tt> <tt id="link-117" class="py-name"><a title="lib.cuckoo.core.startup.ConsoleHandler" class="py-name" href="#" onclick="return doclink('link-117', 'ConsoleHandler', 'link-111');">ConsoleHandler</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L188"></a><tt class="py-lineno">188</tt>  <tt class="py-line">    <tt class="py-name">ch</tt><tt class="py-op">.</tt><tt class="py-name">setFormatter</tt><tt class="py-op">(</tt><tt class="py-name">formatter</tt><tt class="py-op">)</tt> </tt>
<a name="L189"></a><tt class="py-lineno">189</tt>  <tt class="py-line">    <tt id="link-118" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-118', 'log', 'link-62');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">addHandler</tt><tt class="py-op">(</tt><tt class="py-name">ch</tt><tt class="py-op">)</tt> </tt>
<a name="L190"></a><tt class="py-lineno">190</tt>  <tt class="py-line"> </tt>
<a name="L191"></a><tt class="py-lineno">191</tt>  <tt class="py-line">    <tt id="link-119" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-119', 'log', 'link-62');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">setLevel</tt><tt class="py-op">(</tt><tt class="py-name">logging</tt><tt class="py-op">.</tt><tt class="py-name">INFO</tt><tt class="py-op">)</tt> </tt>
</div><a name="L192"></a><tt class="py-lineno">192</tt>  <tt class="py-line"> </tt>
<a name="init_tasks"></a><div id="init_tasks-def"><a name="L193"></a><tt class="py-lineno">193</tt> <a class="py-toggle" href="#" id="init_tasks-toggle" onclick="return toggle('init_tasks');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.startup-module.html#init_tasks">init_tasks</a><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="init_tasks-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="init_tasks-expanded"><a name="L194"></a><tt class="py-lineno">194</tt>  <tt class="py-line">    <tt class="py-docstring">"""Check tasks and reschedule uncompleted ones."""</tt> </tt>
<a name="L195"></a><tt class="py-lineno">195</tt>  <tt class="py-line">    <tt id="link-120" class="py-name"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-120', 'db', 'link-100');">db</a></tt> <tt class="py-op">=</tt> <tt id="link-121" class="py-name"><a title="lib.cuckoo.core.database.Database" class="py-name" href="#" onclick="return doclink('link-121', 'Database', 'link-39');">Database</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L196"></a><tt class="py-lineno">196</tt>  <tt class="py-line">    <tt id="link-122" class="py-name"><a title="lib.cuckoo.core.rooter.cfg
modules.auxiliary.services.cfg
modules.processing.network.cfg" class="py-name" href="#" onclick="return doclink('link-122', 'cfg', 'link-89');">cfg</a></tt> <tt class="py-op">=</tt> <tt id="link-123" class="py-name"><a title="lib.cuckoo.common.config.Config" class="py-name" href="#" onclick="return doclink('link-123', 'Config', 'link-12');">Config</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L197"></a><tt class="py-lineno">197</tt>  <tt class="py-line"> </tt>
<a name="L198"></a><tt class="py-lineno">198</tt>  <tt class="py-line">    <tt id="link-124" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-124', 'log', 'link-62');">log</a></tt><tt class="py-op">.</tt><tt id="link-125" class="py-name" targets="Module modules.processing.debug=modules.processing.debug-module.html"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-125', 'debug', 'link-125');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"Checking for locked tasks.."</tt><tt class="py-op">)</tt> </tt>
<a name="L199"></a><tt class="py-lineno">199</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-126" class="py-name" targets="Variable lib.cuckoo.core.database.Tag.task=lib.cuckoo.core.database.Tag-class.html#task"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-126', 'task', 'link-126');">task</a></tt> <tt class="py-keyword">in</tt> <tt id="link-127" class="py-name"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-127', 'db', 'link-100');">db</a></tt><tt class="py-op">.</tt><tt id="link-128" class="py-name" targets="Method lib.cuckoo.core.database.Database.list_tasks()=lib.cuckoo.core.database.Database-class.html#list_tasks"><a title="lib.cuckoo.core.database.Database.list_tasks" class="py-name" href="#" onclick="return doclink('link-128', 'list_tasks', 'link-128');">list_tasks</a></tt><tt class="py-op">(</tt><tt id="link-129" class="py-name" targets="Variable lib.cuckoo.core.database.Guest.status=lib.cuckoo.core.database.Guest-class.html#status,Variable lib.cuckoo.core.database.Machine.status=lib.cuckoo.core.database.Machine-class.html#status,Variable lib.cuckoo.core.database.Task.status=lib.cuckoo.core.database.Task-class.html#status"><a title="lib.cuckoo.core.database.Guest.status
lib.cuckoo.core.database.Machine.status
lib.cuckoo.core.database.Task.status" class="py-name" href="#" onclick="return doclink('link-129', 'status', 'link-129');">status</a></tt><tt class="py-op">=</tt><tt id="link-130" class="py-name"><a title="lib.cuckoo.core.database.TASK_RUNNING" class="py-name" href="#" onclick="return doclink('link-130', 'TASK_RUNNING', 'link-40');">TASK_RUNNING</a></tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L200"></a><tt class="py-lineno">200</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-131" class="py-name"><a title="lib.cuckoo.core.rooter.cfg
modules.auxiliary.services.cfg
modules.processing.network.cfg" class="py-name" href="#" onclick="return doclink('link-131', 'cfg', 'link-89');">cfg</a></tt><tt class="py-op">.</tt><tt id="link-132" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-132', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-133" class="py-name" targets="Method lib.cuckoo.core.database.Database.reschedule()=lib.cuckoo.core.database.Database-class.html#reschedule"><a title="lib.cuckoo.core.database.Database.reschedule" class="py-name" href="#" onclick="return doclink('link-133', 'reschedule', 'link-133');">reschedule</a></tt><tt class="py-op">:</tt> </tt>
<a name="L201"></a><tt class="py-lineno">201</tt>  <tt class="py-line">            <tt id="link-134" class="py-name"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-134', 'db', 'link-100');">db</a></tt><tt class="py-op">.</tt><tt id="link-135" class="py-name"><a title="lib.cuckoo.core.database.Database.reschedule" class="py-name" href="#" onclick="return doclink('link-135', 'reschedule', 'link-133');">reschedule</a></tt><tt class="py-op">(</tt><tt id="link-136" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-136', 'task', 'link-126');">task</a></tt><tt class="py-op">.</tt><tt id="link-137" class="py-name" targets="Variable lib.cuckoo.core.database.Error.id=lib.cuckoo.core.database.Error-class.html#id,Variable lib.cuckoo.core.database.Guest.id=lib.cuckoo.core.database.Guest-class.html#id,Variable lib.cuckoo.core.database.Machine.id=lib.cuckoo.core.database.Machine-class.html#id,Variable lib.cuckoo.core.database.Sample.id=lib.cuckoo.core.database.Sample-class.html#id,Variable lib.cuckoo.core.database.Tag.id=lib.cuckoo.core.database.Tag-class.html#id,Variable lib.cuckoo.core.database.Task.id=lib.cuckoo.core.database.Task-class.html#id"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-137', 'id', 'link-137');">id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L202"></a><tt class="py-lineno">202</tt>  <tt class="py-line">            <tt id="link-138" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-138', 'log', 'link-62');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">"Rescheduled task with ID {0} and "</tt> </tt>
<a name="L203"></a><tt class="py-lineno">203</tt>  <tt class="py-line">                     <tt class="py-string">"target {1}"</tt><tt class="py-op">.</tt><tt class="py-name">format</tt><tt class="py-op">(</tt><tt id="link-139" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-139', 'task', 'link-126');">task</a></tt><tt class="py-op">.</tt><tt id="link-140" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-140', 'id', 'link-137');">id</a></tt><tt class="py-op">,</tt> <tt id="link-141" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-141', 'task', 'link-126');">task</a></tt><tt class="py-op">.</tt><tt id="link-142" class="py-name" targets="Variable lib.cuckoo.core.database.Task.target=lib.cuckoo.core.database.Task-class.html#target"><a title="lib.cuckoo.core.database.Task.target" class="py-name" href="#" onclick="return doclink('link-142', 'target', 'link-142');">target</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L204"></a><tt class="py-lineno">204</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L205"></a><tt class="py-lineno">205</tt>  <tt class="py-line">            <tt id="link-143" class="py-name"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-143', 'db', 'link-100');">db</a></tt><tt class="py-op">.</tt><tt id="link-144" class="py-name" targets="Method lib.cuckoo.common.abstracts.Machinery.set_status()=lib.cuckoo.common.abstracts.Machinery-class.html#set_status,Method lib.cuckoo.core.database.Database.set_status()=lib.cuckoo.core.database.Database-class.html#set_status"><a title="lib.cuckoo.common.abstracts.Machinery.set_status
lib.cuckoo.core.database.Database.set_status" class="py-name" href="#" onclick="return doclink('link-144', 'set_status', 'link-144');">set_status</a></tt><tt class="py-op">(</tt><tt id="link-145" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-145', 'task', 'link-126');">task</a></tt><tt class="py-op">.</tt><tt id="link-146" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-146', 'id', 'link-137');">id</a></tt><tt class="py-op">,</tt> <tt id="link-147" class="py-name"><a title="lib.cuckoo.core.database.TASK_FAILED_ANALYSIS" class="py-name" href="#" onclick="return doclink('link-147', 'TASK_FAILED_ANALYSIS', 'link-45');">TASK_FAILED_ANALYSIS</a></tt><tt class="py-op">)</tt> </tt>
<a name="L206"></a><tt class="py-lineno">206</tt>  <tt class="py-line">            <tt id="link-148" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-148', 'log', 'link-62');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">"Updated running task ID {0} status to failed_analysis"</tt><tt class="py-op">.</tt><tt class="py-name">format</tt><tt class="py-op">(</tt><tt id="link-149" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-149', 'task', 'link-126');">task</a></tt><tt class="py-op">.</tt><tt id="link-150" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-150', 'id', 'link-137');">id</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L207"></a><tt class="py-lineno">207</tt>  <tt class="py-line"> </tt>
<a name="L208"></a><tt class="py-lineno">208</tt>  <tt class="py-line">    <tt id="link-151" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-151', 'log', 'link-62');">log</a></tt><tt class="py-op">.</tt><tt id="link-152" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-152', 'debug', 'link-125');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"Checking for pending service tasks.."</tt><tt class="py-op">)</tt> </tt>
<a name="L209"></a><tt class="py-lineno">209</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-153" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-153', 'task', 'link-126');">task</a></tt> <tt class="py-keyword">in</tt> <tt id="link-154" class="py-name"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-154', 'db', 'link-100');">db</a></tt><tt class="py-op">.</tt><tt id="link-155" class="py-name"><a title="lib.cuckoo.core.database.Database.list_tasks" class="py-name" href="#" onclick="return doclink('link-155', 'list_tasks', 'link-128');">list_tasks</a></tt><tt class="py-op">(</tt><tt id="link-156" class="py-name"><a title="lib.cuckoo.core.database.Guest.status
lib.cuckoo.core.database.Machine.status
lib.cuckoo.core.database.Task.status" class="py-name" href="#" onclick="return doclink('link-156', 'status', 'link-129');">status</a></tt><tt class="py-op">=</tt><tt id="link-157" class="py-name"><a title="lib.cuckoo.core.database.TASK_PENDING" class="py-name" href="#" onclick="return doclink('link-157', 'TASK_PENDING', 'link-46');">TASK_PENDING</a></tt><tt class="py-op">,</tt> <tt id="link-158" class="py-name" targets="Variable lib.cuckoo.core.database.Task.category=lib.cuckoo.core.database.Task-class.html#category"><a title="lib.cuckoo.core.database.Task.category" class="py-name" href="#" onclick="return doclink('link-158', 'category', 'link-158');">category</a></tt><tt class="py-op">=</tt><tt class="py-string">"service"</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L210"></a><tt class="py-lineno">210</tt>  <tt class="py-line">        <tt id="link-159" class="py-name"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-159', 'db', 'link-100');">db</a></tt><tt class="py-op">.</tt><tt id="link-160" class="py-name"><a title="lib.cuckoo.common.abstracts.Machinery.set_status
lib.cuckoo.core.database.Database.set_status" class="py-name" href="#" onclick="return doclink('link-160', 'set_status', 'link-144');">set_status</a></tt><tt class="py-op">(</tt><tt id="link-161" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-161', 'task', 'link-126');">task</a></tt><tt class="py-op">.</tt><tt id="link-162" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-162', 'id', 'link-137');">id</a></tt><tt class="py-op">,</tt> <tt id="link-163" class="py-name"><a title="lib.cuckoo.core.database.TASK_FAILED_ANALYSIS" class="py-name" href="#" onclick="return doclink('link-163', 'TASK_FAILED_ANALYSIS', 'link-45');">TASK_FAILED_ANALYSIS</a></tt><tt class="py-op">)</tt> </tt>
</div><a name="L211"></a><tt class="py-lineno">211</tt>  <tt class="py-line"> </tt>
<a name="delete_file"></a><div id="delete_file-def"><a name="L212"></a><tt class="py-lineno">212</tt> <a class="py-toggle" href="#" id="delete_file-toggle" onclick="return toggle('delete_file');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.startup-module.html#delete_file">delete_file</a><tt class="py-op">(</tt><tt class="py-op">*</tt><tt class="py-param">rel_path</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="delete_file-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="delete_file-expanded"><a name="L213"></a><tt class="py-lineno">213</tt>  <tt class="py-line">    <tt class="py-name">filepath</tt> <tt class="py-op">=</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt id="link-164" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_ROOT" class="py-name" href="#" onclick="return doclink('link-164', 'CUCKOO_ROOT', 'link-17');">CUCKOO_ROOT</a></tt><tt class="py-op">,</tt> <tt class="py-op">*</tt><tt class="py-name">rel_path</tt><tt class="py-op">)</tt> </tt>
<a name="L214"></a><tt class="py-lineno">214</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">exists</tt><tt class="py-op">(</tt><tt class="py-name">filepath</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L215"></a><tt class="py-lineno">215</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> </tt>
<a name="L216"></a><tt class="py-lineno">216</tt>  <tt class="py-line"> </tt>
<a name="L217"></a><tt class="py-lineno">217</tt>  <tt class="py-line">    <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L218"></a><tt class="py-lineno">218</tt>  <tt class="py-line">        <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">unlink</tt><tt class="py-op">(</tt><tt class="py-name">filepath</tt><tt class="py-op">)</tt> </tt>
<a name="L219"></a><tt class="py-lineno">219</tt>  <tt class="py-line">    <tt class="py-keyword">except</tt> <tt class="py-name">Exception</tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L220"></a><tt class="py-lineno">220</tt>  <tt class="py-line">        <tt id="link-165" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-165', 'log', 'link-62');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">warning</tt><tt class="py-op">(</tt> </tt>
<a name="L221"></a><tt class="py-lineno">221</tt>  <tt class="py-line">            <tt class="py-string">"Unable to remove old %s leftover file from before you updated "</tt> </tt>
<a name="L222"></a><tt class="py-lineno">222</tt>  <tt class="py-line">            <tt class="py-string">"your Cuckoo setup to the latest version: %s."</tt><tt class="py-op">,</tt> </tt>
<a name="L223"></a><tt class="py-lineno">223</tt>  <tt class="py-line">            <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt class="py-op">*</tt><tt class="py-name">rel_path</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">e</tt> </tt>
<a name="L224"></a><tt class="py-lineno">224</tt>  <tt class="py-line">        <tt class="py-op">)</tt> </tt>
</div><a name="L225"></a><tt class="py-lineno">225</tt>  <tt class="py-line"> </tt>
<a name="init_modules"></a><div id="init_modules-def"><a name="L226"></a><tt class="py-lineno">226</tt> <a class="py-toggle" href="#" id="init_modules-toggle" onclick="return toggle('init_modules');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.startup-module.html#init_modules">init_modules</a><tt class="py-op">(</tt><tt class="py-param">machinery</tt><tt class="py-op">=</tt><tt class="py-name">True</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="init_modules-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="init_modules-expanded"><a name="L227"></a><tt class="py-lineno">227</tt>  <tt class="py-line">    <tt class="py-docstring">"""Initializes plugins."""</tt> </tt>
<a name="L228"></a><tt class="py-lineno">228</tt>  <tt class="py-line">    <tt id="link-166" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-166', 'log', 'link-62');">log</a></tt><tt class="py-op">.</tt><tt id="link-167" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-167', 'debug', 'link-125');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"Importing modules..."</tt><tt class="py-op">)</tt> </tt>
<a name="L229"></a><tt class="py-lineno">229</tt>  <tt class="py-line"> </tt>
<a name="L230"></a><tt class="py-lineno">230</tt>  <tt class="py-line">    <tt class="py-comment"># Import all auxiliary modules.</tt> </tt>
<a name="L231"></a><tt class="py-lineno">231</tt>  <tt class="py-line">    <tt class="py-keyword">import</tt> <tt id="link-168" class="py-name" targets="Package modules=modules-module.html"><a title="modules" class="py-name" href="#" onclick="return doclink('link-168', 'modules', 'link-168');">modules</a></tt><tt class="py-op">.</tt><tt id="link-169" class="py-name" targets="Package modules.auxiliary=modules.auxiliary-module.html"><a title="modules.auxiliary" class="py-name" href="#" onclick="return doclink('link-169', 'auxiliary', 'link-169');">auxiliary</a></tt> </tt>
<a name="L232"></a><tt class="py-lineno">232</tt>  <tt class="py-line">    <tt id="link-170" class="py-name"><a title="lib.cuckoo.core.plugins.import_package" class="py-name" href="#" onclick="return doclink('link-170', 'import_package', 'link-52');">import_package</a></tt><tt class="py-op">(</tt><tt id="link-171" class="py-name"><a title="modules" class="py-name" href="#" onclick="return doclink('link-171', 'modules', 'link-168');">modules</a></tt><tt class="py-op">.</tt><tt id="link-172" class="py-name"><a title="modules.auxiliary" class="py-name" href="#" onclick="return doclink('link-172', 'auxiliary', 'link-169');">auxiliary</a></tt><tt class="py-op">)</tt> </tt>
<a name="L233"></a><tt class="py-lineno">233</tt>  <tt class="py-line"> </tt>
<a name="L234"></a><tt class="py-lineno">234</tt>  <tt class="py-line">    <tt class="py-comment"># Import all processing modules.</tt> </tt>
<a name="L235"></a><tt class="py-lineno">235</tt>  <tt class="py-line">    <tt class="py-keyword">import</tt> <tt id="link-173" class="py-name"><a title="modules" class="py-name" href="#" onclick="return doclink('link-173', 'modules', 'link-168');">modules</a></tt><tt class="py-op">.</tt><tt id="link-174" class="py-name" targets="Variable lib.cuckoo.core.database.Task.processing=lib.cuckoo.core.database.Task-class.html#processing,Package modules.processing=modules.processing-module.html"><a title="lib.cuckoo.core.database.Task.processing
modules.processing" class="py-name" href="#" onclick="return doclink('link-174', 'processing', 'link-174');">processing</a></tt> </tt>
<a name="L236"></a><tt class="py-lineno">236</tt>  <tt class="py-line">    <tt id="link-175" class="py-name"><a title="lib.cuckoo.core.plugins.import_package" class="py-name" href="#" onclick="return doclink('link-175', 'import_package', 'link-52');">import_package</a></tt><tt class="py-op">(</tt><tt id="link-176" class="py-name"><a title="modules" class="py-name" href="#" onclick="return doclink('link-176', 'modules', 'link-168');">modules</a></tt><tt class="py-op">.</tt><tt id="link-177" class="py-name"><a title="lib.cuckoo.core.database.Task.processing
modules.processing" class="py-name" href="#" onclick="return doclink('link-177', 'processing', 'link-174');">processing</a></tt><tt class="py-op">)</tt> </tt>
<a name="L237"></a><tt class="py-lineno">237</tt>  <tt class="py-line"> </tt>
<a name="L238"></a><tt class="py-lineno">238</tt>  <tt class="py-line">    <tt class="py-comment"># Import all signatures.</tt> </tt>
<a name="L239"></a><tt class="py-lineno">239</tt>  <tt class="py-line">    <tt class="py-keyword">import</tt> <tt id="link-178" class="py-name"><a title="modules" class="py-name" href="#" onclick="return doclink('link-178', 'modules', 'link-168');">modules</a></tt><tt class="py-op">.</tt><tt id="link-179" class="py-name" targets="Package modules.signatures=modules.signatures-module.html"><a title="modules.signatures" class="py-name" href="#" onclick="return doclink('link-179', 'signatures', 'link-179');">signatures</a></tt> </tt>
<a name="L240"></a><tt class="py-lineno">240</tt>  <tt class="py-line">    <tt id="link-180" class="py-name"><a title="lib.cuckoo.core.plugins.import_package" class="py-name" href="#" onclick="return doclink('link-180', 'import_package', 'link-52');">import_package</a></tt><tt class="py-op">(</tt><tt id="link-181" class="py-name"><a title="modules" class="py-name" href="#" onclick="return doclink('link-181', 'modules', 'link-168');">modules</a></tt><tt class="py-op">.</tt><tt id="link-182" class="py-name"><a title="modules.signatures" class="py-name" href="#" onclick="return doclink('link-182', 'signatures', 'link-179');">signatures</a></tt><tt class="py-op">)</tt> </tt>
<a name="L241"></a><tt class="py-lineno">241</tt>  <tt class="py-line"> </tt>
<a name="L242"></a><tt class="py-lineno">242</tt>  <tt class="py-line">    <tt id="link-183" class="py-name" targets="Function lib.cuckoo.core.startup.delete_file()=lib.cuckoo.core.startup-module.html#delete_file"><a title="lib.cuckoo.core.startup.delete_file" class="py-name" href="#" onclick="return doclink('link-183', 'delete_file', 'link-183');">delete_file</a></tt><tt class="py-op">(</tt><tt class="py-string">"modules"</tt><tt class="py-op">,</tt> <tt class="py-string">"reporting"</tt><tt class="py-op">,</tt> <tt class="py-string">"maec40.pyc"</tt><tt class="py-op">)</tt> </tt>
<a name="L243"></a><tt class="py-lineno">243</tt>  <tt class="py-line">    <tt id="link-184" class="py-name"><a title="lib.cuckoo.core.startup.delete_file" class="py-name" href="#" onclick="return doclink('link-184', 'delete_file', 'link-183');">delete_file</a></tt><tt class="py-op">(</tt><tt class="py-string">"modules"</tt><tt class="py-op">,</tt> <tt class="py-string">"reporting"</tt><tt class="py-op">,</tt> <tt class="py-string">"maec41.pyc"</tt><tt class="py-op">)</tt> </tt>
<a name="L244"></a><tt class="py-lineno">244</tt>  <tt class="py-line">    <tt id="link-185" class="py-name"><a title="lib.cuckoo.core.startup.delete_file" class="py-name" href="#" onclick="return doclink('link-185', 'delete_file', 'link-183');">delete_file</a></tt><tt class="py-op">(</tt><tt class="py-string">"modules"</tt><tt class="py-op">,</tt> <tt class="py-string">"reporting"</tt><tt class="py-op">,</tt> <tt class="py-string">"mmdef.pyc"</tt><tt class="py-op">)</tt> </tt>
<a name="L245"></a><tt class="py-lineno">245</tt>  <tt class="py-line"> </tt>
<a name="L246"></a><tt class="py-lineno">246</tt>  <tt class="py-line">    <tt class="py-comment"># Import all reporting modules.</tt> </tt>
<a name="L247"></a><tt class="py-lineno">247</tt>  <tt class="py-line">    <tt class="py-keyword">import</tt> <tt id="link-186" class="py-name"><a title="modules" class="py-name" href="#" onclick="return doclink('link-186', 'modules', 'link-168');">modules</a></tt><tt class="py-op">.</tt><tt id="link-187" class="py-name" targets="Package modules.reporting=modules.reporting-module.html"><a title="modules.reporting" class="py-name" href="#" onclick="return doclink('link-187', 'reporting', 'link-187');">reporting</a></tt> </tt>
<a name="L248"></a><tt class="py-lineno">248</tt>  <tt class="py-line">    <tt id="link-188" class="py-name"><a title="lib.cuckoo.core.plugins.import_package" class="py-name" href="#" onclick="return doclink('link-188', 'import_package', 'link-52');">import_package</a></tt><tt class="py-op">(</tt><tt id="link-189" class="py-name"><a title="modules" class="py-name" href="#" onclick="return doclink('link-189', 'modules', 'link-168');">modules</a></tt><tt class="py-op">.</tt><tt id="link-190" class="py-name"><a title="modules.reporting" class="py-name" href="#" onclick="return doclink('link-190', 'reporting', 'link-187');">reporting</a></tt><tt class="py-op">)</tt> </tt>
<a name="L249"></a><tt class="py-lineno">249</tt>  <tt class="py-line"> </tt>
<a name="L250"></a><tt class="py-lineno">250</tt>  <tt class="py-line">    <tt class="py-comment"># Import machine manager.</tt> </tt>
<a name="L251"></a><tt class="py-lineno">251</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-191" class="py-name" targets="Variable lib.cuckoo.core.scheduler.machinery=lib.cuckoo.core.scheduler-module.html#machinery,Package modules.machinery=modules.machinery-module.html"><a title="lib.cuckoo.core.scheduler.machinery
modules.machinery" class="py-name" href="#" onclick="return doclink('link-191', 'machinery', 'link-191');">machinery</a></tt><tt class="py-op">:</tt> </tt>
<a name="L252"></a><tt class="py-lineno">252</tt>  <tt class="py-line">        <tt id="link-192" class="py-name"><a title="lib.cuckoo.core.plugins.import_plugin" class="py-name" href="#" onclick="return doclink('link-192', 'import_plugin', 'link-51');">import_plugin</a></tt><tt class="py-op">(</tt><tt class="py-string">"modules.machinery."</tt> <tt class="py-op">+</tt> <tt id="link-193" class="py-name"><a title="lib.cuckoo.common.config.Config" class="py-name" href="#" onclick="return doclink('link-193', 'Config', 'link-12');">Config</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">.</tt><tt id="link-194" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-194', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-195" class="py-name"><a title="lib.cuckoo.core.scheduler.machinery
modules.machinery" class="py-name" href="#" onclick="return doclink('link-195', 'machinery', 'link-191');">machinery</a></tt><tt class="py-op">)</tt> </tt>
<a name="L253"></a><tt class="py-lineno">253</tt>  <tt class="py-line"> </tt>
<a name="L254"></a><tt class="py-lineno">254</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-196" class="py-name"><a title="lib.cuckoo.core.database.Task.category" class="py-name" href="#" onclick="return doclink('link-196', 'category', 'link-158');">category</a></tt><tt class="py-op">,</tt> <tt class="py-name">entries</tt> <tt class="py-keyword">in</tt> <tt id="link-197" class="py-name"><a title="lib.cuckoo.core.plugins.list_plugins" class="py-name" href="#" onclick="return doclink('link-197', 'list_plugins', 'link-53');">list_plugins</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">.</tt><tt class="py-name">items</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L255"></a><tt class="py-lineno">255</tt>  <tt class="py-line">        <tt id="link-198" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-198', 'log', 'link-62');">log</a></tt><tt class="py-op">.</tt><tt id="link-199" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-199', 'debug', 'link-125');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"Imported \"%s\" modules:"</tt><tt class="py-op">,</tt> <tt id="link-200" class="py-name"><a title="lib.cuckoo.core.database.Task.category" class="py-name" href="#" onclick="return doclink('link-200', 'category', 'link-158');">category</a></tt><tt class="py-op">)</tt> </tt>
<a name="L256"></a><tt class="py-lineno">256</tt>  <tt class="py-line"> </tt>
<a name="L257"></a><tt class="py-lineno">257</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">entry</tt> <tt class="py-keyword">in</tt> <tt class="py-name">entries</tt><tt class="py-op">:</tt> </tt>
<a name="L258"></a><tt class="py-lineno">258</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">entry</tt> <tt class="py-op">==</tt> <tt class="py-name">entries</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L259"></a><tt class="py-lineno">259</tt>  <tt class="py-line">                <tt id="link-201" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-201', 'log', 'link-62');">log</a></tt><tt class="py-op">.</tt><tt id="link-202" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-202', 'debug', 'link-125');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"\t `-- %s"</tt><tt class="py-op">,</tt> <tt class="py-name">entry</tt><tt class="py-op">.</tt><tt class="py-name">__name__</tt><tt class="py-op">)</tt> </tt>
<a name="L260"></a><tt class="py-lineno">260</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L261"></a><tt class="py-lineno">261</tt>  <tt class="py-line">                <tt id="link-203" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-203', 'log', 'link-62');">log</a></tt><tt class="py-op">.</tt><tt id="link-204" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-204', 'debug', 'link-125');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"\t |-- %s"</tt><tt class="py-op">,</tt> <tt class="py-name">entry</tt><tt class="py-op">.</tt><tt class="py-name">__name__</tt><tt class="py-op">)</tt> </tt>
</div><a name="L262"></a><tt class="py-lineno">262</tt>  <tt class="py-line"> </tt>
<a name="init_yara"></a><div id="init_yara-def"><a name="L263"></a><tt class="py-lineno">263</tt> <a class="py-toggle" href="#" id="init_yara-toggle" onclick="return toggle('init_yara');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.startup-module.html#init_yara">init_yara</a><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="init_yara-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="init_yara-expanded"><a name="L264"></a><tt class="py-lineno">264</tt>  <tt class="py-line">    <tt class="py-docstring">"""Generates index for yara signatures."""</tt> </tt>
<a name="L265"></a><tt class="py-lineno">265</tt>  <tt class="py-line"> </tt>
<a name="L266"></a><tt class="py-lineno">266</tt>  <tt class="py-line">    <tt class="py-keyword">def</tt> <tt class="py-def-name">find_signatures</tt><tt class="py-op">(</tt><tt class="py-param">root</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L267"></a><tt class="py-lineno">267</tt>  <tt class="py-line">        <tt id="link-205" class="py-name"><a title="modules.signatures" class="py-name" href="#" onclick="return doclink('link-205', 'signatures', 'link-179');">signatures</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L268"></a><tt class="py-lineno">268</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">entry</tt> <tt class="py-keyword">in</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">listdir</tt><tt class="py-op">(</tt><tt class="py-name">root</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L269"></a><tt class="py-lineno">269</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">entry</tt><tt class="py-op">.</tt><tt class="py-name">endswith</tt><tt class="py-op">(</tt><tt class="py-string">".yara"</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-name">entry</tt><tt class="py-op">.</tt><tt class="py-name">endswith</tt><tt class="py-op">(</tt><tt class="py-string">".yar"</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L270"></a><tt class="py-lineno">270</tt>  <tt class="py-line">                <tt id="link-206" class="py-name"><a title="modules.signatures" class="py-name" href="#" onclick="return doclink('link-206', 'signatures', 'link-179');">signatures</a></tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt class="py-name">root</tt><tt class="py-op">,</tt> <tt class="py-name">entry</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L271"></a><tt class="py-lineno">271</tt>  <tt class="py-line"> </tt>
<a name="L272"></a><tt class="py-lineno">272</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt id="link-207" class="py-name"><a title="modules.signatures" class="py-name" href="#" onclick="return doclink('link-207', 'signatures', 'link-179');">signatures</a></tt> </tt>
</div><a name="L273"></a><tt class="py-lineno">273</tt>  <tt class="py-line"> </tt>
<a name="L274"></a><tt class="py-lineno">274</tt>  <tt class="py-line">    <tt id="link-208" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-208', 'log', 'link-62');">log</a></tt><tt class="py-op">.</tt><tt id="link-209" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-209', 'debug', 'link-125');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"Initializing Yara..."</tt><tt class="py-op">)</tt> </tt>
<a name="L275"></a><tt class="py-lineno">275</tt>  <tt class="py-line"> </tt>
<a name="L276"></a><tt class="py-lineno">276</tt>  <tt class="py-line">    <tt class="py-comment"># Generate root directory for yara rules.</tt> </tt>
<a name="L277"></a><tt class="py-lineno">277</tt>  <tt class="py-line">    <tt class="py-name">yara_root</tt> <tt class="py-op">=</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt id="link-210" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_ROOT" class="py-name" href="#" onclick="return doclink('link-210', 'CUCKOO_ROOT', 'link-17');">CUCKOO_ROOT</a></tt><tt class="py-op">,</tt> <tt class="py-string">"data"</tt><tt class="py-op">,</tt> <tt class="py-string">"yara"</tt><tt class="py-op">)</tt> </tt>
<a name="L278"></a><tt class="py-lineno">278</tt>  <tt class="py-line"> </tt>
<a name="L279"></a><tt class="py-lineno">279</tt>  <tt class="py-line">    <tt class="py-comment"># We divide yara rules in three categories.</tt> </tt>
<a name="L280"></a><tt class="py-lineno">280</tt>  <tt class="py-line">    <tt id="link-211" class="py-name" targets="Variable lib.cuckoo.common.abstracts.Signature.categories=lib.cuckoo.common.abstracts.Signature-class.html#categories,Variable modules.signatures.creates_exe.CreatesExe.categories=modules.signatures.creates_exe.CreatesExe-class.html#categories,Variable modules.signatures.generic_metrics.SystemMetrics.categories=modules.signatures.generic_metrics.SystemMetrics-class.html#categories"><a title="lib.cuckoo.common.abstracts.Signature.categories
modules.signatures.creates_exe.CreatesExe.categories
modules.signatures.generic_metrics.SystemMetrics.categories" class="py-name" href="#" onclick="return doclink('link-211', 'categories', 'link-211');">categories</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-string">"binaries"</tt><tt class="py-op">,</tt> <tt class="py-string">"urls"</tt><tt class="py-op">,</tt> <tt class="py-string">"memory"</tt><tt class="py-op">]</tt> </tt>
<a name="L281"></a><tt class="py-lineno">281</tt>  <tt class="py-line">    <tt class="py-name">generated</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L282"></a><tt class="py-lineno">282</tt>  <tt class="py-line">    <tt class="py-comment"># Loop through all categories.</tt> </tt>
<a name="L283"></a><tt class="py-lineno">283</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt id="link-212" class="py-name"><a title="lib.cuckoo.core.database.Task.category" class="py-name" href="#" onclick="return doclink('link-212', 'category', 'link-158');">category</a></tt> <tt class="py-keyword">in</tt> <tt id="link-213" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.categories
modules.signatures.creates_exe.CreatesExe.categories
modules.signatures.generic_metrics.SystemMetrics.categories" class="py-name" href="#" onclick="return doclink('link-213', 'categories', 'link-211');">categories</a></tt><tt class="py-op">:</tt> </tt>
<a name="L284"></a><tt class="py-lineno">284</tt>  <tt class="py-line">        <tt class="py-comment"># Check if there is a directory for the given category.</tt> </tt>
<a name="L285"></a><tt class="py-lineno">285</tt>  <tt class="py-line">        <tt class="py-name">category_root</tt> <tt class="py-op">=</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt class="py-name">yara_root</tt><tt class="py-op">,</tt> <tt id="link-214" class="py-name"><a title="lib.cuckoo.core.database.Task.category" class="py-name" href="#" onclick="return doclink('link-214', 'category', 'link-158');">category</a></tt><tt class="py-op">)</tt> </tt>
<a name="L286"></a><tt class="py-lineno">286</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">exists</tt><tt class="py-op">(</tt><tt class="py-name">category_root</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L287"></a><tt class="py-lineno">287</tt>  <tt class="py-line">            <tt class="py-keyword">continue</tt> </tt>
<a name="L288"></a><tt class="py-lineno">288</tt>  <tt class="py-line"> </tt>
<a name="L289"></a><tt class="py-lineno">289</tt>  <tt class="py-line">        <tt class="py-comment"># Check if the directory contains any rules.</tt> </tt>
<a name="L290"></a><tt class="py-lineno">290</tt>  <tt class="py-line">        <tt id="link-215" class="py-name"><a title="modules.signatures" class="py-name" href="#" onclick="return doclink('link-215', 'signatures', 'link-179');">signatures</a></tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L291"></a><tt class="py-lineno">291</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">entry</tt> <tt class="py-keyword">in</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">listdir</tt><tt class="py-op">(</tt><tt class="py-name">category_root</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L292"></a><tt class="py-lineno">292</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">entry</tt><tt class="py-op">.</tt><tt class="py-name">endswith</tt><tt class="py-op">(</tt><tt class="py-string">".yara"</tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-name">entry</tt><tt class="py-op">.</tt><tt class="py-name">endswith</tt><tt class="py-op">(</tt><tt class="py-string">".yar"</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L293"></a><tt class="py-lineno">293</tt>  <tt class="py-line">                <tt id="link-216" class="py-name"><a title="modules.signatures" class="py-name" href="#" onclick="return doclink('link-216', 'signatures', 'link-179');">signatures</a></tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt class="py-name">category_root</tt><tt class="py-op">,</tt> <tt class="py-name">entry</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L294"></a><tt class="py-lineno">294</tt>  <tt class="py-line"> </tt>
<a name="L295"></a><tt class="py-lineno">295</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-217" class="py-name"><a title="modules.signatures" class="py-name" href="#" onclick="return doclink('link-217', 'signatures', 'link-179');">signatures</a></tt><tt class="py-op">:</tt> </tt>
<a name="L296"></a><tt class="py-lineno">296</tt>  <tt class="py-line">            <tt class="py-keyword">continue</tt> </tt>
<a name="L297"></a><tt class="py-lineno">297</tt>  <tt class="py-line"> </tt>
<a name="L298"></a><tt class="py-lineno">298</tt>  <tt class="py-line">        <tt class="py-comment"># Generate path for the category's index file.</tt> </tt>
<a name="L299"></a><tt class="py-lineno">299</tt>  <tt class="py-line">        <tt class="py-name">index_name</tt> <tt class="py-op">=</tt> <tt class="py-string">"index_{0}.yar"</tt><tt class="py-op">.</tt><tt class="py-name">format</tt><tt class="py-op">(</tt><tt id="link-218" class="py-name"><a title="lib.cuckoo.core.database.Task.category" class="py-name" href="#" onclick="return doclink('link-218', 'category', 'link-158');">category</a></tt><tt class="py-op">)</tt> </tt>
<a name="L300"></a><tt class="py-lineno">300</tt>  <tt class="py-line">        <tt class="py-name">index_path</tt> <tt class="py-op">=</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt class="py-name">yara_root</tt><tt class="py-op">,</tt> <tt class="py-name">index_name</tt><tt class="py-op">)</tt> </tt>
<a name="L301"></a><tt class="py-lineno">301</tt>  <tt class="py-line"> </tt>
<a name="L302"></a><tt class="py-lineno">302</tt>  <tt class="py-line">        <tt class="py-comment"># Create index file and populate it.</tt> </tt>
<a name="L303"></a><tt class="py-lineno">303</tt>  <tt class="py-line">        <tt class="py-keyword">with</tt> <tt class="py-name">open</tt><tt class="py-op">(</tt><tt class="py-name">index_path</tt><tt class="py-op">,</tt> <tt class="py-string">"w"</tt><tt class="py-op">)</tt> <tt class="py-keyword">as</tt> <tt class="py-name">index_handle</tt><tt class="py-op">:</tt> </tt>
<a name="L304"></a><tt class="py-lineno">304</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt class="py-name">signature</tt> <tt class="py-keyword">in</tt> <tt id="link-219" class="py-name"><a title="modules.signatures" class="py-name" href="#" onclick="return doclink('link-219', 'signatures', 'link-179');">signatures</a></tt><tt class="py-op">:</tt> </tt>
<a name="L305"></a><tt class="py-lineno">305</tt>  <tt class="py-line">                <tt class="py-name">index_handle</tt><tt class="py-op">.</tt><tt id="link-220" class="py-name" targets="Method modules.processing.network.SortCap.write()=modules.processing.network.SortCap-class.html#write"><a title="modules.processing.network.SortCap.write" class="py-name" href="#" onclick="return doclink('link-220', 'write', 'link-220');">write</a></tt><tt class="py-op">(</tt><tt class="py-string">"include \"{0}\"\n"</tt><tt class="py-op">.</tt><tt class="py-name">format</tt><tt class="py-op">(</tt><tt class="py-name">signature</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L306"></a><tt class="py-lineno">306</tt>  <tt class="py-line"> </tt>
<a name="L307"></a><tt class="py-lineno">307</tt>  <tt class="py-line">        <tt class="py-name">generated</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt class="py-name">index_name</tt><tt class="py-op">)</tt> </tt>
<a name="L308"></a><tt class="py-lineno">308</tt>  <tt class="py-line"> </tt>
<a name="L309"></a><tt class="py-lineno">309</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">entry</tt> <tt class="py-keyword">in</tt> <tt class="py-name">generated</tt><tt class="py-op">:</tt> </tt>
<a name="L310"></a><tt class="py-lineno">310</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">entry</tt> <tt class="py-op">==</tt> <tt class="py-name">generated</tt><tt class="py-op">[</tt><tt class="py-op">-</tt><tt class="py-number">1</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L311"></a><tt class="py-lineno">311</tt>  <tt class="py-line">            <tt id="link-221" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-221', 'log', 'link-62');">log</a></tt><tt class="py-op">.</tt><tt id="link-222" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-222', 'debug', 'link-125');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"\t `-- %s"</tt><tt class="py-op">,</tt> <tt class="py-name">entry</tt><tt class="py-op">)</tt> </tt>
<a name="L312"></a><tt class="py-lineno">312</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L313"></a><tt class="py-lineno">313</tt>  <tt class="py-line">            <tt id="link-223" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-223', 'log', 'link-62');">log</a></tt><tt class="py-op">.</tt><tt id="link-224" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-224', 'debug', 'link-125');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"\t |-- %s"</tt><tt class="py-op">,</tt> <tt class="py-name">entry</tt><tt class="py-op">)</tt> </tt>
</div><a name="L314"></a><tt class="py-lineno">314</tt>  <tt class="py-line"> </tt>
<a name="init_binaries"></a><div id="init_binaries-def"><a name="L315"></a><tt class="py-lineno">315</tt> <a class="py-toggle" href="#" id="init_binaries-toggle" onclick="return toggle('init_binaries');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.startup-module.html#init_binaries">init_binaries</a><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="init_binaries-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="init_binaries-expanded"><a name="L316"></a><tt class="py-lineno">316</tt>  <tt class="py-line">    <tt class="py-docstring">"""Inform the user about the need to periodically look for new analyzer</tt> </tt>
<a name="L317"></a><tt class="py-lineno">317</tt>  <tt class="py-line"><tt class="py-docstring">    binaries. These include the Windows monitor etc."""</tt> </tt>
<a name="L318"></a><tt class="py-lineno">318</tt>  <tt class="py-line">    <tt class="py-name">monitor</tt> <tt class="py-op">=</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt id="link-225" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_ROOT" class="py-name" href="#" onclick="return doclink('link-225', 'CUCKOO_ROOT', 'link-17');">CUCKOO_ROOT</a></tt><tt class="py-op">,</tt> <tt class="py-string">"data"</tt><tt class="py-op">,</tt> <tt class="py-string">"monitor"</tt><tt class="py-op">,</tt> <tt class="py-string">"latest"</tt><tt class="py-op">)</tt> </tt>
<a name="L319"></a><tt class="py-lineno">319</tt>  <tt class="py-line"> </tt>
<a name="L320"></a><tt class="py-lineno">320</tt>  <tt class="py-line">    <tt class="py-comment"># Checks whether the "latest" symlink is available as well as whether</tt> </tt>
<a name="L321"></a><tt class="py-lineno">321</tt>  <tt class="py-line">    <tt class="py-comment"># it points to an existing directory.</tt> </tt>
<a name="L322"></a><tt class="py-lineno">322</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">exists</tt><tt class="py-op">(</tt><tt class="py-name">monitor</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L323"></a><tt class="py-lineno">323</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-226" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooStartupError" class="py-name" href="#" onclick="return doclink('link-226', 'CuckooStartupError', 'link-23');">CuckooStartupError</a></tt><tt class="py-op">(</tt> </tt>
<a name="L324"></a><tt class="py-lineno">324</tt>  <tt class="py-line">            <tt class="py-string">"The binaries used for Windows analysis are updated regularly, "</tt> </tt>
<a name="L325"></a><tt class="py-lineno">325</tt>  <tt class="py-line">            <tt class="py-string">"independently from the release line. It appears that you're "</tt> </tt>
<a name="L326"></a><tt class="py-lineno">326</tt>  <tt class="py-line">            <tt class="py-string">"not up-to-date. This can happen when you've just installed "</tt> </tt>
<a name="L327"></a><tt class="py-lineno">327</tt>  <tt class="py-line">            <tt class="py-string">"Cuckoo or when you've updated your Cuckoo version by pulling "</tt> </tt>
<a name="L328"></a><tt class="py-lineno">328</tt>  <tt class="py-line">            <tt class="py-string">"the latest changes from our Git repository. In order to get "</tt> </tt>
<a name="L329"></a><tt class="py-lineno">329</tt>  <tt class="py-line">            <tt class="py-string">"up-to-date, please run the following "</tt> </tt>
<a name="L330"></a><tt class="py-lineno">330</tt>  <tt class="py-line">            <tt class="py-string">"command: `./utils/community.py -wafb monitor` or "</tt> </tt>
<a name="L331"></a><tt class="py-lineno">331</tt>  <tt class="py-line">            <tt class="py-string">"`./utils/community.py -wafb 2.0` if you'd also like to download "</tt> </tt>
<a name="L332"></a><tt class="py-lineno">332</tt>  <tt class="py-line">            <tt class="py-string">"over 300 Cuckoo signatures."</tt> </tt>
<a name="L333"></a><tt class="py-lineno">333</tt>  <tt class="py-line">        <tt class="py-op">)</tt> </tt>
</div><a name="L334"></a><tt class="py-lineno">334</tt>  <tt class="py-line"> </tt>
<a name="init_rooter"></a><div id="init_rooter-def"><a name="L335"></a><tt class="py-lineno">335</tt> <a class="py-toggle" href="#" id="init_rooter-toggle" onclick="return toggle('init_rooter');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.startup-module.html#init_rooter">init_rooter</a><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="init_rooter-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="init_rooter-expanded"><a name="L336"></a><tt class="py-lineno">336</tt>  <tt class="py-line">    <tt class="py-docstring">"""If required, check whether the rooter is running and whether we can</tt> </tt>
<a name="L337"></a><tt class="py-lineno">337</tt>  <tt class="py-line"><tt class="py-docstring">    connect to it."""</tt> </tt>
<a name="L338"></a><tt class="py-lineno">338</tt>  <tt class="py-line">    <tt id="link-227" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-227', 'cuckoo', 'link-1');">cuckoo</a></tt> <tt class="py-op">=</tt> <tt id="link-228" class="py-name"><a title="lib.cuckoo.common.config.Config" class="py-name" href="#" onclick="return doclink('link-228', 'Config', 'link-12');">Config</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L339"></a><tt class="py-lineno">339</tt>  <tt class="py-line"> </tt>
<a name="L340"></a><tt class="py-lineno">340</tt>  <tt class="py-line">    <tt class="py-comment"># The default configuration doesn't require the rooter to be ran.</tt> </tt>
<a name="L341"></a><tt class="py-lineno">341</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-229" class="py-name"><a title="lib.cuckoo.common.config.Config" class="py-name" href="#" onclick="return doclink('link-229', 'Config', 'link-12');">Config</a></tt><tt class="py-op">(</tt><tt class="py-string">"vpn"</tt><tt class="py-op">)</tt><tt class="py-op">.</tt><tt class="py-name">vpn</tt><tt class="py-op">.</tt><tt id="link-230" class="py-name" targets="Variable lib.cuckoo.common.abstracts.Processing.enabled=lib.cuckoo.common.abstracts.Processing-class.html#enabled,Variable lib.cuckoo.common.abstracts.Signature.enabled=lib.cuckoo.common.abstracts.Signature-class.html#enabled,Variable modules.signatures.creates_exe.CreatesExe.enabled=modules.signatures.creates_exe.CreatesExe-class.html#enabled,Variable modules.signatures.generic_metrics.SystemMetrics.enabled=modules.signatures.generic_metrics.SystemMetrics-class.html#enabled"><a title="lib.cuckoo.common.abstracts.Processing.enabled
lib.cuckoo.common.abstracts.Signature.enabled
modules.signatures.creates_exe.CreatesExe.enabled
modules.signatures.generic_metrics.SystemMetrics.enabled" class="py-name" href="#" onclick="return doclink('link-230', 'enabled', 'link-230');">enabled</a></tt> <tt class="py-keyword">and</tt> <tt id="link-231" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-231', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt class="py-name">routing</tt><tt class="py-op">.</tt><tt id="link-232" class="py-name" targets="Variable lib.cuckoo.core.database.Task.route=lib.cuckoo.core.database.Task-class.html#route"><a title="lib.cuckoo.core.database.Task.route" class="py-name" href="#" onclick="return doclink('link-232', 'route', 'link-232');">route</a></tt> <tt class="py-op">==</tt> <tt class="py-string">"none"</tt><tt class="py-op">:</tt> </tt>
<a name="L342"></a><tt class="py-lineno">342</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> </tt>
<a name="L343"></a><tt class="py-lineno">343</tt>  <tt class="py-line"> </tt>
<a name="L344"></a><tt class="py-lineno">344</tt>  <tt class="py-line">    <tt id="link-233" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-233', 'cuckoo', 'link-1');">cuckoo</a></tt> <tt class="py-op">=</tt> <tt id="link-234" class="py-name"><a title="lib.cuckoo.common.config.Config" class="py-name" href="#" onclick="return doclink('link-234', 'Config', 'link-12');">Config</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L345"></a><tt class="py-lineno">345</tt>  <tt class="py-line">    <tt class="py-name">s</tt> <tt class="py-op">=</tt> <tt class="py-name">socket</tt><tt class="py-op">.</tt><tt class="py-name">socket</tt><tt class="py-op">(</tt><tt class="py-name">socket</tt><tt class="py-op">.</tt><tt class="py-name">AF_UNIX</tt><tt class="py-op">,</tt> <tt class="py-name">socket</tt><tt class="py-op">.</tt><tt class="py-name">SOCK_DGRAM</tt><tt class="py-op">)</tt> </tt>
<a name="L346"></a><tt class="py-lineno">346</tt>  <tt class="py-line"> </tt>
<a name="L347"></a><tt class="py-lineno">347</tt>  <tt class="py-line">    <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L348"></a><tt class="py-lineno">348</tt>  <tt class="py-line">        <tt class="py-name">s</tt><tt class="py-op">.</tt><tt id="link-235" class="py-name" targets="Method modules.reporting.mongodb.MongoDB.connect()=modules.reporting.mongodb.MongoDB-class.html#connect"><a title="modules.reporting.mongodb.MongoDB.connect" class="py-name" href="#" onclick="return doclink('link-235', 'connect', 'link-235');">connect</a></tt><tt class="py-op">(</tt><tt id="link-236" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-236', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-237" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-237', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-238" class="py-name"><a title="lib.cuckoo.core.rooter
lib.cuckoo.core.rooter.rooter" class="py-name" href="#" onclick="return doclink('link-238', 'rooter', 'link-57');">rooter</a></tt><tt class="py-op">)</tt> </tt>
<a name="L349"></a><tt class="py-lineno">349</tt>  <tt class="py-line">    <tt class="py-keyword">except</tt> <tt class="py-name">socket</tt><tt class="py-op">.</tt><tt class="py-name">error</tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L350"></a><tt class="py-lineno">350</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">e</tt><tt class="py-op">.</tt><tt class="py-name">strerror</tt> <tt class="py-op">==</tt> <tt class="py-string">"No such file or directory"</tt><tt class="py-op">:</tt> </tt>
<a name="L351"></a><tt class="py-lineno">351</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-239" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooStartupError" class="py-name" href="#" onclick="return doclink('link-239', 'CuckooStartupError', 'link-23');">CuckooStartupError</a></tt><tt class="py-op">(</tt> </tt>
<a name="L352"></a><tt class="py-lineno">352</tt>  <tt class="py-line">                <tt class="py-string">"The rooter is required but it is either not running or it "</tt> </tt>
<a name="L353"></a><tt class="py-lineno">353</tt>  <tt class="py-line">                <tt class="py-string">"has been configured to a different Unix socket path. "</tt> </tt>
<a name="L354"></a><tt class="py-lineno">354</tt>  <tt class="py-line">                <tt class="py-string">"(In order to disable the use of rooter, please set route "</tt> </tt>
<a name="L355"></a><tt class="py-lineno">355</tt>  <tt class="py-line">                <tt class="py-string">"and internet to none in cuckoo.conf and enabled to no in "</tt> </tt>
<a name="L356"></a><tt class="py-lineno">356</tt>  <tt class="py-line">                <tt class="py-string">"vpn.conf)."</tt> </tt>
<a name="L357"></a><tt class="py-lineno">357</tt>  <tt class="py-line">            <tt class="py-op">)</tt> </tt>
<a name="L358"></a><tt class="py-lineno">358</tt>  <tt class="py-line"> </tt>
<a name="L359"></a><tt class="py-lineno">359</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">e</tt><tt class="py-op">.</tt><tt class="py-name">strerror</tt> <tt class="py-op">==</tt> <tt class="py-string">"Connection refused"</tt><tt class="py-op">:</tt> </tt>
<a name="L360"></a><tt class="py-lineno">360</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-240" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooStartupError" class="py-name" href="#" onclick="return doclink('link-240', 'CuckooStartupError', 'link-23');">CuckooStartupError</a></tt><tt class="py-op">(</tt> </tt>
<a name="L361"></a><tt class="py-lineno">361</tt>  <tt class="py-line">                <tt class="py-string">"The rooter is required but we can't connect to it as the "</tt> </tt>
<a name="L362"></a><tt class="py-lineno">362</tt>  <tt class="py-line">                <tt class="py-string">"rooter is not actually running. "</tt> </tt>
<a name="L363"></a><tt class="py-lineno">363</tt>  <tt class="py-line">                <tt class="py-string">"(In order to disable the use of rooter, please set route "</tt> </tt>
<a name="L364"></a><tt class="py-lineno">364</tt>  <tt class="py-line">                <tt class="py-string">"and internet to none in cuckoo.conf and enabled to no in "</tt> </tt>
<a name="L365"></a><tt class="py-lineno">365</tt>  <tt class="py-line">                <tt class="py-string">"vpn.conf)."</tt> </tt>
<a name="L366"></a><tt class="py-lineno">366</tt>  <tt class="py-line">            <tt class="py-op">)</tt> </tt>
<a name="L367"></a><tt class="py-lineno">367</tt>  <tt class="py-line"> </tt>
<a name="L368"></a><tt class="py-lineno">368</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">e</tt><tt class="py-op">.</tt><tt class="py-name">strerror</tt> <tt class="py-op">==</tt> <tt class="py-string">"Permission denied"</tt><tt class="py-op">:</tt> </tt>
<a name="L369"></a><tt class="py-lineno">369</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-241" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooStartupError" class="py-name" href="#" onclick="return doclink('link-241', 'CuckooStartupError', 'link-23');">CuckooStartupError</a></tt><tt class="py-op">(</tt> </tt>
<a name="L370"></a><tt class="py-lineno">370</tt>  <tt class="py-line">                <tt class="py-string">"The rooter is required but we can't connect to it due to "</tt> </tt>
<a name="L371"></a><tt class="py-lineno">371</tt>  <tt class="py-line">                <tt class="py-string">"incorrect permissions. Did you assign it the correct group? "</tt> </tt>
<a name="L372"></a><tt class="py-lineno">372</tt>  <tt class="py-line">                <tt class="py-string">"(In order to disable the use of rooter, please set route "</tt> </tt>
<a name="L373"></a><tt class="py-lineno">373</tt>  <tt class="py-line">                <tt class="py-string">"and internet to none in cuckoo.conf and enabled to no in "</tt> </tt>
<a name="L374"></a><tt class="py-lineno">374</tt>  <tt class="py-line">                <tt class="py-string">"vpn.conf)."</tt> </tt>
<a name="L375"></a><tt class="py-lineno">375</tt>  <tt class="py-line">            <tt class="py-op">)</tt> </tt>
<a name="L376"></a><tt class="py-lineno">376</tt>  <tt class="py-line"> </tt>
<a name="L377"></a><tt class="py-lineno">377</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-242" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooStartupError" class="py-name" href="#" onclick="return doclink('link-242', 'CuckooStartupError', 'link-23');">CuckooStartupError</a></tt><tt class="py-op">(</tt><tt class="py-string">"Unknown rooter error: %s"</tt> <tt class="py-op">%</tt> <tt class="py-name">e</tt><tt class="py-op">)</tt> </tt>
<a name="L378"></a><tt class="py-lineno">378</tt>  <tt class="py-line"> </tt>
<a name="L379"></a><tt class="py-lineno">379</tt>  <tt class="py-line">    <tt class="py-comment"># Do not forward any packets unless we have explicitly stated so.</tt> </tt>
<a name="L380"></a><tt class="py-lineno">380</tt>  <tt class="py-line">    <tt id="link-243" class="py-name"><a title="lib.cuckoo.core.rooter
lib.cuckoo.core.rooter.rooter" class="py-name" href="#" onclick="return doclink('link-243', 'rooter', 'link-57');">rooter</a></tt><tt class="py-op">(</tt><tt class="py-string">"forward_drop"</tt><tt class="py-op">)</tt> </tt>
</div><a name="L381"></a><tt class="py-lineno">381</tt>  <tt class="py-line"> </tt>
<a name="init_routing"></a><div id="init_routing-def"><a name="L382"></a><tt class="py-lineno">382</tt> <a class="py-toggle" href="#" id="init_routing-toggle" onclick="return toggle('init_routing');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.startup-module.html#init_routing">init_routing</a><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="init_routing-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="init_routing-expanded"><a name="L383"></a><tt class="py-lineno">383</tt>  <tt class="py-line">    <tt class="py-docstring">"""Initialize and check whether the routing information is correct."""</tt> </tt>
<a name="L384"></a><tt class="py-lineno">384</tt>  <tt class="py-line">    <tt id="link-244" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-244', 'cuckoo', 'link-1');">cuckoo</a></tt> <tt class="py-op">=</tt> <tt id="link-245" class="py-name"><a title="lib.cuckoo.common.config.Config" class="py-name" href="#" onclick="return doclink('link-245', 'Config', 'link-12');">Config</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L385"></a><tt class="py-lineno">385</tt>  <tt class="py-line">    <tt class="py-name">vpn</tt> <tt class="py-op">=</tt> <tt id="link-246" class="py-name"><a title="lib.cuckoo.common.config.Config" class="py-name" href="#" onclick="return doclink('link-246', 'Config', 'link-12');">Config</a></tt><tt class="py-op">(</tt><tt class="py-string">"vpn"</tt><tt class="py-op">)</tt> </tt>
<a name="L386"></a><tt class="py-lineno">386</tt>  <tt class="py-line"> </tt>
<a name="L387"></a><tt class="py-lineno">387</tt>  <tt class="py-line">    <tt class="py-comment"># Check whether all VPNs exist if configured and make their configuration</tt> </tt>
<a name="L388"></a><tt class="py-lineno">388</tt>  <tt class="py-line">    <tt class="py-comment"># available through the vpns variable. Also enable NAT on each interface.</tt> </tt>
<a name="L389"></a><tt class="py-lineno">389</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-name">vpn</tt><tt class="py-op">.</tt><tt class="py-name">vpn</tt><tt class="py-op">.</tt><tt id="link-247" class="py-name"><a title="lib.cuckoo.common.abstracts.Processing.enabled
lib.cuckoo.common.abstracts.Signature.enabled
modules.signatures.creates_exe.CreatesExe.enabled
modules.signatures.generic_metrics.SystemMetrics.enabled" class="py-name" href="#" onclick="return doclink('link-247', 'enabled', 'link-230');">enabled</a></tt><tt class="py-op">:</tt> </tt>
<a name="L390"></a><tt class="py-lineno">390</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-248" class="py-name" targets="Variable lib.cuckoo.common.abstracts.Signature.name=lib.cuckoo.common.abstracts.Signature-class.html#name,Variable lib.cuckoo.core.database.Guest.name=lib.cuckoo.core.database.Guest-class.html#name,Variable lib.cuckoo.core.database.Machine.name=lib.cuckoo.core.database.Machine-class.html#name,Variable lib.cuckoo.core.database.Tag.name=lib.cuckoo.core.database.Tag-class.html#name,Variable modules.signatures.creates_exe.CreatesExe.name=modules.signatures.creates_exe.CreatesExe-class.html#name,Variable modules.signatures.generic_metrics.SystemMetrics.name=modules.signatures.generic_metrics.SystemMetrics-class.html#name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-248', 'name', 'link-248');">name</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">vpn</tt><tt class="py-op">.</tt><tt class="py-name">vpn</tt><tt class="py-op">.</tt><tt id="link-249" class="py-name"><a title="lib.cuckoo.core.rooter.vpns" class="py-name" href="#" onclick="return doclink('link-249', 'vpns', 'link-59');">vpns</a></tt><tt class="py-op">.</tt><tt class="py-name">split</tt><tt class="py-op">(</tt><tt class="py-string">","</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L391"></a><tt class="py-lineno">391</tt>  <tt class="py-line">            <tt id="link-250" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-250', 'name', 'link-248');">name</a></tt> <tt class="py-op">=</tt> <tt id="link-251" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-251', 'name', 'link-248');">name</a></tt><tt class="py-op">.</tt><tt class="py-name">strip</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L392"></a><tt class="py-lineno">392</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-252" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-252', 'name', 'link-248');">name</a></tt><tt class="py-op">:</tt> </tt>
<a name="L393"></a><tt class="py-lineno">393</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L394"></a><tt class="py-lineno">394</tt>  <tt class="py-line"> </tt>
<a name="L395"></a><tt class="py-lineno">395</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">vpn</tt><tt class="py-op">,</tt> <tt id="link-253" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-253', 'name', 'link-248');">name</a></tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L396"></a><tt class="py-lineno">396</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-254" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooStartupError" class="py-name" href="#" onclick="return doclink('link-254', 'CuckooStartupError', 'link-23');">CuckooStartupError</a></tt><tt class="py-op">(</tt> </tt>
<a name="L397"></a><tt class="py-lineno">397</tt>  <tt class="py-line">                    <tt class="py-string">"Could not find VPN configuration for %s"</tt> <tt class="py-op">%</tt> <tt id="link-255" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-255', 'name', 'link-248');">name</a></tt> </tt>
<a name="L398"></a><tt class="py-lineno">398</tt>  <tt class="py-line">                <tt class="py-op">)</tt> </tt>
<a name="L399"></a><tt class="py-lineno">399</tt>  <tt class="py-line"> </tt>
<a name="L400"></a><tt class="py-lineno">400</tt>  <tt class="py-line">            <tt class="py-name">entry</tt> <tt class="py-op">=</tt> <tt class="py-name">vpn</tt><tt class="py-op">.</tt><tt id="link-256" class="py-name" targets="Method lib.cuckoo.common.config.Config.get()=lib.cuckoo.common.config.Config-class.html#get,Method lib.cuckoo.core.guest.GuestManager.get()=lib.cuckoo.core.guest.GuestManager-class.html#get"><a title="lib.cuckoo.common.config.Config.get
lib.cuckoo.core.guest.GuestManager.get" class="py-name" href="#" onclick="return doclink('link-256', 'get', 'link-256');">get</a></tt><tt class="py-op">(</tt><tt id="link-257" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-257', 'name', 'link-248');">name</a></tt><tt class="py-op">)</tt> </tt>
<a name="L401"></a><tt class="py-lineno">401</tt>  <tt class="py-line"> </tt>
<a name="L402"></a><tt class="py-lineno">402</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-258" class="py-name"><a title="lib.cuckoo.core.rooter
lib.cuckoo.core.rooter.rooter" class="py-name" href="#" onclick="return doclink('link-258', 'rooter', 'link-57');">rooter</a></tt><tt class="py-op">(</tt><tt class="py-string">"nic_available"</tt><tt class="py-op">,</tt> <tt class="py-name">entry</tt><tt class="py-op">.</tt><tt id="link-259" class="py-name" targets="Variable lib.cuckoo.core.database.Machine.interface=lib.cuckoo.core.database.Machine-class.html#interface"><a title="lib.cuckoo.core.database.Machine.interface" class="py-name" href="#" onclick="return doclink('link-259', 'interface', 'link-259');">interface</a></tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L403"></a><tt class="py-lineno">403</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-260" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooStartupError" class="py-name" href="#" onclick="return doclink('link-260', 'CuckooStartupError', 'link-23');">CuckooStartupError</a></tt><tt class="py-op">(</tt> </tt>
<a name="L404"></a><tt class="py-lineno">404</tt>  <tt class="py-line">                    <tt class="py-string">"The network interface that has been configured for "</tt> </tt>
<a name="L405"></a><tt class="py-lineno">405</tt>  <tt class="py-line">                    <tt class="py-string">"VPN %s is not available."</tt> <tt class="py-op">%</tt> <tt class="py-name">entry</tt><tt class="py-op">.</tt><tt id="link-261" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-261', 'name', 'link-248');">name</a></tt> </tt>
<a name="L406"></a><tt class="py-lineno">406</tt>  <tt class="py-line">                <tt class="py-op">)</tt> </tt>
<a name="L407"></a><tt class="py-lineno">407</tt>  <tt class="py-line"> </tt>
<a name="L408"></a><tt class="py-lineno">408</tt>  <tt class="py-line">            <tt id="link-262" class="py-name"><a title="lib.cuckoo.core.rooter.vpns" class="py-name" href="#" onclick="return doclink('link-262', 'vpns', 'link-59');">vpns</a></tt><tt class="py-op">[</tt><tt class="py-name">entry</tt><tt class="py-op">.</tt><tt id="link-263" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-263', 'name', 'link-248');">name</a></tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">entry</tt> </tt>
<a name="L409"></a><tt class="py-lineno">409</tt>  <tt class="py-line"> </tt>
<a name="L410"></a><tt class="py-lineno">410</tt>  <tt class="py-line">            <tt class="py-comment"># Disable &amp; enable NAT on this network interface. Disable it just</tt> </tt>
<a name="L411"></a><tt class="py-lineno">411</tt>  <tt class="py-line">            <tt class="py-comment"># in case we still had the same rule from a previous run.</tt> </tt>
<a name="L412"></a><tt class="py-lineno">412</tt>  <tt class="py-line">            <tt id="link-264" class="py-name"><a title="lib.cuckoo.core.rooter
lib.cuckoo.core.rooter.rooter" class="py-name" href="#" onclick="return doclink('link-264', 'rooter', 'link-57');">rooter</a></tt><tt class="py-op">(</tt><tt class="py-string">"disable_nat"</tt><tt class="py-op">,</tt> <tt class="py-name">entry</tt><tt class="py-op">.</tt><tt id="link-265" class="py-name"><a title="lib.cuckoo.core.database.Machine.interface" class="py-name" href="#" onclick="return doclink('link-265', 'interface', 'link-259');">interface</a></tt><tt class="py-op">)</tt> </tt>
<a name="L413"></a><tt class="py-lineno">413</tt>  <tt class="py-line">            <tt id="link-266" class="py-name"><a title="lib.cuckoo.core.rooter
lib.cuckoo.core.rooter.rooter" class="py-name" href="#" onclick="return doclink('link-266', 'rooter', 'link-57');">rooter</a></tt><tt class="py-op">(</tt><tt class="py-string">"enable_nat"</tt><tt class="py-op">,</tt> <tt class="py-name">entry</tt><tt class="py-op">.</tt><tt id="link-267" class="py-name"><a title="lib.cuckoo.core.database.Machine.interface" class="py-name" href="#" onclick="return doclink('link-267', 'interface', 'link-259');">interface</a></tt><tt class="py-op">)</tt> </tt>
<a name="L414"></a><tt class="py-lineno">414</tt>  <tt class="py-line"> </tt>
<a name="L415"></a><tt class="py-lineno">415</tt>  <tt class="py-line">    <tt class="py-comment"># Check whether the default VPN exists if specified.</tt> </tt>
<a name="L416"></a><tt class="py-lineno">416</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-268" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-268', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt class="py-name">routing</tt><tt class="py-op">.</tt><tt id="link-269" class="py-name"><a title="lib.cuckoo.core.database.Task.route" class="py-name" href="#" onclick="return doclink('link-269', 'route', 'link-232');">route</a></tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt class="py-op">(</tt><tt class="py-string">"none"</tt><tt class="py-op">,</tt> <tt class="py-string">"internet"</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L417"></a><tt class="py-lineno">417</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">vpn</tt><tt class="py-op">.</tt><tt class="py-name">vpn</tt><tt class="py-op">.</tt><tt id="link-270" class="py-name"><a title="lib.cuckoo.common.abstracts.Processing.enabled
lib.cuckoo.common.abstracts.Signature.enabled
modules.signatures.creates_exe.CreatesExe.enabled
modules.signatures.generic_metrics.SystemMetrics.enabled" class="py-name" href="#" onclick="return doclink('link-270', 'enabled', 'link-230');">enabled</a></tt><tt class="py-op">:</tt> </tt>
<a name="L418"></a><tt class="py-lineno">418</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-271" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooStartupError" class="py-name" href="#" onclick="return doclink('link-271', 'CuckooStartupError', 'link-23');">CuckooStartupError</a></tt><tt class="py-op">(</tt> </tt>
<a name="L419"></a><tt class="py-lineno">419</tt>  <tt class="py-line">                <tt class="py-string">"A VPN has been configured as default routing interface for "</tt> </tt>
<a name="L420"></a><tt class="py-lineno">420</tt>  <tt class="py-line">                <tt class="py-string">"VMs, but VPNs have not been enabled in vpn.conf"</tt> </tt>
<a name="L421"></a><tt class="py-lineno">421</tt>  <tt class="py-line">            <tt class="py-op">)</tt> </tt>
<a name="L422"></a><tt class="py-lineno">422</tt>  <tt class="py-line"> </tt>
<a name="L423"></a><tt class="py-lineno">423</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-272" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-272', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt class="py-name">routing</tt><tt class="py-op">.</tt><tt id="link-273" class="py-name"><a title="lib.cuckoo.core.database.Task.route" class="py-name" href="#" onclick="return doclink('link-273', 'route', 'link-232');">route</a></tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt id="link-274" class="py-name"><a title="lib.cuckoo.core.rooter.vpns" class="py-name" href="#" onclick="return doclink('link-274', 'vpns', 'link-59');">vpns</a></tt><tt class="py-op">:</tt> </tt>
<a name="L424"></a><tt class="py-lineno">424</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-275" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooStartupError" class="py-name" href="#" onclick="return doclink('link-275', 'CuckooStartupError', 'link-23');">CuckooStartupError</a></tt><tt class="py-op">(</tt> </tt>
<a name="L425"></a><tt class="py-lineno">425</tt>  <tt class="py-line">                <tt class="py-string">"The VPN defined as default routing target has not been "</tt> </tt>
<a name="L426"></a><tt class="py-lineno">426</tt>  <tt class="py-line">                <tt class="py-string">"configured in vpn.conf."</tt> </tt>
<a name="L427"></a><tt class="py-lineno">427</tt>  <tt class="py-line">            <tt class="py-op">)</tt> </tt>
<a name="L428"></a><tt class="py-lineno">428</tt>  <tt class="py-line"> </tt>
<a name="L429"></a><tt class="py-lineno">429</tt>  <tt class="py-line">    <tt class="py-comment"># Check whether the dirty line exists if it has been defined.</tt> </tt>
<a name="L430"></a><tt class="py-lineno">430</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-276" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-276', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt class="py-name">routing</tt><tt class="py-op">.</tt><tt class="py-name">internet</tt> <tt class="py-op">!=</tt> <tt class="py-string">"none"</tt><tt class="py-op">:</tt> </tt>
<a name="L431"></a><tt class="py-lineno">431</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-277" class="py-name"><a title="lib.cuckoo.core.rooter
lib.cuckoo.core.rooter.rooter" class="py-name" href="#" onclick="return doclink('link-277', 'rooter', 'link-57');">rooter</a></tt><tt class="py-op">(</tt><tt class="py-string">"nic_available"</tt><tt class="py-op">,</tt> <tt id="link-278" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-278', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt class="py-name">routing</tt><tt class="py-op">.</tt><tt class="py-name">internet</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L432"></a><tt class="py-lineno">432</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-279" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooStartupError" class="py-name" href="#" onclick="return doclink('link-279', 'CuckooStartupError', 'link-23');">CuckooStartupError</a></tt><tt class="py-op">(</tt> </tt>
<a name="L433"></a><tt class="py-lineno">433</tt>  <tt class="py-line">                <tt class="py-string">"The network interface that has been configured as dirty "</tt> </tt>
<a name="L434"></a><tt class="py-lineno">434</tt>  <tt class="py-line">                <tt class="py-string">"line is not available."</tt> </tt>
<a name="L435"></a><tt class="py-lineno">435</tt>  <tt class="py-line">            <tt class="py-op">)</tt> </tt>
<a name="L436"></a><tt class="py-lineno">436</tt>  <tt class="py-line"> </tt>
<a name="L437"></a><tt class="py-lineno">437</tt>  <tt class="py-line">        <tt class="py-comment"># Enable NAT for this network interface.</tt> </tt>
<a name="L438"></a><tt class="py-lineno">438</tt>  <tt class="py-line">        <tt id="link-280" class="py-name"><a title="lib.cuckoo.core.rooter
lib.cuckoo.core.rooter.rooter" class="py-name" href="#" onclick="return doclink('link-280', 'rooter', 'link-57');">rooter</a></tt><tt class="py-op">(</tt><tt class="py-string">"enable_nat"</tt><tt class="py-op">,</tt> <tt id="link-281" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-281', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt class="py-name">routing</tt><tt class="py-op">.</tt><tt class="py-name">internet</tt><tt class="py-op">)</tt> </tt>
</div><a name="L439"></a><tt class="py-lineno">439</tt>  <tt class="py-line"> </tt>
<a name="cuckoo_clean"></a><div id="cuckoo_clean-def"><a name="L440"></a><tt class="py-lineno">440</tt> <a class="py-toggle" href="#" id="cuckoo_clean-toggle" onclick="return toggle('cuckoo_clean');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.startup-module.html#cuckoo_clean">cuckoo_clean</a><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="cuckoo_clean-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="cuckoo_clean-expanded"><a name="L441"></a><tt class="py-lineno">441</tt>  <tt class="py-line">    <tt class="py-docstring">"""Clean up cuckoo setup.</tt> </tt>
<a name="L442"></a><tt class="py-lineno">442</tt>  <tt class="py-line"><tt class="py-docstring">    It deletes logs, all stored data from file system and configured</tt> </tt>
<a name="L443"></a><tt class="py-lineno">443</tt>  <tt class="py-line"><tt class="py-docstring">    databases (SQL and MongoDB).</tt> </tt>
<a name="L444"></a><tt class="py-lineno">444</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L445"></a><tt class="py-lineno">445</tt>  <tt class="py-line">    <tt class="py-comment"># Init logging.</tt> </tt>
<a name="L446"></a><tt class="py-lineno">446</tt>  <tt class="py-line">    <tt class="py-comment"># This need to init a console logger handler, because the standard</tt> </tt>
<a name="L447"></a><tt class="py-lineno">447</tt>  <tt class="py-line">    <tt class="py-comment"># logger (init_logging()) logs to a file which will be deleted.</tt> </tt>
<a name="L448"></a><tt class="py-lineno">448</tt>  <tt class="py-line">    <tt id="link-282" class="py-name" targets="Function lib.cuckoo.core.startup.create_structure()=lib.cuckoo.core.startup-module.html#create_structure"><a title="lib.cuckoo.core.startup.create_structure" class="py-name" href="#" onclick="return doclink('link-282', 'create_structure', 'link-282');">create_structure</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L449"></a><tt class="py-lineno">449</tt>  <tt class="py-line">    <tt id="link-283" class="py-name" targets="Function lib.cuckoo.core.startup.init_console_logging()=lib.cuckoo.core.startup-module.html#init_console_logging"><a title="lib.cuckoo.core.startup.init_console_logging" class="py-name" href="#" onclick="return doclink('link-283', 'init_console_logging', 'link-283');">init_console_logging</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L450"></a><tt class="py-lineno">450</tt>  <tt class="py-line"> </tt>
<a name="L451"></a><tt class="py-lineno">451</tt>  <tt class="py-line">    <tt class="py-comment"># Initialize the database connection.</tt> </tt>
<a name="L452"></a><tt class="py-lineno">452</tt>  <tt class="py-line">    <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L453"></a><tt class="py-lineno">453</tt>  <tt class="py-line">        <tt id="link-284" class="py-name"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-284', 'db', 'link-100');">db</a></tt> <tt class="py-op">=</tt> <tt id="link-285" class="py-name"><a title="lib.cuckoo.core.database.Database" class="py-name" href="#" onclick="return doclink('link-285', 'Database', 'link-39');">Database</a></tt><tt class="py-op">(</tt><tt class="py-name">schema_check</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt> </tt>
<a name="L454"></a><tt class="py-lineno">454</tt>  <tt class="py-line">    <tt class="py-keyword">except</tt> <tt id="link-286" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooDatabaseError" class="py-name" href="#" onclick="return doclink('link-286', 'CuckooDatabaseError', 'link-24');">CuckooDatabaseError</a></tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L455"></a><tt class="py-lineno">455</tt>  <tt class="py-line">        <tt class="py-comment"># If something is screwed due to incorrect database migrations or bad</tt> </tt>
<a name="L456"></a><tt class="py-lineno">456</tt>  <tt class="py-line">        <tt class="py-comment"># database SqlAlchemy would be unable to connect and operate.</tt> </tt>
<a name="L457"></a><tt class="py-lineno">457</tt>  <tt class="py-line">        <tt id="link-287" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-287', 'log', 'link-62');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">warning</tt><tt class="py-op">(</tt><tt class="py-string">"Error connecting to database: it is suggested to check "</tt> </tt>
<a name="L458"></a><tt class="py-lineno">458</tt>  <tt class="py-line">                    <tt class="py-string">"the connectivity, apply all migrations if needed or purge "</tt> </tt>
<a name="L459"></a><tt class="py-lineno">459</tt>  <tt class="py-line">                    <tt class="py-string">"it manually. Error description: %s"</tt><tt class="py-op">,</tt> <tt class="py-name">e</tt><tt class="py-op">)</tt> </tt>
<a name="L460"></a><tt class="py-lineno">460</tt>  <tt class="py-line">    <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L461"></a><tt class="py-lineno">461</tt>  <tt class="py-line">        <tt class="py-comment"># Drop all tables.</tt> </tt>
<a name="L462"></a><tt class="py-lineno">462</tt>  <tt class="py-line">        <tt id="link-288" class="py-name"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-288', 'db', 'link-100');">db</a></tt><tt class="py-op">.</tt><tt id="link-289" class="py-name" targets="Method lib.cuckoo.core.database.Database.drop()=lib.cuckoo.core.database.Database-class.html#drop"><a title="lib.cuckoo.core.database.Database.drop" class="py-name" href="#" onclick="return doclink('link-289', 'drop', 'link-289');">drop</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L463"></a><tt class="py-lineno">463</tt>  <tt class="py-line"> </tt>
<a name="L464"></a><tt class="py-lineno">464</tt>  <tt class="py-line">    <tt class="py-comment"># Check if MongoDB reporting is enabled and drop that if it is.</tt> </tt>
<a name="L465"></a><tt class="py-lineno">465</tt>  <tt class="py-line">    <tt id="link-290" class="py-name"><a title="lib.cuckoo.core.rooter.cfg
modules.auxiliary.services.cfg
modules.processing.network.cfg" class="py-name" href="#" onclick="return doclink('link-290', 'cfg', 'link-89');">cfg</a></tt> <tt class="py-op">=</tt> <tt id="link-291" class="py-name"><a title="lib.cuckoo.common.config.Config" class="py-name" href="#" onclick="return doclink('link-291', 'Config', 'link-12');">Config</a></tt><tt class="py-op">(</tt><tt class="py-string">"reporting"</tt><tt class="py-op">)</tt> </tt>
<a name="L466"></a><tt class="py-lineno">466</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt id="link-292" class="py-name"><a title="lib.cuckoo.core.rooter.cfg
modules.auxiliary.services.cfg
modules.processing.network.cfg" class="py-name" href="#" onclick="return doclink('link-292', 'cfg', 'link-89');">cfg</a></tt><tt class="py-op">.</tt><tt id="link-293" class="py-name" targets="Module modules.reporting.mongodb=modules.reporting.mongodb-module.html"><a title="modules.reporting.mongodb" class="py-name" href="#" onclick="return doclink('link-293', 'mongodb', 'link-293');">mongodb</a></tt> <tt class="py-keyword">and</tt> <tt id="link-294" class="py-name"><a title="lib.cuckoo.core.rooter.cfg
modules.auxiliary.services.cfg
modules.processing.network.cfg" class="py-name" href="#" onclick="return doclink('link-294', 'cfg', 'link-89');">cfg</a></tt><tt class="py-op">.</tt><tt id="link-295" class="py-name"><a title="modules.reporting.mongodb" class="py-name" href="#" onclick="return doclink('link-295', 'mongodb', 'link-293');">mongodb</a></tt><tt class="py-op">.</tt><tt id="link-296" class="py-name"><a title="lib.cuckoo.common.abstracts.Processing.enabled
lib.cuckoo.common.abstracts.Signature.enabled
modules.signatures.creates_exe.CreatesExe.enabled
modules.signatures.generic_metrics.SystemMetrics.enabled" class="py-name" href="#" onclick="return doclink('link-296', 'enabled', 'link-230');">enabled</a></tt><tt class="py-op">:</tt> </tt>
<a name="L467"></a><tt class="py-lineno">467</tt>  <tt class="py-line">        <tt class="py-keyword">from</tt> <tt class="py-name">pymongo</tt> <tt class="py-keyword">import</tt> <tt class="py-name">MongoClient</tt> </tt>
<a name="L468"></a><tt class="py-lineno">468</tt>  <tt class="py-line">        <tt class="py-name">host</tt> <tt class="py-op">=</tt> <tt id="link-297" class="py-name"><a title="lib.cuckoo.core.rooter.cfg
modules.auxiliary.services.cfg
modules.processing.network.cfg" class="py-name" href="#" onclick="return doclink('link-297', 'cfg', 'link-89');">cfg</a></tt><tt class="py-op">.</tt><tt id="link-298" class="py-name"><a title="modules.reporting.mongodb" class="py-name" href="#" onclick="return doclink('link-298', 'mongodb', 'link-293');">mongodb</a></tt><tt class="py-op">.</tt><tt id="link-299" class="py-name"><a title="lib.cuckoo.common.config.Config.get
lib.cuckoo.core.guest.GuestManager.get" class="py-name" href="#" onclick="return doclink('link-299', 'get', 'link-256');">get</a></tt><tt class="py-op">(</tt><tt class="py-string">"host"</tt><tt class="py-op">,</tt> <tt class="py-string">"127.0.0.1"</tt><tt class="py-op">)</tt> </tt>
<a name="L469"></a><tt class="py-lineno">469</tt>  <tt class="py-line">        <tt class="py-name">port</tt> <tt class="py-op">=</tt> <tt id="link-300" class="py-name"><a title="lib.cuckoo.core.rooter.cfg
modules.auxiliary.services.cfg
modules.processing.network.cfg" class="py-name" href="#" onclick="return doclink('link-300', 'cfg', 'link-89');">cfg</a></tt><tt class="py-op">.</tt><tt id="link-301" class="py-name"><a title="modules.reporting.mongodb" class="py-name" href="#" onclick="return doclink('link-301', 'mongodb', 'link-293');">mongodb</a></tt><tt class="py-op">.</tt><tt id="link-302" class="py-name"><a title="lib.cuckoo.common.config.Config.get
lib.cuckoo.core.guest.GuestManager.get" class="py-name" href="#" onclick="return doclink('link-302', 'get', 'link-256');">get</a></tt><tt class="py-op">(</tt><tt class="py-string">"port"</tt><tt class="py-op">,</tt> <tt class="py-number">27017</tt><tt class="py-op">)</tt> </tt>
<a name="L470"></a><tt class="py-lineno">470</tt>  <tt class="py-line">        <tt class="py-name">mdb</tt> <tt class="py-op">=</tt> <tt id="link-303" class="py-name"><a title="lib.cuckoo.core.rooter.cfg
modules.auxiliary.services.cfg
modules.processing.network.cfg" class="py-name" href="#" onclick="return doclink('link-303', 'cfg', 'link-89');">cfg</a></tt><tt class="py-op">.</tt><tt id="link-304" class="py-name"><a title="modules.reporting.mongodb" class="py-name" href="#" onclick="return doclink('link-304', 'mongodb', 'link-293');">mongodb</a></tt><tt class="py-op">.</tt><tt id="link-305" class="py-name"><a title="lib.cuckoo.common.config.Config.get
lib.cuckoo.core.guest.GuestManager.get" class="py-name" href="#" onclick="return doclink('link-305', 'get', 'link-256');">get</a></tt><tt class="py-op">(</tt><tt class="py-string">"db"</tt><tt class="py-op">,</tt> <tt class="py-string">"cuckoo"</tt><tt class="py-op">)</tt> </tt>
<a name="L471"></a><tt class="py-lineno">471</tt>  <tt class="py-line">        <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L472"></a><tt class="py-lineno">472</tt>  <tt class="py-line">            <tt class="py-name">conn</tt> <tt class="py-op">=</tt> <tt class="py-name">MongoClient</tt><tt class="py-op">(</tt><tt class="py-name">host</tt><tt class="py-op">,</tt> <tt class="py-name">port</tt><tt class="py-op">)</tt> </tt>
<a name="L473"></a><tt class="py-lineno">473</tt>  <tt class="py-line">            <tt class="py-name">conn</tt><tt class="py-op">.</tt><tt class="py-name">drop_database</tt><tt class="py-op">(</tt><tt class="py-name">mdb</tt><tt class="py-op">)</tt> </tt>
<a name="L474"></a><tt class="py-lineno">474</tt>  <tt class="py-line">            <tt class="py-name">conn</tt><tt class="py-op">.</tt><tt id="link-306" class="py-name" targets="Method lib.cuckoo.common.netlog.BsonParser.close()=lib.cuckoo.common.netlog.BsonParser-class.html#close,Method lib.cuckoo.core.resultserver.FileUpload.close()=lib.cuckoo.core.resultserver.FileUpload-class.html#close,Method lib.cuckoo.core.resultserver.LogHandler.close()=lib.cuckoo.core.resultserver.LogHandler-class.html#close,Method modules.processing.network.SortCap.close()=modules.processing.network.SortCap-class.html#close"><a title="lib.cuckoo.common.netlog.BsonParser.close
lib.cuckoo.core.resultserver.FileUpload.close
lib.cuckoo.core.resultserver.LogHandler.close
modules.processing.network.SortCap.close" class="py-name" href="#" onclick="return doclink('link-306', 'close', 'link-306');">close</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L475"></a><tt class="py-lineno">475</tt>  <tt class="py-line">        <tt class="py-keyword">except</tt><tt class="py-op">:</tt> </tt>
<a name="L476"></a><tt class="py-lineno">476</tt>  <tt class="py-line">            <tt id="link-307" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-307', 'log', 'link-62');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">warning</tt><tt class="py-op">(</tt><tt class="py-string">"Unable to drop MongoDB database: %s"</tt><tt class="py-op">,</tt> <tt class="py-name">mdb</tt><tt class="py-op">)</tt> </tt>
<a name="L477"></a><tt class="py-lineno">477</tt>  <tt class="py-line"> </tt>
<a name="L478"></a><tt class="py-lineno">478</tt>  <tt class="py-line">    <tt class="py-comment"># Paths to clean.</tt> </tt>
<a name="L479"></a><tt class="py-lineno">479</tt>  <tt class="py-line">    <tt class="py-name">paths</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt> </tt>
<a name="L480"></a><tt class="py-lineno">480</tt>  <tt class="py-line">        <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt id="link-308" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_ROOT" class="py-name" href="#" onclick="return doclink('link-308', 'CUCKOO_ROOT', 'link-17');">CUCKOO_ROOT</a></tt><tt class="py-op">,</tt> <tt class="py-string">"db"</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> </tt>
<a name="L481"></a><tt class="py-lineno">481</tt>  <tt class="py-line">        <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt id="link-309" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_ROOT" class="py-name" href="#" onclick="return doclink('link-309', 'CUCKOO_ROOT', 'link-17');">CUCKOO_ROOT</a></tt><tt class="py-op">,</tt> <tt class="py-string">"log"</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> </tt>
<a name="L482"></a><tt class="py-lineno">482</tt>  <tt class="py-line">        <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt id="link-310" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_ROOT" class="py-name" href="#" onclick="return doclink('link-310', 'CUCKOO_ROOT', 'link-17');">CUCKOO_ROOT</a></tt><tt class="py-op">,</tt> <tt class="py-string">"storage"</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> </tt>
<a name="L483"></a><tt class="py-lineno">483</tt>  <tt class="py-line">    <tt class="py-op">]</tt> </tt>
<a name="L484"></a><tt class="py-lineno">484</tt>  <tt class="py-line"> </tt>
<a name="L485"></a><tt class="py-lineno">485</tt>  <tt class="py-line">    <tt class="py-comment"># Delete various directories.</tt> </tt>
<a name="L486"></a><tt class="py-lineno">486</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">path</tt> <tt class="py-keyword">in</tt> <tt class="py-name">paths</tt><tt class="py-op">:</tt> </tt>
<a name="L487"></a><tt class="py-lineno">487</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">isdir</tt><tt class="py-op">(</tt><tt class="py-name">path</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L488"></a><tt class="py-lineno">488</tt>  <tt class="py-line">            <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L489"></a><tt class="py-lineno">489</tt>  <tt class="py-line">                <tt class="py-name">shutil</tt><tt class="py-op">.</tt><tt class="py-name">rmtree</tt><tt class="py-op">(</tt><tt class="py-name">path</tt><tt class="py-op">)</tt> </tt>
<a name="L490"></a><tt class="py-lineno">490</tt>  <tt class="py-line">            <tt class="py-keyword">except</tt> <tt class="py-op">(</tt><tt class="py-name">IOError</tt><tt class="py-op">,</tt> <tt class="py-name">OSError</tt><tt class="py-op">)</tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L491"></a><tt class="py-lineno">491</tt>  <tt class="py-line">                <tt id="link-311" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-311', 'log', 'link-62');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">warning</tt><tt class="py-op">(</tt><tt class="py-string">"Error removing directory %s: %s"</tt><tt class="py-op">,</tt> <tt class="py-name">path</tt><tt class="py-op">,</tt> <tt class="py-name">e</tt><tt class="py-op">)</tt> </tt>
<a name="L492"></a><tt class="py-lineno">492</tt>  <tt class="py-line"> </tt>
<a name="L493"></a><tt class="py-lineno">493</tt>  <tt class="py-line">    <tt class="py-comment"># Delete all compiled Python objects ("*.pyc").</tt> </tt>
<a name="L494"></a><tt class="py-lineno">494</tt>  <tt class="py-line">    <tt class="py-keyword">for</tt> <tt class="py-name">dirpath</tt><tt class="py-op">,</tt> <tt class="py-name">dirnames</tt><tt class="py-op">,</tt> <tt class="py-name">filenames</tt> <tt class="py-keyword">in</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">walk</tt><tt class="py-op">(</tt><tt id="link-312" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_ROOT" class="py-name" href="#" onclick="return doclink('link-312', 'CUCKOO_ROOT', 'link-17');">CUCKOO_ROOT</a></tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L495"></a><tt class="py-lineno">495</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">fname</tt> <tt class="py-keyword">in</tt> <tt class="py-name">filenames</tt><tt class="py-op">:</tt> </tt>
<a name="L496"></a><tt class="py-lineno">496</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">fname</tt><tt class="py-op">.</tt><tt class="py-name">endswith</tt><tt class="py-op">(</tt><tt class="py-string">".pyc"</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L497"></a><tt class="py-lineno">497</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L498"></a><tt class="py-lineno">498</tt>  <tt class="py-line"> </tt>
<a name="L499"></a><tt class="py-lineno">499</tt>  <tt class="py-line">            <tt class="py-comment"># We don't want to delete the Android's Agent .pyc files (as we</tt> </tt>
<a name="L500"></a><tt class="py-lineno">500</tt>  <tt class="py-line">            <tt class="py-comment"># don't ship the original .py files and thus they're critical).</tt> </tt>
<a name="L501"></a><tt class="py-lineno">501</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-string">"agent/android/python_agent"</tt> <tt class="py-keyword">in</tt> <tt class="py-name">dirpath</tt><tt class="py-op">.</tt><tt class="py-name">replace</tt><tt class="py-op">(</tt><tt class="py-string">"\\"</tt><tt class="py-op">,</tt> <tt class="py-string">"/"</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L502"></a><tt class="py-lineno">502</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L503"></a><tt class="py-lineno">503</tt>  <tt class="py-line"> </tt>
<a name="L504"></a><tt class="py-lineno">504</tt>  <tt class="py-line">            <tt class="py-name">path</tt> <tt class="py-op">=</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt class="py-name">dirpath</tt><tt class="py-op">,</tt> <tt class="py-name">fname</tt><tt class="py-op">)</tt> </tt>
<a name="L505"></a><tt class="py-lineno">505</tt>  <tt class="py-line"> </tt>
<a name="L506"></a><tt class="py-lineno">506</tt>  <tt class="py-line">            <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L507"></a><tt class="py-lineno">507</tt>  <tt class="py-line">                <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">unlink</tt><tt class="py-op">(</tt><tt class="py-name">path</tt><tt class="py-op">)</tt> </tt>
<a name="L508"></a><tt class="py-lineno">508</tt>  <tt class="py-line">            <tt class="py-keyword">except</tt> <tt class="py-op">(</tt><tt class="py-name">IOError</tt><tt class="py-op">,</tt> <tt class="py-name">OSError</tt><tt class="py-op">)</tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L509"></a><tt class="py-lineno">509</tt>  <tt class="py-line">                <tt id="link-313" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-313', 'log', 'link-62');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">warning</tt><tt class="py-op">(</tt><tt class="py-string">"Error removing file %s: %s"</tt><tt class="py-op">,</tt> <tt class="py-name">path</tt><tt class="py-op">,</tt> <tt class="py-name">e</tt><tt class="py-op">)</tt> </tt>
</div><a name="L510"></a><tt class="py-lineno">510</tt>  <tt class="py-line"> </tt>
<a name="drop_privileges"></a><div id="drop_privileges-def"><a name="L511"></a><tt class="py-lineno">511</tt> <a class="py-toggle" href="#" id="drop_privileges-toggle" onclick="return toggle('drop_privileges');">-</a><tt class="py-line"><tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.startup-module.html#drop_privileges">drop_privileges</a><tt class="py-op">(</tt><tt class="py-param">username</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="drop_privileges-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="drop_privileges-expanded"><a name="L512"></a><tt class="py-lineno">512</tt>  <tt class="py-line">    <tt class="py-docstring">"""Drops privileges to selected user.</tt> </tt>
<a name="L513"></a><tt class="py-lineno">513</tt>  <tt class="py-line"><tt class="py-docstring">    @param username: drop privileges to this username</tt> </tt>
<a name="L514"></a><tt class="py-lineno">514</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L515"></a><tt class="py-lineno">515</tt>  <tt class="py-line">    <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-314" class="py-name"><a title="lib.cuckoo.core.startup.HAVE_PWD" class="py-name" href="#" onclick="return doclink('link-314', 'HAVE_PWD', 'link-60');">HAVE_PWD</a></tt><tt class="py-op">:</tt> </tt>
<a name="L516"></a><tt class="py-lineno">516</tt>  <tt class="py-line">        <tt class="py-name">sys</tt><tt class="py-op">.</tt><tt class="py-name">exit</tt><tt class="py-op">(</tt><tt class="py-string">"Unable to import pwd required for dropping "</tt> </tt>
<a name="L517"></a><tt class="py-lineno">517</tt>  <tt class="py-line">                 <tt class="py-string">"privileges (`pip install pwd`)"</tt><tt class="py-op">)</tt> </tt>
<a name="L518"></a><tt class="py-lineno">518</tt>  <tt class="py-line"> </tt>
<a name="L519"></a><tt class="py-lineno">519</tt>  <tt class="py-line">    <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L520"></a><tt class="py-lineno">520</tt>  <tt class="py-line">        <tt class="py-name">user</tt> <tt class="py-op">=</tt> <tt class="py-name">pwd</tt><tt class="py-op">.</tt><tt class="py-name">getpwnam</tt><tt class="py-op">(</tt><tt class="py-name">username</tt><tt class="py-op">)</tt> </tt>
<a name="L521"></a><tt class="py-lineno">521</tt>  <tt class="py-line">        <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">setgroups</tt><tt class="py-op">(</tt><tt class="py-op">(</tt><tt class="py-name">user</tt><tt class="py-op">.</tt><tt class="py-name">pw_gid</tt><tt class="py-op">,</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L522"></a><tt class="py-lineno">522</tt>  <tt class="py-line">        <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">setgid</tt><tt class="py-op">(</tt><tt class="py-name">user</tt><tt class="py-op">.</tt><tt class="py-name">pw_gid</tt><tt class="py-op">)</tt> </tt>
<a name="L523"></a><tt class="py-lineno">523</tt>  <tt class="py-line">        <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">setuid</tt><tt class="py-op">(</tt><tt class="py-name">user</tt><tt class="py-op">.</tt><tt class="py-name">pw_uid</tt><tt class="py-op">)</tt> </tt>
<a name="L524"></a><tt class="py-lineno">524</tt>  <tt class="py-line">        <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">putenv</tt><tt class="py-op">(</tt><tt class="py-string">"HOME"</tt><tt class="py-op">,</tt> <tt class="py-name">user</tt><tt class="py-op">.</tt><tt class="py-name">pw_dir</tt><tt class="py-op">)</tt> </tt>
<a name="L525"></a><tt class="py-lineno">525</tt>  <tt class="py-line">    <tt class="py-keyword">except</tt> <tt class="py-name">KeyError</tt><tt class="py-op">:</tt> </tt>
<a name="L526"></a><tt class="py-lineno">526</tt>  <tt class="py-line">        <tt class="py-name">sys</tt><tt class="py-op">.</tt><tt class="py-name">exit</tt><tt class="py-op">(</tt><tt class="py-string">"Invalid user specified to drop privileges to: %s"</tt> <tt class="py-op">%</tt> <tt class="py-name">user</tt><tt class="py-op">)</tt> </tt>
<a name="L527"></a><tt class="py-lineno">527</tt>  <tt class="py-line">    <tt class="py-keyword">except</tt> <tt class="py-name">OSError</tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L528"></a><tt class="py-lineno">528</tt>  <tt class="py-line">        <tt class="py-name">sys</tt><tt class="py-op">.</tt><tt class="py-name">exit</tt><tt class="py-op">(</tt><tt class="py-string">"Failed to drop privileges to %s: %s"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt class="py-name">username</tt><tt class="py-op">,</tt> <tt class="py-name">e</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
</div><a name="L529"></a><tt class="py-lineno">529</tt>  <tt class="py-line"> </tt><script type="text/javascript">
<!--
expandto(location.href);
// -->
</script>
</pre>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://cuckoosandbox.org">Cuckoo Sandbox</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Mon Jan 11 19:29:09 2016
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
