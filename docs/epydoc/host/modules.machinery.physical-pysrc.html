<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>modules.machinery.physical</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://cuckoosandbox.org">Cuckoo Sandbox</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="modules-module.html">Package&nbsp;modules</a> ::
        <a href="modules.machinery-module.html">Package&nbsp;machinery</a> ::
        Module&nbsp;physical
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="modules.machinery.physical-pysrc.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<h1 class="epydoc">Source Code for <a href="modules.machinery.physical-module.html">Module modules.machinery.physical</a></h1>
<pre class="py-src">
<a name="L1"></a><tt class="py-lineno">  1</tt>  <tt class="py-line"><tt class="py-comment"># Copyright (C) 2012-2014 The MITRE Corporation.</tt> </tt>
<a name="L2"></a><tt class="py-lineno">  2</tt>  <tt class="py-line"><tt class="py-comment"># This file is part of Cuckoo Sandbox - http://www.cuckoosandbox.org</tt> </tt>
<a name="L3"></a><tt class="py-lineno">  3</tt>  <tt class="py-line"><tt class="py-comment"># See the file 'docs/LICENSE' for copying permission.</tt> </tt>
<a name="L4"></a><tt class="py-lineno">  4</tt>  <tt class="py-line"> </tt>
<a name="L5"></a><tt class="py-lineno">  5</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">socket</tt> </tt>
<a name="L6"></a><tt class="py-lineno">  6</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">logging</tt> </tt>
<a name="L7"></a><tt class="py-lineno">  7</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">xmlrpclib</tt> </tt>
<a name="L8"></a><tt class="py-lineno">  8</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">subprocess</tt> </tt>
<a name="L9"></a><tt class="py-lineno">  9</tt>  <tt class="py-line"> </tt>
<a name="L10"></a><tt class="py-lineno"> 10</tt>  <tt class="py-line"><tt id="link-0" class="py-name" targets="Variable lib.cuckoo.common.abstracts.log=lib.cuckoo.common.abstracts-module.html#log,Variable lib.cuckoo.common.irc.log=lib.cuckoo.common.irc-module.html#log,Variable lib.cuckoo.common.netlog.log=lib.cuckoo.common.netlog-module.html#log,Variable lib.cuckoo.common.objects.log=lib.cuckoo.common.objects-module.html#log,Variable lib.cuckoo.core.database.log=lib.cuckoo.core.database-module.html#log,Variable lib.cuckoo.core.guest.log=lib.cuckoo.core.guest-module.html#log,Variable lib.cuckoo.core.plugins.log=lib.cuckoo.core.plugins-module.html#log,Variable lib.cuckoo.core.resultserver.log=lib.cuckoo.core.resultserver-module.html#log,Variable lib.cuckoo.core.rooter.log=lib.cuckoo.core.rooter-module.html#log,Variable lib.cuckoo.core.scheduler.log=lib.cuckoo.core.scheduler-module.html#log,Variable lib.cuckoo.core.startup.log=lib.cuckoo.core.startup-module.html#log,Variable modules.auxiliary.mitm.log=modules.auxiliary.mitm-module.html#log,Variable modules.auxiliary.services.log=modules.auxiliary.services-module.html#log,Variable modules.auxiliary.sniffer.log=modules.auxiliary.sniffer-module.html#log,Variable modules.machinery.avd.log=modules.machinery.avd-module.html#log,Variable modules.machinery.physical.log=modules.machinery.physical-module.html#log,Variable modules.machinery.qemu.log=modules.machinery.qemu-module.html#log,Variable modules.machinery.virtualbox.log=modules.machinery.virtualbox-module.html#log,Variable modules.machinery.vmware.log=modules.machinery.vmware-module.html#log,Variable modules.machinery.vsphere.log=modules.machinery.vsphere-module.html#log,Variable modules.machinery.xenserver.log=modules.machinery.xenserver-module.html#log,Variable modules.processing.analysisinfo.log=modules.processing.analysisinfo-module.html#log,Variable modules.processing.apkinfo.log=modules.processing.apkinfo-module.html#log,Variable modules.processing.baseline.log=modules.processing.baseline-module.html#log,Variable modules.processing.behavior.log=modules.processing.behavior-module.html#log,Variable modules.processing.droidmon.log=modules.processing.droidmon-module.html#log,Variable modules.processing.dumptls.log=modules.processing.dumptls-module.html#log,Variable modules.processing.googleplay.log=modules.processing.googleplay-module.html#log,Variable modules.processing.memory.log=modules.processing.memory-module.html#log,Variable modules.processing.network.log=modules.processing.network-module.html#log,Variable modules.processing.platform.linux.log=modules.processing.platform.linux-module.html#log,Variable modules.processing.platform.windows.log=modules.processing.platform.windows-module.html#log,Variable modules.processing.screenshots.log=modules.processing.screenshots-module.html#log,Variable modules.processing.snort.log=modules.processing.snort-module.html#log,Variable modules.processing.static.log=modules.processing.static-module.html#log,Variable modules.processing.suricata.log=modules.processing.suricata-module.html#log,Variable modules.processing.virustotal.log=modules.processing.virustotal-module.html#log,Variable modules.reporting.moloch.log=modules.reporting.moloch-module.html#log"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-0', 'log', 'link-0');">log</a></tt> <tt class="py-op">=</tt> <tt class="py-name">logging</tt><tt class="py-op">.</tt><tt class="py-name">getLogger</tt><tt class="py-op">(</tt><tt class="py-name">__name__</tt><tt class="py-op">)</tt> </tt>
<a name="L11"></a><tt class="py-lineno"> 11</tt>  <tt class="py-line"> </tt>
<a name="L12"></a><tt class="py-lineno"> 12</tt>  <tt class="py-line"><tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L13"></a><tt class="py-lineno"> 13</tt>  <tt class="py-line">    <tt class="py-keyword">import</tt> <tt class="py-name">bs4</tt> </tt>
<a name="L14"></a><tt class="py-lineno"> 14</tt>  <tt class="py-line">    <tt class="py-keyword">import</tt> <tt class="py-name">requests</tt> </tt>
<a name="L15"></a><tt class="py-lineno"> 15</tt>  <tt class="py-line">    <tt class="py-keyword">import</tt> <tt class="py-name">wakeonlan</tt><tt class="py-op">.</tt><tt class="py-name">wol</tt> </tt>
<a name="L16"></a><tt class="py-lineno"> 16</tt>  <tt class="py-line">    <tt id="link-1" class="py-name" targets="Variable modules.machinery.physical.HAVE_FOG=modules.machinery.physical-module.html#HAVE_FOG"><a title="modules.machinery.physical.HAVE_FOG" class="py-name" href="#" onclick="return doclink('link-1', 'HAVE_FOG', 'link-1');">HAVE_FOG</a></tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L17"></a><tt class="py-lineno"> 17</tt>  <tt class="py-line"><tt class="py-keyword">except</tt> <tt class="py-name">ImportError</tt><tt class="py-op">:</tt> </tt>
<a name="L18"></a><tt class="py-lineno"> 18</tt>  <tt class="py-line">    <tt id="link-2" class="py-name"><a title="modules.machinery.physical.HAVE_FOG" class="py-name" href="#" onclick="return doclink('link-2', 'HAVE_FOG', 'link-1');">HAVE_FOG</a></tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L19"></a><tt class="py-lineno"> 19</tt>  <tt class="py-line">    <tt id="link-3" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-3', 'log', 'link-0');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">critical</tt><tt class="py-op">(</tt> </tt>
<a name="L20"></a><tt class="py-lineno"> 20</tt>  <tt class="py-line">        <tt class="py-string">"The bs4, requests, and wakeonlan Python libraries are required for "</tt> </tt>
<a name="L21"></a><tt class="py-lineno"> 21</tt>  <tt class="py-line">        <tt class="py-string">"proper FOG integration with Cuckoo (please install them through "</tt> </tt>
<a name="L22"></a><tt class="py-lineno"> 22</tt>  <tt class="py-line">        <tt class="py-string">"`pip install bs4 requests wakeonlan`)."</tt> </tt>
<a name="L23"></a><tt class="py-lineno"> 23</tt>  <tt class="py-line">    <tt class="py-op">)</tt> </tt>
<a name="L24"></a><tt class="py-lineno"> 24</tt>  <tt class="py-line"> </tt>
<a name="L25"></a><tt class="py-lineno"> 25</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-4" class="py-name" targets="Package lib=lib-module.html"><a title="lib" class="py-name" href="#" onclick="return doclink('link-4', 'lib', 'link-4');">lib</a></tt><tt class="py-op">.</tt><tt id="link-5" class="py-name" targets="Package lib.cuckoo=lib.cuckoo-module.html"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-5', 'cuckoo', 'link-5');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-6" class="py-name" targets="Package lib.cuckoo.core=lib.cuckoo.core-module.html"><a title="lib.cuckoo.core" class="py-name" href="#" onclick="return doclink('link-6', 'core', 'link-6');">core</a></tt><tt class="py-op">.</tt><tt id="link-7" class="py-name" targets="Variable lib.cuckoo.core.database.Task.guest=lib.cuckoo.core.database.Task-class.html#guest,Module lib.cuckoo.core.guest=lib.cuckoo.core.guest-module.html"><a title="lib.cuckoo.core.database.Task.guest
lib.cuckoo.core.guest" class="py-name" href="#" onclick="return doclink('link-7', 'guest', 'link-7');">guest</a></tt> <tt class="py-keyword">import</tt> <tt id="link-8" class="py-name" targets="Class lib.cuckoo.core.guest.GuestManager=lib.cuckoo.core.guest.GuestManager-class.html"><a title="lib.cuckoo.core.guest.GuestManager" class="py-name" href="#" onclick="return doclink('link-8', 'GuestManager', 'link-8');">GuestManager</a></tt> </tt>
<a name="L26"></a><tt class="py-lineno"> 26</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-9" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-9', 'lib', 'link-4');">lib</a></tt><tt class="py-op">.</tt><tt id="link-10" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-10', 'cuckoo', 'link-5');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-11" class="py-name" targets="Package lib.cuckoo.common=lib.cuckoo.common-module.html"><a title="lib.cuckoo.common" class="py-name" href="#" onclick="return doclink('link-11', 'common', 'link-11');">common</a></tt><tt class="py-op">.</tt><tt id="link-12" class="py-name" targets="Module lib.cuckoo.common.abstracts=lib.cuckoo.common.abstracts-module.html"><a title="lib.cuckoo.common.abstracts" class="py-name" href="#" onclick="return doclink('link-12', 'abstracts', 'link-12');">abstracts</a></tt> <tt class="py-keyword">import</tt> <tt id="link-13" class="py-name" targets="Class lib.cuckoo.common.abstracts.Machinery=lib.cuckoo.common.abstracts.Machinery-class.html"><a title="lib.cuckoo.common.abstracts.Machinery" class="py-name" href="#" onclick="return doclink('link-13', 'Machinery', 'link-13');">Machinery</a></tt> </tt>
<a name="L27"></a><tt class="py-lineno"> 27</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-14" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-14', 'lib', 'link-4');">lib</a></tt><tt class="py-op">.</tt><tt id="link-15" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-15', 'cuckoo', 'link-5');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-16" class="py-name"><a title="lib.cuckoo.common" class="py-name" href="#" onclick="return doclink('link-16', 'common', 'link-11');">common</a></tt><tt class="py-op">.</tt><tt id="link-17" class="py-name" targets="Module lib.cuckoo.common.exceptions=lib.cuckoo.common.exceptions-module.html"><a title="lib.cuckoo.common.exceptions" class="py-name" href="#" onclick="return doclink('link-17', 'exceptions', 'link-17');">exceptions</a></tt> <tt class="py-keyword">import</tt> <tt id="link-18" class="py-name" targets="Class lib.cuckoo.common.exceptions.CuckooCriticalError=lib.cuckoo.common.exceptions.CuckooCriticalError-class.html"><a title="lib.cuckoo.common.exceptions.CuckooCriticalError" class="py-name" href="#" onclick="return doclink('link-18', 'CuckooCriticalError', 'link-18');">CuckooCriticalError</a></tt> </tt>
<a name="L28"></a><tt class="py-lineno"> 28</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-19" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-19', 'lib', 'link-4');">lib</a></tt><tt class="py-op">.</tt><tt id="link-20" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-20', 'cuckoo', 'link-5');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-21" class="py-name"><a title="lib.cuckoo.common" class="py-name" href="#" onclick="return doclink('link-21', 'common', 'link-11');">common</a></tt><tt class="py-op">.</tt><tt id="link-22" class="py-name"><a title="lib.cuckoo.common.exceptions" class="py-name" href="#" onclick="return doclink('link-22', 'exceptions', 'link-17');">exceptions</a></tt> <tt class="py-keyword">import</tt> <tt id="link-23" class="py-name" targets="Class lib.cuckoo.common.exceptions.CuckooMachineError=lib.cuckoo.common.exceptions.CuckooMachineError-class.html"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-23', 'CuckooMachineError', 'link-23');">CuckooMachineError</a></tt> </tt>
<a name="L29"></a><tt class="py-lineno"> 29</tt>  <tt class="py-line"> </tt>
<a name="Physical"></a><div id="Physical-def"><a name="L30"></a><tt class="py-lineno"> 30</tt> <a class="py-toggle" href="#" id="Physical-toggle" onclick="return toggle('Physical');">-</a><tt class="py-line"><tt class="py-keyword">class</tt> <a class="py-def-name" href="modules.machinery.physical.Physical-class.html">Physical</a><tt class="py-op">(</tt><tt class="py-base-class">Machinery</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Physical-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="Physical-expanded"><a name="L31"></a><tt class="py-lineno"> 31</tt>  <tt class="py-line">    <tt class="py-docstring">"""Manage physical sandboxes."""</tt> </tt>
<a name="L32"></a><tt class="py-lineno"> 32</tt>  <tt class="py-line"> </tt>
<a name="L33"></a><tt class="py-lineno"> 33</tt>  <tt class="py-line">    <tt class="py-comment"># Physical machine states.</tt> </tt>
<a name="L34"></a><tt class="py-lineno"> 34</tt>  <tt class="py-line">    <tt id="link-24" class="py-name" targets="Variable lib.cuckoo.common.abstracts.LibVirtMachinery.RUNNING=lib.cuckoo.common.abstracts.LibVirtMachinery-class.html#RUNNING,Variable modules.machinery.physical.Physical.RUNNING=modules.machinery.physical.Physical-class.html#RUNNING,Variable modules.machinery.qemu.QEMU.RUNNING=modules.machinery.qemu.QEMU-class.html#RUNNING,Variable modules.machinery.virtualbox.VirtualBox.RUNNING=modules.machinery.virtualbox.VirtualBox-class.html#RUNNING,Variable modules.machinery.vsphere.vSphere.RUNNING=modules.machinery.vsphere.vSphere-class.html#RUNNING,Variable modules.machinery.xenserver.XenServerMachinery.RUNNING=modules.machinery.xenserver.XenServerMachinery-class.html#RUNNING"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery.RUNNING
modules.machinery.physical.Physical.RUNNING
modules.machinery.qemu.QEMU.RUNNING
modules.machinery.virtualbox.VirtualBox.RUNNING
modules.machinery.vsphere.vSphere.RUNNING
modules.machinery.xenserver.XenServerMachinery.RUNNING" class="py-name" href="#" onclick="return doclink('link-24', 'RUNNING', 'link-24');">RUNNING</a></tt> <tt class="py-op">=</tt> <tt class="py-string">"running"</tt> </tt>
<a name="L35"></a><tt class="py-lineno"> 35</tt>  <tt class="py-line">    <tt id="link-25" class="py-name" targets="Variable modules.machinery.physical.Physical.STOPPED=modules.machinery.physical.Physical-class.html#STOPPED,Variable modules.machinery.qemu.QEMU.STOPPED=modules.machinery.qemu.QEMU-class.html#STOPPED"><a title="modules.machinery.physical.Physical.STOPPED
modules.machinery.qemu.QEMU.STOPPED" class="py-name" href="#" onclick="return doclink('link-25', 'STOPPED', 'link-25');">STOPPED</a></tt> <tt class="py-op">=</tt> <tt class="py-string">"stopped"</tt> </tt>
<a name="L36"></a><tt class="py-lineno"> 36</tt>  <tt class="py-line">    <tt id="link-26" class="py-name" targets="Variable lib.cuckoo.common.abstracts.LibVirtMachinery.ERROR=lib.cuckoo.common.abstracts.LibVirtMachinery-class.html#ERROR,Variable modules.machinery.physical.Physical.ERROR=modules.machinery.physical.Physical-class.html#ERROR,Variable modules.machinery.qemu.QEMU.ERROR=modules.machinery.qemu.QEMU-class.html#ERROR,Variable modules.machinery.virtualbox.VirtualBox.ERROR=modules.machinery.virtualbox.VirtualBox-class.html#ERROR"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery.ERROR
modules.machinery.physical.Physical.ERROR
modules.machinery.qemu.QEMU.ERROR
modules.machinery.virtualbox.VirtualBox.ERROR" class="py-name" href="#" onclick="return doclink('link-26', 'ERROR', 'link-26');">ERROR</a></tt> <tt class="py-op">=</tt> <tt class="py-string">"error"</tt> </tt>
<a name="L37"></a><tt class="py-lineno"> 37</tt>  <tt class="py-line"> </tt>
<a name="Physical._initialize_check"></a><div id="Physical._initialize_check-def"><a name="L38"></a><tt class="py-lineno"> 38</tt> <a class="py-toggle" href="#" id="Physical._initialize_check-toggle" onclick="return toggle('Physical._initialize_check');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.machinery.physical.Physical-class.html#_initialize_check">_initialize_check</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Physical._initialize_check-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="Physical._initialize_check-expanded"><a name="L39"></a><tt class="py-lineno"> 39</tt>  <tt class="py-line">        <tt class="py-docstring">"""Ensures that credentials have been entered into the config file.</tt> </tt>
<a name="L40"></a><tt class="py-lineno"> 40</tt>  <tt class="py-line"><tt class="py-docstring">        @raise CuckooCriticalError: if no credentials were provided or if</tt> </tt>
<a name="L41"></a><tt class="py-lineno"> 41</tt>  <tt class="py-line"><tt class="py-docstring">            one or more physical machines are offline.</tt> </tt>
<a name="L42"></a><tt class="py-lineno"> 42</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L43"></a><tt class="py-lineno"> 43</tt>  <tt class="py-line">        <tt class="py-comment"># TODO This should be moved to a per-machine thing.</tt> </tt>
<a name="L44"></a><tt class="py-lineno"> 44</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-27" class="py-name" targets="Variable lib.cuckoo.core.database.Machine.options=lib.cuckoo.core.database.Machine-class.html#options,Variable lib.cuckoo.core.database.Task.options=lib.cuckoo.core.database.Task-class.html#options"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-27', 'options', 'link-27');">options</a></tt><tt class="py-op">.</tt><tt id="link-28" class="py-name" targets="Module modules.machinery.physical=modules.machinery.physical-module.html"><a title="modules.machinery.physical" class="py-name" href="#" onclick="return doclink('link-28', 'physical', 'link-28');">physical</a></tt><tt class="py-op">.</tt><tt class="py-name">user</tt> <tt class="py-keyword">or</tt> <tt class="py-keyword">not</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-29" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-29', 'options', 'link-27');">options</a></tt><tt class="py-op">.</tt><tt id="link-30" class="py-name"><a title="modules.machinery.physical" class="py-name" href="#" onclick="return doclink('link-30', 'physical', 'link-28');">physical</a></tt><tt class="py-op">.</tt><tt class="py-name">password</tt><tt class="py-op">:</tt> </tt>
<a name="L45"></a><tt class="py-lineno"> 45</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-31" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooCriticalError" class="py-name" href="#" onclick="return doclink('link-31', 'CuckooCriticalError', 'link-18');">CuckooCriticalError</a></tt><tt class="py-op">(</tt> </tt>
<a name="L46"></a><tt class="py-lineno"> 46</tt>  <tt class="py-line">                <tt class="py-string">"Physical machine credentials are missing, please add it to "</tt> </tt>
<a name="L47"></a><tt class="py-lineno"> 47</tt>  <tt class="py-line">                <tt class="py-string">"the Physical machinery configuration file."</tt> </tt>
<a name="L48"></a><tt class="py-lineno"> 48</tt>  <tt class="py-line">            <tt class="py-op">)</tt> </tt>
<a name="L49"></a><tt class="py-lineno"> 49</tt>  <tt class="py-line"> </tt>
<a name="L50"></a><tt class="py-lineno"> 50</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-32" class="py-name" targets="Method modules.machinery.physical.Physical.fog_init()=modules.machinery.physical.Physical-class.html#fog_init"><a title="modules.machinery.physical.Physical.fog_init" class="py-name" href="#" onclick="return doclink('link-32', 'fog_init', 'link-32');">fog_init</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L51"></a><tt class="py-lineno"> 51</tt>  <tt class="py-line"> </tt>
<a name="L52"></a><tt class="py-lineno"> 52</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-33" class="py-name" targets="Variable lib.cuckoo.core.database.Tag.machine=lib.cuckoo.core.database.Tag-class.html#machine,Variable lib.cuckoo.core.database.Task.machine=lib.cuckoo.core.database.Task-class.html#machine"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-33', 'machine', 'link-33');">machine</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-34" class="py-name" targets="Method lib.cuckoo.common.abstracts.Machinery.machines()=lib.cuckoo.common.abstracts.Machinery-class.html#machines"><a title="lib.cuckoo.common.abstracts.Machinery.machines" class="py-name" href="#" onclick="return doclink('link-34', 'machines', 'link-34');">machines</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L53"></a><tt class="py-lineno"> 53</tt>  <tt class="py-line">            <tt id="link-35" class="py-name" targets="Variable lib.cuckoo.core.database.Guest.status=lib.cuckoo.core.database.Guest-class.html#status,Variable lib.cuckoo.core.database.Machine.status=lib.cuckoo.core.database.Machine-class.html#status,Variable lib.cuckoo.core.database.Task.status=lib.cuckoo.core.database.Task-class.html#status"><a title="lib.cuckoo.core.database.Guest.status
lib.cuckoo.core.database.Machine.status
lib.cuckoo.core.database.Task.status" class="py-name" href="#" onclick="return doclink('link-35', 'status', 'link-35');">status</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-36" class="py-name" targets="Method lib.cuckoo.common.abstracts.LibVirtMachinery._status()=lib.cuckoo.common.abstracts.LibVirtMachinery-class.html#_status,Method modules.machinery.avd.Avd._status()=modules.machinery.avd.Avd-class.html#_status,Method modules.machinery.physical.Physical._status()=modules.machinery.physical.Physical-class.html#_status,Method modules.machinery.qemu.QEMU._status()=modules.machinery.qemu.QEMU-class.html#_status,Method modules.machinery.virtualbox.VirtualBox._status()=modules.machinery.virtualbox.VirtualBox-class.html#_status,Method modules.machinery.vsphere.vSphere._status()=modules.machinery.vsphere.vSphere-class.html#_status,Method modules.machinery.xenserver.XenServerMachinery._status()=modules.machinery.xenserver.XenServerMachinery-class.html#_status"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery._status
modules.machinery.avd.Avd._status
modules.machinery.physical.Physical._status
modules.machinery.qemu.QEMU._status
modules.machinery.virtualbox.VirtualBox._status
modules.machinery.vsphere.vSphere._status
modules.machinery.xenserver.XenServerMachinery._status" class="py-name" href="#" onclick="return doclink('link-36', '_status', 'link-36');">_status</a></tt><tt class="py-op">(</tt><tt id="link-37" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-37', 'machine', 'link-33');">machine</a></tt><tt class="py-op">.</tt><tt id="link-38" class="py-name" targets="Variable lib.cuckoo.core.database.Guest.label=lib.cuckoo.core.database.Guest-class.html#label,Variable lib.cuckoo.core.database.Machine.label=lib.cuckoo.core.database.Machine-class.html#label"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-38', 'label', 'link-38');">label</a></tt><tt class="py-op">)</tt> </tt>
<a name="L54"></a><tt class="py-lineno"> 54</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-39" class="py-name"><a title="lib.cuckoo.core.database.Guest.status
lib.cuckoo.core.database.Machine.status
lib.cuckoo.core.database.Task.status" class="py-name" href="#" onclick="return doclink('link-39', 'status', 'link-35');">status</a></tt> <tt class="py-op">==</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-40" class="py-name"><a title="modules.machinery.physical.Physical.STOPPED
modules.machinery.qemu.QEMU.STOPPED" class="py-name" href="#" onclick="return doclink('link-40', 'STOPPED', 'link-25');">STOPPED</a></tt><tt class="py-op">:</tt> </tt>
<a name="L55"></a><tt class="py-lineno"> 55</tt>  <tt class="py-line">                <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-41" class="py-name" targets="Method modules.machinery.physical.Physical.wake_on_lan()=modules.machinery.physical.Physical-class.html#wake_on_lan"><a title="modules.machinery.physical.Physical.wake_on_lan" class="py-name" href="#" onclick="return doclink('link-41', 'wake_on_lan', 'link-41');">wake_on_lan</a></tt><tt class="py-op">(</tt><tt id="link-42" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-42', 'machine', 'link-33');">machine</a></tt><tt class="py-op">.</tt><tt id="link-43" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-43', 'label', 'link-38');">label</a></tt><tt class="py-op">)</tt> </tt>
<a name="L56"></a><tt class="py-lineno"> 56</tt>  <tt class="py-line">            <tt class="py-keyword">elif</tt> <tt id="link-44" class="py-name"><a title="lib.cuckoo.core.database.Guest.status
lib.cuckoo.core.database.Machine.status
lib.cuckoo.core.database.Task.status" class="py-name" href="#" onclick="return doclink('link-44', 'status', 'link-35');">status</a></tt> <tt class="py-op">==</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-45" class="py-name"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery.ERROR
modules.machinery.physical.Physical.ERROR
modules.machinery.qemu.QEMU.ERROR
modules.machinery.virtualbox.VirtualBox.ERROR" class="py-name" href="#" onclick="return doclink('link-45', 'ERROR', 'link-26');">ERROR</a></tt><tt class="py-op">:</tt> </tt>
<a name="L57"></a><tt class="py-lineno"> 57</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-46" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-46', 'CuckooMachineError', 'link-23');">CuckooMachineError</a></tt><tt class="py-op">(</tt> </tt>
<a name="L58"></a><tt class="py-lineno"> 58</tt>  <tt class="py-line">                    <tt class="py-string">"Unknown error occurred trying to obtain the status of "</tt> </tt>
<a name="L59"></a><tt class="py-lineno"> 59</tt>  <tt class="py-line">                    <tt class="py-string">"physical machine %s. Please turn it on and check the "</tt> </tt>
<a name="L60"></a><tt class="py-lineno"> 60</tt>  <tt class="py-line">                    <tt class="py-string">"Cuckoo Agent."</tt> <tt class="py-op">%</tt> <tt id="link-47" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-47', 'machine', 'link-33');">machine</a></tt><tt class="py-op">.</tt><tt id="link-48" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-48', 'label', 'link-38');">label</a></tt> </tt>
<a name="L61"></a><tt class="py-lineno"> 61</tt>  <tt class="py-line">                <tt class="py-op">)</tt> </tt>
</div><a name="L62"></a><tt class="py-lineno"> 62</tt>  <tt class="py-line"> </tt>
<a name="Physical._get_machine"></a><div id="Physical._get_machine-def"><a name="L63"></a><tt class="py-lineno"> 63</tt> <a class="py-toggle" href="#" id="Physical._get_machine-toggle" onclick="return toggle('Physical._get_machine');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.machinery.physical.Physical-class.html#_get_machine">_get_machine</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">label</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Physical._get_machine-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="Physical._get_machine-expanded"><a name="L64"></a><tt class="py-lineno"> 64</tt>  <tt class="py-line">        <tt class="py-docstring">"""Retrieve all machine info given a machine's name.</tt> </tt>
<a name="L65"></a><tt class="py-lineno"> 65</tt>  <tt class="py-line"><tt class="py-docstring">        @param label: machine name.</tt> </tt>
<a name="L66"></a><tt class="py-lineno"> 66</tt>  <tt class="py-line"><tt class="py-docstring">        @return: machine dictionary (id, ip, platform, ...).</tt> </tt>
<a name="L67"></a><tt class="py-lineno"> 67</tt>  <tt class="py-line"><tt class="py-docstring">        @raises CuckooMachineError: if no machine is available with the given label.</tt> </tt>
<a name="L68"></a><tt class="py-lineno"> 68</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L69"></a><tt class="py-lineno"> 69</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">m</tt> <tt class="py-keyword">in</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-49" class="py-name"><a title="lib.cuckoo.common.abstracts.Machinery.machines" class="py-name" href="#" onclick="return doclink('link-49', 'machines', 'link-34');">machines</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L70"></a><tt class="py-lineno"> 70</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-50" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-50', 'label', 'link-38');">label</a></tt> <tt class="py-op">==</tt> <tt class="py-name">m</tt><tt class="py-op">.</tt><tt id="link-51" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-51', 'label', 'link-38');">label</a></tt><tt class="py-op">:</tt> </tt>
<a name="L71"></a><tt class="py-lineno"> 71</tt>  <tt class="py-line">                <tt class="py-keyword">return</tt> <tt class="py-name">m</tt> </tt>
<a name="L72"></a><tt class="py-lineno"> 72</tt>  <tt class="py-line"> </tt>
<a name="L73"></a><tt class="py-lineno"> 73</tt>  <tt class="py-line">        <tt class="py-keyword">raise</tt> <tt id="link-52" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-52', 'CuckooMachineError', 'link-23');">CuckooMachineError</a></tt><tt class="py-op">(</tt><tt class="py-string">"No machine with label: %s."</tt> <tt class="py-op">%</tt> <tt id="link-53" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-53', 'label', 'link-38');">label</a></tt><tt class="py-op">)</tt> </tt>
</div><a name="L74"></a><tt class="py-lineno"> 74</tt>  <tt class="py-line"> </tt>
<a name="Physical.start"></a><div id="Physical.start-def"><a name="L75"></a><tt class="py-lineno"> 75</tt> <a class="py-toggle" href="#" id="Physical.start-toggle" onclick="return toggle('Physical.start');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.machinery.physical.Physical-class.html#start">start</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">label</tt><tt class="py-op">,</tt> <tt class="py-param">task</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Physical.start-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="Physical.start-expanded"><a name="L76"></a><tt class="py-lineno"> 76</tt>  <tt class="py-line">        <tt class="py-docstring">"""Start a physical machine.</tt> </tt>
<a name="L77"></a><tt class="py-lineno"> 77</tt>  <tt class="py-line"><tt class="py-docstring">        @param label: physical machine name.</tt> </tt>
<a name="L78"></a><tt class="py-lineno"> 78</tt>  <tt class="py-line"><tt class="py-docstring">        @param task: task object.</tt> </tt>
<a name="L79"></a><tt class="py-lineno"> 79</tt>  <tt class="py-line"><tt class="py-docstring">        @raise CuckooMachineError: if unable to start.</tt> </tt>
<a name="L80"></a><tt class="py-lineno"> 80</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L81"></a><tt class="py-lineno"> 81</tt>  <tt class="py-line">        <tt class="py-comment"># Check to ensure a given machine is running</tt> </tt>
<a name="L82"></a><tt class="py-lineno"> 82</tt>  <tt class="py-line">        <tt id="link-54" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-54', 'log', 'link-0');">log</a></tt><tt class="py-op">.</tt><tt id="link-55" class="py-name" targets="Module modules.processing.debug=modules.processing.debug-module.html"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-55', 'debug', 'link-55');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"Checking if machine %r is running."</tt><tt class="py-op">,</tt> <tt id="link-56" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-56', 'label', 'link-38');">label</a></tt><tt class="py-op">)</tt> </tt>
<a name="L83"></a><tt class="py-lineno"> 83</tt>  <tt class="py-line">        <tt id="link-57" class="py-name"><a title="lib.cuckoo.core.database.Guest.status
lib.cuckoo.core.database.Machine.status
lib.cuckoo.core.database.Task.status" class="py-name" href="#" onclick="return doclink('link-57', 'status', 'link-35');">status</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-58" class="py-name"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery._status
modules.machinery.avd.Avd._status
modules.machinery.physical.Physical._status
modules.machinery.qemu.QEMU._status
modules.machinery.virtualbox.VirtualBox._status
modules.machinery.vsphere.vSphere._status
modules.machinery.xenserver.XenServerMachinery._status" class="py-name" href="#" onclick="return doclink('link-58', '_status', 'link-36');">_status</a></tt><tt class="py-op">(</tt><tt id="link-59" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-59', 'label', 'link-38');">label</a></tt><tt class="py-op">)</tt> </tt>
<a name="L84"></a><tt class="py-lineno"> 84</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-60" class="py-name"><a title="lib.cuckoo.core.database.Guest.status
lib.cuckoo.core.database.Machine.status
lib.cuckoo.core.database.Task.status" class="py-name" href="#" onclick="return doclink('link-60', 'status', 'link-35');">status</a></tt> <tt class="py-op">==</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-61" class="py-name"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery.RUNNING
modules.machinery.physical.Physical.RUNNING
modules.machinery.qemu.QEMU.RUNNING
modules.machinery.virtualbox.VirtualBox.RUNNING
modules.machinery.vsphere.vSphere.RUNNING
modules.machinery.xenserver.XenServerMachinery.RUNNING" class="py-name" href="#" onclick="return doclink('link-61', 'RUNNING', 'link-24');">RUNNING</a></tt><tt class="py-op">:</tt> </tt>
<a name="L85"></a><tt class="py-lineno"> 85</tt>  <tt class="py-line">            <tt id="link-62" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-62', 'log', 'link-0');">log</a></tt><tt class="py-op">.</tt><tt id="link-63" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-63', 'debug', 'link-55');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"Machine already running: %s."</tt><tt class="py-op">,</tt> <tt id="link-64" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-64', 'label', 'link-38');">label</a></tt><tt class="py-op">)</tt> </tt>
<a name="L86"></a><tt class="py-lineno"> 86</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt id="link-65" class="py-name"><a title="lib.cuckoo.core.database.Guest.status
lib.cuckoo.core.database.Machine.status
lib.cuckoo.core.database.Task.status" class="py-name" href="#" onclick="return doclink('link-65', 'status', 'link-35');">status</a></tt> <tt class="py-op">==</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-66" class="py-name"><a title="modules.machinery.physical.Physical.STOPPED
modules.machinery.qemu.QEMU.STOPPED" class="py-name" href="#" onclick="return doclink('link-66', 'STOPPED', 'link-25');">STOPPED</a></tt><tt class="py-op">:</tt> </tt>
<a name="L87"></a><tt class="py-lineno"> 87</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-67" class="py-name" targets="Method lib.cuckoo.common.abstracts.Machinery._wait_status()=lib.cuckoo.common.abstracts.Machinery-class.html#_wait_status"><a title="lib.cuckoo.common.abstracts.Machinery._wait_status" class="py-name" href="#" onclick="return doclink('link-67', '_wait_status', 'link-67');">_wait_status</a></tt><tt class="py-op">(</tt><tt id="link-68" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-68', 'label', 'link-38');">label</a></tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-69" class="py-name"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery.RUNNING
modules.machinery.physical.Physical.RUNNING
modules.machinery.qemu.QEMU.RUNNING
modules.machinery.virtualbox.VirtualBox.RUNNING
modules.machinery.vsphere.vSphere.RUNNING
modules.machinery.xenserver.XenServerMachinery.RUNNING" class="py-name" href="#" onclick="return doclink('link-69', 'RUNNING', 'link-24');">RUNNING</a></tt><tt class="py-op">)</tt> </tt>
<a name="L88"></a><tt class="py-lineno"> 88</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L89"></a><tt class="py-lineno"> 89</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-70" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-70', 'CuckooMachineError', 'link-23');">CuckooMachineError</a></tt><tt class="py-op">(</tt><tt class="py-string">"Error occurred while starting: "</tt> </tt>
<a name="L90"></a><tt class="py-lineno"> 90</tt>  <tt class="py-line">                                     <tt class="py-string">"%s (STATUS=%s)"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt id="link-71" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-71', 'label', 'link-38');">label</a></tt><tt class="py-op">,</tt> <tt id="link-72" class="py-name"><a title="lib.cuckoo.core.database.Guest.status
lib.cuckoo.core.database.Machine.status
lib.cuckoo.core.database.Task.status" class="py-name" href="#" onclick="return doclink('link-72', 'status', 'link-35');">status</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
</div><a name="L91"></a><tt class="py-lineno"> 91</tt>  <tt class="py-line"> </tt>
<a name="Physical.stop"></a><div id="Physical.stop-def"><a name="L92"></a><tt class="py-lineno"> 92</tt> <a class="py-toggle" href="#" id="Physical.stop-toggle" onclick="return toggle('Physical.stop');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.machinery.physical.Physical-class.html#stop">stop</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">label</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Physical.stop-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="Physical.stop-expanded"><a name="L93"></a><tt class="py-lineno"> 93</tt>  <tt class="py-line">        <tt class="py-docstring">"""Stops a physical machine.</tt> </tt>
<a name="L94"></a><tt class="py-lineno"> 94</tt>  <tt class="py-line"><tt class="py-docstring">        @param label: physical machine name.</tt> </tt>
<a name="L95"></a><tt class="py-lineno"> 95</tt>  <tt class="py-line"><tt class="py-docstring">        @raise CuckooMachineError: if unable to stop.</tt> </tt>
<a name="L96"></a><tt class="py-lineno"> 96</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L97"></a><tt class="py-lineno"> 97</tt>  <tt class="py-line">        <tt class="py-comment"># Since we are 'stopping' a physical machine, it must</tt> </tt>
<a name="L98"></a><tt class="py-lineno"> 98</tt>  <tt class="py-line">        <tt class="py-comment"># actually be rebooted to kick off the re-imaging process.</tt> </tt>
<a name="L99"></a><tt class="py-lineno"> 99</tt>  <tt class="py-line">        <tt class="py-name">creds</tt> <tt class="py-op">=</tt> <tt class="py-string">"%s%%%s"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt> </tt>
<a name="L100"></a><tt class="py-lineno">100</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-73" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-73', 'options', 'link-27');">options</a></tt><tt class="py-op">.</tt><tt id="link-74" class="py-name"><a title="modules.machinery.physical" class="py-name" href="#" onclick="return doclink('link-74', 'physical', 'link-28');">physical</a></tt><tt class="py-op">.</tt><tt class="py-name">user</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-75" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-75', 'options', 'link-27');">options</a></tt><tt class="py-op">.</tt><tt id="link-76" class="py-name"><a title="modules.machinery.physical" class="py-name" href="#" onclick="return doclink('link-76', 'physical', 'link-28');">physical</a></tt><tt class="py-op">.</tt><tt class="py-name">password</tt> </tt>
<a name="L101"></a><tt class="py-lineno">101</tt>  <tt class="py-line">        <tt class="py-op">)</tt> </tt>
<a name="L102"></a><tt class="py-lineno">102</tt>  <tt class="py-line"> </tt>
<a name="L103"></a><tt class="py-lineno">103</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-77" class="py-name"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery._status
modules.machinery.avd.Avd._status
modules.machinery.physical.Physical._status
modules.machinery.qemu.QEMU._status
modules.machinery.virtualbox.VirtualBox._status
modules.machinery.vsphere.vSphere._status
modules.machinery.xenserver.XenServerMachinery._status" class="py-name" href="#" onclick="return doclink('link-77', '_status', 'link-36');">_status</a></tt><tt class="py-op">(</tt><tt id="link-78" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-78', 'label', 'link-38');">label</a></tt><tt class="py-op">)</tt> <tt class="py-op">==</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-79" class="py-name"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery.RUNNING
modules.machinery.physical.Physical.RUNNING
modules.machinery.qemu.QEMU.RUNNING
modules.machinery.virtualbox.VirtualBox.RUNNING
modules.machinery.vsphere.vSphere.RUNNING
modules.machinery.xenserver.XenServerMachinery.RUNNING" class="py-name" href="#" onclick="return doclink('link-79', 'RUNNING', 'link-24');">RUNNING</a></tt><tt class="py-op">:</tt> </tt>
<a name="L104"></a><tt class="py-lineno">104</tt>  <tt class="py-line">            <tt id="link-80" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-80', 'log', 'link-0');">log</a></tt><tt class="py-op">.</tt><tt id="link-81" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-81', 'debug', 'link-55');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"Rebooting machine: %s."</tt><tt class="py-op">,</tt> <tt id="link-82" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-82', 'label', 'link-38');">label</a></tt><tt class="py-op">)</tt> </tt>
<a name="L105"></a><tt class="py-lineno">105</tt>  <tt class="py-line">            <tt id="link-83" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-83', 'machine', 'link-33');">machine</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-84" class="py-name" targets="Method modules.machinery.physical.Physical._get_machine()=modules.machinery.physical.Physical-class.html#_get_machine"><a title="modules.machinery.physical.Physical._get_machine" class="py-name" href="#" onclick="return doclink('link-84', '_get_machine', 'link-84');">_get_machine</a></tt><tt class="py-op">(</tt><tt id="link-85" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-85', 'label', 'link-38');">label</a></tt><tt class="py-op">)</tt> </tt>
<a name="L106"></a><tt class="py-lineno">106</tt>  <tt class="py-line"> </tt>
<a name="L107"></a><tt class="py-lineno">107</tt>  <tt class="py-line">            <tt class="py-name">args</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt> </tt>
<a name="L108"></a><tt class="py-lineno">108</tt>  <tt class="py-line">                <tt class="py-string">"net"</tt><tt class="py-op">,</tt> <tt class="py-string">"rpc"</tt><tt class="py-op">,</tt> <tt class="py-string">"shutdown"</tt><tt class="py-op">,</tt> <tt class="py-string">"-I"</tt><tt class="py-op">,</tt> <tt id="link-86" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-86', 'machine', 'link-33');">machine</a></tt><tt class="py-op">.</tt><tt id="link-87" class="py-name" targets="Variable lib.cuckoo.core.database.Machine.ip=lib.cuckoo.core.database.Machine-class.html#ip"><a title="lib.cuckoo.core.database.Machine.ip" class="py-name" href="#" onclick="return doclink('link-87', 'ip', 'link-87');">ip</a></tt><tt class="py-op">,</tt> </tt>
<a name="L109"></a><tt class="py-lineno">109</tt>  <tt class="py-line">                <tt class="py-string">"-U"</tt><tt class="py-op">,</tt> <tt class="py-name">creds</tt><tt class="py-op">,</tt> <tt class="py-string">"-r"</tt><tt class="py-op">,</tt> <tt class="py-string">"-f"</tt><tt class="py-op">,</tt> <tt class="py-string">"--timeout=5"</tt> </tt>
<a name="L110"></a><tt class="py-lineno">110</tt>  <tt class="py-line">            <tt class="py-op">]</tt> </tt>
<a name="L111"></a><tt class="py-lineno">111</tt>  <tt class="py-line">            <tt class="py-name">output</tt> <tt class="py-op">=</tt> <tt class="py-name">subprocess</tt><tt class="py-op">.</tt><tt class="py-name">check_output</tt><tt class="py-op">(</tt><tt class="py-name">args</tt><tt class="py-op">)</tt> </tt>
<a name="L112"></a><tt class="py-lineno">112</tt>  <tt class="py-line"> </tt>
<a name="L113"></a><tt class="py-lineno">113</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-string">"Shutdown of remote machine succeeded"</tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt class="py-name">output</tt><tt class="py-op">:</tt> </tt>
<a name="L114"></a><tt class="py-lineno">114</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-88" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-88', 'CuckooMachineError', 'link-23');">CuckooMachineError</a></tt><tt class="py-op">(</tt><tt class="py-string">"Unable to initiate RPC request"</tt><tt class="py-op">)</tt> </tt>
<a name="L115"></a><tt class="py-lineno">115</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L116"></a><tt class="py-lineno">116</tt>  <tt class="py-line">                <tt id="link-89" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-89', 'log', 'link-0');">log</a></tt><tt class="py-op">.</tt><tt id="link-90" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-90', 'debug', 'link-55');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"Reboot success: %s."</tt> <tt class="py-op">%</tt> <tt id="link-91" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-91', 'label', 'link-38');">label</a></tt><tt class="py-op">)</tt> </tt>
<a name="L117"></a><tt class="py-lineno">117</tt>  <tt class="py-line"> </tt>
<a name="L118"></a><tt class="py-lineno">118</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-92" class="py-name" targets="Method modules.machinery.physical.Physical.fog_queue_task()=modules.machinery.physical.Physical-class.html#fog_queue_task"><a title="modules.machinery.physical.Physical.fog_queue_task" class="py-name" href="#" onclick="return doclink('link-92', 'fog_queue_task', 'link-92');">fog_queue_task</a></tt><tt class="py-op">(</tt><tt id="link-93" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-93', 'label', 'link-38');">label</a></tt><tt class="py-op">)</tt> </tt>
</div><a name="L119"></a><tt class="py-lineno">119</tt>  <tt class="py-line"> </tt>
<a name="Physical._list"></a><div id="Physical._list-def"><a name="L120"></a><tt class="py-lineno">120</tt> <a class="py-toggle" href="#" id="Physical._list-toggle" onclick="return toggle('Physical._list');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.machinery.physical.Physical-class.html#_list">_list</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Physical._list-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="Physical._list-expanded"><a name="L121"></a><tt class="py-lineno">121</tt>  <tt class="py-line">        <tt class="py-docstring">"""Lists physical machines installed.</tt> </tt>
<a name="L122"></a><tt class="py-lineno">122</tt>  <tt class="py-line"><tt class="py-docstring">        @return: physical machine names list.</tt> </tt>
<a name="L123"></a><tt class="py-lineno">123</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L124"></a><tt class="py-lineno">124</tt>  <tt class="py-line">        <tt class="py-name">active_machines</tt> <tt class="py-op">=</tt> <tt class="py-op">[</tt><tt class="py-op">]</tt> </tt>
<a name="L125"></a><tt class="py-lineno">125</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-94" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-94', 'machine', 'link-33');">machine</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-95" class="py-name"><a title="lib.cuckoo.common.abstracts.Machinery.machines" class="py-name" href="#" onclick="return doclink('link-95', 'machines', 'link-34');">machines</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L126"></a><tt class="py-lineno">126</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-96" class="py-name"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery._status
modules.machinery.avd.Avd._status
modules.machinery.physical.Physical._status
modules.machinery.qemu.QEMU._status
modules.machinery.virtualbox.VirtualBox._status
modules.machinery.vsphere.vSphere._status
modules.machinery.xenserver.XenServerMachinery._status" class="py-name" href="#" onclick="return doclink('link-96', '_status', 'link-36');">_status</a></tt><tt class="py-op">(</tt><tt id="link-97" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-97', 'machine', 'link-33');">machine</a></tt><tt class="py-op">.</tt><tt id="link-98" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-98', 'label', 'link-38');">label</a></tt><tt class="py-op">)</tt> <tt class="py-op">==</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-99" class="py-name"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery.RUNNING
modules.machinery.physical.Physical.RUNNING
modules.machinery.qemu.QEMU.RUNNING
modules.machinery.virtualbox.VirtualBox.RUNNING
modules.machinery.vsphere.vSphere.RUNNING
modules.machinery.xenserver.XenServerMachinery.RUNNING" class="py-name" href="#" onclick="return doclink('link-99', 'RUNNING', 'link-24');">RUNNING</a></tt><tt class="py-op">:</tt> </tt>
<a name="L127"></a><tt class="py-lineno">127</tt>  <tt class="py-line">                <tt class="py-name">active_machines</tt><tt class="py-op">.</tt><tt class="py-name">append</tt><tt class="py-op">(</tt><tt id="link-100" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-100', 'machine', 'link-33');">machine</a></tt><tt class="py-op">.</tt><tt id="link-101" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-101', 'label', 'link-38');">label</a></tt><tt class="py-op">)</tt> </tt>
<a name="L128"></a><tt class="py-lineno">128</tt>  <tt class="py-line"> </tt>
<a name="L129"></a><tt class="py-lineno">129</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">active_machines</tt> </tt>
</div><a name="L130"></a><tt class="py-lineno">130</tt>  <tt class="py-line"> </tt>
<a name="Physical._status"></a><div id="Physical._status-def"><a name="L131"></a><tt class="py-lineno">131</tt> <a class="py-toggle" href="#" id="Physical._status-toggle" onclick="return toggle('Physical._status');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.machinery.physical.Physical-class.html#_status">_status</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">label</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Physical._status-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="Physical._status-expanded"><a name="L132"></a><tt class="py-lineno">132</tt>  <tt class="py-line">        <tt class="py-docstring">"""Gets current status of a physical machine.</tt> </tt>
<a name="L133"></a><tt class="py-lineno">133</tt>  <tt class="py-line"><tt class="py-docstring">        @param label: physical machine name.</tt> </tt>
<a name="L134"></a><tt class="py-lineno">134</tt>  <tt class="py-line"><tt class="py-docstring">        @return: status string.</tt> </tt>
<a name="L135"></a><tt class="py-lineno">135</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L136"></a><tt class="py-lineno">136</tt>  <tt class="py-line">        <tt class="py-comment"># For physical machines, the agent can either be contacted or not.</tt> </tt>
<a name="L137"></a><tt class="py-lineno">137</tt>  <tt class="py-line">        <tt class="py-comment"># However, there is some information to be garnered from potential</tt> </tt>
<a name="L138"></a><tt class="py-lineno">138</tt>  <tt class="py-line">        <tt class="py-comment"># exceptions.</tt> </tt>
<a name="L139"></a><tt class="py-lineno">139</tt>  <tt class="py-line">        <tt id="link-102" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-102', 'log', 'link-0');">log</a></tt><tt class="py-op">.</tt><tt id="link-103" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-103', 'debug', 'link-55');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"Getting status for machine: %s."</tt><tt class="py-op">,</tt> <tt id="link-104" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-104', 'label', 'link-38');">label</a></tt><tt class="py-op">)</tt> </tt>
<a name="L140"></a><tt class="py-lineno">140</tt>  <tt class="py-line">        <tt id="link-105" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-105', 'machine', 'link-33');">machine</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-106" class="py-name"><a title="modules.machinery.physical.Physical._get_machine" class="py-name" href="#" onclick="return doclink('link-106', '_get_machine', 'link-84');">_get_machine</a></tt><tt class="py-op">(</tt><tt id="link-107" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-107', 'label', 'link-38');">label</a></tt><tt class="py-op">)</tt> </tt>
<a name="L141"></a><tt class="py-lineno">141</tt>  <tt class="py-line">        <tt id="link-108" class="py-name"><a title="lib.cuckoo.core.database.Task.guest
lib.cuckoo.core.guest" class="py-name" href="#" onclick="return doclink('link-108', 'guest', 'link-7');">guest</a></tt> <tt class="py-op">=</tt> <tt id="link-109" class="py-name"><a title="lib.cuckoo.core.guest.GuestManager" class="py-name" href="#" onclick="return doclink('link-109', 'GuestManager', 'link-8');">GuestManager</a></tt><tt class="py-op">(</tt><tt id="link-110" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-110', 'machine', 'link-33');">machine</a></tt><tt class="py-op">.</tt><tt id="link-111" class="py-name" targets="Variable lib.cuckoo.core.database.Error.id=lib.cuckoo.core.database.Error-class.html#id,Variable lib.cuckoo.core.database.Guest.id=lib.cuckoo.core.database.Guest-class.html#id,Variable lib.cuckoo.core.database.Machine.id=lib.cuckoo.core.database.Machine-class.html#id,Variable lib.cuckoo.core.database.Sample.id=lib.cuckoo.core.database.Sample-class.html#id,Variable lib.cuckoo.core.database.Tag.id=lib.cuckoo.core.database.Tag-class.html#id,Variable lib.cuckoo.core.database.Task.id=lib.cuckoo.core.database.Task-class.html#id"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-111', 'id', 'link-111');">id</a></tt><tt class="py-op">,</tt> <tt id="link-112" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-112', 'machine', 'link-33');">machine</a></tt><tt class="py-op">.</tt><tt id="link-113" class="py-name"><a title="lib.cuckoo.core.database.Machine.ip" class="py-name" href="#" onclick="return doclink('link-113', 'ip', 'link-87');">ip</a></tt><tt class="py-op">,</tt> <tt id="link-114" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-114', 'machine', 'link-33');">machine</a></tt><tt class="py-op">.</tt><tt id="link-115" class="py-name" targets="Variable lib.cuckoo.common.abstracts.Signature.platform=lib.cuckoo.common.abstracts.Signature-class.html#platform,Variable lib.cuckoo.core.database.Machine.platform=lib.cuckoo.core.database.Machine-class.html#platform,Variable lib.cuckoo.core.database.Task.platform=lib.cuckoo.core.database.Task-class.html#platform,Package modules.processing.platform=modules.processing.platform-module.html"><a title="lib.cuckoo.common.abstracts.Signature.platform
lib.cuckoo.core.database.Machine.platform
lib.cuckoo.core.database.Task.platform
modules.processing.platform" class="py-name" href="#" onclick="return doclink('link-115', 'platform', 'link-115');">platform</a></tt><tt class="py-op">,</tt> <tt class="py-name">None</tt><tt class="py-op">)</tt> </tt>
<a name="L142"></a><tt class="py-lineno">142</tt>  <tt class="py-line"> </tt>
<a name="L143"></a><tt class="py-lineno">143</tt>  <tt class="py-line">        <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L144"></a><tt class="py-lineno">144</tt>  <tt class="py-line">            <tt id="link-116" class="py-name"><a title="lib.cuckoo.core.database.Guest.status
lib.cuckoo.core.database.Machine.status
lib.cuckoo.core.database.Task.status" class="py-name" href="#" onclick="return doclink('link-116', 'status', 'link-35');">status</a></tt> <tt class="py-op">=</tt> <tt id="link-117" class="py-name"><a title="lib.cuckoo.core.database.Task.guest
lib.cuckoo.core.guest" class="py-name" href="#" onclick="return doclink('link-117', 'guest', 'link-7');">guest</a></tt><tt class="py-op">.</tt><tt id="link-118" class="py-name" targets="Variable lib.cuckoo.core.guest.GuestManager.server=lib.cuckoo.core.guest.GuestManager-class.html#server"><a title="lib.cuckoo.core.guest.GuestManager.server" class="py-name" href="#" onclick="return doclink('link-118', 'server', 'link-118');">server</a></tt><tt class="py-op">.</tt><tt class="py-name">get_status</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L145"></a><tt class="py-lineno">145</tt>  <tt class="py-line">        <tt class="py-keyword">except</tt> <tt class="py-name">xmlrpclib</tt><tt class="py-op">.</tt><tt class="py-name">Fault</tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L146"></a><tt class="py-lineno">146</tt>  <tt class="py-line">            <tt class="py-comment"># Contacted Agent, but it threw an error.</tt> </tt>
<a name="L147"></a><tt class="py-lineno">147</tt>  <tt class="py-line">            <tt id="link-119" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-119', 'log', 'link-0');">log</a></tt><tt class="py-op">.</tt><tt id="link-120" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-120', 'debug', 'link-55');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"Agent error: %s (%s) (Error: %s)."</tt><tt class="py-op">,</tt> </tt>
<a name="L148"></a><tt class="py-lineno">148</tt>  <tt class="py-line">                      <tt id="link-121" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-121', 'machine', 'link-33');">machine</a></tt><tt class="py-op">.</tt><tt id="link-122" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-122', 'id', 'link-111');">id</a></tt><tt class="py-op">,</tt> <tt id="link-123" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-123', 'machine', 'link-33');">machine</a></tt><tt class="py-op">.</tt><tt id="link-124" class="py-name"><a title="lib.cuckoo.core.database.Machine.ip" class="py-name" href="#" onclick="return doclink('link-124', 'ip', 'link-87');">ip</a></tt><tt class="py-op">,</tt> <tt class="py-name">e</tt><tt class="py-op">)</tt> </tt>
<a name="L149"></a><tt class="py-lineno">149</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-125" class="py-name"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery.ERROR
modules.machinery.physical.Physical.ERROR
modules.machinery.qemu.QEMU.ERROR
modules.machinery.virtualbox.VirtualBox.ERROR" class="py-name" href="#" onclick="return doclink('link-125', 'ERROR', 'link-26');">ERROR</a></tt> </tt>
<a name="L150"></a><tt class="py-lineno">150</tt>  <tt class="py-line">        <tt class="py-keyword">except</tt> <tt class="py-name">socket</tt><tt class="py-op">.</tt><tt class="py-name">error</tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L151"></a><tt class="py-lineno">151</tt>  <tt class="py-line">            <tt class="py-comment"># Could not contact agent.</tt> </tt>
<a name="L152"></a><tt class="py-lineno">152</tt>  <tt class="py-line">            <tt id="link-126" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-126', 'log', 'link-0');">log</a></tt><tt class="py-op">.</tt><tt id="link-127" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-127', 'debug', 'link-55');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"Agent unresponsive: %s (%s) (Error: %s)."</tt><tt class="py-op">,</tt> </tt>
<a name="L153"></a><tt class="py-lineno">153</tt>  <tt class="py-line">                      <tt id="link-128" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-128', 'machine', 'link-33');">machine</a></tt><tt class="py-op">.</tt><tt id="link-129" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-129', 'id', 'link-111');">id</a></tt><tt class="py-op">,</tt> <tt id="link-130" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-130', 'machine', 'link-33');">machine</a></tt><tt class="py-op">.</tt><tt id="link-131" class="py-name"><a title="lib.cuckoo.core.database.Machine.ip" class="py-name" href="#" onclick="return doclink('link-131', 'ip', 'link-87');">ip</a></tt><tt class="py-op">,</tt> <tt class="py-name">e</tt><tt class="py-op">)</tt> </tt>
<a name="L154"></a><tt class="py-lineno">154</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-132" class="py-name"><a title="modules.machinery.physical.Physical.STOPPED
modules.machinery.qemu.QEMU.STOPPED" class="py-name" href="#" onclick="return doclink('link-132', 'STOPPED', 'link-25');">STOPPED</a></tt> </tt>
<a name="L155"></a><tt class="py-lineno">155</tt>  <tt class="py-line">        <tt class="py-keyword">except</tt> <tt class="py-name">Exception</tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L156"></a><tt class="py-lineno">156</tt>  <tt class="py-line">            <tt class="py-comment"># TODO Handle this better.</tt> </tt>
<a name="L157"></a><tt class="py-lineno">157</tt>  <tt class="py-line">            <tt id="link-133" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-133', 'log', 'link-0');">log</a></tt><tt class="py-op">.</tt><tt id="link-134" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-134', 'debug', 'link-55');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"Received unknown exception: %s."</tt><tt class="py-op">,</tt> <tt class="py-name">e</tt><tt class="py-op">)</tt> </tt>
<a name="L158"></a><tt class="py-lineno">158</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-135" class="py-name"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery.ERROR
modules.machinery.physical.Physical.ERROR
modules.machinery.qemu.QEMU.ERROR
modules.machinery.virtualbox.VirtualBox.ERROR" class="py-name" href="#" onclick="return doclink('link-135', 'ERROR', 'link-26');">ERROR</a></tt> </tt>
<a name="L159"></a><tt class="py-lineno">159</tt>  <tt class="py-line"> </tt>
<a name="L160"></a><tt class="py-lineno">160</tt>  <tt class="py-line">        <tt class="py-comment"># If the agent responded successfully, then the physical machine</tt> </tt>
<a name="L161"></a><tt class="py-lineno">161</tt>  <tt class="py-line">        <tt class="py-comment"># is running</tt> </tt>
<a name="L162"></a><tt class="py-lineno">162</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-136" class="py-name"><a title="lib.cuckoo.core.database.Guest.status
lib.cuckoo.core.database.Machine.status
lib.cuckoo.core.database.Task.status" class="py-name" href="#" onclick="return doclink('link-136', 'status', 'link-35');">status</a></tt><tt class="py-op">:</tt> </tt>
<a name="L163"></a><tt class="py-lineno">163</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-137" class="py-name"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery.RUNNING
modules.machinery.physical.Physical.RUNNING
modules.machinery.qemu.QEMU.RUNNING
modules.machinery.virtualbox.VirtualBox.RUNNING
modules.machinery.vsphere.vSphere.RUNNING
modules.machinery.xenserver.XenServerMachinery.RUNNING" class="py-name" href="#" onclick="return doclink('link-137', 'RUNNING', 'link-24');">RUNNING</a></tt> </tt>
<a name="L164"></a><tt class="py-lineno">164</tt>  <tt class="py-line"> </tt>
<a name="L165"></a><tt class="py-lineno">165</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-138" class="py-name"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery.ERROR
modules.machinery.physical.Physical.ERROR
modules.machinery.qemu.QEMU.ERROR
modules.machinery.virtualbox.VirtualBox.ERROR" class="py-name" href="#" onclick="return doclink('link-138', 'ERROR', 'link-26');">ERROR</a></tt> </tt>
</div><a name="L166"></a><tt class="py-lineno">166</tt>  <tt class="py-line"> </tt>
<a name="Physical.fog_query"></a><div id="Physical.fog_query-def"><a name="L167"></a><tt class="py-lineno">167</tt> <a class="py-toggle" href="#" id="Physical.fog_query-toggle" onclick="return toggle('Physical.fog_query');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.machinery.physical.Physical-class.html#fog_query">fog_query</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">uri</tt><tt class="py-op">,</tt> <tt class="py-param">data</tt><tt class="py-op">=</tt><tt class="py-op">{</tt><tt class="py-op">}</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Physical.fog_query-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="Physical.fog_query-expanded"><a name="L168"></a><tt class="py-lineno">168</tt>  <tt class="py-line">        <tt class="py-docstring">"""Wrapper around requests for simplifying FOG API access. Assuming</tt> </tt>
<a name="L169"></a><tt class="py-lineno">169</tt>  <tt class="py-line"><tt class="py-docstring">        you can call what FOG is providing an API."""</tt> </tt>
<a name="L170"></a><tt class="py-lineno">170</tt>  <tt class="py-line">        <tt class="py-name">url</tt> <tt class="py-op">=</tt> <tt class="py-string">"http://%s/fog/management/index.php?%s"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt> </tt>
<a name="L171"></a><tt class="py-lineno">171</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-139" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-139', 'options', 'link-27');">options</a></tt><tt class="py-op">.</tt><tt class="py-name">fog</tt><tt class="py-op">.</tt><tt class="py-name">hostname</tt><tt class="py-op">,</tt> <tt class="py-name">uri</tt><tt class="py-op">,</tt> </tt>
<a name="L172"></a><tt class="py-lineno">172</tt>  <tt class="py-line">        <tt class="py-op">)</tt> </tt>
<a name="L173"></a><tt class="py-lineno">173</tt>  <tt class="py-line"> </tt>
<a name="L174"></a><tt class="py-lineno">174</tt>  <tt class="py-line">        <tt class="py-name">data</tt><tt class="py-op">.</tt><tt class="py-name">update</tt><tt class="py-op">(</tt><tt class="py-op">{</tt> </tt>
<a name="L175"></a><tt class="py-lineno">175</tt>  <tt class="py-line">            <tt class="py-string">"uname"</tt><tt class="py-op">:</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-140" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-140', 'options', 'link-27');">options</a></tt><tt class="py-op">.</tt><tt class="py-name">fog</tt><tt class="py-op">.</tt><tt class="py-name">username</tt><tt class="py-op">,</tt> </tt>
<a name="L176"></a><tt class="py-lineno">176</tt>  <tt class="py-line">            <tt class="py-string">"upass"</tt><tt class="py-op">:</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-141" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-141', 'options', 'link-27');">options</a></tt><tt class="py-op">.</tt><tt class="py-name">fog</tt><tt class="py-op">.</tt><tt class="py-name">password</tt><tt class="py-op">,</tt> </tt>
<a name="L177"></a><tt class="py-lineno">177</tt>  <tt class="py-line">        <tt class="py-op">}</tt><tt class="py-op">)</tt> </tt>
<a name="L178"></a><tt class="py-lineno">178</tt>  <tt class="py-line"> </tt>
<a name="L179"></a><tt class="py-lineno">179</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">requests</tt><tt class="py-op">.</tt><tt id="link-142" class="py-name" targets="Method lib.cuckoo.core.guest.GuestManager.post()=lib.cuckoo.core.guest.GuestManager-class.html#post"><a title="lib.cuckoo.core.guest.GuestManager.post" class="py-name" href="#" onclick="return doclink('link-142', 'post', 'link-142');">post</a></tt><tt class="py-op">(</tt><tt class="py-name">url</tt><tt class="py-op">,</tt> <tt class="py-name">data</tt><tt class="py-op">=</tt><tt class="py-name">data</tt><tt class="py-op">)</tt> </tt>
</div><a name="L180"></a><tt class="py-lineno">180</tt>  <tt class="py-line"> </tt>
<a name="Physical.fog_init"></a><div id="Physical.fog_init-def"><a name="L181"></a><tt class="py-lineno">181</tt> <a class="py-toggle" href="#" id="Physical.fog_init-toggle" onclick="return toggle('Physical.fog_init');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.machinery.physical.Physical-class.html#fog_init">fog_init</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Physical.fog_init-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="Physical.fog_init-expanded"><a name="L182"></a><tt class="py-lineno">182</tt>  <tt class="py-line">        <tt class="py-docstring">"""Initiate by indexing FOG regarding all available machines."""</tt> </tt>
<a name="L183"></a><tt class="py-lineno">183</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">fog_machines</tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt> </tt>
<a name="L184"></a><tt class="py-lineno">184</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-143" class="py-name"><a title="modules.machinery.physical.HAVE_FOG" class="py-name" href="#" onclick="return doclink('link-143', 'HAVE_FOG', 'link-1');">HAVE_FOG</a></tt> <tt class="py-keyword">or</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-144" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-144', 'options', 'link-27');">options</a></tt><tt class="py-op">.</tt><tt class="py-name">fog</tt><tt class="py-op">.</tt><tt class="py-name">hostname</tt> <tt class="py-op">==</tt> <tt class="py-string">"none"</tt><tt class="py-op">:</tt> </tt>
<a name="L185"></a><tt class="py-lineno">185</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> </tt>
<a name="L186"></a><tt class="py-lineno">186</tt>  <tt class="py-line"> </tt>
<a name="L187"></a><tt class="py-lineno">187</tt>  <tt class="py-line">        <tt class="py-comment"># TODO Handle exceptions such as not being able to connect.</tt> </tt>
<a name="L188"></a><tt class="py-lineno">188</tt>  <tt class="py-line">        <tt class="py-name">r</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-145" class="py-name" targets="Method modules.machinery.physical.Physical.fog_query()=modules.machinery.physical.Physical-class.html#fog_query"><a title="modules.machinery.physical.Physical.fog_query" class="py-name" href="#" onclick="return doclink('link-145', 'fog_query', 'link-145');">fog_query</a></tt><tt class="py-op">(</tt><tt class="py-string">"node=tasks&amp;sub=listhosts"</tt><tt class="py-op">)</tt> </tt>
<a name="L189"></a><tt class="py-lineno">189</tt>  <tt class="py-line"> </tt>
<a name="L190"></a><tt class="py-lineno">190</tt>  <tt class="py-line">        <tt class="py-comment"># Parse the HTML.</tt> </tt>
<a name="L191"></a><tt class="py-lineno">191</tt>  <tt class="py-line">        <tt class="py-name">b</tt> <tt class="py-op">=</tt> <tt class="py-name">bs4</tt><tt class="py-op">.</tt><tt class="py-name">BeautifulSoup</tt><tt class="py-op">(</tt><tt class="py-name">r</tt><tt class="py-op">.</tt><tt class="py-name">content</tt><tt class="py-op">,</tt> <tt class="py-string">"html.parser"</tt><tt class="py-op">)</tt> </tt>
<a name="L192"></a><tt class="py-lineno">192</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">b</tt><tt class="py-op">.</tt><tt class="py-name">find_all</tt><tt class="py-op">(</tt><tt class="py-string">"table"</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L193"></a><tt class="py-lineno">193</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-146" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooCriticalError" class="py-name" href="#" onclick="return doclink('link-146', 'CuckooCriticalError', 'link-18');">CuckooCriticalError</a></tt><tt class="py-op">(</tt> </tt>
<a name="L194"></a><tt class="py-lineno">194</tt>  <tt class="py-line">                <tt class="py-string">"The supplied FOG username and/or password do not allow us "</tt> </tt>
<a name="L195"></a><tt class="py-lineno">195</tt>  <tt class="py-line">                <tt class="py-string">"to login into FOG, please configure the correct credentials."</tt> </tt>
<a name="L196"></a><tt class="py-lineno">196</tt>  <tt class="py-line">            <tt class="py-op">)</tt> </tt>
<a name="L197"></a><tt class="py-lineno">197</tt>  <tt class="py-line"> </tt>
<a name="L198"></a><tt class="py-lineno">198</tt>  <tt class="py-line">        <tt class="py-comment"># Mapping for physical machine hostnames to their mac address and uri</tt> </tt>
<a name="L199"></a><tt class="py-lineno">199</tt>  <tt class="py-line">        <tt class="py-comment"># for "downloading" a safe image onto the host. Great piece of FOG API</tt> </tt>
<a name="L200"></a><tt class="py-lineno">200</tt>  <tt class="py-line">        <tt class="py-comment"># usage here.</tt> </tt>
<a name="L201"></a><tt class="py-lineno">201</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">row</tt> <tt class="py-keyword">in</tt> <tt class="py-name">b</tt><tt class="py-op">.</tt><tt class="py-name">find_all</tt><tt class="py-op">(</tt><tt class="py-string">"table"</tt><tt class="py-op">)</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt class="py-name">find_all</tt><tt class="py-op">(</tt><tt class="py-string">"tr"</tt><tt class="py-op">)</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">:</tt><tt class="py-op">]</tt><tt class="py-op">:</tt> </tt>
<a name="L202"></a><tt class="py-lineno">202</tt>  <tt class="py-line">            <tt class="py-name">hostname</tt><tt class="py-op">,</tt> <tt class="py-name">macaddr</tt><tt class="py-op">,</tt> <tt class="py-name">download</tt><tt class="py-op">,</tt> <tt class="py-name">upload</tt><tt class="py-op">,</tt> <tt class="py-name">advanced</tt> <tt class="py-op">=</tt> <tt class="py-name">row</tt><tt class="py-op">.</tt><tt class="py-name">find_all</tt><tt class="py-op">(</tt><tt class="py-string">"td"</tt><tt class="py-op">)</tt> </tt>
<a name="L203"></a><tt class="py-lineno">203</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">fog_machines</tt><tt class="py-op">[</tt><tt class="py-name">hostname</tt><tt class="py-op">.</tt><tt class="py-name">text</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-op">(</tt> </tt>
<a name="L204"></a><tt class="py-lineno">204</tt>  <tt class="py-line">                <tt class="py-name">macaddr</tt><tt class="py-op">.</tt><tt class="py-name">text</tt><tt class="py-op">,</tt> <tt id="link-147" class="py-name" targets="Method modules.processing.network.SortCap.next()=modules.processing.network.SortCap-class.html#next"><a title="modules.processing.network.SortCap.next" class="py-name" href="#" onclick="return doclink('link-147', 'next', 'link-147');">next</a></tt><tt class="py-op">(</tt><tt class="py-name">download</tt><tt class="py-op">.</tt><tt class="py-name">children</tt><tt class="py-op">)</tt><tt class="py-op">.</tt><tt class="py-name">attrs</tt><tt class="py-op">[</tt><tt class="py-string">"href"</tt><tt class="py-op">]</tt><tt class="py-op">[</tt><tt class="py-number">1</tt><tt class="py-op">:</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> </tt>
<a name="L205"></a><tt class="py-lineno">205</tt>  <tt class="py-line">            <tt class="py-op">)</tt> </tt>
<a name="L206"></a><tt class="py-lineno">206</tt>  <tt class="py-line"> </tt>
<a name="L207"></a><tt class="py-lineno">207</tt>  <tt class="py-line">        <tt class="py-comment"># Check whether all our machines are available on FOG.</tt> </tt>
<a name="L208"></a><tt class="py-lineno">208</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-148" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-148', 'machine', 'link-33');">machine</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-149" class="py-name"><a title="lib.cuckoo.common.abstracts.Machinery.machines" class="py-name" href="#" onclick="return doclink('link-149', 'machines', 'link-34');">machines</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L209"></a><tt class="py-lineno">209</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-150" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-150', 'machine', 'link-33');">machine</a></tt><tt class="py-op">.</tt><tt id="link-151" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-151', 'label', 'link-38');">label</a></tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">fog_machines</tt><tt class="py-op">:</tt> </tt>
<a name="L210"></a><tt class="py-lineno">210</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-152" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-152', 'CuckooMachineError', 'link-23');">CuckooMachineError</a></tt><tt class="py-op">(</tt> </tt>
<a name="L211"></a><tt class="py-lineno">211</tt>  <tt class="py-line">                    <tt class="py-string">"The physical machine %s has not been defined in FOG, "</tt> </tt>
<a name="L212"></a><tt class="py-lineno">212</tt>  <tt class="py-line">                    <tt class="py-string">"please investigate and configure the configuration "</tt> </tt>
<a name="L213"></a><tt class="py-lineno">213</tt>  <tt class="py-line">                    <tt class="py-string">"correctly."</tt> <tt class="py-op">%</tt> <tt id="link-153" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-153', 'machine', 'link-33');">machine</a></tt><tt class="py-op">.</tt><tt id="link-154" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-154', 'label', 'link-38');">label</a></tt> </tt>
<a name="L214"></a><tt class="py-lineno">214</tt>  <tt class="py-line">                <tt class="py-op">)</tt> </tt>
</div><a name="L215"></a><tt class="py-lineno">215</tt>  <tt class="py-line"> </tt>
<a name="Physical.fog_queue_task"></a><div id="Physical.fog_queue_task-def"><a name="L216"></a><tt class="py-lineno">216</tt> <a class="py-toggle" href="#" id="Physical.fog_queue_task-toggle" onclick="return toggle('Physical.fog_queue_task');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.machinery.physical.Physical-class.html#fog_queue_task">fog_queue_task</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">hostname</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Physical.fog_queue_task-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="Physical.fog_queue_task-expanded"><a name="L217"></a><tt class="py-lineno">217</tt>  <tt class="py-line">        <tt class="py-docstring">"""Queues a task with FOG to deploy the given machine after reboot."""</tt> </tt>
<a name="L218"></a><tt class="py-lineno">218</tt>  <tt class="py-line">        <tt class="py-name">macaddr</tt><tt class="py-op">,</tt> <tt class="py-name">download</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">fog_machines</tt><tt class="py-op">[</tt><tt class="py-name">hostname</tt><tt class="py-op">]</tt> </tt>
<a name="L219"></a><tt class="py-lineno">219</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-155" class="py-name"><a title="modules.machinery.physical.Physical.fog_query" class="py-name" href="#" onclick="return doclink('link-155', 'fog_query', 'link-145');">fog_query</a></tt><tt class="py-op">(</tt><tt class="py-name">download</tt><tt class="py-op">)</tt> </tt>
</div><a name="L220"></a><tt class="py-lineno">220</tt>  <tt class="py-line"> </tt>
<a name="Physical.wake_on_lan"></a><div id="Physical.wake_on_lan-def"><a name="L221"></a><tt class="py-lineno">221</tt> <a class="py-toggle" href="#" id="Physical.wake_on_lan-toggle" onclick="return toggle('Physical.wake_on_lan');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="modules.machinery.physical.Physical-class.html#wake_on_lan">wake_on_lan</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">hostname</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Physical.wake_on_lan-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="Physical.wake_on_lan-expanded"><a name="L222"></a><tt class="py-lineno">222</tt>  <tt class="py-line">        <tt class="py-docstring">"""Start a machine that's currently shutdown."""</tt> </tt>
<a name="L223"></a><tt class="py-lineno">223</tt>  <tt class="py-line">        <tt class="py-name">macaddr</tt><tt class="py-op">,</tt> <tt class="py-name">download</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">fog_machines</tt><tt class="py-op">[</tt><tt class="py-name">hostname</tt><tt class="py-op">]</tt> </tt>
<a name="L224"></a><tt class="py-lineno">224</tt>  <tt class="py-line">        <tt class="py-name">wakeonlan</tt><tt class="py-op">.</tt><tt class="py-name">wol</tt><tt class="py-op">.</tt><tt class="py-name">send_magic_packet</tt><tt class="py-op">(</tt><tt class="py-name">macaddr</tt><tt class="py-op">)</tt> </tt>
</div></div><a name="L225"></a><tt class="py-lineno">225</tt>  <tt class="py-line"> </tt><script type="text/javascript">
<!--
expandto(location.href);
// -->
</script>
</pre>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://cuckoosandbox.org">Cuckoo Sandbox</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Mon Jan 11 19:29:09 2016
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
