<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>lib.cuckoo.core.scheduler</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://cuckoosandbox.org">Cuckoo Sandbox</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="lib-module.html">Package&nbsp;lib</a> ::
        <a href="lib.cuckoo-module.html">Package&nbsp;cuckoo</a> ::
        <a href="lib.cuckoo.core-module.html">Package&nbsp;core</a> ::
        Module&nbsp;scheduler
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="lib.cuckoo.core.scheduler-pysrc.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<h1 class="epydoc">Source Code for <a href="lib.cuckoo.core.scheduler-module.html">Module lib.cuckoo.core.scheduler</a></h1>
<pre class="py-src">
<a name="L1"></a><tt class="py-lineno">  1</tt>  <tt class="py-line"><tt class="py-comment"># Copyright (C) 2010-2013 Claudio Guarnieri.</tt> </tt>
<a name="L2"></a><tt class="py-lineno">  2</tt>  <tt class="py-line"><tt class="py-comment"># Copyright (C) 2014-2015 Cuckoo Foundation.</tt> </tt>
<a name="L3"></a><tt class="py-lineno">  3</tt>  <tt class="py-line"><tt class="py-comment"># This file is part of Cuckoo Sandbox - http://www.cuckoosandbox.org</tt> </tt>
<a name="L4"></a><tt class="py-lineno">  4</tt>  <tt class="py-line"><tt class="py-comment"># See the file 'docs/LICENSE' for copying permission.</tt> </tt>
<a name="L5"></a><tt class="py-lineno">  5</tt>  <tt class="py-line"> </tt>
<a name="L6"></a><tt class="py-lineno">  6</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">os</tt> </tt>
<a name="L7"></a><tt class="py-lineno">  7</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">time</tt> </tt>
<a name="L8"></a><tt class="py-lineno">  8</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">shutil</tt> </tt>
<a name="L9"></a><tt class="py-lineno">  9</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">logging</tt> </tt>
<a name="L10"></a><tt class="py-lineno"> 10</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">threading</tt> </tt>
<a name="L11"></a><tt class="py-lineno"> 11</tt>  <tt class="py-line"><tt class="py-keyword">import</tt> <tt class="py-name">Queue</tt> </tt>
<a name="L12"></a><tt class="py-lineno"> 12</tt>  <tt class="py-line"> </tt>
<a name="L13"></a><tt class="py-lineno"> 13</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-0" class="py-name" targets="Package lib=lib-module.html"><a title="lib" class="py-name" href="#" onclick="return doclink('link-0', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-1" class="py-name" targets="Package lib.cuckoo=lib.cuckoo-module.html"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-1', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-2" class="py-name" targets="Package lib.cuckoo.common=lib.cuckoo.common-module.html"><a title="lib.cuckoo.common" class="py-name" href="#" onclick="return doclink('link-2', 'common', 'link-2');">common</a></tt><tt class="py-op">.</tt><tt id="link-3" class="py-name" targets="Module lib.cuckoo.common.config=lib.cuckoo.common.config-module.html"><a title="lib.cuckoo.common.config" class="py-name" href="#" onclick="return doclink('link-3', 'config', 'link-3');">config</a></tt> <tt class="py-keyword">import</tt> <tt id="link-4" class="py-name" targets="Class lib.cuckoo.common.config.Config=lib.cuckoo.common.config.Config-class.html"><a title="lib.cuckoo.common.config.Config" class="py-name" href="#" onclick="return doclink('link-4', 'Config', 'link-4');">Config</a></tt><tt class="py-op">,</tt> <tt id="link-5" class="py-name" targets="Function lib.cuckoo.common.config.parse_options()=lib.cuckoo.common.config-module.html#parse_options"><a title="lib.cuckoo.common.config.parse_options" class="py-name" href="#" onclick="return doclink('link-5', 'parse_options', 'link-5');">parse_options</a></tt><tt class="py-op">,</tt> <tt id="link-6" class="py-name" targets="Function lib.cuckoo.common.config.emit_options()=lib.cuckoo.common.config-module.html#emit_options"><a title="lib.cuckoo.common.config.emit_options" class="py-name" href="#" onclick="return doclink('link-6', 'emit_options', 'link-6');">emit_options</a></tt> </tt>
<a name="L14"></a><tt class="py-lineno"> 14</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-7" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-7', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-8" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-8', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-9" class="py-name"><a title="lib.cuckoo.common" class="py-name" href="#" onclick="return doclink('link-9', 'common', 'link-2');">common</a></tt><tt class="py-op">.</tt><tt id="link-10" class="py-name" targets="Module lib.cuckoo.common.constants=lib.cuckoo.common.constants-module.html"><a title="lib.cuckoo.common.constants" class="py-name" href="#" onclick="return doclink('link-10', 'constants', 'link-10');">constants</a></tt> <tt class="py-keyword">import</tt> <tt id="link-11" class="py-name" targets="Variable lib.cuckoo.common.constants.CUCKOO_ROOT=lib.cuckoo.common.constants-module.html#CUCKOO_ROOT"><a title="lib.cuckoo.common.constants.CUCKOO_ROOT" class="py-name" href="#" onclick="return doclink('link-11', 'CUCKOO_ROOT', 'link-11');">CUCKOO_ROOT</a></tt> </tt>
<a name="L15"></a><tt class="py-lineno"> 15</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-12" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-12', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-13" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-13', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-14" class="py-name"><a title="lib.cuckoo.common" class="py-name" href="#" onclick="return doclink('link-14', 'common', 'link-2');">common</a></tt><tt class="py-op">.</tt><tt id="link-15" class="py-name" targets="Module lib.cuckoo.common.exceptions=lib.cuckoo.common.exceptions-module.html"><a title="lib.cuckoo.common.exceptions" class="py-name" href="#" onclick="return doclink('link-15', 'exceptions', 'link-15');">exceptions</a></tt> <tt class="py-keyword">import</tt> <tt id="link-16" class="py-name" targets="Class lib.cuckoo.common.exceptions.CuckooMachineError=lib.cuckoo.common.exceptions.CuckooMachineError-class.html"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-16', 'CuckooMachineError', 'link-16');">CuckooMachineError</a></tt><tt class="py-op">,</tt> <tt id="link-17" class="py-name" targets="Class lib.cuckoo.common.exceptions.CuckooGuestError=lib.cuckoo.common.exceptions.CuckooGuestError-class.html"><a title="lib.cuckoo.common.exceptions.CuckooGuestError" class="py-name" href="#" onclick="return doclink('link-17', 'CuckooGuestError', 'link-17');">CuckooGuestError</a></tt> </tt>
<a name="L16"></a><tt class="py-lineno"> 16</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-18" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-18', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-19" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-19', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-20" class="py-name"><a title="lib.cuckoo.common" class="py-name" href="#" onclick="return doclink('link-20', 'common', 'link-2');">common</a></tt><tt class="py-op">.</tt><tt id="link-21" class="py-name"><a title="lib.cuckoo.common.exceptions" class="py-name" href="#" onclick="return doclink('link-21', 'exceptions', 'link-15');">exceptions</a></tt> <tt class="py-keyword">import</tt> <tt id="link-22" class="py-name" targets="Class lib.cuckoo.common.exceptions.CuckooOperationalError=lib.cuckoo.common.exceptions.CuckooOperationalError-class.html"><a title="lib.cuckoo.common.exceptions.CuckooOperationalError" class="py-name" href="#" onclick="return doclink('link-22', 'CuckooOperationalError', 'link-22');">CuckooOperationalError</a></tt> </tt>
<a name="L17"></a><tt class="py-lineno"> 17</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-23" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-23', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-24" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-24', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-25" class="py-name"><a title="lib.cuckoo.common" class="py-name" href="#" onclick="return doclink('link-25', 'common', 'link-2');">common</a></tt><tt class="py-op">.</tt><tt id="link-26" class="py-name"><a title="lib.cuckoo.common.exceptions" class="py-name" href="#" onclick="return doclink('link-26', 'exceptions', 'link-15');">exceptions</a></tt> <tt class="py-keyword">import</tt> <tt id="link-27" class="py-name" targets="Class lib.cuckoo.common.exceptions.CuckooCriticalError=lib.cuckoo.common.exceptions.CuckooCriticalError-class.html"><a title="lib.cuckoo.common.exceptions.CuckooCriticalError" class="py-name" href="#" onclick="return doclink('link-27', 'CuckooCriticalError', 'link-27');">CuckooCriticalError</a></tt> </tt>
<a name="L18"></a><tt class="py-lineno"> 18</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-28" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-28', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-29" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-29', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-30" class="py-name"><a title="lib.cuckoo.common" class="py-name" href="#" onclick="return doclink('link-30', 'common', 'link-2');">common</a></tt><tt class="py-op">.</tt><tt id="link-31" class="py-name" targets="Module lib.cuckoo.common.objects=lib.cuckoo.common.objects-module.html"><a title="lib.cuckoo.common.objects" class="py-name" href="#" onclick="return doclink('link-31', 'objects', 'link-31');">objects</a></tt> <tt class="py-keyword">import</tt> <tt id="link-32" class="py-name" targets="Class lib.cuckoo.common.objects.File=lib.cuckoo.common.objects.File-class.html"><a title="lib.cuckoo.common.objects.File" class="py-name" href="#" onclick="return doclink('link-32', 'File', 'link-32');">File</a></tt> </tt>
<a name="L19"></a><tt class="py-lineno"> 19</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-33" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-33', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-34" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-34', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-35" class="py-name"><a title="lib.cuckoo.common" class="py-name" href="#" onclick="return doclink('link-35', 'common', 'link-2');">common</a></tt><tt class="py-op">.</tt><tt id="link-36" class="py-name" targets="Module lib.cuckoo.common.utils=lib.cuckoo.common.utils-module.html"><a title="lib.cuckoo.common.utils" class="py-name" href="#" onclick="return doclink('link-36', 'utils', 'link-36');">utils</a></tt> <tt class="py-keyword">import</tt> <tt id="link-37" class="py-name" targets="Function lib.cuckoo.common.utils.create_folder()=lib.cuckoo.common.utils-module.html#create_folder"><a title="lib.cuckoo.common.utils.create_folder" class="py-name" href="#" onclick="return doclink('link-37', 'create_folder', 'link-37');">create_folder</a></tt> </tt>
<a name="L20"></a><tt class="py-lineno"> 20</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-38" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-38', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-39" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-39', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-40" class="py-name" targets="Package lib.cuckoo.core=lib.cuckoo.core-module.html"><a title="lib.cuckoo.core" class="py-name" href="#" onclick="return doclink('link-40', 'core', 'link-40');">core</a></tt><tt class="py-op">.</tt><tt id="link-41" class="py-name" targets="Module lib.cuckoo.core.database=lib.cuckoo.core.database-module.html"><a title="lib.cuckoo.core.database" class="py-name" href="#" onclick="return doclink('link-41', 'database', 'link-41');">database</a></tt> <tt class="py-keyword">import</tt> <tt id="link-42" class="py-name" targets="Class lib.cuckoo.core.database.Database=lib.cuckoo.core.database.Database-class.html"><a title="lib.cuckoo.core.database.Database" class="py-name" href="#" onclick="return doclink('link-42', 'Database', 'link-42');">Database</a></tt><tt class="py-op">,</tt> <tt id="link-43" class="py-name" targets="Variable lib.cuckoo.core.database.TASK_COMPLETED=lib.cuckoo.core.database-module.html#TASK_COMPLETED"><a title="lib.cuckoo.core.database.TASK_COMPLETED" class="py-name" href="#" onclick="return doclink('link-43', 'TASK_COMPLETED', 'link-43');">TASK_COMPLETED</a></tt><tt class="py-op">,</tt> <tt id="link-44" class="py-name" targets="Variable lib.cuckoo.core.database.TASK_REPORTED=lib.cuckoo.core.database-module.html#TASK_REPORTED"><a title="lib.cuckoo.core.database.TASK_REPORTED" class="py-name" href="#" onclick="return doclink('link-44', 'TASK_REPORTED', 'link-44');">TASK_REPORTED</a></tt> </tt>
<a name="L21"></a><tt class="py-lineno"> 21</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-45" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-45', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-46" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-46', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-47" class="py-name"><a title="lib.cuckoo.core" class="py-name" href="#" onclick="return doclink('link-47', 'core', 'link-40');">core</a></tt><tt class="py-op">.</tt><tt id="link-48" class="py-name" targets="Variable lib.cuckoo.core.database.Task.guest=lib.cuckoo.core.database.Task-class.html#guest,Module lib.cuckoo.core.guest=lib.cuckoo.core.guest-module.html"><a title="lib.cuckoo.core.database.Task.guest
lib.cuckoo.core.guest" class="py-name" href="#" onclick="return doclink('link-48', 'guest', 'link-48');">guest</a></tt> <tt class="py-keyword">import</tt> <tt id="link-49" class="py-name" targets="Class lib.cuckoo.core.guest.GuestManager=lib.cuckoo.core.guest.GuestManager-class.html"><a title="lib.cuckoo.core.guest.GuestManager" class="py-name" href="#" onclick="return doclink('link-49', 'GuestManager', 'link-49');">GuestManager</a></tt> </tt>
<a name="L22"></a><tt class="py-lineno"> 22</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-50" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-50', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-51" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-51', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-52" class="py-name"><a title="lib.cuckoo.core" class="py-name" href="#" onclick="return doclink('link-52', 'core', 'link-40');">core</a></tt><tt class="py-op">.</tt><tt id="link-53" class="py-name" targets="Module lib.cuckoo.core.plugins=lib.cuckoo.core.plugins-module.html"><a title="lib.cuckoo.core.plugins" class="py-name" href="#" onclick="return doclink('link-53', 'plugins', 'link-53');">plugins</a></tt> <tt class="py-keyword">import</tt> <tt id="link-54" class="py-name" targets="Function lib.cuckoo.core.plugins.list_plugins()=lib.cuckoo.core.plugins-module.html#list_plugins"><a title="lib.cuckoo.core.plugins.list_plugins" class="py-name" href="#" onclick="return doclink('link-54', 'list_plugins', 'link-54');">list_plugins</a></tt><tt class="py-op">,</tt> <tt id="link-55" class="py-name" targets="Class lib.cuckoo.core.plugins.RunAuxiliary=lib.cuckoo.core.plugins.RunAuxiliary-class.html"><a title="lib.cuckoo.core.plugins.RunAuxiliary" class="py-name" href="#" onclick="return doclink('link-55', 'RunAuxiliary', 'link-55');">RunAuxiliary</a></tt><tt class="py-op">,</tt> <tt id="link-56" class="py-name" targets="Class lib.cuckoo.core.plugins.RunProcessing=lib.cuckoo.core.plugins.RunProcessing-class.html"><a title="lib.cuckoo.core.plugins.RunProcessing" class="py-name" href="#" onclick="return doclink('link-56', 'RunProcessing', 'link-56');">RunProcessing</a></tt> </tt>
<a name="L23"></a><tt class="py-lineno"> 23</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-57" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-57', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-58" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-58', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-59" class="py-name"><a title="lib.cuckoo.core" class="py-name" href="#" onclick="return doclink('link-59', 'core', 'link-40');">core</a></tt><tt class="py-op">.</tt><tt id="link-60" class="py-name"><a title="lib.cuckoo.core.plugins" class="py-name" href="#" onclick="return doclink('link-60', 'plugins', 'link-53');">plugins</a></tt> <tt class="py-keyword">import</tt> <tt id="link-61" class="py-name" targets="Class lib.cuckoo.core.plugins.RunSignatures=lib.cuckoo.core.plugins.RunSignatures-class.html"><a title="lib.cuckoo.core.plugins.RunSignatures" class="py-name" href="#" onclick="return doclink('link-61', 'RunSignatures', 'link-61');">RunSignatures</a></tt><tt class="py-op">,</tt> <tt id="link-62" class="py-name" targets="Class lib.cuckoo.core.plugins.RunReporting=lib.cuckoo.core.plugins.RunReporting-class.html"><a title="lib.cuckoo.core.plugins.RunReporting" class="py-name" href="#" onclick="return doclink('link-62', 'RunReporting', 'link-62');">RunReporting</a></tt> </tt>
<a name="L24"></a><tt class="py-lineno"> 24</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-63" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-63', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-64" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-64', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-65" class="py-name"><a title="lib.cuckoo.core" class="py-name" href="#" onclick="return doclink('link-65', 'core', 'link-40');">core</a></tt><tt class="py-op">.</tt><tt id="link-66" class="py-name" targets="Module lib.cuckoo.core.resultserver=lib.cuckoo.core.resultserver-module.html"><a title="lib.cuckoo.core.resultserver" class="py-name" href="#" onclick="return doclink('link-66', 'resultserver', 'link-66');">resultserver</a></tt> <tt class="py-keyword">import</tt> <tt id="link-67" class="py-name" targets="Class lib.cuckoo.core.resultserver.ResultServer=lib.cuckoo.core.resultserver.ResultServer-class.html"><a title="lib.cuckoo.core.resultserver.ResultServer" class="py-name" href="#" onclick="return doclink('link-67', 'ResultServer', 'link-67');">ResultServer</a></tt> </tt>
<a name="L25"></a><tt class="py-lineno"> 25</tt>  <tt class="py-line"><tt class="py-keyword">from</tt> <tt id="link-68" class="py-name"><a title="lib" class="py-name" href="#" onclick="return doclink('link-68', 'lib', 'link-0');">lib</a></tt><tt class="py-op">.</tt><tt id="link-69" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-69', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-70" class="py-name"><a title="lib.cuckoo.core" class="py-name" href="#" onclick="return doclink('link-70', 'core', 'link-40');">core</a></tt><tt class="py-op">.</tt><tt id="link-71" class="py-name" targets="Module lib.cuckoo.core.rooter=lib.cuckoo.core.rooter-module.html,Function lib.cuckoo.core.rooter.rooter()=lib.cuckoo.core.rooter-module.html#rooter"><a title="lib.cuckoo.core.rooter
lib.cuckoo.core.rooter.rooter" class="py-name" href="#" onclick="return doclink('link-71', 'rooter', 'link-71');">rooter</a></tt> <tt class="py-keyword">import</tt> <tt id="link-72" class="py-name"><a title="lib.cuckoo.core.rooter
lib.cuckoo.core.rooter.rooter" class="py-name" href="#" onclick="return doclink('link-72', 'rooter', 'link-71');">rooter</a></tt><tt class="py-op">,</tt> <tt id="link-73" class="py-name" targets="Variable lib.cuckoo.core.rooter.vpns=lib.cuckoo.core.rooter-module.html#vpns"><a title="lib.cuckoo.core.rooter.vpns" class="py-name" href="#" onclick="return doclink('link-73', 'vpns', 'link-73');">vpns</a></tt> </tt>
<a name="L26"></a><tt class="py-lineno"> 26</tt>  <tt class="py-line"> </tt>
<a name="L27"></a><tt class="py-lineno"> 27</tt>  <tt class="py-line"><tt id="link-74" class="py-name" targets="Variable lib.cuckoo.common.abstracts.log=lib.cuckoo.common.abstracts-module.html#log,Variable lib.cuckoo.common.irc.log=lib.cuckoo.common.irc-module.html#log,Variable lib.cuckoo.common.netlog.log=lib.cuckoo.common.netlog-module.html#log,Variable lib.cuckoo.common.objects.log=lib.cuckoo.common.objects-module.html#log,Variable lib.cuckoo.core.database.log=lib.cuckoo.core.database-module.html#log,Variable lib.cuckoo.core.guest.log=lib.cuckoo.core.guest-module.html#log,Variable lib.cuckoo.core.plugins.log=lib.cuckoo.core.plugins-module.html#log,Variable lib.cuckoo.core.resultserver.log=lib.cuckoo.core.resultserver-module.html#log,Variable lib.cuckoo.core.rooter.log=lib.cuckoo.core.rooter-module.html#log,Variable lib.cuckoo.core.scheduler.log=lib.cuckoo.core.scheduler-module.html#log,Variable lib.cuckoo.core.startup.log=lib.cuckoo.core.startup-module.html#log,Variable modules.auxiliary.mitm.log=modules.auxiliary.mitm-module.html#log,Variable modules.auxiliary.services.log=modules.auxiliary.services-module.html#log,Variable modules.auxiliary.sniffer.log=modules.auxiliary.sniffer-module.html#log,Variable modules.machinery.avd.log=modules.machinery.avd-module.html#log,Variable modules.machinery.physical.log=modules.machinery.physical-module.html#log,Variable modules.machinery.qemu.log=modules.machinery.qemu-module.html#log,Variable modules.machinery.virtualbox.log=modules.machinery.virtualbox-module.html#log,Variable modules.machinery.vmware.log=modules.machinery.vmware-module.html#log,Variable modules.machinery.vsphere.log=modules.machinery.vsphere-module.html#log,Variable modules.machinery.xenserver.log=modules.machinery.xenserver-module.html#log,Variable modules.processing.analysisinfo.log=modules.processing.analysisinfo-module.html#log,Variable modules.processing.apkinfo.log=modules.processing.apkinfo-module.html#log,Variable modules.processing.baseline.log=modules.processing.baseline-module.html#log,Variable modules.processing.behavior.log=modules.processing.behavior-module.html#log,Variable modules.processing.droidmon.log=modules.processing.droidmon-module.html#log,Variable modules.processing.dumptls.log=modules.processing.dumptls-module.html#log,Variable modules.processing.googleplay.log=modules.processing.googleplay-module.html#log,Variable modules.processing.memory.log=modules.processing.memory-module.html#log,Variable modules.processing.network.log=modules.processing.network-module.html#log,Variable modules.processing.platform.linux.log=modules.processing.platform.linux-module.html#log,Variable modules.processing.platform.windows.log=modules.processing.platform.windows-module.html#log,Variable modules.processing.screenshots.log=modules.processing.screenshots-module.html#log,Variable modules.processing.snort.log=modules.processing.snort-module.html#log,Variable modules.processing.static.log=modules.processing.static-module.html#log,Variable modules.processing.suricata.log=modules.processing.suricata-module.html#log,Variable modules.processing.virustotal.log=modules.processing.virustotal-module.html#log,Variable modules.reporting.moloch.log=modules.reporting.moloch-module.html#log"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-74', 'log', 'link-74');">log</a></tt> <tt class="py-op">=</tt> <tt class="py-name">logging</tt><tt class="py-op">.</tt><tt class="py-name">getLogger</tt><tt class="py-op">(</tt><tt class="py-name">__name__</tt><tt class="py-op">)</tt> </tt>
<a name="L28"></a><tt class="py-lineno"> 28</tt>  <tt class="py-line"> </tt>
<a name="L29"></a><tt class="py-lineno"> 29</tt>  <tt class="py-line"><tt id="link-75" class="py-name" targets="Variable lib.cuckoo.core.scheduler.machinery=lib.cuckoo.core.scheduler-module.html#machinery,Package modules.machinery=modules.machinery-module.html"><a title="lib.cuckoo.core.scheduler.machinery
modules.machinery" class="py-name" href="#" onclick="return doclink('link-75', 'machinery', 'link-75');">machinery</a></tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L30"></a><tt class="py-lineno"> 30</tt>  <tt class="py-line"><tt id="link-76" class="py-name" targets="Variable lib.cuckoo.core.scheduler.machine_lock=lib.cuckoo.core.scheduler-module.html#machine_lock"><a title="lib.cuckoo.core.scheduler.machine_lock" class="py-name" href="#" onclick="return doclink('link-76', 'machine_lock', 'link-76');">machine_lock</a></tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L31"></a><tt class="py-lineno"> 31</tt>  <tt class="py-line"><tt id="link-77" class="py-name" targets="Variable lib.cuckoo.core.scheduler.latest_symlink_lock=lib.cuckoo.core.scheduler-module.html#latest_symlink_lock"><a title="lib.cuckoo.core.scheduler.latest_symlink_lock" class="py-name" href="#" onclick="return doclink('link-77', 'latest_symlink_lock', 'link-77');">latest_symlink_lock</a></tt> <tt class="py-op">=</tt> <tt class="py-name">threading</tt><tt class="py-op">.</tt><tt class="py-name">Lock</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L32"></a><tt class="py-lineno"> 32</tt>  <tt class="py-line"> </tt>
<a name="L33"></a><tt class="py-lineno"> 33</tt>  <tt class="py-line"><tt id="link-78" class="py-name" targets="Variable lib.cuckoo.core.scheduler.active_analysis_count=lib.cuckoo.core.scheduler-module.html#active_analysis_count"><a title="lib.cuckoo.core.scheduler.active_analysis_count" class="py-name" href="#" onclick="return doclink('link-78', 'active_analysis_count', 'link-78');">active_analysis_count</a></tt> <tt class="py-op">=</tt> <tt class="py-number">0</tt> </tt>
<a name="L34"></a><tt class="py-lineno"> 34</tt>  <tt class="py-line"> </tt>
<a name="AnalysisManager"></a><div id="AnalysisManager-def"><a name="L35"></a><tt class="py-lineno"> 35</tt> <a class="py-toggle" href="#" id="AnalysisManager-toggle" onclick="return toggle('AnalysisManager');">-</a><tt class="py-line"><tt class="py-keyword">class</tt> <a class="py-def-name" href="lib.cuckoo.core.scheduler.AnalysisManager-class.html">AnalysisManager</a><tt class="py-op">(</tt><tt class="py-base-class">threading</tt><tt class="py-op">.</tt><tt class="py-base-class">Thread</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="AnalysisManager-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="AnalysisManager-expanded"><a name="L36"></a><tt class="py-lineno"> 36</tt>  <tt class="py-line">    <tt class="py-docstring">"""Analysis Manager.</tt> </tt>
<a name="L37"></a><tt class="py-lineno"> 37</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L38"></a><tt class="py-lineno"> 38</tt>  <tt class="py-line"><tt class="py-docstring">    This class handles the full analysis process for a given task. It takes</tt> </tt>
<a name="L39"></a><tt class="py-lineno"> 39</tt>  <tt class="py-line"><tt class="py-docstring">    care of selecting the analysis machine, preparing the configuration and</tt> </tt>
<a name="L40"></a><tt class="py-lineno"> 40</tt>  <tt class="py-line"><tt class="py-docstring">    interacting with the guest agent and analyzer components to launch and</tt> </tt>
<a name="L41"></a><tt class="py-lineno"> 41</tt>  <tt class="py-line"><tt class="py-docstring">    complete the analysis and store, process and report its results.</tt> </tt>
<a name="L42"></a><tt class="py-lineno"> 42</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="L43"></a><tt class="py-lineno"> 43</tt>  <tt class="py-line"> </tt>
<a name="AnalysisManager.__init__"></a><div id="AnalysisManager.__init__-def"><a name="L44"></a><tt class="py-lineno"> 44</tt> <a class="py-toggle" href="#" id="AnalysisManager.__init__-toggle" onclick="return toggle('AnalysisManager.__init__');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.scheduler.AnalysisManager-class.html#__init__">__init__</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">task</tt><tt class="py-op">,</tt> <tt class="py-param">error_queue</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="AnalysisManager.__init__-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="AnalysisManager.__init__-expanded"><a name="L45"></a><tt class="py-lineno"> 45</tt>  <tt class="py-line">        <tt class="py-docstring">"""@param task: task object containing the details for the analysis."""</tt> </tt>
<a name="L46"></a><tt class="py-lineno"> 46</tt>  <tt class="py-line">        <tt class="py-name">threading</tt><tt class="py-op">.</tt><tt class="py-name">Thread</tt><tt class="py-op">.</tt><tt id="link-79" class="py-name" targets="Method lib.cuckoo.common.abstracts.Auxiliary.__init__()=lib.cuckoo.common.abstracts.Auxiliary-class.html#__init__,Method lib.cuckoo.common.abstracts.BehaviorHandler.__init__()=lib.cuckoo.common.abstracts.BehaviorHandler-class.html#__init__,Method lib.cuckoo.common.abstracts.LibVirtMachinery.__init__()=lib.cuckoo.common.abstracts.LibVirtMachinery-class.html#__init__,Method lib.cuckoo.common.abstracts.Machinery.__init__()=lib.cuckoo.common.abstracts.Machinery-class.html#__init__,Method lib.cuckoo.common.abstracts.Processing.__init__()=lib.cuckoo.common.abstracts.Processing-class.html#__init__,Method lib.cuckoo.common.abstracts.Report.__init__()=lib.cuckoo.common.abstracts.Report-class.html#__init__,Method lib.cuckoo.common.abstracts.Signature.__init__()=lib.cuckoo.common.abstracts.Signature-class.html#__init__,Method lib.cuckoo.common.config.Config.__init__()=lib.cuckoo.common.config.Config-class.html#__init__,Method lib.cuckoo.common.irc.ircMessage.__init__()=lib.cuckoo.common.irc.ircMessage-class.html#__init__,Method lib.cuckoo.common.netlog.BsonParser.__init__()=lib.cuckoo.common.netlog.BsonParser-class.html#__init__,Method lib.cuckoo.common.objects.File.__init__()=lib.cuckoo.common.objects.File-class.html#__init__,Method lib.cuckoo.common.objects.URL.__init__()=lib.cuckoo.common.objects.URL-class.html#__init__,Method lib.cuckoo.common.utils.SuperLock.__init__()=lib.cuckoo.common.utils.SuperLock-class.html#__init__,Method lib.cuckoo.common.utils.TimeoutServer.__init__()=lib.cuckoo.common.utils.TimeoutServer-class.html#__init__,Method lib.cuckoo.common.utils.TimeoutTransport.__init__()=lib.cuckoo.common.utils.TimeoutTransport-class.html#__init__,Method lib.cuckoo.common.virustotal.VirusTotalAPI.__init__()=lib.cuckoo.common.virustotal.VirusTotalAPI-class.html#__init__,Method lib.cuckoo.core.database.AlembicVersion.__init__()=lib.cuckoo.core.database.AlembicVersion-class.html#__init__,Method lib.cuckoo.core.database.Database.__init__()=lib.cuckoo.core.database.Database-class.html#__init__,Method lib.cuckoo.core.database.Error.__init__()=lib.cuckoo.core.database.Error-class.html#__init__,Method lib.cuckoo.core.database.Guest.__init__()=lib.cuckoo.core.database.Guest-class.html#__init__,Method lib.cuckoo.core.database.Machine.__init__()=lib.cuckoo.core.database.Machine-class.html#__init__,Method lib.cuckoo.core.database.Sample.__init__()=lib.cuckoo.core.database.Sample-class.html#__init__,Method lib.cuckoo.core.database.Tag.__init__()=lib.cuckoo.core.database.Tag-class.html#__init__,Method lib.cuckoo.core.database.Task.__init__()=lib.cuckoo.core.database.Task-class.html#__init__,Method lib.cuckoo.core.guest.GuestManager.__init__()=lib.cuckoo.core.guest.GuestManager-class.html#__init__,Method lib.cuckoo.core.guest.OldGuestManager.__init__()=lib.cuckoo.core.guest.OldGuestManager-class.html#__init__,Method lib.cuckoo.core.plugins.RunAuxiliary.__init__()=lib.cuckoo.core.plugins.RunAuxiliary-class.html#__init__,Method lib.cuckoo.core.plugins.RunProcessing.__init__()=lib.cuckoo.core.plugins.RunProcessing-class.html#__init__,Method lib.cuckoo.core.plugins.RunReporting.__init__()=lib.cuckoo.core.plugins.RunReporting-class.html#__init__,Method lib.cuckoo.core.plugins.RunSignatures.__init__()=lib.cuckoo.core.plugins.RunSignatures-class.html#__init__,Method lib.cuckoo.core.resultserver.FileUpload.__init__()=lib.cuckoo.core.resultserver.FileUpload-class.html#__init__,Method lib.cuckoo.core.resultserver.LogHandler.__init__()=lib.cuckoo.core.resultserver.LogHandler-class.html#__init__,Method lib.cuckoo.core.resultserver.ResultServer.__init__()=lib.cuckoo.core.resultserver.ResultServer-class.html#__init__,Method lib.cuckoo.core.scheduler.AnalysisManager.__init__()=lib.cuckoo.core.scheduler.AnalysisManager-class.html#__init__,Method lib.cuckoo.core.scheduler.Scheduler.__init__()=lib.cuckoo.core.scheduler.Scheduler-class.html#__init__,Method modules.auxiliary.mitm.MITM.__init__()=modules.auxiliary.mitm.MITM-class.html#__init__,Method modules.auxiliary.sniffer.Sniffer.__init__()=modules.auxiliary.sniffer.Sniffer-class.html#__init__,Method modules.machinery.qemu.QEMU.__init__()=modules.machinery.qemu.QEMU-class.html#__init__,Method modules.machinery.vsphere.vSphere.__init__()=modules.machinery.vsphere.vSphere-class.html#__init__,Method modules.processing.behavior.Anomaly.__init__()=modules.processing.behavior.Anomaly-class.html#__init__,Method modules.processing.behavior.ApiStats.__init__()=modules.processing.behavior.ApiStats-class.html#__init__,Method modules.processing.behavior.GenericBehavior.__init__()=modules.processing.behavior.GenericBehavior-class.html#__init__,Method modules.processing.behavior.ProcessTree.__init__()=modules.processing.behavior.ProcessTree-class.html#__init__,Method modules.processing.behavior.Summary.__init__()=modules.processing.behavior.Summary-class.html#__init__,Method modules.processing.droidmon.Droidmon.__init__()=modules.processing.droidmon.Droidmon-class.html#__init__,Method modules.processing.memory.VolatilityAPI.__init__()=modules.processing.memory.VolatilityAPI-class.html#__init__,Method modules.processing.memory.VolatilityManager.__init__()=modules.processing.memory.VolatilityManager-class.html#__init__,Method modules.processing.network.Pcap.__init__()=modules.processing.network.Pcap-class.html#__init__,Method modules.processing.network.Pcap2.__init__()=modules.processing.network.Pcap2-class.html#__init__,Method modules.processing.network.SortCap.__init__()=modules.processing.network.SortCap-class.html#__init__,Method modules.processing.platform.linux.FilteredProcessLog.__init__()=modules.processing.platform.linux.FilteredProcessLog-class.html#__init__,Method modules.processing.platform.linux.LinuxSystemTap.__init__()=modules.processing.platform.linux.LinuxSystemTap-class.html#__init__,Method modules.processing.platform.linux.StapParser.__init__()=modules.processing.platform.linux.StapParser-class.html#__init__,Method modules.processing.platform.windows.BehaviorReconstructor.__init__()=modules.processing.platform.windows.BehaviorReconstructor-class.html#__init__,Method modules.processing.platform.windows.MonitorProcessLog.__init__()=modules.processing.platform.windows.MonitorProcessLog-class.html#__init__,Method modules.processing.platform.windows.WindowsMonitor.__init__()=modules.processing.platform.windows.WindowsMonitor-class.html#__init__,Method modules.processing.static.PortableExecutable.__init__()=modules.processing.static.PortableExecutable-class.html#__init__"><a title="lib.cuckoo.common.abstracts.Auxiliary.__init__
lib.cuckoo.common.abstracts.BehaviorHandler.__init__
lib.cuckoo.common.abstracts.LibVirtMachinery.__init__
lib.cuckoo.common.abstracts.Machinery.__init__
lib.cuckoo.common.abstracts.Processing.__init__
lib.cuckoo.common.abstracts.Report.__init__
lib.cuckoo.common.abstracts.Signature.__init__
lib.cuckoo.common.config.Config.__init__
lib.cuckoo.common.irc.ircMessage.__init__
lib.cuckoo.common.netlog.BsonParser.__init__
lib.cuckoo.common.objects.File.__init__
lib.cuckoo.common.objects.URL.__init__
lib.cuckoo.common.utils.SuperLock.__init__
lib.cuckoo.common.utils.TimeoutServer.__init__
lib.cuckoo.common.utils.TimeoutTransport.__init__
lib.cuckoo.common.virustotal.VirusTotalAPI.__init__
lib.cuckoo.core.database.AlembicVersion.__init__
lib.cuckoo.core.database.Database.__init__
lib.cuckoo.core.database.Error.__init__
lib.cuckoo.core.database.Guest.__init__
lib.cuckoo.core.database.Machine.__init__
lib.cuckoo.core.database.Sample.__init__
lib.cuckoo.core.database.Tag.__init__
lib.cuckoo.core.database.Task.__init__
lib.cuckoo.core.guest.GuestManager.__init__
lib.cuckoo.core.guest.OldGuestManager.__init__
lib.cuckoo.core.plugins.RunAuxiliary.__init__
lib.cuckoo.core.plugins.RunProcessing.__init__
lib.cuckoo.core.plugins.RunReporting.__init__
lib.cuckoo.core.plugins.RunSignatures.__init__
lib.cuckoo.core.resultserver.FileUpload.__init__
lib.cuckoo.core.resultserver.LogHandler.__init__
lib.cuckoo.core.resultserver.ResultServer.__init__
lib.cuckoo.core.scheduler.AnalysisManager.__init__
lib.cuckoo.core.scheduler.Scheduler.__init__
modules.auxiliary.mitm.MITM.__init__
modules.auxiliary.sniffer.Sniffer.__init__
modules.machinery.qemu.QEMU.__init__
modules.machinery.vsphere.vSphere.__init__
modules.processing.behavior.Anomaly.__init__
modules.processing.behavior.ApiStats.__init__
modules.processing.behavior.GenericBehavior.__init__
modules.processing.behavior.ProcessTree.__init__
modules.processing.behavior.Summary.__init__
modules.processing.droidmon.Droidmon.__init__
modules.processing.memory.VolatilityAPI.__init__
modules.processing.memory.VolatilityManager.__init__
modules.processing.network.Pcap.__init__
modules.processing.network.Pcap2.__init__
modules.processing.network.SortCap.__init__
modules.processing.platform.linux.FilteredProcessLog.__init__
modules.processing.platform.linux.LinuxSystemTap.__init__
modules.processing.platform.linux.StapParser.__init__
modules.processing.platform.windows.BehaviorReconstructor.__init__
modules.processing.platform.windows.MonitorProcessLog.__init__
modules.processing.platform.windows.WindowsMonitor.__init__
modules.processing.static.PortableExecutable.__init__" class="py-name" href="#" onclick="return doclink('link-79', '__init__', 'link-79');">__init__</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">)</tt> </tt>
<a name="L47"></a><tt class="py-lineno"> 47</tt>  <tt class="py-line"> </tt>
<a name="L48"></a><tt class="py-lineno"> 48</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-80" class="py-name" targets="Variable lib.cuckoo.core.database.Tag.task=lib.cuckoo.core.database.Tag-class.html#task"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-80', 'task', 'link-80');">task</a></tt> <tt class="py-op">=</tt> <tt id="link-81" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-81', 'task', 'link-80');">task</a></tt> </tt>
<a name="L49"></a><tt class="py-lineno"> 49</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-82" class="py-name" targets="Variable lib.cuckoo.core.database.Task.errors=lib.cuckoo.core.database.Task-class.html#errors"><a title="lib.cuckoo.core.database.Task.errors" class="py-name" href="#" onclick="return doclink('link-82', 'errors', 'link-82');">errors</a></tt> <tt class="py-op">=</tt> <tt class="py-name">error_queue</tt> </tt>
<a name="L50"></a><tt class="py-lineno"> 50</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-83" class="py-name" targets="Variable lib.cuckoo.core.rooter.cfg=lib.cuckoo.core.rooter-module.html#cfg,Variable modules.auxiliary.services.cfg=modules.auxiliary.services-module.html#cfg,Variable modules.processing.network.cfg=modules.processing.network-module.html#cfg"><a title="lib.cuckoo.core.rooter.cfg
modules.auxiliary.services.cfg
modules.processing.network.cfg" class="py-name" href="#" onclick="return doclink('link-83', 'cfg', 'link-83');">cfg</a></tt> <tt class="py-op">=</tt> <tt id="link-84" class="py-name"><a title="lib.cuckoo.common.config.Config" class="py-name" href="#" onclick="return doclink('link-84', 'Config', 'link-4');">Config</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L51"></a><tt class="py-lineno"> 51</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">storage</tt> <tt class="py-op">=</tt> <tt class="py-string">""</tt> </tt>
<a name="L52"></a><tt class="py-lineno"> 52</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">binary</tt> <tt class="py-op">=</tt> <tt class="py-string">""</tt> </tt>
<a name="L53"></a><tt class="py-lineno"> 53</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-85" class="py-name" targets="Variable lib.cuckoo.core.database.Tag.machine=lib.cuckoo.core.database.Tag-class.html#machine,Variable lib.cuckoo.core.database.Task.machine=lib.cuckoo.core.database.Task-class.html#machine"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-85', 'machine', 'link-85');">machine</a></tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L54"></a><tt class="py-lineno"> 54</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-86" class="py-name" targets="Variable lib.cuckoo.core.guest.db=lib.cuckoo.core.guest-module.html#db,Variable modules.auxiliary.services.db=modules.auxiliary.services-module.html#db"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-86', 'db', 'link-86');">db</a></tt> <tt class="py-op">=</tt> <tt id="link-87" class="py-name"><a title="lib.cuckoo.core.database.Database" class="py-name" href="#" onclick="return doclink('link-87', 'Database', 'link-42');">Database</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L55"></a><tt class="py-lineno"> 55</tt>  <tt class="py-line"> </tt>
<a name="L56"></a><tt class="py-lineno"> 56</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-88" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-88', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-89" class="py-name" targets="Variable lib.cuckoo.core.database.Machine.options=lib.cuckoo.core.database.Machine-class.html#options,Variable lib.cuckoo.core.database.Task.options=lib.cuckoo.core.database.Task-class.html#options"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-89', 'options', 'link-89');">options</a></tt> <tt class="py-op">=</tt> <tt id="link-90" class="py-name"><a title="lib.cuckoo.common.config.parse_options" class="py-name" href="#" onclick="return doclink('link-90', 'parse_options', 'link-5');">parse_options</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-91" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-91', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-92" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-92', 'options', 'link-89');">options</a></tt><tt class="py-op">)</tt> </tt>
</div><a name="L57"></a><tt class="py-lineno"> 57</tt>  <tt class="py-line"> </tt>
<a name="AnalysisManager.init_storage"></a><div id="AnalysisManager.init_storage-def"><a name="L58"></a><tt class="py-lineno"> 58</tt> <a class="py-toggle" href="#" id="AnalysisManager.init_storage-toggle" onclick="return toggle('AnalysisManager.init_storage');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.scheduler.AnalysisManager-class.html#init_storage">init_storage</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="AnalysisManager.init_storage-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="AnalysisManager.init_storage-expanded"><a name="L59"></a><tt class="py-lineno"> 59</tt>  <tt class="py-line">        <tt class="py-docstring">"""Initialize analysis storage folder."""</tt> </tt>
<a name="L60"></a><tt class="py-lineno"> 60</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">storage</tt> <tt class="py-op">=</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt id="link-93" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_ROOT" class="py-name" href="#" onclick="return doclink('link-93', 'CUCKOO_ROOT', 'link-11');">CUCKOO_ROOT</a></tt><tt class="py-op">,</tt> </tt>
<a name="L61"></a><tt class="py-lineno"> 61</tt>  <tt class="py-line">                                    <tt class="py-string">"storage"</tt><tt class="py-op">,</tt> </tt>
<a name="L62"></a><tt class="py-lineno"> 62</tt>  <tt class="py-line">                                    <tt class="py-string">"analyses"</tt><tt class="py-op">,</tt> </tt>
<a name="L63"></a><tt class="py-lineno"> 63</tt>  <tt class="py-line">                                    <tt class="py-name">str</tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-94" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-94', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-95" class="py-name" targets="Variable lib.cuckoo.core.database.Error.id=lib.cuckoo.core.database.Error-class.html#id,Variable lib.cuckoo.core.database.Guest.id=lib.cuckoo.core.database.Guest-class.html#id,Variable lib.cuckoo.core.database.Machine.id=lib.cuckoo.core.database.Machine-class.html#id,Variable lib.cuckoo.core.database.Sample.id=lib.cuckoo.core.database.Sample-class.html#id,Variable lib.cuckoo.core.database.Tag.id=lib.cuckoo.core.database.Tag-class.html#id,Variable lib.cuckoo.core.database.Task.id=lib.cuckoo.core.database.Task-class.html#id"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-95', 'id', 'link-95');">id</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L64"></a><tt class="py-lineno"> 64</tt>  <tt class="py-line"> </tt>
<a name="L65"></a><tt class="py-lineno"> 65</tt>  <tt class="py-line">        <tt class="py-comment"># If the analysis storage folder already exists, we need to abort the</tt> </tt>
<a name="L66"></a><tt class="py-lineno"> 66</tt>  <tt class="py-line">        <tt class="py-comment"># analysis or previous results will be overwritten and lost.</tt> </tt>
<a name="L67"></a><tt class="py-lineno"> 67</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">exists</tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">storage</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L68"></a><tt class="py-lineno"> 68</tt>  <tt class="py-line">            <tt id="link-96" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-96', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">error</tt><tt class="py-op">(</tt><tt class="py-string">"Analysis results folder already exists at path \"%s\","</tt> </tt>
<a name="L69"></a><tt class="py-lineno"> 69</tt>  <tt class="py-line">                      <tt class="py-string">" analysis aborted"</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">storage</tt><tt class="py-op">)</tt> </tt>
<a name="L70"></a><tt class="py-lineno"> 70</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-name">False</tt> </tt>
<a name="L71"></a><tt class="py-lineno"> 71</tt>  <tt class="py-line"> </tt>
<a name="L72"></a><tt class="py-lineno"> 72</tt>  <tt class="py-line">        <tt class="py-comment"># If we're not able to create the analysis storage folder, we have to</tt> </tt>
<a name="L73"></a><tt class="py-lineno"> 73</tt>  <tt class="py-line">        <tt class="py-comment"># abort the analysis.</tt> </tt>
<a name="L74"></a><tt class="py-lineno"> 74</tt>  <tt class="py-line">        <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L75"></a><tt class="py-lineno"> 75</tt>  <tt class="py-line">            <tt id="link-97" class="py-name"><a title="lib.cuckoo.common.utils.create_folder" class="py-name" href="#" onclick="return doclink('link-97', 'create_folder', 'link-37');">create_folder</a></tt><tt class="py-op">(</tt><tt class="py-name">folder</tt><tt class="py-op">=</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">storage</tt><tt class="py-op">)</tt> </tt>
<a name="L76"></a><tt class="py-lineno"> 76</tt>  <tt class="py-line">        <tt class="py-keyword">except</tt> <tt id="link-98" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooOperationalError" class="py-name" href="#" onclick="return doclink('link-98', 'CuckooOperationalError', 'link-22');">CuckooOperationalError</a></tt><tt class="py-op">:</tt> </tt>
<a name="L77"></a><tt class="py-lineno"> 77</tt>  <tt class="py-line">            <tt id="link-99" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-99', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">error</tt><tt class="py-op">(</tt><tt class="py-string">"Unable to create analysis folder %s"</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">storage</tt><tt class="py-op">)</tt> </tt>
<a name="L78"></a><tt class="py-lineno"> 78</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-name">False</tt> </tt>
<a name="L79"></a><tt class="py-lineno"> 79</tt>  <tt class="py-line"> </tt>
<a name="L80"></a><tt class="py-lineno"> 80</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">True</tt> </tt>
</div><a name="L81"></a><tt class="py-lineno"> 81</tt>  <tt class="py-line"> </tt>
<a name="AnalysisManager.check_file"></a><div id="AnalysisManager.check_file-def"><a name="L82"></a><tt class="py-lineno"> 82</tt> <a class="py-toggle" href="#" id="AnalysisManager.check_file-toggle" onclick="return toggle('AnalysisManager.check_file');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.scheduler.AnalysisManager-class.html#check_file">check_file</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="AnalysisManager.check_file-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="AnalysisManager.check_file-expanded"><a name="L83"></a><tt class="py-lineno"> 83</tt>  <tt class="py-line">        <tt class="py-docstring">"""Checks the integrity of the file to be analyzed."""</tt> </tt>
<a name="L84"></a><tt class="py-lineno"> 84</tt>  <tt class="py-line">        <tt id="link-100" class="py-name" targets="Variable lib.cuckoo.core.database.Task.sample=lib.cuckoo.core.database.Task-class.html#sample"><a title="lib.cuckoo.core.database.Task.sample" class="py-name" href="#" onclick="return doclink('link-100', 'sample', 'link-100');">sample</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-101" class="py-name"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-101', 'db', 'link-86');">db</a></tt><tt class="py-op">.</tt><tt id="link-102" class="py-name" targets="Method lib.cuckoo.core.database.Database.view_sample()=lib.cuckoo.core.database.Database-class.html#view_sample"><a title="lib.cuckoo.core.database.Database.view_sample" class="py-name" href="#" onclick="return doclink('link-102', 'view_sample', 'link-102');">view_sample</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-103" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-103', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-104" class="py-name" targets="Variable lib.cuckoo.core.database.Task.sample_id=lib.cuckoo.core.database.Task-class.html#sample_id"><a title="lib.cuckoo.core.database.Task.sample_id" class="py-name" href="#" onclick="return doclink('link-104', 'sample_id', 'link-104');">sample_id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L85"></a><tt class="py-lineno"> 85</tt>  <tt class="py-line"> </tt>
<a name="L86"></a><tt class="py-lineno"> 86</tt>  <tt class="py-line">        <tt id="link-105" class="py-name" targets="Variable lib.cuckoo.core.database.Sample.sha256=lib.cuckoo.core.database.Sample-class.html#sha256"><a title="lib.cuckoo.core.database.Sample.sha256" class="py-name" href="#" onclick="return doclink('link-105', 'sha256', 'link-105');">sha256</a></tt> <tt class="py-op">=</tt> <tt id="link-106" class="py-name"><a title="lib.cuckoo.common.objects.File" class="py-name" href="#" onclick="return doclink('link-106', 'File', 'link-32');">File</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-107" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-107', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-108" class="py-name" targets="Variable lib.cuckoo.core.database.Task.target=lib.cuckoo.core.database.Task-class.html#target"><a title="lib.cuckoo.core.database.Task.target" class="py-name" href="#" onclick="return doclink('link-108', 'target', 'link-108');">target</a></tt><tt class="py-op">)</tt><tt class="py-op">.</tt><tt id="link-109" class="py-name" targets="Method lib.cuckoo.common.objects.File.get_sha256()=lib.cuckoo.common.objects.File-class.html#get_sha256"><a title="lib.cuckoo.common.objects.File.get_sha256" class="py-name" href="#" onclick="return doclink('link-109', 'get_sha256', 'link-109');">get_sha256</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L87"></a><tt class="py-lineno"> 87</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-110" class="py-name"><a title="lib.cuckoo.core.database.Sample.sha256" class="py-name" href="#" onclick="return doclink('link-110', 'sha256', 'link-105');">sha256</a></tt> <tt class="py-op">!=</tt> <tt id="link-111" class="py-name"><a title="lib.cuckoo.core.database.Task.sample" class="py-name" href="#" onclick="return doclink('link-111', 'sample', 'link-100');">sample</a></tt><tt class="py-op">.</tt><tt id="link-112" class="py-name"><a title="lib.cuckoo.core.database.Sample.sha256" class="py-name" href="#" onclick="return doclink('link-112', 'sha256', 'link-105');">sha256</a></tt><tt class="py-op">:</tt> </tt>
<a name="L88"></a><tt class="py-lineno"> 88</tt>  <tt class="py-line">            <tt id="link-113" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-113', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">error</tt><tt class="py-op">(</tt><tt class="py-string">"Target file has been modified after submission: \"%s\""</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-114" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-114', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-115" class="py-name"><a title="lib.cuckoo.core.database.Task.target" class="py-name" href="#" onclick="return doclink('link-115', 'target', 'link-108');">target</a></tt><tt class="py-op">)</tt> </tt>
<a name="L89"></a><tt class="py-lineno"> 89</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-name">False</tt> </tt>
<a name="L90"></a><tt class="py-lineno"> 90</tt>  <tt class="py-line"> </tt>
<a name="L91"></a><tt class="py-lineno"> 91</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">True</tt> </tt>
</div><a name="L92"></a><tt class="py-lineno"> 92</tt>  <tt class="py-line"> </tt>
<a name="AnalysisManager.store_file"></a><div id="AnalysisManager.store_file-def"><a name="L93"></a><tt class="py-lineno"> 93</tt> <a class="py-toggle" href="#" id="AnalysisManager.store_file-toggle" onclick="return toggle('AnalysisManager.store_file');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.scheduler.AnalysisManager-class.html#store_file">store_file</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="AnalysisManager.store_file-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="AnalysisManager.store_file-expanded"><a name="L94"></a><tt class="py-lineno"> 94</tt>  <tt class="py-line">        <tt class="py-docstring">"""Store a copy of the file being analyzed."""</tt> </tt>
<a name="L95"></a><tt class="py-lineno"> 95</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">exists</tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-116" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-116', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-117" class="py-name"><a title="lib.cuckoo.core.database.Task.target" class="py-name" href="#" onclick="return doclink('link-117', 'target', 'link-108');">target</a></tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L96"></a><tt class="py-lineno"> 96</tt>  <tt class="py-line">            <tt id="link-118" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-118', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">error</tt><tt class="py-op">(</tt><tt class="py-string">"The file to analyze does not exist at path \"%s\", "</tt> </tt>
<a name="L97"></a><tt class="py-lineno"> 97</tt>  <tt class="py-line">                      <tt class="py-string">"analysis aborted"</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-119" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-119', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-120" class="py-name"><a title="lib.cuckoo.core.database.Task.target" class="py-name" href="#" onclick="return doclink('link-120', 'target', 'link-108');">target</a></tt><tt class="py-op">)</tt> </tt>
<a name="L98"></a><tt class="py-lineno"> 98</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-name">False</tt> </tt>
<a name="L99"></a><tt class="py-lineno"> 99</tt>  <tt class="py-line"> </tt>
<a name="L100"></a><tt class="py-lineno">100</tt>  <tt class="py-line">        <tt id="link-121" class="py-name"><a title="lib.cuckoo.core.database.Sample.sha256" class="py-name" href="#" onclick="return doclink('link-121', 'sha256', 'link-105');">sha256</a></tt> <tt class="py-op">=</tt> <tt id="link-122" class="py-name"><a title="lib.cuckoo.common.objects.File" class="py-name" href="#" onclick="return doclink('link-122', 'File', 'link-32');">File</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-123" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-123', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-124" class="py-name"><a title="lib.cuckoo.core.database.Task.target" class="py-name" href="#" onclick="return doclink('link-124', 'target', 'link-108');">target</a></tt><tt class="py-op">)</tt><tt class="py-op">.</tt><tt id="link-125" class="py-name"><a title="lib.cuckoo.common.objects.File.get_sha256" class="py-name" href="#" onclick="return doclink('link-125', 'get_sha256', 'link-109');">get_sha256</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L101"></a><tt class="py-lineno">101</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">binary</tt> <tt class="py-op">=</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt id="link-126" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_ROOT" class="py-name" href="#" onclick="return doclink('link-126', 'CUCKOO_ROOT', 'link-11');">CUCKOO_ROOT</a></tt><tt class="py-op">,</tt> <tt class="py-string">"storage"</tt><tt class="py-op">,</tt> <tt class="py-string">"binaries"</tt><tt class="py-op">,</tt> <tt id="link-127" class="py-name"><a title="lib.cuckoo.core.database.Sample.sha256" class="py-name" href="#" onclick="return doclink('link-127', 'sha256', 'link-105');">sha256</a></tt><tt class="py-op">)</tt> </tt>
<a name="L102"></a><tt class="py-lineno">102</tt>  <tt class="py-line"> </tt>
<a name="L103"></a><tt class="py-lineno">103</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">exists</tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">binary</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L104"></a><tt class="py-lineno">104</tt>  <tt class="py-line">            <tt id="link-128" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-128', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">"File already exists at \"%s\""</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">binary</tt><tt class="py-op">)</tt> </tt>
<a name="L105"></a><tt class="py-lineno">105</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L106"></a><tt class="py-lineno">106</tt>  <tt class="py-line">            <tt class="py-comment"># TODO: do we really need to abort the analysis in case we are not</tt> </tt>
<a name="L107"></a><tt class="py-lineno">107</tt>  <tt class="py-line">            <tt class="py-comment"># able to store a copy of the file?</tt> </tt>
<a name="L108"></a><tt class="py-lineno">108</tt>  <tt class="py-line">            <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L109"></a><tt class="py-lineno">109</tt>  <tt class="py-line">                <tt class="py-name">shutil</tt><tt class="py-op">.</tt><tt class="py-name">copy</tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-129" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-129', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-130" class="py-name"><a title="lib.cuckoo.core.database.Task.target" class="py-name" href="#" onclick="return doclink('link-130', 'target', 'link-108');">target</a></tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">binary</tt><tt class="py-op">)</tt> </tt>
<a name="L110"></a><tt class="py-lineno">110</tt>  <tt class="py-line">            <tt class="py-keyword">except</tt> <tt class="py-op">(</tt><tt class="py-name">IOError</tt><tt class="py-op">,</tt> <tt class="py-name">shutil</tt><tt class="py-op">.</tt><tt id="link-131" class="py-name" targets="Class lib.cuckoo.core.database.Error=lib.cuckoo.core.database.Error-class.html"><a title="lib.cuckoo.core.database.Error" class="py-name" href="#" onclick="return doclink('link-131', 'Error', 'link-131');">Error</a></tt><tt class="py-op">)</tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L111"></a><tt class="py-lineno">111</tt>  <tt class="py-line">                <tt id="link-132" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-132', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">error</tt><tt class="py-op">(</tt><tt class="py-string">"Unable to store file from \"%s\" to \"%s\", "</tt> </tt>
<a name="L112"></a><tt class="py-lineno">112</tt>  <tt class="py-line">                          <tt class="py-string">"analysis aborted"</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-133" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-133', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-134" class="py-name"><a title="lib.cuckoo.core.database.Task.target" class="py-name" href="#" onclick="return doclink('link-134', 'target', 'link-108');">target</a></tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">binary</tt><tt class="py-op">)</tt> </tt>
<a name="L113"></a><tt class="py-lineno">113</tt>  <tt class="py-line">                <tt class="py-keyword">return</tt> <tt class="py-name">False</tt> </tt>
<a name="L114"></a><tt class="py-lineno">114</tt>  <tt class="py-line"> </tt>
<a name="L115"></a><tt class="py-lineno">115</tt>  <tt class="py-line">        <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L116"></a><tt class="py-lineno">116</tt>  <tt class="py-line">            <tt class="py-name">new_binary_path</tt> <tt class="py-op">=</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">storage</tt><tt class="py-op">,</tt> <tt class="py-string">"binary"</tt><tt class="py-op">)</tt> </tt>
<a name="L117"></a><tt class="py-lineno">117</tt>  <tt class="py-line"> </tt>
<a name="L118"></a><tt class="py-lineno">118</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">os</tt><tt class="py-op">,</tt> <tt class="py-string">"symlink"</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L119"></a><tt class="py-lineno">119</tt>  <tt class="py-line">                <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">symlink</tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">binary</tt><tt class="py-op">,</tt> <tt class="py-name">new_binary_path</tt><tt class="py-op">)</tt> </tt>
<a name="L120"></a><tt class="py-lineno">120</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L121"></a><tt class="py-lineno">121</tt>  <tt class="py-line">                <tt class="py-name">shutil</tt><tt class="py-op">.</tt><tt class="py-name">copy</tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">binary</tt><tt class="py-op">,</tt> <tt class="py-name">new_binary_path</tt><tt class="py-op">)</tt> </tt>
<a name="L122"></a><tt class="py-lineno">122</tt>  <tt class="py-line">        <tt class="py-keyword">except</tt> <tt class="py-op">(</tt><tt class="py-name">AttributeError</tt><tt class="py-op">,</tt> <tt class="py-name">OSError</tt><tt class="py-op">)</tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L123"></a><tt class="py-lineno">123</tt>  <tt class="py-line">            <tt id="link-135" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-135', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">error</tt><tt class="py-op">(</tt><tt class="py-string">"Unable to create symlink/copy from \"%s\" to "</tt> </tt>
<a name="L124"></a><tt class="py-lineno">124</tt>  <tt class="py-line">                      <tt class="py-string">"\"%s\": %s"</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">binary</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">storage</tt><tt class="py-op">,</tt> <tt class="py-name">e</tt><tt class="py-op">)</tt> </tt>
<a name="L125"></a><tt class="py-lineno">125</tt>  <tt class="py-line"> </tt>
<a name="L126"></a><tt class="py-lineno">126</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">True</tt> </tt>
</div><a name="L127"></a><tt class="py-lineno">127</tt>  <tt class="py-line"> </tt>
<a name="AnalysisManager.acquire_machine"></a><div id="AnalysisManager.acquire_machine-def"><a name="L128"></a><tt class="py-lineno">128</tt> <a class="py-toggle" href="#" id="AnalysisManager.acquire_machine-toggle" onclick="return toggle('AnalysisManager.acquire_machine');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.scheduler.AnalysisManager-class.html#acquire_machine">acquire_machine</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="AnalysisManager.acquire_machine-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="AnalysisManager.acquire_machine-expanded"><a name="L129"></a><tt class="py-lineno">129</tt>  <tt class="py-line">        <tt class="py-docstring">"""Acquire an analysis machine from the pool of available ones."""</tt> </tt>
<a name="L130"></a><tt class="py-lineno">130</tt>  <tt class="py-line">        <tt id="link-136" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-136', 'machine', 'link-85');">machine</a></tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L131"></a><tt class="py-lineno">131</tt>  <tt class="py-line"> </tt>
<a name="L132"></a><tt class="py-lineno">132</tt>  <tt class="py-line">        <tt class="py-comment"># Start a loop to acquire the a machine to run the analysis on.</tt> </tt>
<a name="L133"></a><tt class="py-lineno">133</tt>  <tt class="py-line">        <tt class="py-keyword">while</tt> <tt class="py-name">True</tt><tt class="py-op">:</tt> </tt>
<a name="L134"></a><tt class="py-lineno">134</tt>  <tt class="py-line">            <tt id="link-137" class="py-name"><a title="lib.cuckoo.core.scheduler.machine_lock" class="py-name" href="#" onclick="return doclink('link-137', 'machine_lock', 'link-76');">machine_lock</a></tt><tt class="py-op">.</tt><tt id="link-138" class="py-name" targets="Method lib.cuckoo.common.abstracts.Machinery.acquire()=lib.cuckoo.common.abstracts.Machinery-class.html#acquire"><a title="lib.cuckoo.common.abstracts.Machinery.acquire" class="py-name" href="#" onclick="return doclink('link-138', 'acquire', 'link-138');">acquire</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L135"></a><tt class="py-lineno">135</tt>  <tt class="py-line"> </tt>
<a name="L136"></a><tt class="py-lineno">136</tt>  <tt class="py-line">            <tt class="py-comment"># In some cases it's possible that we enter this loop without</tt> </tt>
<a name="L137"></a><tt class="py-lineno">137</tt>  <tt class="py-line">            <tt class="py-comment"># having any available machines. We should make sure this is not</tt> </tt>
<a name="L138"></a><tt class="py-lineno">138</tt>  <tt class="py-line">            <tt class="py-comment"># such case, or the analysis task will fail completely.</tt> </tt>
<a name="L139"></a><tt class="py-lineno">139</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-139" class="py-name"><a title="lib.cuckoo.core.scheduler.machinery
modules.machinery" class="py-name" href="#" onclick="return doclink('link-139', 'machinery', 'link-75');">machinery</a></tt><tt class="py-op">.</tt><tt id="link-140" class="py-name" targets="Method lib.cuckoo.common.abstracts.Machinery.availables()=lib.cuckoo.common.abstracts.Machinery-class.html#availables"><a title="lib.cuckoo.common.abstracts.Machinery.availables" class="py-name" href="#" onclick="return doclink('link-140', 'availables', 'link-140');">availables</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L140"></a><tt class="py-lineno">140</tt>  <tt class="py-line">                <tt id="link-141" class="py-name"><a title="lib.cuckoo.core.scheduler.machine_lock" class="py-name" href="#" onclick="return doclink('link-141', 'machine_lock', 'link-76');">machine_lock</a></tt><tt class="py-op">.</tt><tt id="link-142" class="py-name" targets="Method lib.cuckoo.common.abstracts.Machinery.release()=lib.cuckoo.common.abstracts.Machinery-class.html#release"><a title="lib.cuckoo.common.abstracts.Machinery.release" class="py-name" href="#" onclick="return doclink('link-142', 'release', 'link-142');">release</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L141"></a><tt class="py-lineno">141</tt>  <tt class="py-line">                <tt class="py-name">time</tt><tt class="py-op">.</tt><tt class="py-name">sleep</tt><tt class="py-op">(</tt><tt class="py-number">1</tt><tt class="py-op">)</tt> </tt>
<a name="L142"></a><tt class="py-lineno">142</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L143"></a><tt class="py-lineno">143</tt>  <tt class="py-line"> </tt>
<a name="L144"></a><tt class="py-lineno">144</tt>  <tt class="py-line">            <tt class="py-comment"># If the user specified a specific machine ID, a platform to be</tt> </tt>
<a name="L145"></a><tt class="py-lineno">145</tt>  <tt class="py-line">            <tt class="py-comment"># used or machine tags acquire the machine accordingly.</tt> </tt>
<a name="L146"></a><tt class="py-lineno">146</tt>  <tt class="py-line">            <tt id="link-143" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-143', 'machine', 'link-85');">machine</a></tt> <tt class="py-op">=</tt> <tt id="link-144" class="py-name"><a title="lib.cuckoo.core.scheduler.machinery
modules.machinery" class="py-name" href="#" onclick="return doclink('link-144', 'machinery', 'link-75');">machinery</a></tt><tt class="py-op">.</tt><tt id="link-145" class="py-name"><a title="lib.cuckoo.common.abstracts.Machinery.acquire" class="py-name" href="#" onclick="return doclink('link-145', 'acquire', 'link-138');">acquire</a></tt><tt class="py-op">(</tt><tt class="py-name">machine_id</tt><tt class="py-op">=</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-146" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-146', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-147" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-147', 'machine', 'link-85');">machine</a></tt><tt class="py-op">,</tt> </tt>
<a name="L147"></a><tt class="py-lineno">147</tt>  <tt class="py-line">                                        <tt id="link-148" class="py-name" targets="Variable lib.cuckoo.common.abstracts.Signature.platform=lib.cuckoo.common.abstracts.Signature-class.html#platform,Variable lib.cuckoo.core.database.Machine.platform=lib.cuckoo.core.database.Machine-class.html#platform,Variable lib.cuckoo.core.database.Task.platform=lib.cuckoo.core.database.Task-class.html#platform,Package modules.processing.platform=modules.processing.platform-module.html"><a title="lib.cuckoo.common.abstracts.Signature.platform
lib.cuckoo.core.database.Machine.platform
lib.cuckoo.core.database.Task.platform
modules.processing.platform" class="py-name" href="#" onclick="return doclink('link-148', 'platform', 'link-148');">platform</a></tt><tt class="py-op">=</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-149" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-149', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-150" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.platform
lib.cuckoo.core.database.Machine.platform
lib.cuckoo.core.database.Task.platform
modules.processing.platform" class="py-name" href="#" onclick="return doclink('link-150', 'platform', 'link-148');">platform</a></tt><tt class="py-op">,</tt> </tt>
<a name="L148"></a><tt class="py-lineno">148</tt>  <tt class="py-line">                                        <tt id="link-151" class="py-name" targets="Variable lib.cuckoo.core.database.Machine.tags=lib.cuckoo.core.database.Machine-class.html#tags,Variable lib.cuckoo.core.database.Task.tags=lib.cuckoo.core.database.Task-class.html#tags"><a title="lib.cuckoo.core.database.Machine.tags
lib.cuckoo.core.database.Task.tags" class="py-name" href="#" onclick="return doclink('link-151', 'tags', 'link-151');">tags</a></tt><tt class="py-op">=</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-152" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-152', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-153" class="py-name"><a title="lib.cuckoo.core.database.Machine.tags
lib.cuckoo.core.database.Task.tags" class="py-name" href="#" onclick="return doclink('link-153', 'tags', 'link-151');">tags</a></tt><tt class="py-op">)</tt> </tt>
<a name="L149"></a><tt class="py-lineno">149</tt>  <tt class="py-line"> </tt>
<a name="L150"></a><tt class="py-lineno">150</tt>  <tt class="py-line">            <tt class="py-comment"># If no machine is available at this moment, wait for one second</tt> </tt>
<a name="L151"></a><tt class="py-lineno">151</tt>  <tt class="py-line">            <tt class="py-comment"># and try again.</tt> </tt>
<a name="L152"></a><tt class="py-lineno">152</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-154" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-154', 'machine', 'link-85');">machine</a></tt><tt class="py-op">:</tt> </tt>
<a name="L153"></a><tt class="py-lineno">153</tt>  <tt class="py-line">                <tt id="link-155" class="py-name"><a title="lib.cuckoo.core.scheduler.machine_lock" class="py-name" href="#" onclick="return doclink('link-155', 'machine_lock', 'link-76');">machine_lock</a></tt><tt class="py-op">.</tt><tt id="link-156" class="py-name"><a title="lib.cuckoo.common.abstracts.Machinery.release" class="py-name" href="#" onclick="return doclink('link-156', 'release', 'link-142');">release</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L154"></a><tt class="py-lineno">154</tt>  <tt class="py-line">                <tt id="link-157" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-157', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt id="link-158" class="py-name" targets="Module modules.processing.debug=modules.processing.debug-module.html"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-158', 'debug', 'link-158');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"Task #%d: no machine available yet"</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-159" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-159', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-160" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-160', 'id', 'link-95');">id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L155"></a><tt class="py-lineno">155</tt>  <tt class="py-line">                <tt class="py-name">time</tt><tt class="py-op">.</tt><tt class="py-name">sleep</tt><tt class="py-op">(</tt><tt class="py-number">1</tt><tt class="py-op">)</tt> </tt>
<a name="L156"></a><tt class="py-lineno">156</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L157"></a><tt class="py-lineno">157</tt>  <tt class="py-line">                <tt id="link-161" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-161', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">"Task #%d: acquired machine %s (label=%s)"</tt><tt class="py-op">,</tt> </tt>
<a name="L158"></a><tt class="py-lineno">158</tt>  <tt class="py-line">                         <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-162" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-162', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-163" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-163', 'id', 'link-95');">id</a></tt><tt class="py-op">,</tt> <tt id="link-164" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-164', 'machine', 'link-85');">machine</a></tt><tt class="py-op">.</tt><tt id="link-165" class="py-name" targets="Variable lib.cuckoo.common.abstracts.Signature.name=lib.cuckoo.common.abstracts.Signature-class.html#name,Variable lib.cuckoo.core.database.Guest.name=lib.cuckoo.core.database.Guest-class.html#name,Variable lib.cuckoo.core.database.Machine.name=lib.cuckoo.core.database.Machine-class.html#name,Variable lib.cuckoo.core.database.Tag.name=lib.cuckoo.core.database.Tag-class.html#name,Variable modules.signatures.creates_exe.CreatesExe.name=modules.signatures.creates_exe.CreatesExe-class.html#name,Variable modules.signatures.generic_metrics.SystemMetrics.name=modules.signatures.generic_metrics.SystemMetrics-class.html#name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-165', 'name', 'link-165');">name</a></tt><tt class="py-op">,</tt> <tt id="link-166" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-166', 'machine', 'link-85');">machine</a></tt><tt class="py-op">.</tt><tt id="link-167" class="py-name" targets="Variable lib.cuckoo.core.database.Guest.label=lib.cuckoo.core.database.Guest-class.html#label,Variable lib.cuckoo.core.database.Machine.label=lib.cuckoo.core.database.Machine-class.html#label"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-167', 'label', 'link-167');">label</a></tt><tt class="py-op">)</tt> </tt>
<a name="L159"></a><tt class="py-lineno">159</tt>  <tt class="py-line">                <tt class="py-keyword">break</tt> </tt>
<a name="L160"></a><tt class="py-lineno">160</tt>  <tt class="py-line"> </tt>
<a name="L161"></a><tt class="py-lineno">161</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-168" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-168', 'machine', 'link-85');">machine</a></tt> <tt class="py-op">=</tt> <tt id="link-169" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-169', 'machine', 'link-85');">machine</a></tt> </tt>
</div><a name="L162"></a><tt class="py-lineno">162</tt>  <tt class="py-line"> </tt>
<a name="AnalysisManager.build_options"></a><div id="AnalysisManager.build_options-def"><a name="L163"></a><tt class="py-lineno">163</tt> <a class="py-toggle" href="#" id="AnalysisManager.build_options-toggle" onclick="return toggle('AnalysisManager.build_options');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.scheduler.AnalysisManager-class.html#build_options">build_options</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="AnalysisManager.build_options-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="AnalysisManager.build_options-expanded"><a name="L164"></a><tt class="py-lineno">164</tt>  <tt class="py-line">        <tt class="py-docstring">"""Generate analysis options.</tt> </tt>
<a name="L165"></a><tt class="py-lineno">165</tt>  <tt class="py-line"><tt class="py-docstring">        @return: options dict.</tt> </tt>
<a name="L166"></a><tt class="py-lineno">166</tt>  <tt class="py-line"><tt class="py-docstring">        """</tt> </tt>
<a name="L167"></a><tt class="py-lineno">167</tt>  <tt class="py-line">        <tt id="link-170" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-170', 'options', 'link-89');">options</a></tt> <tt class="py-op">=</tt> <tt class="py-op">{</tt><tt class="py-op">}</tt> </tt>
<a name="L168"></a><tt class="py-lineno">168</tt>  <tt class="py-line"> </tt>
<a name="L169"></a><tt class="py-lineno">169</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-171" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-171', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-172" class="py-name" targets="Variable lib.cuckoo.core.database.Task.category=lib.cuckoo.core.database.Task-class.html#category"><a title="lib.cuckoo.core.database.Task.category" class="py-name" href="#" onclick="return doclink('link-172', 'category', 'link-172');">category</a></tt> <tt class="py-op">==</tt> <tt class="py-string">"file"</tt><tt class="py-op">:</tt> </tt>
<a name="L170"></a><tt class="py-lineno">170</tt>  <tt class="py-line">            <tt id="link-173" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-173', 'options', 'link-89');">options</a></tt><tt class="py-op">[</tt><tt class="py-string">"file_name"</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-174" class="py-name"><a title="lib.cuckoo.common.objects.File" class="py-name" href="#" onclick="return doclink('link-174', 'File', 'link-32');">File</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-175" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-175', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-176" class="py-name"><a title="lib.cuckoo.core.database.Task.target" class="py-name" href="#" onclick="return doclink('link-176', 'target', 'link-108');">target</a></tt><tt class="py-op">)</tt><tt class="py-op">.</tt><tt id="link-177" class="py-name" targets="Method lib.cuckoo.common.objects.File.get_name()=lib.cuckoo.common.objects.File-class.html#get_name"><a title="lib.cuckoo.common.objects.File.get_name" class="py-name" href="#" onclick="return doclink('link-177', 'get_name', 'link-177');">get_name</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L171"></a><tt class="py-lineno">171</tt>  <tt class="py-line">            <tt id="link-178" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-178', 'options', 'link-89');">options</a></tt><tt class="py-op">[</tt><tt class="py-string">"file_type"</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-179" class="py-name"><a title="lib.cuckoo.common.objects.File" class="py-name" href="#" onclick="return doclink('link-179', 'File', 'link-32');">File</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-180" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-180', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-181" class="py-name"><a title="lib.cuckoo.core.database.Task.target" class="py-name" href="#" onclick="return doclink('link-181', 'target', 'link-108');">target</a></tt><tt class="py-op">)</tt><tt class="py-op">.</tt><tt id="link-182" class="py-name" targets="Method lib.cuckoo.common.objects.File.get_type()=lib.cuckoo.common.objects.File-class.html#get_type"><a title="lib.cuckoo.common.objects.File.get_type" class="py-name" href="#" onclick="return doclink('link-182', 'get_type', 'link-182');">get_type</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L172"></a><tt class="py-lineno">172</tt>  <tt class="py-line">            <tt id="link-183" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-183', 'options', 'link-89');">options</a></tt><tt class="py-op">[</tt><tt class="py-string">"pe_exports"</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> \ </tt>
<a name="L173"></a><tt class="py-lineno">173</tt>  <tt class="py-line">                <tt class="py-string">","</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt id="link-184" class="py-name"><a title="lib.cuckoo.common.objects.File" class="py-name" href="#" onclick="return doclink('link-184', 'File', 'link-32');">File</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-185" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-185', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-186" class="py-name"><a title="lib.cuckoo.core.database.Task.target" class="py-name" href="#" onclick="return doclink('link-186', 'target', 'link-108');">target</a></tt><tt class="py-op">)</tt><tt class="py-op">.</tt><tt id="link-187" class="py-name" targets="Method lib.cuckoo.common.objects.File.get_exported_functions()=lib.cuckoo.common.objects.File-class.html#get_exported_functions"><a title="lib.cuckoo.common.objects.File.get_exported_functions" class="py-name" href="#" onclick="return doclink('link-187', 'get_exported_functions', 'link-187');">get_exported_functions</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L174"></a><tt class="py-lineno">174</tt>  <tt class="py-line"> </tt>
<a name="L175"></a><tt class="py-lineno">175</tt>  <tt class="py-line">            <tt id="link-188" class="py-name" targets="Variable lib.cuckoo.core.database.Task.package=lib.cuckoo.core.database.Task-class.html#package"><a title="lib.cuckoo.core.database.Task.package" class="py-name" href="#" onclick="return doclink('link-188', 'package', 'link-188');">package</a></tt><tt class="py-op">,</tt> <tt class="py-name">activity</tt> <tt class="py-op">=</tt> <tt id="link-189" class="py-name"><a title="lib.cuckoo.common.objects.File" class="py-name" href="#" onclick="return doclink('link-189', 'File', 'link-32');">File</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-190" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-190', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-191" class="py-name"><a title="lib.cuckoo.core.database.Task.target" class="py-name" href="#" onclick="return doclink('link-191', 'target', 'link-108');">target</a></tt><tt class="py-op">)</tt><tt class="py-op">.</tt><tt id="link-192" class="py-name" targets="Method lib.cuckoo.common.objects.File.get_apk_entry()=lib.cuckoo.common.objects.File-class.html#get_apk_entry"><a title="lib.cuckoo.common.objects.File.get_apk_entry" class="py-name" href="#" onclick="return doclink('link-192', 'get_apk_entry', 'link-192');">get_apk_entry</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L176"></a><tt class="py-lineno">176</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-193" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-193', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-194" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-194', 'options', 'link-89');">options</a></tt><tt class="py-op">[</tt><tt class="py-string">"apk_entry"</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-string">"%s:%s"</tt> <tt class="py-op">%</tt> <tt class="py-op">(</tt><tt id="link-195" class="py-name"><a title="lib.cuckoo.core.database.Task.package" class="py-name" href="#" onclick="return doclink('link-195', 'package', 'link-188');">package</a></tt><tt class="py-op">,</tt> <tt class="py-name">activity</tt><tt class="py-op">)</tt> </tt>
<a name="L177"></a><tt class="py-lineno">177</tt>  <tt class="py-line"> </tt>
<a name="L178"></a><tt class="py-lineno">178</tt>  <tt class="py-line">        <tt id="link-196" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-196', 'options', 'link-89');">options</a></tt><tt class="py-op">[</tt><tt class="py-string">"id"</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-197" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-197', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-198" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-198', 'id', 'link-95');">id</a></tt> </tt>
<a name="L179"></a><tt class="py-lineno">179</tt>  <tt class="py-line">        <tt id="link-199" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-199', 'options', 'link-89');">options</a></tt><tt class="py-op">[</tt><tt class="py-string">"ip"</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-200" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-200', 'machine', 'link-85');">machine</a></tt><tt class="py-op">.</tt><tt id="link-201" class="py-name" targets="Variable lib.cuckoo.core.database.Machine.resultserver_ip=lib.cuckoo.core.database.Machine-class.html#resultserver_ip"><a title="lib.cuckoo.core.database.Machine.resultserver_ip" class="py-name" href="#" onclick="return doclink('link-201', 'resultserver_ip', 'link-201');">resultserver_ip</a></tt> </tt>
<a name="L180"></a><tt class="py-lineno">180</tt>  <tt class="py-line">        <tt id="link-202" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-202', 'options', 'link-89');">options</a></tt><tt class="py-op">[</tt><tt class="py-string">"port"</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-203" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-203', 'machine', 'link-85');">machine</a></tt><tt class="py-op">.</tt><tt id="link-204" class="py-name" targets="Variable lib.cuckoo.core.database.Machine.resultserver_port=lib.cuckoo.core.database.Machine-class.html#resultserver_port"><a title="lib.cuckoo.core.database.Machine.resultserver_port" class="py-name" href="#" onclick="return doclink('link-204', 'resultserver_port', 'link-204');">resultserver_port</a></tt> </tt>
<a name="L181"></a><tt class="py-lineno">181</tt>  <tt class="py-line">        <tt id="link-205" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-205', 'options', 'link-89');">options</a></tt><tt class="py-op">[</tt><tt class="py-string">"category"</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-206" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-206', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-207" class="py-name"><a title="lib.cuckoo.core.database.Task.category" class="py-name" href="#" onclick="return doclink('link-207', 'category', 'link-172');">category</a></tt> </tt>
<a name="L182"></a><tt class="py-lineno">182</tt>  <tt class="py-line">        <tt id="link-208" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-208', 'options', 'link-89');">options</a></tt><tt class="py-op">[</tt><tt class="py-string">"target"</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-209" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-209', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-210" class="py-name"><a title="lib.cuckoo.core.database.Task.target" class="py-name" href="#" onclick="return doclink('link-210', 'target', 'link-108');">target</a></tt> </tt>
<a name="L183"></a><tt class="py-lineno">183</tt>  <tt class="py-line">        <tt id="link-211" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-211', 'options', 'link-89');">options</a></tt><tt class="py-op">[</tt><tt class="py-string">"package"</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-212" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-212', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-213" class="py-name"><a title="lib.cuckoo.core.database.Task.package" class="py-name" href="#" onclick="return doclink('link-213', 'package', 'link-188');">package</a></tt> </tt>
<a name="L184"></a><tt class="py-lineno">184</tt>  <tt class="py-line">        <tt id="link-214" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-214', 'options', 'link-89');">options</a></tt><tt class="py-op">[</tt><tt class="py-string">"options"</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt id="link-215" class="py-name"><a title="lib.cuckoo.common.config.emit_options" class="py-name" href="#" onclick="return doclink('link-215', 'emit_options', 'link-6');">emit_options</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-216" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-216', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-217" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-217', 'options', 'link-89');">options</a></tt><tt class="py-op">)</tt> </tt>
<a name="L185"></a><tt class="py-lineno">185</tt>  <tt class="py-line">        <tt id="link-218" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-218', 'options', 'link-89');">options</a></tt><tt class="py-op">[</tt><tt class="py-string">"enforce_timeout"</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-219" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-219', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-220" class="py-name" targets="Variable lib.cuckoo.core.database.Task.enforce_timeout=lib.cuckoo.core.database.Task-class.html#enforce_timeout"><a title="lib.cuckoo.core.database.Task.enforce_timeout" class="py-name" href="#" onclick="return doclink('link-220', 'enforce_timeout', 'link-220');">enforce_timeout</a></tt> </tt>
<a name="L186"></a><tt class="py-lineno">186</tt>  <tt class="py-line">        <tt id="link-221" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-221', 'options', 'link-89');">options</a></tt><tt class="py-op">[</tt><tt class="py-string">"clock"</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-222" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-222', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-223" class="py-name" targets="Variable lib.cuckoo.core.database.Task.clock=lib.cuckoo.core.database.Task-class.html#clock"><a title="lib.cuckoo.core.database.Task.clock" class="py-name" href="#" onclick="return doclink('link-223', 'clock', 'link-223');">clock</a></tt> </tt>
<a name="L187"></a><tt class="py-lineno">187</tt>  <tt class="py-line">        <tt id="link-224" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-224', 'options', 'link-89');">options</a></tt><tt class="py-op">[</tt><tt class="py-string">"terminate_processes"</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-225" class="py-name"><a title="lib.cuckoo.core.rooter.cfg
modules.auxiliary.services.cfg
modules.processing.network.cfg" class="py-name" href="#" onclick="return doclink('link-225', 'cfg', 'link-83');">cfg</a></tt><tt class="py-op">.</tt><tt id="link-226" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-226', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt class="py-name">terminate_processes</tt> </tt>
<a name="L188"></a><tt class="py-lineno">188</tt>  <tt class="py-line"> </tt>
<a name="L189"></a><tt class="py-lineno">189</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-227" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-227', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-228" class="py-name" targets="Variable lib.cuckoo.core.database.Task.timeout=lib.cuckoo.core.database.Task-class.html#timeout"><a title="lib.cuckoo.core.database.Task.timeout" class="py-name" href="#" onclick="return doclink('link-228', 'timeout', 'link-228');">timeout</a></tt><tt class="py-op">:</tt> </tt>
<a name="L190"></a><tt class="py-lineno">190</tt>  <tt class="py-line">            <tt id="link-229" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-229', 'options', 'link-89');">options</a></tt><tt class="py-op">[</tt><tt class="py-string">"timeout"</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-230" class="py-name"><a title="lib.cuckoo.core.rooter.cfg
modules.auxiliary.services.cfg
modules.processing.network.cfg" class="py-name" href="#" onclick="return doclink('link-230', 'cfg', 'link-83');">cfg</a></tt><tt class="py-op">.</tt><tt class="py-name">timeouts</tt><tt class="py-op">.</tt><tt id="link-231" class="py-name" targets="Function modules.reporting.jsondump.default()=modules.reporting.jsondump-module.html#default"><a title="modules.reporting.jsondump.default" class="py-name" href="#" onclick="return doclink('link-231', 'default', 'link-231');">default</a></tt> </tt>
<a name="L191"></a><tt class="py-lineno">191</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L192"></a><tt class="py-lineno">192</tt>  <tt class="py-line">            <tt id="link-232" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-232', 'options', 'link-89');">options</a></tt><tt class="py-op">[</tt><tt class="py-string">"timeout"</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-233" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-233', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-234" class="py-name"><a title="lib.cuckoo.core.database.Task.timeout" class="py-name" href="#" onclick="return doclink('link-234', 'timeout', 'link-228');">timeout</a></tt> </tt>
<a name="L193"></a><tt class="py-lineno">193</tt>  <tt class="py-line"> </tt>
<a name="L194"></a><tt class="py-lineno">194</tt>  <tt class="py-line">        <tt class="py-comment"># copy in other analyzer specific options, TEMPORARY (most likely)</tt> </tt>
<a name="L195"></a><tt class="py-lineno">195</tt>  <tt class="py-line">        <tt class="py-name">vm_options</tt> <tt class="py-op">=</tt> <tt class="py-name">getattr</tt><tt class="py-op">(</tt><tt id="link-235" class="py-name"><a title="lib.cuckoo.core.scheduler.machinery
modules.machinery" class="py-name" href="#" onclick="return doclink('link-235', 'machinery', 'link-75');">machinery</a></tt><tt class="py-op">.</tt><tt id="link-236" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-236', 'options', 'link-89');">options</a></tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-237" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-237', 'machine', 'link-85');">machine</a></tt><tt class="py-op">.</tt><tt id="link-238" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-238', 'name', 'link-165');">name</a></tt><tt class="py-op">)</tt> </tt>
<a name="L196"></a><tt class="py-lineno">196</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt class="py-name">k</tt> <tt class="py-keyword">in</tt> <tt class="py-name">vm_options</tt><tt class="py-op">:</tt> </tt>
<a name="L197"></a><tt class="py-lineno">197</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">k</tt><tt class="py-op">.</tt><tt class="py-name">startswith</tt><tt class="py-op">(</tt><tt class="py-string">"analyzer_"</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L198"></a><tt class="py-lineno">198</tt>  <tt class="py-line">                <tt id="link-239" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-239', 'options', 'link-89');">options</a></tt><tt class="py-op">[</tt><tt class="py-name">k</tt><tt class="py-op">]</tt> <tt class="py-op">=</tt> <tt class="py-name">vm_options</tt><tt class="py-op">[</tt><tt class="py-name">k</tt><tt class="py-op">]</tt> </tt>
<a name="L199"></a><tt class="py-lineno">199</tt>  <tt class="py-line"> </tt>
<a name="L200"></a><tt class="py-lineno">200</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt id="link-240" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-240', 'options', 'link-89');">options</a></tt> </tt>
</div><a name="L201"></a><tt class="py-lineno">201</tt>  <tt class="py-line"> </tt>
<a name="AnalysisManager.route_network"></a><div id="AnalysisManager.route_network-def"><a name="L202"></a><tt class="py-lineno">202</tt> <a class="py-toggle" href="#" id="AnalysisManager.route_network-toggle" onclick="return toggle('AnalysisManager.route_network');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.scheduler.AnalysisManager-class.html#route_network">route_network</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="AnalysisManager.route_network-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="AnalysisManager.route_network-expanded"><a name="L203"></a><tt class="py-lineno">203</tt>  <tt class="py-line">        <tt class="py-docstring">"""Enable network routing if desired."""</tt> </tt>
<a name="L204"></a><tt class="py-lineno">204</tt>  <tt class="py-line">        <tt class="py-comment"># Determine the desired routing strategy (none, internet, VPN).</tt> </tt>
<a name="L205"></a><tt class="py-lineno">205</tt>  <tt class="py-line">        <tt id="link-241" class="py-name" targets="Variable lib.cuckoo.core.database.Task.route=lib.cuckoo.core.database.Task-class.html#route"><a title="lib.cuckoo.core.database.Task.route" class="py-name" href="#" onclick="return doclink('link-241', 'route', 'link-241');">route</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-242" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-242', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-243" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-243', 'options', 'link-89');">options</a></tt><tt class="py-op">.</tt><tt id="link-244" class="py-name" targets="Method lib.cuckoo.common.config.Config.get()=lib.cuckoo.common.config.Config-class.html#get,Method lib.cuckoo.core.guest.GuestManager.get()=lib.cuckoo.core.guest.GuestManager-class.html#get"><a title="lib.cuckoo.common.config.Config.get
lib.cuckoo.core.guest.GuestManager.get" class="py-name" href="#" onclick="return doclink('link-244', 'get', 'link-244');">get</a></tt><tt class="py-op">(</tt><tt class="py-string">"route"</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-245" class="py-name"><a title="lib.cuckoo.core.rooter.cfg
modules.auxiliary.services.cfg
modules.processing.network.cfg" class="py-name" href="#" onclick="return doclink('link-245', 'cfg', 'link-83');">cfg</a></tt><tt class="py-op">.</tt><tt class="py-name">routing</tt><tt class="py-op">.</tt><tt id="link-246" class="py-name"><a title="lib.cuckoo.core.database.Task.route" class="py-name" href="#" onclick="return doclink('link-246', 'route', 'link-241');">route</a></tt><tt class="py-op">)</tt> </tt>
<a name="L206"></a><tt class="py-lineno">206</tt>  <tt class="py-line"> </tt>
<a name="L207"></a><tt class="py-lineno">207</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt id="link-247" class="py-name"><a title="lib.cuckoo.core.database.Task.route" class="py-name" href="#" onclick="return doclink('link-247', 'route', 'link-241');">route</a></tt> <tt class="py-op">==</tt> <tt class="py-string">"none"</tt><tt class="py-op">:</tt> </tt>
<a name="L208"></a><tt class="py-lineno">208</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-248" class="py-name" targets="Variable lib.cuckoo.core.database.Machine.interface=lib.cuckoo.core.database.Machine-class.html#interface"><a title="lib.cuckoo.core.database.Machine.interface" class="py-name" href="#" onclick="return doclink('link-248', 'interface', 'link-248');">interface</a></tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L209"></a><tt class="py-lineno">209</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt id="link-249" class="py-name"><a title="lib.cuckoo.core.database.Task.route" class="py-name" href="#" onclick="return doclink('link-249', 'route', 'link-241');">route</a></tt> <tt class="py-op">==</tt> <tt class="py-string">"internet"</tt> <tt class="py-keyword">and</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-250" class="py-name"><a title="lib.cuckoo.core.rooter.cfg
modules.auxiliary.services.cfg
modules.processing.network.cfg" class="py-name" href="#" onclick="return doclink('link-250', 'cfg', 'link-83');">cfg</a></tt><tt class="py-op">.</tt><tt class="py-name">routing</tt><tt class="py-op">.</tt><tt class="py-name">internet</tt> <tt class="py-op">!=</tt> <tt class="py-string">"none"</tt><tt class="py-op">:</tt> </tt>
<a name="L210"></a><tt class="py-lineno">210</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-251" class="py-name"><a title="lib.cuckoo.core.database.Machine.interface" class="py-name" href="#" onclick="return doclink('link-251', 'interface', 'link-248');">interface</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-252" class="py-name"><a title="lib.cuckoo.core.rooter.cfg
modules.auxiliary.services.cfg
modules.processing.network.cfg" class="py-name" href="#" onclick="return doclink('link-252', 'cfg', 'link-83');">cfg</a></tt><tt class="py-op">.</tt><tt class="py-name">routing</tt><tt class="py-op">.</tt><tt class="py-name">internet</tt> </tt>
<a name="L211"></a><tt class="py-lineno">211</tt>  <tt class="py-line">        <tt class="py-keyword">elif</tt> <tt id="link-253" class="py-name"><a title="lib.cuckoo.core.database.Task.route" class="py-name" href="#" onclick="return doclink('link-253', 'route', 'link-241');">route</a></tt> <tt class="py-keyword">in</tt> <tt id="link-254" class="py-name"><a title="lib.cuckoo.core.rooter.vpns" class="py-name" href="#" onclick="return doclink('link-254', 'vpns', 'link-73');">vpns</a></tt><tt class="py-op">:</tt> </tt>
<a name="L212"></a><tt class="py-lineno">212</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-255" class="py-name"><a title="lib.cuckoo.core.database.Machine.interface" class="py-name" href="#" onclick="return doclink('link-255', 'interface', 'link-248');">interface</a></tt> <tt class="py-op">=</tt> <tt id="link-256" class="py-name"><a title="lib.cuckoo.core.rooter.vpns" class="py-name" href="#" onclick="return doclink('link-256', 'vpns', 'link-73');">vpns</a></tt><tt class="py-op">[</tt><tt id="link-257" class="py-name"><a title="lib.cuckoo.core.database.Task.route" class="py-name" href="#" onclick="return doclink('link-257', 'route', 'link-241');">route</a></tt><tt class="py-op">]</tt><tt class="py-op">.</tt><tt id="link-258" class="py-name"><a title="lib.cuckoo.core.database.Machine.interface" class="py-name" href="#" onclick="return doclink('link-258', 'interface', 'link-248');">interface</a></tt> </tt>
<a name="L213"></a><tt class="py-lineno">213</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L214"></a><tt class="py-lineno">214</tt>  <tt class="py-line">            <tt id="link-259" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-259', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">warning</tt><tt class="py-op">(</tt><tt class="py-string">"Unknown network routing destination specified, "</tt> </tt>
<a name="L215"></a><tt class="py-lineno">215</tt>  <tt class="py-line">                        <tt class="py-string">"ignoring routing for this analysis: %r"</tt><tt class="py-op">,</tt> <tt id="link-260" class="py-name"><a title="lib.cuckoo.core.database.Task.route" class="py-name" href="#" onclick="return doclink('link-260', 'route', 'link-241');">route</a></tt><tt class="py-op">)</tt> </tt>
<a name="L216"></a><tt class="py-lineno">216</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-261" class="py-name"><a title="lib.cuckoo.core.database.Machine.interface" class="py-name" href="#" onclick="return doclink('link-261', 'interface', 'link-248');">interface</a></tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L217"></a><tt class="py-lineno">217</tt>  <tt class="py-line"> </tt>
<a name="L218"></a><tt class="py-lineno">218</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-262" class="py-name"><a title="lib.cuckoo.core.database.Machine.interface" class="py-name" href="#" onclick="return doclink('link-262', 'interface', 'link-248');">interface</a></tt><tt class="py-op">:</tt> </tt>
<a name="L219"></a><tt class="py-lineno">219</tt>  <tt class="py-line">            <tt id="link-263" class="py-name"><a title="lib.cuckoo.core.rooter
lib.cuckoo.core.rooter.rooter" class="py-name" href="#" onclick="return doclink('link-263', 'rooter', 'link-71');">rooter</a></tt><tt class="py-op">(</tt><tt class="py-string">"forward_enable"</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-264" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-264', 'machine', 'link-85');">machine</a></tt><tt class="py-op">.</tt><tt id="link-265" class="py-name"><a title="lib.cuckoo.core.database.Machine.interface" class="py-name" href="#" onclick="return doclink('link-265', 'interface', 'link-248');">interface</a></tt><tt class="py-op">,</tt> </tt>
<a name="L220"></a><tt class="py-lineno">220</tt>  <tt class="py-line">                   <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-266" class="py-name"><a title="lib.cuckoo.core.database.Machine.interface" class="py-name" href="#" onclick="return doclink('link-266', 'interface', 'link-248');">interface</a></tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-267" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-267', 'machine', 'link-85');">machine</a></tt><tt class="py-op">.</tt><tt id="link-268" class="py-name" targets="Variable lib.cuckoo.core.database.Machine.ip=lib.cuckoo.core.database.Machine-class.html#ip"><a title="lib.cuckoo.core.database.Machine.ip" class="py-name" href="#" onclick="return doclink('link-268', 'ip', 'link-268');">ip</a></tt><tt class="py-op">)</tt> </tt>
<a name="L221"></a><tt class="py-lineno">221</tt>  <tt class="py-line"> </tt>
<a name="L222"></a><tt class="py-lineno">222</tt>  <tt class="py-line">        <tt class="py-comment"># Propagate the taken route to the database.</tt> </tt>
<a name="L223"></a><tt class="py-lineno">223</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-269" class="py-name"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-269', 'db', 'link-86');">db</a></tt><tt class="py-op">.</tt><tt id="link-270" class="py-name" targets="Method lib.cuckoo.core.database.Database.set_route()=lib.cuckoo.core.database.Database-class.html#set_route"><a title="lib.cuckoo.core.database.Database.set_route" class="py-name" href="#" onclick="return doclink('link-270', 'set_route', 'link-270');">set_route</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-271" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-271', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-272" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-272', 'id', 'link-95');">id</a></tt><tt class="py-op">,</tt> <tt id="link-273" class="py-name"><a title="lib.cuckoo.core.database.Task.route" class="py-name" href="#" onclick="return doclink('link-273', 'route', 'link-241');">route</a></tt><tt class="py-op">)</tt> </tt>
</div><a name="L224"></a><tt class="py-lineno">224</tt>  <tt class="py-line"> </tt>
<a name="AnalysisManager.unroute_network"></a><div id="AnalysisManager.unroute_network-def"><a name="L225"></a><tt class="py-lineno">225</tt> <a class="py-toggle" href="#" id="AnalysisManager.unroute_network-toggle" onclick="return toggle('AnalysisManager.unroute_network');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.scheduler.AnalysisManager-class.html#unroute_network">unroute_network</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="AnalysisManager.unroute_network-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="AnalysisManager.unroute_network-expanded"><a name="L226"></a><tt class="py-lineno">226</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-274" class="py-name"><a title="lib.cuckoo.core.database.Machine.interface" class="py-name" href="#" onclick="return doclink('link-274', 'interface', 'link-248');">interface</a></tt><tt class="py-op">:</tt> </tt>
<a name="L227"></a><tt class="py-lineno">227</tt>  <tt class="py-line">            <tt id="link-275" class="py-name"><a title="lib.cuckoo.core.rooter
lib.cuckoo.core.rooter.rooter" class="py-name" href="#" onclick="return doclink('link-275', 'rooter', 'link-71');">rooter</a></tt><tt class="py-op">(</tt><tt class="py-string">"forward_disable"</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-276" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-276', 'machine', 'link-85');">machine</a></tt><tt class="py-op">.</tt><tt id="link-277" class="py-name"><a title="lib.cuckoo.core.database.Machine.interface" class="py-name" href="#" onclick="return doclink('link-277', 'interface', 'link-248');">interface</a></tt><tt class="py-op">,</tt> </tt>
<a name="L228"></a><tt class="py-lineno">228</tt>  <tt class="py-line">                   <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-278" class="py-name"><a title="lib.cuckoo.core.database.Machine.interface" class="py-name" href="#" onclick="return doclink('link-278', 'interface', 'link-248');">interface</a></tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-279" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-279', 'machine', 'link-85');">machine</a></tt><tt class="py-op">.</tt><tt id="link-280" class="py-name"><a title="lib.cuckoo.core.database.Machine.ip" class="py-name" href="#" onclick="return doclink('link-280', 'ip', 'link-268');">ip</a></tt><tt class="py-op">)</tt> </tt>
</div><a name="L229"></a><tt class="py-lineno">229</tt>  <tt class="py-line"> </tt>
<a name="AnalysisManager.wait_finish"></a><div id="AnalysisManager.wait_finish-def"><a name="L230"></a><tt class="py-lineno">230</tt> <a class="py-toggle" href="#" id="AnalysisManager.wait_finish-toggle" onclick="return toggle('AnalysisManager.wait_finish');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.scheduler.AnalysisManager-class.html#wait_finish">wait_finish</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="AnalysisManager.wait_finish-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="AnalysisManager.wait_finish-expanded"><a name="L231"></a><tt class="py-lineno">231</tt>  <tt class="py-line">        <tt class="py-docstring">"""Some VMs don't have an actual agent. Mainly those that are used as</tt> </tt>
<a name="L232"></a><tt class="py-lineno">232</tt>  <tt class="py-line"><tt class="py-docstring">        assistance for an analysis through the services auxiliary module. This</tt> </tt>
<a name="L233"></a><tt class="py-lineno">233</tt>  <tt class="py-line"><tt class="py-docstring">        method just waits until the analysis is finished rather than actively</tt> </tt>
<a name="L234"></a><tt class="py-lineno">234</tt>  <tt class="py-line"><tt class="py-docstring">        trying to engage with the Cuckoo Agent."""</tt> </tt>
<a name="L235"></a><tt class="py-lineno">235</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-281" class="py-name"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-281', 'db', 'link-86');">db</a></tt><tt class="py-op">.</tt><tt id="link-282" class="py-name" targets="Method lib.cuckoo.core.database.Database.guest_set_status()=lib.cuckoo.core.database.Database-class.html#guest_set_status"><a title="lib.cuckoo.core.database.Database.guest_set_status" class="py-name" href="#" onclick="return doclink('link-282', 'guest_set_status', 'link-282');">guest_set_status</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-283" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-283', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-284" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-284', 'id', 'link-95');">id</a></tt><tt class="py-op">,</tt> <tt class="py-string">"running"</tt><tt class="py-op">)</tt> </tt>
<a name="L236"></a><tt class="py-lineno">236</tt>  <tt class="py-line">        <tt class="py-keyword">while</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-285" class="py-name"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-285', 'db', 'link-86');">db</a></tt><tt class="py-op">.</tt><tt id="link-286" class="py-name" targets="Method lib.cuckoo.core.database.Database.guest_get_status()=lib.cuckoo.core.database.Database-class.html#guest_get_status"><a title="lib.cuckoo.core.database.Database.guest_get_status" class="py-name" href="#" onclick="return doclink('link-286', 'guest_get_status', 'link-286');">guest_get_status</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-287" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-287', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-288" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-288', 'id', 'link-95');">id</a></tt><tt class="py-op">)</tt> <tt class="py-op">==</tt> <tt class="py-string">"running"</tt><tt class="py-op">:</tt> </tt>
<a name="L237"></a><tt class="py-lineno">237</tt>  <tt class="py-line">            <tt class="py-name">time</tt><tt class="py-op">.</tt><tt class="py-name">sleep</tt><tt class="py-op">(</tt><tt class="py-number">1</tt><tt class="py-op">)</tt> </tt>
</div><a name="L238"></a><tt class="py-lineno">238</tt>  <tt class="py-line"> </tt>
<a name="AnalysisManager.guest_manage"></a><div id="AnalysisManager.guest_manage-def"><a name="L239"></a><tt class="py-lineno">239</tt> <a class="py-toggle" href="#" id="AnalysisManager.guest_manage-toggle" onclick="return toggle('AnalysisManager.guest_manage');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.scheduler.AnalysisManager-class.html#guest_manage">guest_manage</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">options</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="AnalysisManager.guest_manage-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="AnalysisManager.guest_manage-expanded"><a name="L240"></a><tt class="py-lineno">240</tt>  <tt class="py-line">        <tt class="py-comment"># Handle a special case where we're creating a baseline report of this</tt> </tt>
<a name="L241"></a><tt class="py-lineno">241</tt>  <tt class="py-line">        <tt class="py-comment"># particular virtual machine - a report containing all the results</tt> </tt>
<a name="L242"></a><tt class="py-lineno">242</tt>  <tt class="py-line">        <tt class="py-comment"># that are gathered if no additional samples are ran in the VM. These</tt> </tt>
<a name="L243"></a><tt class="py-lineno">243</tt>  <tt class="py-line">        <tt class="py-comment"># results, such as loaded drivers and opened sockets in volatility, or</tt> </tt>
<a name="L244"></a><tt class="py-lineno">244</tt>  <tt class="py-line">        <tt class="py-comment"># DNS requests to hostnames related to Microsoft Windows, etc may be</tt> </tt>
<a name="L245"></a><tt class="py-lineno">245</tt>  <tt class="py-line">        <tt class="py-comment"># omitted or at the very least given less priority when creating a</tt> </tt>
<a name="L246"></a><tt class="py-lineno">246</tt>  <tt class="py-line">        <tt class="py-comment"># report for an analysis that ran on this VM later on.</tt> </tt>
<a name="L247"></a><tt class="py-lineno">247</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-289" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-289', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-290" class="py-name"><a title="lib.cuckoo.core.database.Task.category" class="py-name" href="#" onclick="return doclink('link-290', 'category', 'link-172');">category</a></tt> <tt class="py-op">==</tt> <tt class="py-string">"baseline"</tt><tt class="py-op">:</tt> </tt>
<a name="L248"></a><tt class="py-lineno">248</tt>  <tt class="py-line">            <tt class="py-name">time</tt><tt class="py-op">.</tt><tt class="py-name">sleep</tt><tt class="py-op">(</tt><tt id="link-291" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-291', 'options', 'link-89');">options</a></tt><tt class="py-op">[</tt><tt class="py-string">"timeout"</tt><tt class="py-op">]</tt><tt class="py-op">)</tt> </tt>
<a name="L249"></a><tt class="py-lineno">249</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L250"></a><tt class="py-lineno">250</tt>  <tt class="py-line">            <tt class="py-comment"># Initialize the guest manager.</tt> </tt>
<a name="L251"></a><tt class="py-lineno">251</tt>  <tt class="py-line">            <tt id="link-292" class="py-name"><a title="lib.cuckoo.core.database.Task.guest
lib.cuckoo.core.guest" class="py-name" href="#" onclick="return doclink('link-292', 'guest', 'link-48');">guest</a></tt> <tt class="py-op">=</tt> <tt id="link-293" class="py-name"><a title="lib.cuckoo.core.guest.GuestManager" class="py-name" href="#" onclick="return doclink('link-293', 'GuestManager', 'link-49');">GuestManager</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-294" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-294', 'machine', 'link-85');">machine</a></tt><tt class="py-op">.</tt><tt id="link-295" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-295', 'name', 'link-165');">name</a></tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-296" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-296', 'machine', 'link-85');">machine</a></tt><tt class="py-op">.</tt><tt id="link-297" class="py-name"><a title="lib.cuckoo.core.database.Machine.ip" class="py-name" href="#" onclick="return doclink('link-297', 'ip', 'link-268');">ip</a></tt><tt class="py-op">,</tt> </tt>
<a name="L252"></a><tt class="py-lineno">252</tt>  <tt class="py-line">                                 <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-298" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-298', 'machine', 'link-85');">machine</a></tt><tt class="py-op">.</tt><tt id="link-299" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.platform
lib.cuckoo.core.database.Machine.platform
lib.cuckoo.core.database.Task.platform
modules.processing.platform" class="py-name" href="#" onclick="return doclink('link-299', 'platform', 'link-148');">platform</a></tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-300" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-300', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-301" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-301', 'id', 'link-95');">id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L253"></a><tt class="py-lineno">253</tt>  <tt class="py-line"> </tt>
<a name="L254"></a><tt class="py-lineno">254</tt>  <tt class="py-line">            <tt class="py-comment"># Start the analysis.</tt> </tt>
<a name="L255"></a><tt class="py-lineno">255</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-302" class="py-name"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-302', 'db', 'link-86');">db</a></tt><tt class="py-op">.</tt><tt id="link-303" class="py-name"><a title="lib.cuckoo.core.database.Database.guest_set_status" class="py-name" href="#" onclick="return doclink('link-303', 'guest_set_status', 'link-282');">guest_set_status</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-304" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-304', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-305" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-305', 'id', 'link-95');">id</a></tt><tt class="py-op">,</tt> <tt class="py-string">"starting"</tt><tt class="py-op">)</tt> </tt>
<a name="L256"></a><tt class="py-lineno">256</tt>  <tt class="py-line">            <tt class="py-name">monitor</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-306" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-306', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-307" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-307', 'options', 'link-89');">options</a></tt><tt class="py-op">.</tt><tt id="link-308" class="py-name"><a title="lib.cuckoo.common.config.Config.get
lib.cuckoo.core.guest.GuestManager.get" class="py-name" href="#" onclick="return doclink('link-308', 'get', 'link-244');">get</a></tt><tt class="py-op">(</tt><tt class="py-string">"monitor"</tt><tt class="py-op">,</tt> <tt class="py-string">"latest"</tt><tt class="py-op">)</tt> </tt>
<a name="L257"></a><tt class="py-lineno">257</tt>  <tt class="py-line">            <tt id="link-309" class="py-name"><a title="lib.cuckoo.core.database.Task.guest
lib.cuckoo.core.guest" class="py-name" href="#" onclick="return doclink('link-309', 'guest', 'link-48');">guest</a></tt><tt class="py-op">.</tt><tt id="link-310" class="py-name" targets="Method lib.cuckoo.core.guest.GuestManager.start_analysis()=lib.cuckoo.core.guest.GuestManager-class.html#start_analysis,Method lib.cuckoo.core.guest.OldGuestManager.start_analysis()=lib.cuckoo.core.guest.OldGuestManager-class.html#start_analysis"><a title="lib.cuckoo.core.guest.GuestManager.start_analysis
lib.cuckoo.core.guest.OldGuestManager.start_analysis" class="py-name" href="#" onclick="return doclink('link-310', 'start_analysis', 'link-310');">start_analysis</a></tt><tt class="py-op">(</tt><tt id="link-311" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-311', 'options', 'link-89');">options</a></tt><tt class="py-op">,</tt> <tt class="py-name">monitor</tt><tt class="py-op">)</tt> </tt>
<a name="L258"></a><tt class="py-lineno">258</tt>  <tt class="py-line"> </tt>
<a name="L259"></a><tt class="py-lineno">259</tt>  <tt class="py-line">            <tt class="py-comment"># In case the Agent didn't respond and we force-quit the analysis</tt> </tt>
<a name="L260"></a><tt class="py-lineno">260</tt>  <tt class="py-line">            <tt class="py-comment"># at some point while it was still starting the analysis the state</tt> </tt>
<a name="L261"></a><tt class="py-lineno">261</tt>  <tt class="py-line">            <tt class="py-comment"># will be "stop" (or anything but "running", really).</tt> </tt>
<a name="L262"></a><tt class="py-lineno">262</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-312" class="py-name"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-312', 'db', 'link-86');">db</a></tt><tt class="py-op">.</tt><tt id="link-313" class="py-name"><a title="lib.cuckoo.core.database.Database.guest_get_status" class="py-name" href="#" onclick="return doclink('link-313', 'guest_get_status', 'link-286');">guest_get_status</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-314" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-314', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-315" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-315', 'id', 'link-95');">id</a></tt><tt class="py-op">)</tt> <tt class="py-op">==</tt> <tt class="py-string">"starting"</tt><tt class="py-op">:</tt> </tt>
<a name="L263"></a><tt class="py-lineno">263</tt>  <tt class="py-line">                <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-316" class="py-name"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-316', 'db', 'link-86');">db</a></tt><tt class="py-op">.</tt><tt id="link-317" class="py-name"><a title="lib.cuckoo.core.database.Database.guest_set_status" class="py-name" href="#" onclick="return doclink('link-317', 'guest_set_status', 'link-282');">guest_set_status</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-318" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-318', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-319" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-319', 'id', 'link-95');">id</a></tt><tt class="py-op">,</tt> <tt class="py-string">"running"</tt><tt class="py-op">)</tt> </tt>
<a name="L264"></a><tt class="py-lineno">264</tt>  <tt class="py-line">                <tt id="link-320" class="py-name"><a title="lib.cuckoo.core.database.Task.guest
lib.cuckoo.core.guest" class="py-name" href="#" onclick="return doclink('link-320', 'guest', 'link-48');">guest</a></tt><tt class="py-op">.</tt><tt id="link-321" class="py-name" targets="Method lib.cuckoo.core.guest.GuestManager.wait_for_completion()=lib.cuckoo.core.guest.GuestManager-class.html#wait_for_completion,Method lib.cuckoo.core.guest.OldGuestManager.wait_for_completion()=lib.cuckoo.core.guest.OldGuestManager-class.html#wait_for_completion"><a title="lib.cuckoo.core.guest.GuestManager.wait_for_completion
lib.cuckoo.core.guest.OldGuestManager.wait_for_completion" class="py-name" href="#" onclick="return doclink('link-321', 'wait_for_completion', 'link-321');">wait_for_completion</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L265"></a><tt class="py-lineno">265</tt>  <tt class="py-line"> </tt>
<a name="L266"></a><tt class="py-lineno">266</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-322" class="py-name"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-322', 'db', 'link-86');">db</a></tt><tt class="py-op">.</tt><tt id="link-323" class="py-name"><a title="lib.cuckoo.core.database.Database.guest_set_status" class="py-name" href="#" onclick="return doclink('link-323', 'guest_set_status', 'link-282');">guest_set_status</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-324" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-324', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-325" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-325', 'id', 'link-95');">id</a></tt><tt class="py-op">,</tt> <tt class="py-string">"stopping"</tt><tt class="py-op">)</tt> </tt>
</div><a name="L267"></a><tt class="py-lineno">267</tt>  <tt class="py-line"> </tt>
<a name="AnalysisManager.launch_analysis"></a><div id="AnalysisManager.launch_analysis-def"><a name="L268"></a><tt class="py-lineno">268</tt> <a class="py-toggle" href="#" id="AnalysisManager.launch_analysis-toggle" onclick="return toggle('AnalysisManager.launch_analysis');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.scheduler.AnalysisManager-class.html#launch_analysis">launch_analysis</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="AnalysisManager.launch_analysis-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="AnalysisManager.launch_analysis-expanded"><a name="L269"></a><tt class="py-lineno">269</tt>  <tt class="py-line">        <tt class="py-docstring">"""Start analysis."""</tt> </tt>
<a name="L270"></a><tt class="py-lineno">270</tt>  <tt class="py-line">        <tt class="py-name">succeeded</tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L271"></a><tt class="py-lineno">271</tt>  <tt class="py-line"> </tt>
<a name="L272"></a><tt class="py-lineno">272</tt>  <tt class="py-line">        <tt id="link-326" class="py-name"><a title="lib.cuckoo.core.database.Task.target" class="py-name" href="#" onclick="return doclink('link-326', 'target', 'link-108');">target</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-327" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-327', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-328" class="py-name"><a title="lib.cuckoo.core.database.Task.target" class="py-name" href="#" onclick="return doclink('link-328', 'target', 'link-108');">target</a></tt> </tt>
<a name="L273"></a><tt class="py-lineno">273</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-329" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-329', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-330" class="py-name"><a title="lib.cuckoo.core.database.Task.category" class="py-name" href="#" onclick="return doclink('link-330', 'category', 'link-172');">category</a></tt> <tt class="py-op">==</tt> <tt class="py-string">"file"</tt><tt class="py-op">:</tt> </tt>
<a name="L274"></a><tt class="py-lineno">274</tt>  <tt class="py-line">            <tt id="link-331" class="py-name"><a title="lib.cuckoo.core.database.Task.target" class="py-name" href="#" onclick="return doclink('link-331', 'target', 'link-108');">target</a></tt> <tt class="py-op">=</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">basename</tt><tt class="py-op">(</tt><tt id="link-332" class="py-name"><a title="lib.cuckoo.core.database.Task.target" class="py-name" href="#" onclick="return doclink('link-332', 'target', 'link-108');">target</a></tt><tt class="py-op">)</tt> </tt>
<a name="L275"></a><tt class="py-lineno">275</tt>  <tt class="py-line"> </tt>
<a name="L276"></a><tt class="py-lineno">276</tt>  <tt class="py-line">        <tt id="link-333" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-333', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">"Starting analysis of %s \"%s\" (task #%d, options \"%s\")"</tt><tt class="py-op">,</tt> </tt>
<a name="L277"></a><tt class="py-lineno">277</tt>  <tt class="py-line">                 <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-334" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-334', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-335" class="py-name"><a title="lib.cuckoo.core.database.Task.category" class="py-name" href="#" onclick="return doclink('link-335', 'category', 'link-172');">category</a></tt><tt class="py-op">.</tt><tt class="py-name">upper</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt id="link-336" class="py-name"><a title="lib.cuckoo.core.database.Task.target" class="py-name" href="#" onclick="return doclink('link-336', 'target', 'link-108');">target</a></tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-337" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-337', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-338" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-338', 'id', 'link-95');">id</a></tt><tt class="py-op">,</tt> </tt>
<a name="L278"></a><tt class="py-lineno">278</tt>  <tt class="py-line">                 <tt id="link-339" class="py-name"><a title="lib.cuckoo.common.config.emit_options" class="py-name" href="#" onclick="return doclink('link-339', 'emit_options', 'link-6');">emit_options</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-340" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-340', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-341" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-341', 'options', 'link-89');">options</a></tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L279"></a><tt class="py-lineno">279</tt>  <tt class="py-line"> </tt>
<a name="L280"></a><tt class="py-lineno">280</tt>  <tt class="py-line">        <tt class="py-comment"># Initialize the analysis folders.</tt> </tt>
<a name="L281"></a><tt class="py-lineno">281</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-342" class="py-name" targets="Method lib.cuckoo.core.scheduler.AnalysisManager.init_storage()=lib.cuckoo.core.scheduler.AnalysisManager-class.html#init_storage"><a title="lib.cuckoo.core.scheduler.AnalysisManager.init_storage" class="py-name" href="#" onclick="return doclink('link-342', 'init_storage', 'link-342');">init_storage</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L282"></a><tt class="py-lineno">282</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-name">False</tt> </tt>
<a name="L283"></a><tt class="py-lineno">283</tt>  <tt class="py-line"> </tt>
<a name="L284"></a><tt class="py-lineno">284</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-343" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-343', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-344" class="py-name"><a title="lib.cuckoo.core.database.Task.category" class="py-name" href="#" onclick="return doclink('link-344', 'category', 'link-172');">category</a></tt> <tt class="py-op">==</tt> <tt class="py-string">"file"</tt><tt class="py-op">:</tt> </tt>
<a name="L285"></a><tt class="py-lineno">285</tt>  <tt class="py-line">            <tt class="py-comment"># Check whether the file has been changed for some unknown reason.</tt> </tt>
<a name="L286"></a><tt class="py-lineno">286</tt>  <tt class="py-line">            <tt class="py-comment"># And fail this analysis if it has been modified.</tt> </tt>
<a name="L287"></a><tt class="py-lineno">287</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-345" class="py-name" targets="Method lib.cuckoo.common.abstracts.Signature.check_file()=lib.cuckoo.common.abstracts.Signature-class.html#check_file,Method lib.cuckoo.core.scheduler.AnalysisManager.check_file()=lib.cuckoo.core.scheduler.AnalysisManager-class.html#check_file"><a title="lib.cuckoo.common.abstracts.Signature.check_file
lib.cuckoo.core.scheduler.AnalysisManager.check_file" class="py-name" href="#" onclick="return doclink('link-345', 'check_file', 'link-345');">check_file</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L288"></a><tt class="py-lineno">288</tt>  <tt class="py-line">                <tt class="py-keyword">return</tt> <tt class="py-name">False</tt> </tt>
<a name="L289"></a><tt class="py-lineno">289</tt>  <tt class="py-line"> </tt>
<a name="L290"></a><tt class="py-lineno">290</tt>  <tt class="py-line">            <tt class="py-comment"># Store a copy of the original file.</tt> </tt>
<a name="L291"></a><tt class="py-lineno">291</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-346" class="py-name" targets="Method lib.cuckoo.core.scheduler.AnalysisManager.store_file()=lib.cuckoo.core.scheduler.AnalysisManager-class.html#store_file,Method modules.reporting.mongodb.MongoDB.store_file()=modules.reporting.mongodb.MongoDB-class.html#store_file"><a title="lib.cuckoo.core.scheduler.AnalysisManager.store_file
modules.reporting.mongodb.MongoDB.store_file" class="py-name" href="#" onclick="return doclink('link-346', 'store_file', 'link-346');">store_file</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L292"></a><tt class="py-lineno">292</tt>  <tt class="py-line">                <tt class="py-keyword">return</tt> <tt class="py-name">False</tt> </tt>
<a name="L293"></a><tt class="py-lineno">293</tt>  <tt class="py-line"> </tt>
<a name="L294"></a><tt class="py-lineno">294</tt>  <tt class="py-line">        <tt class="py-comment"># Acquire analysis machine.</tt> </tt>
<a name="L295"></a><tt class="py-lineno">295</tt>  <tt class="py-line">        <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L296"></a><tt class="py-lineno">296</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-347" class="py-name" targets="Method lib.cuckoo.core.scheduler.AnalysisManager.acquire_machine()=lib.cuckoo.core.scheduler.AnalysisManager-class.html#acquire_machine"><a title="lib.cuckoo.core.scheduler.AnalysisManager.acquire_machine" class="py-name" href="#" onclick="return doclink('link-347', 'acquire_machine', 'link-347');">acquire_machine</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L297"></a><tt class="py-lineno">297</tt>  <tt class="py-line">        <tt class="py-keyword">except</tt> <tt id="link-348" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooOperationalError" class="py-name" href="#" onclick="return doclink('link-348', 'CuckooOperationalError', 'link-22');">CuckooOperationalError</a></tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L298"></a><tt class="py-lineno">298</tt>  <tt class="py-line">            <tt id="link-349" class="py-name"><a title="lib.cuckoo.core.scheduler.machine_lock" class="py-name" href="#" onclick="return doclink('link-349', 'machine_lock', 'link-76');">machine_lock</a></tt><tt class="py-op">.</tt><tt id="link-350" class="py-name"><a title="lib.cuckoo.common.abstracts.Machinery.release" class="py-name" href="#" onclick="return doclink('link-350', 'release', 'link-142');">release</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L299"></a><tt class="py-lineno">299</tt>  <tt class="py-line">            <tt id="link-351" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-351', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">error</tt><tt class="py-op">(</tt><tt class="py-string">"Cannot acquire machine: {0}"</tt><tt class="py-op">.</tt><tt class="py-name">format</tt><tt class="py-op">(</tt><tt class="py-name">e</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L300"></a><tt class="py-lineno">300</tt>  <tt class="py-line">            <tt class="py-keyword">return</tt> <tt class="py-name">False</tt> </tt>
<a name="L301"></a><tt class="py-lineno">301</tt>  <tt class="py-line"> </tt>
<a name="L302"></a><tt class="py-lineno">302</tt>  <tt class="py-line">        <tt class="py-comment"># At this point we can tell the ResultServer about it.</tt> </tt>
<a name="L303"></a><tt class="py-lineno">303</tt>  <tt class="py-line">        <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L304"></a><tt class="py-lineno">304</tt>  <tt class="py-line">            <tt id="link-352" class="py-name"><a title="lib.cuckoo.core.resultserver.ResultServer" class="py-name" href="#" onclick="return doclink('link-352', 'ResultServer', 'link-67');">ResultServer</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">.</tt><tt id="link-353" class="py-name" targets="Method lib.cuckoo.core.resultserver.ResultServer.add_task()=lib.cuckoo.core.resultserver.ResultServer-class.html#add_task"><a title="lib.cuckoo.core.resultserver.ResultServer.add_task" class="py-name" href="#" onclick="return doclink('link-353', 'add_task', 'link-353');">add_task</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-354" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-354', 'task', 'link-80');">task</a></tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-355" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-355', 'machine', 'link-85');">machine</a></tt><tt class="py-op">)</tt> </tt>
<a name="L305"></a><tt class="py-lineno">305</tt>  <tt class="py-line">        <tt class="py-keyword">except</tt> <tt class="py-name">Exception</tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L306"></a><tt class="py-lineno">306</tt>  <tt class="py-line">            <tt id="link-356" class="py-name"><a title="lib.cuckoo.core.scheduler.machinery
modules.machinery" class="py-name" href="#" onclick="return doclink('link-356', 'machinery', 'link-75');">machinery</a></tt><tt class="py-op">.</tt><tt id="link-357" class="py-name"><a title="lib.cuckoo.common.abstracts.Machinery.release" class="py-name" href="#" onclick="return doclink('link-357', 'release', 'link-142');">release</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-358" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-358', 'machine', 'link-85');">machine</a></tt><tt class="py-op">.</tt><tt id="link-359" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-359', 'label', 'link-167');">label</a></tt><tt class="py-op">)</tt> </tt>
<a name="L307"></a><tt class="py-lineno">307</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-360" class="py-name"><a title="lib.cuckoo.core.database.Task.errors" class="py-name" href="#" onclick="return doclink('link-360', 'errors', 'link-82');">errors</a></tt><tt class="py-op">.</tt><tt class="py-name">put</tt><tt class="py-op">(</tt><tt class="py-name">e</tt><tt class="py-op">)</tt> </tt>
<a name="L308"></a><tt class="py-lineno">308</tt>  <tt class="py-line"> </tt>
<a name="L309"></a><tt class="py-lineno">309</tt>  <tt class="py-line">        <tt class="py-name">aux</tt> <tt class="py-op">=</tt> <tt id="link-361" class="py-name"><a title="lib.cuckoo.core.plugins.RunAuxiliary" class="py-name" href="#" onclick="return doclink('link-361', 'RunAuxiliary', 'link-55');">RunAuxiliary</a></tt><tt class="py-op">(</tt><tt id="link-362" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-362', 'task', 'link-80');">task</a></tt><tt class="py-op">=</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-363" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-363', 'task', 'link-80');">task</a></tt><tt class="py-op">,</tt> <tt id="link-364" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-364', 'machine', 'link-85');">machine</a></tt><tt class="py-op">=</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-365" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-365', 'machine', 'link-85');">machine</a></tt><tt class="py-op">)</tt> </tt>
<a name="L310"></a><tt class="py-lineno">310</tt>  <tt class="py-line">        <tt class="py-name">aux</tt><tt class="py-op">.</tt><tt id="link-366" class="py-name" targets="Method lib.cuckoo.common.abstracts.Auxiliary.start()=lib.cuckoo.common.abstracts.Auxiliary-class.html#start,Method lib.cuckoo.common.abstracts.LibVirtMachinery.start()=lib.cuckoo.common.abstracts.LibVirtMachinery-class.html#start,Method lib.cuckoo.common.abstracts.Machinery.start()=lib.cuckoo.common.abstracts.Machinery-class.html#start,Method lib.cuckoo.core.plugins.RunAuxiliary.start()=lib.cuckoo.core.plugins.RunAuxiliary-class.html#start,Method lib.cuckoo.core.scheduler.Scheduler.start()=lib.cuckoo.core.scheduler.Scheduler-class.html#start,Method modules.auxiliary.mitm.MITM.start()=modules.auxiliary.mitm.MITM-class.html#start,Method modules.auxiliary.services.Services.start()=modules.auxiliary.services.Services-class.html#start,Method modules.auxiliary.sniffer.Sniffer.start()=modules.auxiliary.sniffer.Sniffer-class.html#start,Method modules.machinery.avd.Avd.start()=modules.machinery.avd.Avd-class.html#start,Method modules.machinery.physical.Physical.start()=modules.machinery.physical.Physical-class.html#start,Method modules.machinery.qemu.QEMU.start()=modules.machinery.qemu.QEMU-class.html#start,Method modules.machinery.virtualbox.VirtualBox.start()=modules.machinery.virtualbox.VirtualBox-class.html#start,Method modules.machinery.vmware.VMware.start()=modules.machinery.vmware.VMware-class.html#start,Method modules.machinery.vsphere.vSphere.start()=modules.machinery.vsphere.vSphere-class.html#start,Method modules.machinery.xenserver.XenServerMachinery.start()=modules.machinery.xenserver.XenServerMachinery-class.html#start"><a title="lib.cuckoo.common.abstracts.Auxiliary.start
lib.cuckoo.common.abstracts.LibVirtMachinery.start
lib.cuckoo.common.abstracts.Machinery.start
lib.cuckoo.core.plugins.RunAuxiliary.start
lib.cuckoo.core.scheduler.Scheduler.start
modules.auxiliary.mitm.MITM.start
modules.auxiliary.services.Services.start
modules.auxiliary.sniffer.Sniffer.start
modules.machinery.avd.Avd.start
modules.machinery.physical.Physical.start
modules.machinery.qemu.QEMU.start
modules.machinery.virtualbox.VirtualBox.start
modules.machinery.vmware.VMware.start
modules.machinery.vsphere.vSphere.start
modules.machinery.xenserver.XenServerMachinery.start" class="py-name" href="#" onclick="return doclink('link-366', 'start', 'link-366');">start</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L311"></a><tt class="py-lineno">311</tt>  <tt class="py-line"> </tt>
<a name="L312"></a><tt class="py-lineno">312</tt>  <tt class="py-line">        <tt class="py-comment"># Generate the analysis configuration file.</tt> </tt>
<a name="L313"></a><tt class="py-lineno">313</tt>  <tt class="py-line">        <tt id="link-367" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-367', 'options', 'link-89');">options</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-368" class="py-name" targets="Method lib.cuckoo.core.scheduler.AnalysisManager.build_options()=lib.cuckoo.core.scheduler.AnalysisManager-class.html#build_options"><a title="lib.cuckoo.core.scheduler.AnalysisManager.build_options" class="py-name" href="#" onclick="return doclink('link-368', 'build_options', 'link-368');">build_options</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L314"></a><tt class="py-lineno">314</tt>  <tt class="py-line"> </tt>
<a name="L315"></a><tt class="py-lineno">315</tt>  <tt class="py-line">        <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L316"></a><tt class="py-lineno">316</tt>  <tt class="py-line">            <tt class="py-name">unlocked</tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L317"></a><tt class="py-lineno">317</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-369" class="py-name"><a title="lib.cuckoo.core.database.Machine.interface" class="py-name" href="#" onclick="return doclink('link-369', 'interface', 'link-248');">interface</a></tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt> </tt>
<a name="L318"></a><tt class="py-lineno">318</tt>  <tt class="py-line"> </tt>
<a name="L319"></a><tt class="py-lineno">319</tt>  <tt class="py-line">            <tt class="py-comment"># Mark the selected analysis machine in the database as started.</tt> </tt>
<a name="L320"></a><tt class="py-lineno">320</tt>  <tt class="py-line">            <tt class="py-name">guest_log</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-370" class="py-name"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-370', 'db', 'link-86');">db</a></tt><tt class="py-op">.</tt><tt id="link-371" class="py-name" targets="Method lib.cuckoo.core.database.Database.guest_start()=lib.cuckoo.core.database.Database-class.html#guest_start"><a title="lib.cuckoo.core.database.Database.guest_start" class="py-name" href="#" onclick="return doclink('link-371', 'guest_start', 'link-371');">guest_start</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-372" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-372', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-373" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-373', 'id', 'link-95');">id</a></tt><tt class="py-op">,</tt> </tt>
<a name="L321"></a><tt class="py-lineno">321</tt>  <tt class="py-line">                                            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-374" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-374', 'machine', 'link-85');">machine</a></tt><tt class="py-op">.</tt><tt id="link-375" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-375', 'name', 'link-165');">name</a></tt><tt class="py-op">,</tt> </tt>
<a name="L322"></a><tt class="py-lineno">322</tt>  <tt class="py-line">                                            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-376" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-376', 'machine', 'link-85');">machine</a></tt><tt class="py-op">.</tt><tt id="link-377" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-377', 'label', 'link-167');">label</a></tt><tt class="py-op">,</tt> </tt>
<a name="L323"></a><tt class="py-lineno">323</tt>  <tt class="py-line">                                            <tt id="link-378" class="py-name"><a title="lib.cuckoo.core.scheduler.machinery
modules.machinery" class="py-name" href="#" onclick="return doclink('link-378', 'machinery', 'link-75');">machinery</a></tt><tt class="py-op">.</tt><tt class="py-name">__class__</tt><tt class="py-op">.</tt><tt class="py-name">__name__</tt><tt class="py-op">)</tt> </tt>
<a name="L324"></a><tt class="py-lineno">324</tt>  <tt class="py-line">            <tt class="py-comment"># Start the machine.</tt> </tt>
<a name="L325"></a><tt class="py-lineno">325</tt>  <tt class="py-line">            <tt id="link-379" class="py-name"><a title="lib.cuckoo.core.scheduler.machinery
modules.machinery" class="py-name" href="#" onclick="return doclink('link-379', 'machinery', 'link-75');">machinery</a></tt><tt class="py-op">.</tt><tt id="link-380" class="py-name"><a title="lib.cuckoo.common.abstracts.Auxiliary.start
lib.cuckoo.common.abstracts.LibVirtMachinery.start
lib.cuckoo.common.abstracts.Machinery.start
lib.cuckoo.core.plugins.RunAuxiliary.start
lib.cuckoo.core.scheduler.Scheduler.start
modules.auxiliary.mitm.MITM.start
modules.auxiliary.services.Services.start
modules.auxiliary.sniffer.Sniffer.start
modules.machinery.avd.Avd.start
modules.machinery.physical.Physical.start
modules.machinery.qemu.QEMU.start
modules.machinery.virtualbox.VirtualBox.start
modules.machinery.vmware.VMware.start
modules.machinery.vsphere.vSphere.start
modules.machinery.xenserver.XenServerMachinery.start" class="py-name" href="#" onclick="return doclink('link-380', 'start', 'link-366');">start</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-381" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-381', 'machine', 'link-85');">machine</a></tt><tt class="py-op">.</tt><tt id="link-382" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-382', 'label', 'link-167');">label</a></tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-383" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-383', 'task', 'link-80');">task</a></tt><tt class="py-op">)</tt> </tt>
<a name="L326"></a><tt class="py-lineno">326</tt>  <tt class="py-line"> </tt>
<a name="L327"></a><tt class="py-lineno">327</tt>  <tt class="py-line">            <tt class="py-comment"># Enable network routing.</tt> </tt>
<a name="L328"></a><tt class="py-lineno">328</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-384" class="py-name" targets="Method lib.cuckoo.core.scheduler.AnalysisManager.route_network()=lib.cuckoo.core.scheduler.AnalysisManager-class.html#route_network"><a title="lib.cuckoo.core.scheduler.AnalysisManager.route_network" class="py-name" href="#" onclick="return doclink('link-384', 'route_network', 'link-384');">route_network</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L329"></a><tt class="py-lineno">329</tt>  <tt class="py-line"> </tt>
<a name="L330"></a><tt class="py-lineno">330</tt>  <tt class="py-line">            <tt class="py-comment"># By the time start returns it will have fully started the Virtual</tt> </tt>
<a name="L331"></a><tt class="py-lineno">331</tt>  <tt class="py-line">            <tt class="py-comment"># Machine. We can now safely release the machine lock.</tt> </tt>
<a name="L332"></a><tt class="py-lineno">332</tt>  <tt class="py-line">            <tt id="link-385" class="py-name"><a title="lib.cuckoo.core.scheduler.machine_lock" class="py-name" href="#" onclick="return doclink('link-385', 'machine_lock', 'link-76');">machine_lock</a></tt><tt class="py-op">.</tt><tt id="link-386" class="py-name"><a title="lib.cuckoo.common.abstracts.Machinery.release" class="py-name" href="#" onclick="return doclink('link-386', 'release', 'link-142');">release</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L333"></a><tt class="py-lineno">333</tt>  <tt class="py-line">            <tt class="py-name">unlocked</tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L334"></a><tt class="py-lineno">334</tt>  <tt class="py-line"> </tt>
<a name="L335"></a><tt class="py-lineno">335</tt>  <tt class="py-line">            <tt class="py-comment"># Run and manage the components inside the guest unless this</tt> </tt>
<a name="L336"></a><tt class="py-lineno">336</tt>  <tt class="py-line">            <tt class="py-comment"># machine has the "noagent" option specified (please refer to the</tt> </tt>
<a name="L337"></a><tt class="py-lineno">337</tt>  <tt class="py-line">            <tt class="py-comment"># wait_finish() function for more details on this function).</tt> </tt>
<a name="L338"></a><tt class="py-lineno">338</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-string">"noagent"</tt> <tt class="py-keyword">not</tt> <tt class="py-keyword">in</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-387" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-387', 'machine', 'link-85');">machine</a></tt><tt class="py-op">.</tt><tt id="link-388" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-388', 'options', 'link-89');">options</a></tt><tt class="py-op">:</tt> </tt>
<a name="L339"></a><tt class="py-lineno">339</tt>  <tt class="py-line">                <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-389" class="py-name" targets="Method lib.cuckoo.core.scheduler.AnalysisManager.guest_manage()=lib.cuckoo.core.scheduler.AnalysisManager-class.html#guest_manage"><a title="lib.cuckoo.core.scheduler.AnalysisManager.guest_manage" class="py-name" href="#" onclick="return doclink('link-389', 'guest_manage', 'link-389');">guest_manage</a></tt><tt class="py-op">(</tt><tt id="link-390" class="py-name"><a title="lib.cuckoo.core.database.Machine.options
lib.cuckoo.core.database.Task.options" class="py-name" href="#" onclick="return doclink('link-390', 'options', 'link-89');">options</a></tt><tt class="py-op">)</tt> </tt>
<a name="L340"></a><tt class="py-lineno">340</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L341"></a><tt class="py-lineno">341</tt>  <tt class="py-line">                <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-391" class="py-name" targets="Method lib.cuckoo.core.scheduler.AnalysisManager.wait_finish()=lib.cuckoo.core.scheduler.AnalysisManager-class.html#wait_finish"><a title="lib.cuckoo.core.scheduler.AnalysisManager.wait_finish" class="py-name" href="#" onclick="return doclink('link-391', 'wait_finish', 'link-391');">wait_finish</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L342"></a><tt class="py-lineno">342</tt>  <tt class="py-line"> </tt>
<a name="L343"></a><tt class="py-lineno">343</tt>  <tt class="py-line">            <tt class="py-name">succeeded</tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L344"></a><tt class="py-lineno">344</tt>  <tt class="py-line">        <tt class="py-keyword">except</tt> <tt id="link-392" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-392', 'CuckooMachineError', 'link-16');">CuckooMachineError</a></tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L345"></a><tt class="py-lineno">345</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">unlocked</tt><tt class="py-op">:</tt> </tt>
<a name="L346"></a><tt class="py-lineno">346</tt>  <tt class="py-line">                <tt id="link-393" class="py-name"><a title="lib.cuckoo.core.scheduler.machine_lock" class="py-name" href="#" onclick="return doclink('link-393', 'machine_lock', 'link-76');">machine_lock</a></tt><tt class="py-op">.</tt><tt id="link-394" class="py-name"><a title="lib.cuckoo.common.abstracts.Machinery.release" class="py-name" href="#" onclick="return doclink('link-394', 'release', 'link-142');">release</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L347"></a><tt class="py-lineno">347</tt>  <tt class="py-line">            <tt id="link-395" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-395', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">error</tt><tt class="py-op">(</tt><tt class="py-name">str</tt><tt class="py-op">(</tt><tt class="py-name">e</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">extra</tt><tt class="py-op">=</tt><tt class="py-op">{</tt><tt class="py-string">"task_id"</tt><tt class="py-op">:</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-396" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-396', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-397" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-397', 'id', 'link-95');">id</a></tt><tt class="py-op">}</tt><tt class="py-op">)</tt> </tt>
<a name="L348"></a><tt class="py-lineno">348</tt>  <tt class="py-line">            <tt id="link-398" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-398', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">critical</tt><tt class="py-op">(</tt> </tt>
<a name="L349"></a><tt class="py-lineno">349</tt>  <tt class="py-line">                <tt class="py-string">"A critical error has occurred trying to use the machine "</tt> </tt>
<a name="L350"></a><tt class="py-lineno">350</tt>  <tt class="py-line">                <tt class="py-string">"with name %s during an analysis due to which it is no "</tt> </tt>
<a name="L351"></a><tt class="py-lineno">351</tt>  <tt class="py-line">                <tt class="py-string">"longer in a working state, please report this issue and all "</tt> </tt>
<a name="L352"></a><tt class="py-lineno">352</tt>  <tt class="py-line">                <tt class="py-string">"of the related environment details to the developers so we "</tt> </tt>
<a name="L353"></a><tt class="py-lineno">353</tt>  <tt class="py-line">                <tt class="py-string">"can improve this situation. (Note that before we would "</tt> </tt>
<a name="L354"></a><tt class="py-lineno">354</tt>  <tt class="py-line">                <tt class="py-string">"simply remove this VM from doing any more analyses, but as "</tt> </tt>
<a name="L355"></a><tt class="py-lineno">355</tt>  <tt class="py-line">                <tt class="py-string">"all the VMs will eventually be depleted that way, hopefully "</tt> </tt>
<a name="L356"></a><tt class="py-lineno">356</tt>  <tt class="py-line">                <tt class="py-string">"we'll find a better solution now)."</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-399" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-399', 'machine', 'link-85');">machine</a></tt><tt class="py-op">.</tt><tt id="link-400" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-400', 'name', 'link-165');">name</a></tt><tt class="py-op">,</tt> </tt>
<a name="L357"></a><tt class="py-lineno">357</tt>  <tt class="py-line">            <tt class="py-op">)</tt> </tt>
<a name="L358"></a><tt class="py-lineno">358</tt>  <tt class="py-line">        <tt class="py-keyword">except</tt> <tt id="link-401" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooGuestError" class="py-name" href="#" onclick="return doclink('link-401', 'CuckooGuestError', 'link-17');">CuckooGuestError</a></tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L359"></a><tt class="py-lineno">359</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">unlocked</tt><tt class="py-op">:</tt> </tt>
<a name="L360"></a><tt class="py-lineno">360</tt>  <tt class="py-line">                <tt id="link-402" class="py-name"><a title="lib.cuckoo.core.scheduler.machine_lock" class="py-name" href="#" onclick="return doclink('link-402', 'machine_lock', 'link-76');">machine_lock</a></tt><tt class="py-op">.</tt><tt id="link-403" class="py-name"><a title="lib.cuckoo.common.abstracts.Machinery.release" class="py-name" href="#" onclick="return doclink('link-403', 'release', 'link-142');">release</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L361"></a><tt class="py-lineno">361</tt>  <tt class="py-line">            <tt id="link-404" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-404', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">error</tt><tt class="py-op">(</tt><tt class="py-name">str</tt><tt class="py-op">(</tt><tt class="py-name">e</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt class="py-name">extra</tt><tt class="py-op">=</tt><tt class="py-op">{</tt><tt class="py-string">"task_id"</tt><tt class="py-op">:</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-405" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-405', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-406" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-406', 'id', 'link-95');">id</a></tt><tt class="py-op">}</tt><tt class="py-op">)</tt> </tt>
<a name="L362"></a><tt class="py-lineno">362</tt>  <tt class="py-line">        <tt class="py-keyword">finally</tt><tt class="py-op">:</tt> </tt>
<a name="L363"></a><tt class="py-lineno">363</tt>  <tt class="py-line">            <tt class="py-comment"># Stop Auxiliary modules.</tt> </tt>
<a name="L364"></a><tt class="py-lineno">364</tt>  <tt class="py-line">            <tt class="py-name">aux</tt><tt class="py-op">.</tt><tt id="link-407" class="py-name" targets="Method lib.cuckoo.common.abstracts.Auxiliary.stop()=lib.cuckoo.common.abstracts.Auxiliary-class.html#stop,Method lib.cuckoo.common.abstracts.LibVirtMachinery.stop()=lib.cuckoo.common.abstracts.LibVirtMachinery-class.html#stop,Method lib.cuckoo.common.abstracts.Machinery.stop()=lib.cuckoo.common.abstracts.Machinery-class.html#stop,Method lib.cuckoo.core.plugins.RunAuxiliary.stop()=lib.cuckoo.core.plugins.RunAuxiliary-class.html#stop,Method lib.cuckoo.core.scheduler.Scheduler.stop()=lib.cuckoo.core.scheduler.Scheduler-class.html#stop,Method modules.auxiliary.mitm.MITM.stop()=modules.auxiliary.mitm.MITM-class.html#stop,Method modules.auxiliary.services.Services.stop()=modules.auxiliary.services.Services-class.html#stop,Method modules.auxiliary.sniffer.Sniffer.stop()=modules.auxiliary.sniffer.Sniffer-class.html#stop,Method modules.machinery.avd.Avd.stop()=modules.machinery.avd.Avd-class.html#stop,Method modules.machinery.physical.Physical.stop()=modules.machinery.physical.Physical-class.html#stop,Method modules.machinery.qemu.QEMU.stop()=modules.machinery.qemu.QEMU-class.html#stop,Method modules.machinery.virtualbox.VirtualBox.stop()=modules.machinery.virtualbox.VirtualBox-class.html#stop,Method modules.machinery.vmware.VMware.stop()=modules.machinery.vmware.VMware-class.html#stop,Method modules.machinery.vsphere.vSphere.stop()=modules.machinery.vsphere.vSphere-class.html#stop,Method modules.machinery.xenserver.XenServerMachinery.stop()=modules.machinery.xenserver.XenServerMachinery-class.html#stop,Method modules.signatures.generic_metrics.SystemMetrics.stop()=modules.signatures.generic_metrics.SystemMetrics-class.html#stop"><a title="lib.cuckoo.common.abstracts.Auxiliary.stop
lib.cuckoo.common.abstracts.LibVirtMachinery.stop
lib.cuckoo.common.abstracts.Machinery.stop
lib.cuckoo.core.plugins.RunAuxiliary.stop
lib.cuckoo.core.scheduler.Scheduler.stop
modules.auxiliary.mitm.MITM.stop
modules.auxiliary.services.Services.stop
modules.auxiliary.sniffer.Sniffer.stop
modules.machinery.avd.Avd.stop
modules.machinery.physical.Physical.stop
modules.machinery.qemu.QEMU.stop
modules.machinery.virtualbox.VirtualBox.stop
modules.machinery.vmware.VMware.stop
modules.machinery.vsphere.vSphere.stop
modules.machinery.xenserver.XenServerMachinery.stop
modules.signatures.generic_metrics.SystemMetrics.stop" class="py-name" href="#" onclick="return doclink('link-407', 'stop', 'link-407');">stop</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L365"></a><tt class="py-lineno">365</tt>  <tt class="py-line"> </tt>
<a name="L366"></a><tt class="py-lineno">366</tt>  <tt class="py-line">            <tt class="py-comment"># Take a memory dump of the machine before shutting it off.</tt> </tt>
<a name="L367"></a><tt class="py-lineno">367</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-408" class="py-name"><a title="lib.cuckoo.core.rooter.cfg
modules.auxiliary.services.cfg
modules.processing.network.cfg" class="py-name" href="#" onclick="return doclink('link-408', 'cfg', 'link-83');">cfg</a></tt><tt class="py-op">.</tt><tt id="link-409" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-409', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt class="py-name">memory_dump</tt> <tt class="py-keyword">or</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-410" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-410', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-411" class="py-name" targets="Variable lib.cuckoo.core.database.Task.memory=lib.cuckoo.core.database.Task-class.html#memory,Method modules.processing.baseline.Baseline.memory()=modules.processing.baseline.Baseline-class.html#memory,Module modules.processing.memory=modules.processing.memory-module.html"><a title="lib.cuckoo.core.database.Task.memory
modules.processing.baseline.Baseline.memory
modules.processing.memory" class="py-name" href="#" onclick="return doclink('link-411', 'memory', 'link-411');">memory</a></tt><tt class="py-op">:</tt> </tt>
<a name="L368"></a><tt class="py-lineno">368</tt>  <tt class="py-line">                <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L369"></a><tt class="py-lineno">369</tt>  <tt class="py-line">                    <tt class="py-name">dump_path</tt> <tt class="py-op">=</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">storage</tt><tt class="py-op">,</tt> <tt class="py-string">"memory.dmp"</tt><tt class="py-op">)</tt> </tt>
<a name="L370"></a><tt class="py-lineno">370</tt>  <tt class="py-line">                    <tt id="link-412" class="py-name"><a title="lib.cuckoo.core.scheduler.machinery
modules.machinery" class="py-name" href="#" onclick="return doclink('link-412', 'machinery', 'link-75');">machinery</a></tt><tt class="py-op">.</tt><tt id="link-413" class="py-name" targets="Method lib.cuckoo.common.abstracts.LibVirtMachinery.dump_memory()=lib.cuckoo.common.abstracts.LibVirtMachinery-class.html#dump_memory,Method lib.cuckoo.common.abstracts.Machinery.dump_memory()=lib.cuckoo.common.abstracts.Machinery-class.html#dump_memory,Method modules.machinery.virtualbox.VirtualBox.dump_memory()=modules.machinery.virtualbox.VirtualBox-class.html#dump_memory,Method modules.machinery.vmware.VMware.dump_memory()=modules.machinery.vmware.VMware-class.html#dump_memory,Method modules.machinery.vsphere.vSphere.dump_memory()=modules.machinery.vsphere.vSphere-class.html#dump_memory"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery.dump_memory
lib.cuckoo.common.abstracts.Machinery.dump_memory
modules.machinery.virtualbox.VirtualBox.dump_memory
modules.machinery.vmware.VMware.dump_memory
modules.machinery.vsphere.vSphere.dump_memory" class="py-name" href="#" onclick="return doclink('link-413', 'dump_memory', 'link-413');">dump_memory</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-414" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-414', 'machine', 'link-85');">machine</a></tt><tt class="py-op">.</tt><tt id="link-415" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-415', 'label', 'link-167');">label</a></tt><tt class="py-op">,</tt> <tt class="py-name">dump_path</tt><tt class="py-op">)</tt> </tt>
<a name="L371"></a><tt class="py-lineno">371</tt>  <tt class="py-line">                <tt class="py-keyword">except</tt> <tt class="py-name">NotImplementedError</tt><tt class="py-op">:</tt> </tt>
<a name="L372"></a><tt class="py-lineno">372</tt>  <tt class="py-line">                    <tt id="link-416" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-416', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">error</tt><tt class="py-op">(</tt><tt class="py-string">"The memory dump functionality is not available "</tt> </tt>
<a name="L373"></a><tt class="py-lineno">373</tt>  <tt class="py-line">                              <tt class="py-string">"for the current machine manager."</tt><tt class="py-op">)</tt> </tt>
<a name="L374"></a><tt class="py-lineno">374</tt>  <tt class="py-line">                <tt class="py-keyword">except</tt> <tt id="link-417" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-417', 'CuckooMachineError', 'link-16');">CuckooMachineError</a></tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L375"></a><tt class="py-lineno">375</tt>  <tt class="py-line">                    <tt id="link-418" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-418', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">error</tt><tt class="py-op">(</tt><tt class="py-name">e</tt><tt class="py-op">)</tt> </tt>
<a name="L376"></a><tt class="py-lineno">376</tt>  <tt class="py-line"> </tt>
<a name="L377"></a><tt class="py-lineno">377</tt>  <tt class="py-line">            <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L378"></a><tt class="py-lineno">378</tt>  <tt class="py-line">                <tt class="py-comment"># Stop the analysis machine.</tt> </tt>
<a name="L379"></a><tt class="py-lineno">379</tt>  <tt class="py-line">                <tt id="link-419" class="py-name"><a title="lib.cuckoo.core.scheduler.machinery
modules.machinery" class="py-name" href="#" onclick="return doclink('link-419', 'machinery', 'link-75');">machinery</a></tt><tt class="py-op">.</tt><tt id="link-420" class="py-name"><a title="lib.cuckoo.common.abstracts.Auxiliary.stop
lib.cuckoo.common.abstracts.LibVirtMachinery.stop
lib.cuckoo.common.abstracts.Machinery.stop
lib.cuckoo.core.plugins.RunAuxiliary.stop
lib.cuckoo.core.scheduler.Scheduler.stop
modules.auxiliary.mitm.MITM.stop
modules.auxiliary.services.Services.stop
modules.auxiliary.sniffer.Sniffer.stop
modules.machinery.avd.Avd.stop
modules.machinery.physical.Physical.stop
modules.machinery.qemu.QEMU.stop
modules.machinery.virtualbox.VirtualBox.stop
modules.machinery.vmware.VMware.stop
modules.machinery.vsphere.vSphere.stop
modules.machinery.xenserver.XenServerMachinery.stop
modules.signatures.generic_metrics.SystemMetrics.stop" class="py-name" href="#" onclick="return doclink('link-420', 'stop', 'link-407');">stop</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-421" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-421', 'machine', 'link-85');">machine</a></tt><tt class="py-op">.</tt><tt id="link-422" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-422', 'label', 'link-167');">label</a></tt><tt class="py-op">)</tt> </tt>
<a name="L380"></a><tt class="py-lineno">380</tt>  <tt class="py-line">            <tt class="py-keyword">except</tt> <tt id="link-423" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-423', 'CuckooMachineError', 'link-16');">CuckooMachineError</a></tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L381"></a><tt class="py-lineno">381</tt>  <tt class="py-line">                <tt id="link-424" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-424', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">warning</tt><tt class="py-op">(</tt><tt class="py-string">"Unable to stop machine %s: %s"</tt><tt class="py-op">,</tt> </tt>
<a name="L382"></a><tt class="py-lineno">382</tt>  <tt class="py-line">                            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-425" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-425', 'machine', 'link-85');">machine</a></tt><tt class="py-op">.</tt><tt id="link-426" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-426', 'label', 'link-167');">label</a></tt><tt class="py-op">,</tt> <tt class="py-name">e</tt><tt class="py-op">)</tt> </tt>
<a name="L383"></a><tt class="py-lineno">383</tt>  <tt class="py-line"> </tt>
<a name="L384"></a><tt class="py-lineno">384</tt>  <tt class="py-line">            <tt class="py-comment"># Mark the machine in the database as stopped. Unless this machine</tt> </tt>
<a name="L385"></a><tt class="py-lineno">385</tt>  <tt class="py-line">            <tt class="py-comment"># has been marked as dead, we just keep it as "started" in the</tt> </tt>
<a name="L386"></a><tt class="py-lineno">386</tt>  <tt class="py-line">            <tt class="py-comment"># database so it'll not be used later on in this session.</tt> </tt>
<a name="L387"></a><tt class="py-lineno">387</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-427" class="py-name"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-427', 'db', 'link-86');">db</a></tt><tt class="py-op">.</tt><tt id="link-428" class="py-name" targets="Method lib.cuckoo.core.database.Database.guest_stop()=lib.cuckoo.core.database.Database-class.html#guest_stop"><a title="lib.cuckoo.core.database.Database.guest_stop" class="py-name" href="#" onclick="return doclink('link-428', 'guest_stop', 'link-428');">guest_stop</a></tt><tt class="py-op">(</tt><tt class="py-name">guest_log</tt><tt class="py-op">)</tt> </tt>
<a name="L388"></a><tt class="py-lineno">388</tt>  <tt class="py-line"> </tt>
<a name="L389"></a><tt class="py-lineno">389</tt>  <tt class="py-line">            <tt class="py-comment"># After all this, we can make the ResultServer forget about the</tt> </tt>
<a name="L390"></a><tt class="py-lineno">390</tt>  <tt class="py-line">            <tt class="py-comment"># internal state for this analysis task.</tt> </tt>
<a name="L391"></a><tt class="py-lineno">391</tt>  <tt class="py-line">            <tt id="link-429" class="py-name"><a title="lib.cuckoo.core.resultserver.ResultServer" class="py-name" href="#" onclick="return doclink('link-429', 'ResultServer', 'link-67');">ResultServer</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">.</tt><tt id="link-430" class="py-name" targets="Method lib.cuckoo.core.resultserver.ResultServer.del_task()=lib.cuckoo.core.resultserver.ResultServer-class.html#del_task"><a title="lib.cuckoo.core.resultserver.ResultServer.del_task" class="py-name" href="#" onclick="return doclink('link-430', 'del_task', 'link-430');">del_task</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-431" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-431', 'task', 'link-80');">task</a></tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-432" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-432', 'machine', 'link-85');">machine</a></tt><tt class="py-op">)</tt> </tt>
<a name="L392"></a><tt class="py-lineno">392</tt>  <tt class="py-line"> </tt>
<a name="L393"></a><tt class="py-lineno">393</tt>  <tt class="py-line">            <tt class="py-comment"># Drop the network routing rules if any.</tt> </tt>
<a name="L394"></a><tt class="py-lineno">394</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-433" class="py-name" targets="Method lib.cuckoo.core.scheduler.AnalysisManager.unroute_network()=lib.cuckoo.core.scheduler.AnalysisManager-class.html#unroute_network"><a title="lib.cuckoo.core.scheduler.AnalysisManager.unroute_network" class="py-name" href="#" onclick="return doclink('link-433', 'unroute_network', 'link-433');">unroute_network</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L395"></a><tt class="py-lineno">395</tt>  <tt class="py-line"> </tt>
<a name="L396"></a><tt class="py-lineno">396</tt>  <tt class="py-line">            <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L397"></a><tt class="py-lineno">397</tt>  <tt class="py-line">                <tt class="py-comment"># Release the analysis machine. But only if the machine has</tt> </tt>
<a name="L398"></a><tt class="py-lineno">398</tt>  <tt class="py-line">                <tt class="py-comment"># not turned dead yet.</tt> </tt>
<a name="L399"></a><tt class="py-lineno">399</tt>  <tt class="py-line">                <tt id="link-434" class="py-name"><a title="lib.cuckoo.core.scheduler.machinery
modules.machinery" class="py-name" href="#" onclick="return doclink('link-434', 'machinery', 'link-75');">machinery</a></tt><tt class="py-op">.</tt><tt id="link-435" class="py-name"><a title="lib.cuckoo.common.abstracts.Machinery.release" class="py-name" href="#" onclick="return doclink('link-435', 'release', 'link-142');">release</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-436" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-436', 'machine', 'link-85');">machine</a></tt><tt class="py-op">.</tt><tt id="link-437" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-437', 'label', 'link-167');">label</a></tt><tt class="py-op">)</tt> </tt>
<a name="L400"></a><tt class="py-lineno">400</tt>  <tt class="py-line">            <tt class="py-keyword">except</tt> <tt id="link-438" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-438', 'CuckooMachineError', 'link-16');">CuckooMachineError</a></tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L401"></a><tt class="py-lineno">401</tt>  <tt class="py-line">                <tt id="link-439" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-439', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">error</tt><tt class="py-op">(</tt><tt class="py-string">"Unable to release machine %s, reason %s. "</tt> </tt>
<a name="L402"></a><tt class="py-lineno">402</tt>  <tt class="py-line">                          <tt class="py-string">"You might need to restore it manually."</tt><tt class="py-op">,</tt> </tt>
<a name="L403"></a><tt class="py-lineno">403</tt>  <tt class="py-line">                          <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-440" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-440', 'machine', 'link-85');">machine</a></tt><tt class="py-op">.</tt><tt id="link-441" class="py-name"><a title="lib.cuckoo.core.database.Guest.label
lib.cuckoo.core.database.Machine.label" class="py-name" href="#" onclick="return doclink('link-441', 'label', 'link-167');">label</a></tt><tt class="py-op">,</tt> <tt class="py-name">e</tt><tt class="py-op">)</tt> </tt>
<a name="L404"></a><tt class="py-lineno">404</tt>  <tt class="py-line"> </tt>
<a name="L405"></a><tt class="py-lineno">405</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">succeeded</tt> </tt>
</div><a name="L406"></a><tt class="py-lineno">406</tt>  <tt class="py-line"> </tt>
<a name="AnalysisManager.process_results"></a><div id="AnalysisManager.process_results-def"><a name="L407"></a><tt class="py-lineno">407</tt> <a class="py-toggle" href="#" id="AnalysisManager.process_results-toggle" onclick="return toggle('AnalysisManager.process_results');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.scheduler.AnalysisManager-class.html#process_results">process_results</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="AnalysisManager.process_results-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="AnalysisManager.process_results-expanded"><a name="L408"></a><tt class="py-lineno">408</tt>  <tt class="py-line">        <tt class="py-docstring">"""Process the analysis results and generate the enabled reports."""</tt> </tt>
<a name="L409"></a><tt class="py-lineno">409</tt>  <tt class="py-line">        <tt id="link-442" class="py-name" targets="Method lib.cuckoo.common.abstracts.Signature.results()=lib.cuckoo.common.abstracts.Signature-class.html#results"><a title="lib.cuckoo.common.abstracts.Signature.results" class="py-name" href="#" onclick="return doclink('link-442', 'results', 'link-442');">results</a></tt> <tt class="py-op">=</tt> <tt id="link-443" class="py-name"><a title="lib.cuckoo.core.plugins.RunProcessing" class="py-name" href="#" onclick="return doclink('link-443', 'RunProcessing', 'link-56');">RunProcessing</a></tt><tt class="py-op">(</tt><tt id="link-444" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-444', 'task', 'link-80');">task</a></tt><tt class="py-op">=</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-445" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-445', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-446" class="py-name" targets="Method lib.cuckoo.core.database.Error.to_dict()=lib.cuckoo.core.database.Error-class.html#to_dict,Method lib.cuckoo.core.database.Guest.to_dict()=lib.cuckoo.core.database.Guest-class.html#to_dict,Method lib.cuckoo.core.database.Machine.to_dict()=lib.cuckoo.core.database.Machine-class.html#to_dict,Method lib.cuckoo.core.database.Sample.to_dict()=lib.cuckoo.core.database.Sample-class.html#to_dict,Method lib.cuckoo.core.database.Task.to_dict()=lib.cuckoo.core.database.Task-class.html#to_dict"><a title="lib.cuckoo.core.database.Error.to_dict
lib.cuckoo.core.database.Guest.to_dict
lib.cuckoo.core.database.Machine.to_dict
lib.cuckoo.core.database.Sample.to_dict
lib.cuckoo.core.database.Task.to_dict" class="py-name" href="#" onclick="return doclink('link-446', 'to_dict', 'link-446');">to_dict</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">.</tt><tt id="link-447" class="py-name" targets="Method lib.cuckoo.common.abstracts.BehaviorHandler.run()=lib.cuckoo.common.abstracts.BehaviorHandler-class.html#run,Method lib.cuckoo.common.abstracts.Processing.run()=lib.cuckoo.common.abstracts.Processing-class.html#run,Method lib.cuckoo.common.abstracts.Report.run()=lib.cuckoo.common.abstracts.Report-class.html#run,Method lib.cuckoo.core.plugins.RunProcessing.run()=lib.cuckoo.core.plugins.RunProcessing-class.html#run,Method lib.cuckoo.core.plugins.RunReporting.run()=lib.cuckoo.core.plugins.RunReporting-class.html#run,Method lib.cuckoo.core.plugins.RunSignatures.run()=lib.cuckoo.core.plugins.RunSignatures-class.html#run,Method lib.cuckoo.core.scheduler.AnalysisManager.run()=lib.cuckoo.core.scheduler.AnalysisManager-class.html#run,Method modules.processing.analysisinfo.AnalysisInfo.run()=modules.processing.analysisinfo.AnalysisInfo-class.html#run,Method modules.processing.apkinfo.ApkInfo.run()=modules.processing.apkinfo.ApkInfo-class.html#run,Method modules.processing.baseline.Baseline.run()=modules.processing.baseline.Baseline-class.html#run,Method modules.processing.behavior.Anomaly.run()=modules.processing.behavior.Anomaly-class.html#run,Method modules.processing.behavior.ApiStats.run()=modules.processing.behavior.ApiStats-class.html#run,Method modules.processing.behavior.BehaviorAnalysis.run()=modules.processing.behavior.BehaviorAnalysis-class.html#run,Method modules.processing.behavior.GenericBehavior.run()=modules.processing.behavior.GenericBehavior-class.html#run,Method modules.processing.behavior.ProcessTree.run()=modules.processing.behavior.ProcessTree-class.html#run,Method modules.processing.behavior.Summary.run()=modules.processing.behavior.Summary-class.html#run,Method modules.processing.buffer.DroppedBuffer.run()=modules.processing.buffer.DroppedBuffer-class.html#run,Method modules.processing.debug.Debug.run()=modules.processing.debug.Debug-class.html#run,Method modules.processing.droidmon.Droidmon.run()=modules.processing.droidmon.Droidmon-class.html#run,Method modules.processing.dropped.Dropped.run()=modules.processing.dropped.Dropped-class.html#run,Method modules.processing.dumptls.TLSMasterSecrets.run()=modules.processing.dumptls.TLSMasterSecrets-class.html#run,Method modules.processing.googleplay.GooglePlay.run()=modules.processing.googleplay.GooglePlay-class.html#run,Method modules.processing.memory.Memory.run()=modules.processing.memory.Memory-class.html#run,Method modules.processing.memory.VolatilityManager.run()=modules.processing.memory.VolatilityManager-class.html#run,Method modules.processing.network.NetworkAnalysis.run()=modules.processing.network.NetworkAnalysis-class.html#run,Method modules.processing.network.Pcap.run()=modules.processing.network.Pcap-class.html#run,Method modules.processing.network.Pcap2.run()=modules.processing.network.Pcap2-class.html#run,Method modules.processing.platform.linux.LinuxSystemTap.run()=modules.processing.platform.linux.LinuxSystemTap-class.html#run,Method modules.processing.platform.windows.WindowsMonitor.run()=modules.processing.platform.windows.WindowsMonitor-class.html#run,Method modules.processing.procmemory.ProcessMemory.run()=modules.processing.procmemory.ProcessMemory-class.html#run,Method modules.processing.screenshots.Screenshots.run()=modules.processing.screenshots.Screenshots-class.html#run,Method modules.processing.snort.Snort.run()=modules.processing.snort.Snort-class.html#run,Method modules.processing.static.PortableExecutable.run()=modules.processing.static.PortableExecutable-class.html#run,Method modules.processing.static.Static.run()=modules.processing.static.Static-class.html#run,Method modules.processing.strings.Strings.run()=modules.processing.strings.Strings-class.html#run,Method modules.processing.suricata.Suricata.run()=modules.processing.suricata.Suricata-class.html#run,Method modules.processing.targetinfo.TargetInfo.run()=modules.processing.targetinfo.TargetInfo-class.html#run,Method modules.processing.virustotal.VirusTotal.run()=modules.processing.virustotal.VirusTotal-class.html#run,Method modules.reporting.jsondump.JsonDump.run()=modules.reporting.jsondump.JsonDump-class.html#run,Method modules.reporting.moloch.Moloch.run()=modules.reporting.moloch.Moloch-class.html#run,Method modules.reporting.mongodb.MongoDB.run()=modules.reporting.mongodb.MongoDB-class.html#run,Method modules.reporting.reporthtml.ReportHTML.run()=modules.reporting.reporthtml.ReportHTML-class.html#run"><a title="lib.cuckoo.common.abstracts.BehaviorHandler.run
lib.cuckoo.common.abstracts.Processing.run
lib.cuckoo.common.abstracts.Report.run
lib.cuckoo.core.plugins.RunProcessing.run
lib.cuckoo.core.plugins.RunReporting.run
lib.cuckoo.core.plugins.RunSignatures.run
lib.cuckoo.core.scheduler.AnalysisManager.run
modules.processing.analysisinfo.AnalysisInfo.run
modules.processing.apkinfo.ApkInfo.run
modules.processing.baseline.Baseline.run
modules.processing.behavior.Anomaly.run
modules.processing.behavior.ApiStats.run
modules.processing.behavior.BehaviorAnalysis.run
modules.processing.behavior.GenericBehavior.run
modules.processing.behavior.ProcessTree.run
modules.processing.behavior.Summary.run
modules.processing.buffer.DroppedBuffer.run
modules.processing.debug.Debug.run
modules.processing.droidmon.Droidmon.run
modules.processing.dropped.Dropped.run
modules.processing.dumptls.TLSMasterSecrets.run
modules.processing.googleplay.GooglePlay.run
modules.processing.memory.Memory.run
modules.processing.memory.VolatilityManager.run
modules.processing.network.NetworkAnalysis.run
modules.processing.network.Pcap.run
modules.processing.network.Pcap2.run
modules.processing.platform.linux.LinuxSystemTap.run
modules.processing.platform.windows.WindowsMonitor.run
modules.processing.procmemory.ProcessMemory.run
modules.processing.screenshots.Screenshots.run
modules.processing.snort.Snort.run
modules.processing.static.PortableExecutable.run
modules.processing.static.Static.run
modules.processing.strings.Strings.run
modules.processing.suricata.Suricata.run
modules.processing.targetinfo.TargetInfo.run
modules.processing.virustotal.VirusTotal.run
modules.reporting.jsondump.JsonDump.run
modules.reporting.moloch.Moloch.run
modules.reporting.mongodb.MongoDB.run
modules.reporting.reporthtml.ReportHTML.run" class="py-name" href="#" onclick="return doclink('link-447', 'run', 'link-447');">run</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L410"></a><tt class="py-lineno">410</tt>  <tt class="py-line">        <tt id="link-448" class="py-name"><a title="lib.cuckoo.core.plugins.RunSignatures" class="py-name" href="#" onclick="return doclink('link-448', 'RunSignatures', 'link-61');">RunSignatures</a></tt><tt class="py-op">(</tt><tt id="link-449" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.results" class="py-name" href="#" onclick="return doclink('link-449', 'results', 'link-442');">results</a></tt><tt class="py-op">=</tt><tt id="link-450" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.results" class="py-name" href="#" onclick="return doclink('link-450', 'results', 'link-442');">results</a></tt><tt class="py-op">)</tt><tt class="py-op">.</tt><tt id="link-451" class="py-name"><a title="lib.cuckoo.common.abstracts.BehaviorHandler.run
lib.cuckoo.common.abstracts.Processing.run
lib.cuckoo.common.abstracts.Report.run
lib.cuckoo.core.plugins.RunProcessing.run
lib.cuckoo.core.plugins.RunReporting.run
lib.cuckoo.core.plugins.RunSignatures.run
lib.cuckoo.core.scheduler.AnalysisManager.run
modules.processing.analysisinfo.AnalysisInfo.run
modules.processing.apkinfo.ApkInfo.run
modules.processing.baseline.Baseline.run
modules.processing.behavior.Anomaly.run
modules.processing.behavior.ApiStats.run
modules.processing.behavior.BehaviorAnalysis.run
modules.processing.behavior.GenericBehavior.run
modules.processing.behavior.ProcessTree.run
modules.processing.behavior.Summary.run
modules.processing.buffer.DroppedBuffer.run
modules.processing.debug.Debug.run
modules.processing.droidmon.Droidmon.run
modules.processing.dropped.Dropped.run
modules.processing.dumptls.TLSMasterSecrets.run
modules.processing.googleplay.GooglePlay.run
modules.processing.memory.Memory.run
modules.processing.memory.VolatilityManager.run
modules.processing.network.NetworkAnalysis.run
modules.processing.network.Pcap.run
modules.processing.network.Pcap2.run
modules.processing.platform.linux.LinuxSystemTap.run
modules.processing.platform.windows.WindowsMonitor.run
modules.processing.procmemory.ProcessMemory.run
modules.processing.screenshots.Screenshots.run
modules.processing.snort.Snort.run
modules.processing.static.PortableExecutable.run
modules.processing.static.Static.run
modules.processing.strings.Strings.run
modules.processing.suricata.Suricata.run
modules.processing.targetinfo.TargetInfo.run
modules.processing.virustotal.VirusTotal.run
modules.reporting.jsondump.JsonDump.run
modules.reporting.moloch.Moloch.run
modules.reporting.mongodb.MongoDB.run
modules.reporting.reporthtml.ReportHTML.run" class="py-name" href="#" onclick="return doclink('link-451', 'run', 'link-447');">run</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L411"></a><tt class="py-lineno">411</tt>  <tt class="py-line">        <tt id="link-452" class="py-name"><a title="lib.cuckoo.core.plugins.RunReporting" class="py-name" href="#" onclick="return doclink('link-452', 'RunReporting', 'link-62');">RunReporting</a></tt><tt class="py-op">(</tt><tt id="link-453" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-453', 'task', 'link-80');">task</a></tt><tt class="py-op">=</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-454" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-454', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-455" class="py-name"><a title="lib.cuckoo.core.database.Error.to_dict
lib.cuckoo.core.database.Guest.to_dict
lib.cuckoo.core.database.Machine.to_dict
lib.cuckoo.core.database.Sample.to_dict
lib.cuckoo.core.database.Task.to_dict" class="py-name" href="#" onclick="return doclink('link-455', 'to_dict', 'link-446');">to_dict</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">,</tt> <tt id="link-456" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.results" class="py-name" href="#" onclick="return doclink('link-456', 'results', 'link-442');">results</a></tt><tt class="py-op">=</tt><tt id="link-457" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.results" class="py-name" href="#" onclick="return doclink('link-457', 'results', 'link-442');">results</a></tt><tt class="py-op">)</tt><tt class="py-op">.</tt><tt id="link-458" class="py-name"><a title="lib.cuckoo.common.abstracts.BehaviorHandler.run
lib.cuckoo.common.abstracts.Processing.run
lib.cuckoo.common.abstracts.Report.run
lib.cuckoo.core.plugins.RunProcessing.run
lib.cuckoo.core.plugins.RunReporting.run
lib.cuckoo.core.plugins.RunSignatures.run
lib.cuckoo.core.scheduler.AnalysisManager.run
modules.processing.analysisinfo.AnalysisInfo.run
modules.processing.apkinfo.ApkInfo.run
modules.processing.baseline.Baseline.run
modules.processing.behavior.Anomaly.run
modules.processing.behavior.ApiStats.run
modules.processing.behavior.BehaviorAnalysis.run
modules.processing.behavior.GenericBehavior.run
modules.processing.behavior.ProcessTree.run
modules.processing.behavior.Summary.run
modules.processing.buffer.DroppedBuffer.run
modules.processing.debug.Debug.run
modules.processing.droidmon.Droidmon.run
modules.processing.dropped.Dropped.run
modules.processing.dumptls.TLSMasterSecrets.run
modules.processing.googleplay.GooglePlay.run
modules.processing.memory.Memory.run
modules.processing.memory.VolatilityManager.run
modules.processing.network.NetworkAnalysis.run
modules.processing.network.Pcap.run
modules.processing.network.Pcap2.run
modules.processing.platform.linux.LinuxSystemTap.run
modules.processing.platform.windows.WindowsMonitor.run
modules.processing.procmemory.ProcessMemory.run
modules.processing.screenshots.Screenshots.run
modules.processing.snort.Snort.run
modules.processing.static.PortableExecutable.run
modules.processing.static.Static.run
modules.processing.strings.Strings.run
modules.processing.suricata.Suricata.run
modules.processing.targetinfo.TargetInfo.run
modules.processing.virustotal.VirusTotal.run
modules.reporting.jsondump.JsonDump.run
modules.reporting.moloch.Moloch.run
modules.reporting.mongodb.MongoDB.run
modules.reporting.reporthtml.ReportHTML.run" class="py-name" href="#" onclick="return doclink('link-458', 'run', 'link-447');">run</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L412"></a><tt class="py-lineno">412</tt>  <tt class="py-line"> </tt>
<a name="L413"></a><tt class="py-lineno">413</tt>  <tt class="py-line">        <tt class="py-comment"># If the target is a file and the user enabled the option,</tt> </tt>
<a name="L414"></a><tt class="py-lineno">414</tt>  <tt class="py-line">        <tt class="py-comment"># delete the original copy.</tt> </tt>
<a name="L415"></a><tt class="py-lineno">415</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-459" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-459', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-460" class="py-name"><a title="lib.cuckoo.core.database.Task.category" class="py-name" href="#" onclick="return doclink('link-460', 'category', 'link-172');">category</a></tt> <tt class="py-op">==</tt> <tt class="py-string">"file"</tt> <tt class="py-keyword">and</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-461" class="py-name"><a title="lib.cuckoo.core.rooter.cfg
modules.auxiliary.services.cfg
modules.processing.network.cfg" class="py-name" href="#" onclick="return doclink('link-461', 'cfg', 'link-83');">cfg</a></tt><tt class="py-op">.</tt><tt id="link-462" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-462', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt class="py-name">delete_original</tt><tt class="py-op">:</tt> </tt>
<a name="L416"></a><tt class="py-lineno">416</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">exists</tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-463" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-463', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-464" class="py-name"><a title="lib.cuckoo.core.database.Task.target" class="py-name" href="#" onclick="return doclink('link-464', 'target', 'link-108');">target</a></tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L417"></a><tt class="py-lineno">417</tt>  <tt class="py-line">                <tt id="link-465" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-465', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">warning</tt><tt class="py-op">(</tt><tt class="py-string">"Original file does not exist anymore: \"%s\": "</tt> </tt>
<a name="L418"></a><tt class="py-lineno">418</tt>  <tt class="py-line">                            <tt class="py-string">"File not found."</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-466" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-466', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-467" class="py-name"><a title="lib.cuckoo.core.database.Task.target" class="py-name" href="#" onclick="return doclink('link-467', 'target', 'link-108');">target</a></tt><tt class="py-op">)</tt> </tt>
<a name="L419"></a><tt class="py-lineno">419</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L420"></a><tt class="py-lineno">420</tt>  <tt class="py-line">                <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L421"></a><tt class="py-lineno">421</tt>  <tt class="py-line">                    <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">remove</tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-468" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-468', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-469" class="py-name"><a title="lib.cuckoo.core.database.Task.target" class="py-name" href="#" onclick="return doclink('link-469', 'target', 'link-108');">target</a></tt><tt class="py-op">)</tt> </tt>
<a name="L422"></a><tt class="py-lineno">422</tt>  <tt class="py-line">                <tt class="py-keyword">except</tt> <tt class="py-name">OSError</tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L423"></a><tt class="py-lineno">423</tt>  <tt class="py-line">                    <tt id="link-470" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-470', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">error</tt><tt class="py-op">(</tt><tt class="py-string">"Unable to delete original file at path "</tt> </tt>
<a name="L424"></a><tt class="py-lineno">424</tt>  <tt class="py-line">                              <tt class="py-string">"\"%s\": %s"</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-471" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-471', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-472" class="py-name"><a title="lib.cuckoo.core.database.Task.target" class="py-name" href="#" onclick="return doclink('link-472', 'target', 'link-108');">target</a></tt><tt class="py-op">,</tt> <tt class="py-name">e</tt><tt class="py-op">)</tt> </tt>
<a name="L425"></a><tt class="py-lineno">425</tt>  <tt class="py-line"> </tt>
<a name="L426"></a><tt class="py-lineno">426</tt>  <tt class="py-line">        <tt class="py-comment"># If the target is a file and the user enabled the delete copy of</tt> </tt>
<a name="L427"></a><tt class="py-lineno">427</tt>  <tt class="py-line">        <tt class="py-comment"># the binary option, then delete the copy.</tt> </tt>
<a name="L428"></a><tt class="py-lineno">428</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-473" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-473', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-474" class="py-name"><a title="lib.cuckoo.core.database.Task.category" class="py-name" href="#" onclick="return doclink('link-474', 'category', 'link-172');">category</a></tt> <tt class="py-op">==</tt> <tt class="py-string">"file"</tt> <tt class="py-keyword">and</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-475" class="py-name"><a title="lib.cuckoo.core.rooter.cfg
modules.auxiliary.services.cfg
modules.processing.network.cfg" class="py-name" href="#" onclick="return doclink('link-475', 'cfg', 'link-83');">cfg</a></tt><tt class="py-op">.</tt><tt id="link-476" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-476', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt class="py-name">delete_bin_copy</tt><tt class="py-op">:</tt> </tt>
<a name="L429"></a><tt class="py-lineno">429</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">exists</tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">binary</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L430"></a><tt class="py-lineno">430</tt>  <tt class="py-line">                <tt id="link-477" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-477', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">warning</tt><tt class="py-op">(</tt><tt class="py-string">"Copy of the original file does not exist anymore: \"%s\": File not found"</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">binary</tt><tt class="py-op">)</tt> </tt>
<a name="L431"></a><tt class="py-lineno">431</tt>  <tt class="py-line">            <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L432"></a><tt class="py-lineno">432</tt>  <tt class="py-line">                <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L433"></a><tt class="py-lineno">433</tt>  <tt class="py-line">                    <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">remove</tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">binary</tt><tt class="py-op">)</tt> </tt>
<a name="L434"></a><tt class="py-lineno">434</tt>  <tt class="py-line">                <tt class="py-keyword">except</tt> <tt class="py-name">OSError</tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L435"></a><tt class="py-lineno">435</tt>  <tt class="py-line">                    <tt id="link-478" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-478', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">error</tt><tt class="py-op">(</tt><tt class="py-string">"Unable to delete the copy of the original file at path \"%s\": %s"</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">binary</tt><tt class="py-op">,</tt> <tt class="py-name">e</tt><tt class="py-op">)</tt> </tt>
<a name="L436"></a><tt class="py-lineno">436</tt>  <tt class="py-line"> </tt>
<a name="L437"></a><tt class="py-lineno">437</tt>  <tt class="py-line">        <tt id="link-479" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-479', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">"Task #%d: reports generation completed (path=%s)"</tt><tt class="py-op">,</tt> </tt>
<a name="L438"></a><tt class="py-lineno">438</tt>  <tt class="py-line">                 <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-480" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-480', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-481" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-481', 'id', 'link-95');">id</a></tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">storage</tt><tt class="py-op">)</tt> </tt>
<a name="L439"></a><tt class="py-lineno">439</tt>  <tt class="py-line"> </tt>
<a name="L440"></a><tt class="py-lineno">440</tt>  <tt class="py-line">        <tt class="py-keyword">return</tt> <tt class="py-name">True</tt> </tt>
</div><a name="L441"></a><tt class="py-lineno">441</tt>  <tt class="py-line"> </tt>
<a name="AnalysisManager.run"></a><div id="AnalysisManager.run-def"><a name="L442"></a><tt class="py-lineno">442</tt> <a class="py-toggle" href="#" id="AnalysisManager.run-toggle" onclick="return toggle('AnalysisManager.run');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.scheduler.AnalysisManager-class.html#run">run</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="AnalysisManager.run-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="AnalysisManager.run-expanded"><a name="L443"></a><tt class="py-lineno">443</tt>  <tt class="py-line">        <tt class="py-docstring">"""Run manager thread."""</tt> </tt>
<a name="L444"></a><tt class="py-lineno">444</tt>  <tt class="py-line">        <tt class="py-keyword">global</tt> <tt id="link-482" class="py-name"><a title="lib.cuckoo.core.scheduler.active_analysis_count" class="py-name" href="#" onclick="return doclink('link-482', 'active_analysis_count', 'link-78');">active_analysis_count</a></tt> </tt>
<a name="L445"></a><tt class="py-lineno">445</tt>  <tt class="py-line">        <tt id="link-483" class="py-name"><a title="lib.cuckoo.core.scheduler.active_analysis_count" class="py-name" href="#" onclick="return doclink('link-483', 'active_analysis_count', 'link-78');">active_analysis_count</a></tt> <tt class="py-op">+=</tt> <tt class="py-number">1</tt> </tt>
<a name="L446"></a><tt class="py-lineno">446</tt>  <tt class="py-line">        <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L447"></a><tt class="py-lineno">447</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-484" class="py-name" targets="Method lib.cuckoo.core.scheduler.AnalysisManager.launch_analysis()=lib.cuckoo.core.scheduler.AnalysisManager-class.html#launch_analysis"><a title="lib.cuckoo.core.scheduler.AnalysisManager.launch_analysis" class="py-name" href="#" onclick="return doclink('link-484', 'launch_analysis', 'link-484');">launch_analysis</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L448"></a><tt class="py-lineno">448</tt>  <tt class="py-line"> </tt>
<a name="L449"></a><tt class="py-lineno">449</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-485" class="py-name"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-485', 'db', 'link-86');">db</a></tt><tt class="py-op">.</tt><tt id="link-486" class="py-name" targets="Method lib.cuckoo.common.abstracts.Machinery.set_status()=lib.cuckoo.common.abstracts.Machinery-class.html#set_status,Method lib.cuckoo.core.database.Database.set_status()=lib.cuckoo.core.database.Database-class.html#set_status"><a title="lib.cuckoo.common.abstracts.Machinery.set_status
lib.cuckoo.core.database.Database.set_status" class="py-name" href="#" onclick="return doclink('link-486', 'set_status', 'link-486');">set_status</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-487" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-487', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-488" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-488', 'id', 'link-95');">id</a></tt><tt class="py-op">,</tt> <tt id="link-489" class="py-name"><a title="lib.cuckoo.core.database.TASK_COMPLETED" class="py-name" href="#" onclick="return doclink('link-489', 'TASK_COMPLETED', 'link-43');">TASK_COMPLETED</a></tt><tt class="py-op">)</tt> </tt>
<a name="L450"></a><tt class="py-lineno">450</tt>  <tt class="py-line"> </tt>
<a name="L451"></a><tt class="py-lineno">451</tt>  <tt class="py-line">            <tt class="py-comment"># If the task is still available in the database, update our task</tt> </tt>
<a name="L452"></a><tt class="py-lineno">452</tt>  <tt class="py-line">            <tt class="py-comment"># variable with what's in the database, as otherwise we're missing</tt> </tt>
<a name="L453"></a><tt class="py-lineno">453</tt>  <tt class="py-line">            <tt class="py-comment"># out on the status and completed_on change. This would then in</tt> </tt>
<a name="L454"></a><tt class="py-lineno">454</tt>  <tt class="py-line">            <tt class="py-comment"># turn thrown an exception in the analysisinfo processing module.</tt> </tt>
<a name="L455"></a><tt class="py-lineno">455</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-490" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-490', 'task', 'link-80');">task</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-491" class="py-name"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-491', 'db', 'link-86');">db</a></tt><tt class="py-op">.</tt><tt id="link-492" class="py-name" targets="Method lib.cuckoo.core.database.Database.view_task()=lib.cuckoo.core.database.Database-class.html#view_task"><a title="lib.cuckoo.core.database.Database.view_task" class="py-name" href="#" onclick="return doclink('link-492', 'view_task', 'link-492');">view_task</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-493" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-493', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-494" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-494', 'id', 'link-95');">id</a></tt><tt class="py-op">)</tt> <tt class="py-keyword">or</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-495" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-495', 'task', 'link-80');">task</a></tt> </tt>
<a name="L456"></a><tt class="py-lineno">456</tt>  <tt class="py-line"> </tt>
<a name="L457"></a><tt class="py-lineno">457</tt>  <tt class="py-line">            <tt id="link-496" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-496', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt id="link-497" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-497', 'debug', 'link-158');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"Released database task #%d"</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-498" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-498', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-499" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-499', 'id', 'link-95');">id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L458"></a><tt class="py-lineno">458</tt>  <tt class="py-line"> </tt>
<a name="L459"></a><tt class="py-lineno">459</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-500" class="py-name"><a title="lib.cuckoo.core.rooter.cfg
modules.auxiliary.services.cfg
modules.processing.network.cfg" class="py-name" href="#" onclick="return doclink('link-500', 'cfg', 'link-83');">cfg</a></tt><tt class="py-op">.</tt><tt id="link-501" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-501', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-502" class="py-name" targets="Method lib.cuckoo.core.scheduler.AnalysisManager.process_results()=lib.cuckoo.core.scheduler.AnalysisManager-class.html#process_results"><a title="lib.cuckoo.core.scheduler.AnalysisManager.process_results" class="py-name" href="#" onclick="return doclink('link-502', 'process_results', 'link-502');">process_results</a></tt><tt class="py-op">:</tt> </tt>
<a name="L460"></a><tt class="py-lineno">460</tt>  <tt class="py-line">                <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-503" class="py-name"><a title="lib.cuckoo.core.scheduler.AnalysisManager.process_results" class="py-name" href="#" onclick="return doclink('link-503', 'process_results', 'link-502');">process_results</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L461"></a><tt class="py-lineno">461</tt>  <tt class="py-line">                <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-504" class="py-name"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-504', 'db', 'link-86');">db</a></tt><tt class="py-op">.</tt><tt id="link-505" class="py-name"><a title="lib.cuckoo.common.abstracts.Machinery.set_status
lib.cuckoo.core.database.Database.set_status" class="py-name" href="#" onclick="return doclink('link-505', 'set_status', 'link-486');">set_status</a></tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-506" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-506', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-507" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-507', 'id', 'link-95');">id</a></tt><tt class="py-op">,</tt> <tt id="link-508" class="py-name"><a title="lib.cuckoo.core.database.TASK_REPORTED" class="py-name" href="#" onclick="return doclink('link-508', 'TASK_REPORTED', 'link-44');">TASK_REPORTED</a></tt><tt class="py-op">)</tt> </tt>
<a name="L462"></a><tt class="py-lineno">462</tt>  <tt class="py-line"> </tt>
<a name="L463"></a><tt class="py-lineno">463</tt>  <tt class="py-line">            <tt class="py-comment"># We make a symbolic link ("latest") which links to the latest</tt> </tt>
<a name="L464"></a><tt class="py-lineno">464</tt>  <tt class="py-line">            <tt class="py-comment"># analysis - this is useful for debugging purposes. This is only</tt> </tt>
<a name="L465"></a><tt class="py-lineno">465</tt>  <tt class="py-line">            <tt class="py-comment"># supported under systems that support symbolic links.</tt> </tt>
<a name="L466"></a><tt class="py-lineno">466</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">os</tt><tt class="py-op">,</tt> <tt class="py-string">"symlink"</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L467"></a><tt class="py-lineno">467</tt>  <tt class="py-line">                <tt class="py-name">latest</tt> <tt class="py-op">=</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt id="link-509" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_ROOT" class="py-name" href="#" onclick="return doclink('link-509', 'CUCKOO_ROOT', 'link-11');">CUCKOO_ROOT</a></tt><tt class="py-op">,</tt> <tt class="py-string">"storage"</tt><tt class="py-op">,</tt> </tt>
<a name="L468"></a><tt class="py-lineno">468</tt>  <tt class="py-line">                                      <tt class="py-string">"analyses"</tt><tt class="py-op">,</tt> <tt class="py-string">"latest"</tt><tt class="py-op">)</tt> </tt>
<a name="L469"></a><tt class="py-lineno">469</tt>  <tt class="py-line"> </tt>
<a name="L470"></a><tt class="py-lineno">470</tt>  <tt class="py-line">                <tt class="py-comment"># First we have to remove the existing symbolic link, then we</tt> </tt>
<a name="L471"></a><tt class="py-lineno">471</tt>  <tt class="py-line">                <tt class="py-comment"># have to create the new one.</tt> </tt>
<a name="L472"></a><tt class="py-lineno">472</tt>  <tt class="py-line">                <tt class="py-comment"># Deal with race conditions using a lock.</tt> </tt>
<a name="L473"></a><tt class="py-lineno">473</tt>  <tt class="py-line">                <tt id="link-510" class="py-name"><a title="lib.cuckoo.core.scheduler.latest_symlink_lock" class="py-name" href="#" onclick="return doclink('link-510', 'latest_symlink_lock', 'link-77');">latest_symlink_lock</a></tt><tt class="py-op">.</tt><tt id="link-511" class="py-name"><a title="lib.cuckoo.common.abstracts.Machinery.acquire" class="py-name" href="#" onclick="return doclink('link-511', 'acquire', 'link-138');">acquire</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L474"></a><tt class="py-lineno">474</tt>  <tt class="py-line">                <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L475"></a><tt class="py-lineno">475</tt>  <tt class="py-line">                    <tt class="py-comment"># As per documentation, lexists() returns True for dead</tt> </tt>
<a name="L476"></a><tt class="py-lineno">476</tt>  <tt class="py-line">                    <tt class="py-comment"># symbolic links.</tt> </tt>
<a name="L477"></a><tt class="py-lineno">477</tt>  <tt class="py-line">                    <tt class="py-keyword">if</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">lexists</tt><tt class="py-op">(</tt><tt class="py-name">latest</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L478"></a><tt class="py-lineno">478</tt>  <tt class="py-line">                        <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">remove</tt><tt class="py-op">(</tt><tt class="py-name">latest</tt><tt class="py-op">)</tt> </tt>
<a name="L479"></a><tt class="py-lineno">479</tt>  <tt class="py-line"> </tt>
<a name="L480"></a><tt class="py-lineno">480</tt>  <tt class="py-line">                    <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">symlink</tt><tt class="py-op">(</tt><tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">storage</tt><tt class="py-op">,</tt> <tt class="py-name">latest</tt><tt class="py-op">)</tt> </tt>
<a name="L481"></a><tt class="py-lineno">481</tt>  <tt class="py-line">                <tt class="py-keyword">except</tt> <tt class="py-name">OSError</tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L482"></a><tt class="py-lineno">482</tt>  <tt class="py-line">                    <tt id="link-512" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-512', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">warning</tt><tt class="py-op">(</tt><tt class="py-string">"Error pointing latest analysis symlink: %s"</tt> <tt class="py-op">%</tt> <tt class="py-name">e</tt><tt class="py-op">)</tt> </tt>
<a name="L483"></a><tt class="py-lineno">483</tt>  <tt class="py-line">                <tt class="py-keyword">finally</tt><tt class="py-op">:</tt> </tt>
<a name="L484"></a><tt class="py-lineno">484</tt>  <tt class="py-line">                    <tt id="link-513" class="py-name"><a title="lib.cuckoo.core.scheduler.latest_symlink_lock" class="py-name" href="#" onclick="return doclink('link-513', 'latest_symlink_lock', 'link-77');">latest_symlink_lock</a></tt><tt class="py-op">.</tt><tt id="link-514" class="py-name"><a title="lib.cuckoo.common.abstracts.Machinery.release" class="py-name" href="#" onclick="return doclink('link-514', 'release', 'link-142');">release</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L485"></a><tt class="py-lineno">485</tt>  <tt class="py-line"> </tt>
<a name="L486"></a><tt class="py-lineno">486</tt>  <tt class="py-line">            <tt id="link-515" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-515', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">"Task #%d: analysis procedure completed"</tt><tt class="py-op">,</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-516" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-516', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-517" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-517', 'id', 'link-95');">id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L487"></a><tt class="py-lineno">487</tt>  <tt class="py-line">        <tt class="py-keyword">except</tt><tt class="py-op">:</tt> </tt>
<a name="L488"></a><tt class="py-lineno">488</tt>  <tt class="py-line">            <tt id="link-518" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-518', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">exception</tt><tt class="py-op">(</tt><tt class="py-string">"Failure in AnalysisManager.run"</tt><tt class="py-op">)</tt> </tt>
<a name="L489"></a><tt class="py-lineno">489</tt>  <tt class="py-line"> </tt>
<a name="L490"></a><tt class="py-lineno">490</tt>  <tt class="py-line">        <tt id="link-519" class="py-name"><a title="lib.cuckoo.core.scheduler.active_analysis_count" class="py-name" href="#" onclick="return doclink('link-519', 'active_analysis_count', 'link-78');">active_analysis_count</a></tt> <tt class="py-op">-=</tt> <tt class="py-number">1</tt> </tt>
</div></div><a name="L491"></a><tt class="py-lineno">491</tt>  <tt class="py-line"> </tt>
<a name="Scheduler"></a><div id="Scheduler-def"><a name="L492"></a><tt class="py-lineno">492</tt> <a class="py-toggle" href="#" id="Scheduler-toggle" onclick="return toggle('Scheduler');">-</a><tt class="py-line"><tt class="py-keyword">class</tt> <a class="py-def-name" href="lib.cuckoo.core.scheduler.Scheduler-class.html">Scheduler</a><tt class="py-op">(</tt><tt class="py-base-class">object</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Scheduler-collapsed" style="display:none;" pad="+++" indent="++++"></div><div id="Scheduler-expanded"><a name="L493"></a><tt class="py-lineno">493</tt>  <tt class="py-line">    <tt class="py-docstring">"""Tasks Scheduler.</tt> </tt>
<a name="L494"></a><tt class="py-lineno">494</tt>  <tt class="py-line"><tt class="py-docstring"></tt> </tt>
<a name="L495"></a><tt class="py-lineno">495</tt>  <tt class="py-line"><tt class="py-docstring">    This class is responsible for the main execution loop of the tool. It</tt> </tt>
<a name="L496"></a><tt class="py-lineno">496</tt>  <tt class="py-line"><tt class="py-docstring">    prepares the analysis machines and keep waiting and loading for new</tt> </tt>
<a name="L497"></a><tt class="py-lineno">497</tt>  <tt class="py-line"><tt class="py-docstring">    analysis tasks.</tt> </tt>
<a name="L498"></a><tt class="py-lineno">498</tt>  <tt class="py-line"><tt class="py-docstring">    Whenever a new task is available, it launches AnalysisManager which will</tt> </tt>
<a name="L499"></a><tt class="py-lineno">499</tt>  <tt class="py-line"><tt class="py-docstring">    take care of running the full analysis process and operating with the</tt> </tt>
<a name="L500"></a><tt class="py-lineno">500</tt>  <tt class="py-line"><tt class="py-docstring">    assigned analysis machine.</tt> </tt>
<a name="L501"></a><tt class="py-lineno">501</tt>  <tt class="py-line"><tt class="py-docstring">    """</tt> </tt>
<a name="Scheduler.__init__"></a><div id="Scheduler.__init__-def"><a name="L502"></a><tt class="py-lineno">502</tt> <a class="py-toggle" href="#" id="Scheduler.__init__-toggle" onclick="return toggle('Scheduler.__init__');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.scheduler.Scheduler-class.html#__init__">__init__</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">,</tt> <tt class="py-param">maxcount</tt><tt class="py-op">=</tt><tt class="py-name">None</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Scheduler.__init__-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="Scheduler.__init__-expanded"><a name="L503"></a><tt class="py-lineno">503</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-520" class="py-name" targets="Method lib.cuckoo.common.abstracts.Machinery.running()=lib.cuckoo.common.abstracts.Machinery-class.html#running"><a title="lib.cuckoo.common.abstracts.Machinery.running" class="py-name" href="#" onclick="return doclink('link-520', 'running', 'link-520');">running</a></tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L504"></a><tt class="py-lineno">504</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-521" class="py-name"><a title="lib.cuckoo.core.rooter.cfg
modules.auxiliary.services.cfg
modules.processing.network.cfg" class="py-name" href="#" onclick="return doclink('link-521', 'cfg', 'link-83');">cfg</a></tt> <tt class="py-op">=</tt> <tt id="link-522" class="py-name"><a title="lib.cuckoo.common.config.Config" class="py-name" href="#" onclick="return doclink('link-522', 'Config', 'link-4');">Config</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L505"></a><tt class="py-lineno">505</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-523" class="py-name"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-523', 'db', 'link-86');">db</a></tt> <tt class="py-op">=</tt> <tt id="link-524" class="py-name"><a title="lib.cuckoo.core.database.Database" class="py-name" href="#" onclick="return doclink('link-524', 'Database', 'link-42');">Database</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L506"></a><tt class="py-lineno">506</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">maxcount</tt> <tt class="py-op">=</tt> <tt class="py-name">maxcount</tt> </tt>
<a name="L507"></a><tt class="py-lineno">507</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">total_analysis_count</tt> <tt class="py-op">=</tt> <tt class="py-number">0</tt> </tt>
</div><a name="L508"></a><tt class="py-lineno">508</tt>  <tt class="py-line"> </tt>
<a name="Scheduler.initialize"></a><div id="Scheduler.initialize-def"><a name="L509"></a><tt class="py-lineno">509</tt> <a class="py-toggle" href="#" id="Scheduler.initialize-toggle" onclick="return toggle('Scheduler.initialize');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.scheduler.Scheduler-class.html#initialize">initialize</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Scheduler.initialize-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="Scheduler.initialize-expanded"><a name="L510"></a><tt class="py-lineno">510</tt>  <tt class="py-line">        <tt class="py-docstring">"""Initialize the machine manager."""</tt> </tt>
<a name="L511"></a><tt class="py-lineno">511</tt>  <tt class="py-line">        <tt class="py-keyword">global</tt> <tt id="link-525" class="py-name"><a title="lib.cuckoo.core.scheduler.machinery
modules.machinery" class="py-name" href="#" onclick="return doclink('link-525', 'machinery', 'link-75');">machinery</a></tt><tt class="py-op">,</tt> <tt id="link-526" class="py-name"><a title="lib.cuckoo.core.scheduler.machine_lock" class="py-name" href="#" onclick="return doclink('link-526', 'machine_lock', 'link-76');">machine_lock</a></tt> </tt>
<a name="L512"></a><tt class="py-lineno">512</tt>  <tt class="py-line"> </tt>
<a name="L513"></a><tt class="py-lineno">513</tt>  <tt class="py-line">        <tt class="py-name">machinery_name</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-527" class="py-name"><a title="lib.cuckoo.core.rooter.cfg
modules.auxiliary.services.cfg
modules.processing.network.cfg" class="py-name" href="#" onclick="return doclink('link-527', 'cfg', 'link-83');">cfg</a></tt><tt class="py-op">.</tt><tt id="link-528" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-528', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-529" class="py-name"><a title="lib.cuckoo.core.scheduler.machinery
modules.machinery" class="py-name" href="#" onclick="return doclink('link-529', 'machinery', 'link-75');">machinery</a></tt> </tt>
<a name="L514"></a><tt class="py-lineno">514</tt>  <tt class="py-line"> </tt>
<a name="L515"></a><tt class="py-lineno">515</tt>  <tt class="py-line">        <tt class="py-name">max_vmstartup_count</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-530" class="py-name"><a title="lib.cuckoo.core.rooter.cfg
modules.auxiliary.services.cfg
modules.processing.network.cfg" class="py-name" href="#" onclick="return doclink('link-530', 'cfg', 'link-83');">cfg</a></tt><tt class="py-op">.</tt><tt id="link-531" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-531', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt class="py-name">max_vmstartup_count</tt> </tt>
<a name="L516"></a><tt class="py-lineno">516</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">max_vmstartup_count</tt><tt class="py-op">:</tt> </tt>
<a name="L517"></a><tt class="py-lineno">517</tt>  <tt class="py-line">            <tt id="link-532" class="py-name"><a title="lib.cuckoo.core.scheduler.machine_lock" class="py-name" href="#" onclick="return doclink('link-532', 'machine_lock', 'link-76');">machine_lock</a></tt> <tt class="py-op">=</tt> <tt class="py-name">threading</tt><tt class="py-op">.</tt><tt class="py-name">Semaphore</tt><tt class="py-op">(</tt><tt class="py-name">max_vmstartup_count</tt><tt class="py-op">)</tt> </tt>
<a name="L518"></a><tt class="py-lineno">518</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L519"></a><tt class="py-lineno">519</tt>  <tt class="py-line">            <tt id="link-533" class="py-name"><a title="lib.cuckoo.core.scheduler.machine_lock" class="py-name" href="#" onclick="return doclink('link-533', 'machine_lock', 'link-76');">machine_lock</a></tt> <tt class="py-op">=</tt> <tt class="py-name">threading</tt><tt class="py-op">.</tt><tt class="py-name">Lock</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L520"></a><tt class="py-lineno">520</tt>  <tt class="py-line"> </tt>
<a name="L521"></a><tt class="py-lineno">521</tt>  <tt class="py-line">        <tt id="link-534" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-534', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">"Using \"%s\" as machine manager"</tt><tt class="py-op">,</tt> <tt class="py-name">machinery_name</tt><tt class="py-op">)</tt> </tt>
<a name="L522"></a><tt class="py-lineno">522</tt>  <tt class="py-line"> </tt>
<a name="L523"></a><tt class="py-lineno">523</tt>  <tt class="py-line">        <tt class="py-comment"># Get registered class name. Only one machine manager is imported,</tt> </tt>
<a name="L524"></a><tt class="py-lineno">524</tt>  <tt class="py-line">        <tt class="py-comment"># therefore there should be only one class in the list.</tt> </tt>
<a name="L525"></a><tt class="py-lineno">525</tt>  <tt class="py-line">        <tt class="py-name">plugin</tt> <tt class="py-op">=</tt> <tt id="link-535" class="py-name"><a title="lib.cuckoo.core.plugins.list_plugins" class="py-name" href="#" onclick="return doclink('link-535', 'list_plugins', 'link-54');">list_plugins</a></tt><tt class="py-op">(</tt><tt class="py-string">"machinery"</tt><tt class="py-op">)</tt><tt class="py-op">[</tt><tt class="py-number">0</tt><tt class="py-op">]</tt> </tt>
<a name="L526"></a><tt class="py-lineno">526</tt>  <tt class="py-line">        <tt class="py-comment"># Initialize the machine manager.</tt> </tt>
<a name="L527"></a><tt class="py-lineno">527</tt>  <tt class="py-line">        <tt id="link-536" class="py-name"><a title="lib.cuckoo.core.scheduler.machinery
modules.machinery" class="py-name" href="#" onclick="return doclink('link-536', 'machinery', 'link-75');">machinery</a></tt> <tt class="py-op">=</tt> <tt class="py-name">plugin</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L528"></a><tt class="py-lineno">528</tt>  <tt class="py-line"> </tt>
<a name="L529"></a><tt class="py-lineno">529</tt>  <tt class="py-line">        <tt class="py-comment"># Find its configuration file.</tt> </tt>
<a name="L530"></a><tt class="py-lineno">530</tt>  <tt class="py-line">        <tt class="py-name">conf</tt> <tt class="py-op">=</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt id="link-537" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_ROOT" class="py-name" href="#" onclick="return doclink('link-537', 'CUCKOO_ROOT', 'link-11');">CUCKOO_ROOT</a></tt><tt class="py-op">,</tt> <tt class="py-string">"conf"</tt><tt class="py-op">,</tt> <tt class="py-string">"%s.conf"</tt> <tt class="py-op">%</tt> <tt class="py-name">machinery_name</tt><tt class="py-op">)</tt> </tt>
<a name="L531"></a><tt class="py-lineno">531</tt>  <tt class="py-line"> </tt>
<a name="L532"></a><tt class="py-lineno">532</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">exists</tt><tt class="py-op">(</tt><tt class="py-name">conf</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L533"></a><tt class="py-lineno">533</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-538" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooCriticalError" class="py-name" href="#" onclick="return doclink('link-538', 'CuckooCriticalError', 'link-27');">CuckooCriticalError</a></tt><tt class="py-op">(</tt><tt class="py-string">"The configuration file for machine "</tt> </tt>
<a name="L534"></a><tt class="py-lineno">534</tt>  <tt class="py-line">                                      <tt class="py-string">"manager \"{0}\" does not exist at path:"</tt> </tt>
<a name="L535"></a><tt class="py-lineno">535</tt>  <tt class="py-line">                                      <tt class="py-string">" {1}"</tt><tt class="py-op">.</tt><tt class="py-name">format</tt><tt class="py-op">(</tt><tt class="py-name">machinery_name</tt><tt class="py-op">,</tt> <tt class="py-name">conf</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L536"></a><tt class="py-lineno">536</tt>  <tt class="py-line"> </tt>
<a name="L537"></a><tt class="py-lineno">537</tt>  <tt class="py-line">        <tt class="py-comment"># Provide a dictionary with the configuration options to the</tt> </tt>
<a name="L538"></a><tt class="py-lineno">538</tt>  <tt class="py-line">        <tt class="py-comment"># machine manager instance.</tt> </tt>
<a name="L539"></a><tt class="py-lineno">539</tt>  <tt class="py-line">        <tt id="link-539" class="py-name"><a title="lib.cuckoo.core.scheduler.machinery
modules.machinery" class="py-name" href="#" onclick="return doclink('link-539', 'machinery', 'link-75');">machinery</a></tt><tt class="py-op">.</tt><tt id="link-540" class="py-name" targets="Method lib.cuckoo.common.abstracts.Auxiliary.set_options()=lib.cuckoo.common.abstracts.Auxiliary-class.html#set_options,Method lib.cuckoo.common.abstracts.Machinery.set_options()=lib.cuckoo.common.abstracts.Machinery-class.html#set_options,Method lib.cuckoo.common.abstracts.Processing.set_options()=lib.cuckoo.common.abstracts.Processing-class.html#set_options,Method lib.cuckoo.common.abstracts.Report.set_options()=lib.cuckoo.common.abstracts.Report-class.html#set_options"><a title="lib.cuckoo.common.abstracts.Auxiliary.set_options
lib.cuckoo.common.abstracts.Machinery.set_options
lib.cuckoo.common.abstracts.Processing.set_options
lib.cuckoo.common.abstracts.Report.set_options" class="py-name" href="#" onclick="return doclink('link-540', 'set_options', 'link-540');">set_options</a></tt><tt class="py-op">(</tt><tt id="link-541" class="py-name"><a title="lib.cuckoo.common.config.Config" class="py-name" href="#" onclick="return doclink('link-541', 'Config', 'link-4');">Config</a></tt><tt class="py-op">(</tt><tt class="py-name">machinery_name</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L540"></a><tt class="py-lineno">540</tt>  <tt class="py-line"> </tt>
<a name="L541"></a><tt class="py-lineno">541</tt>  <tt class="py-line">        <tt class="py-comment"># Initialize the machine manager.</tt> </tt>
<a name="L542"></a><tt class="py-lineno">542</tt>  <tt class="py-line">        <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L543"></a><tt class="py-lineno">543</tt>  <tt class="py-line">            <tt id="link-542" class="py-name"><a title="lib.cuckoo.core.scheduler.machinery
modules.machinery" class="py-name" href="#" onclick="return doclink('link-542', 'machinery', 'link-75');">machinery</a></tt><tt class="py-op">.</tt><tt id="link-543" class="py-name" targets="Method lib.cuckoo.common.abstracts.LibVirtMachinery.initialize()=lib.cuckoo.common.abstracts.LibVirtMachinery-class.html#initialize,Method lib.cuckoo.common.abstracts.Machinery.initialize()=lib.cuckoo.common.abstracts.Machinery-class.html#initialize,Method lib.cuckoo.core.scheduler.Scheduler.initialize()=lib.cuckoo.core.scheduler.Scheduler-class.html#initialize"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery.initialize
lib.cuckoo.common.abstracts.Machinery.initialize
lib.cuckoo.core.scheduler.Scheduler.initialize" class="py-name" href="#" onclick="return doclink('link-543', 'initialize', 'link-543');">initialize</a></tt><tt class="py-op">(</tt><tt class="py-name">machinery_name</tt><tt class="py-op">)</tt> </tt>
<a name="L544"></a><tt class="py-lineno">544</tt>  <tt class="py-line">        <tt class="py-keyword">except</tt> <tt id="link-544" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooMachineError" class="py-name" href="#" onclick="return doclink('link-544', 'CuckooMachineError', 'link-16');">CuckooMachineError</a></tt> <tt class="py-keyword">as</tt> <tt class="py-name">e</tt><tt class="py-op">:</tt> </tt>
<a name="L545"></a><tt class="py-lineno">545</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-545" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooCriticalError" class="py-name" href="#" onclick="return doclink('link-545', 'CuckooCriticalError', 'link-27');">CuckooCriticalError</a></tt><tt class="py-op">(</tt><tt class="py-string">"Error initializing machines: %s"</tt> <tt class="py-op">%</tt> <tt class="py-name">e</tt><tt class="py-op">)</tt> </tt>
<a name="L546"></a><tt class="py-lineno">546</tt>  <tt class="py-line"> </tt>
<a name="L547"></a><tt class="py-lineno">547</tt>  <tt class="py-line">        <tt class="py-comment"># At this point all the available machines should have been identified</tt> </tt>
<a name="L548"></a><tt class="py-lineno">548</tt>  <tt class="py-line">        <tt class="py-comment"># and added to the list. If none were found, Cuckoo needs to abort the</tt> </tt>
<a name="L549"></a><tt class="py-lineno">549</tt>  <tt class="py-line">        <tt class="py-comment"># execution.</tt> </tt>
<a name="L550"></a><tt class="py-lineno">550</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-546" class="py-name"><a title="lib.cuckoo.core.scheduler.machinery
modules.machinery" class="py-name" href="#" onclick="return doclink('link-546', 'machinery', 'link-75');">machinery</a></tt><tt class="py-op">.</tt><tt id="link-547" class="py-name" targets="Method lib.cuckoo.common.abstracts.Machinery.machines()=lib.cuckoo.common.abstracts.Machinery-class.html#machines"><a title="lib.cuckoo.common.abstracts.Machinery.machines" class="py-name" href="#" onclick="return doclink('link-547', 'machines', 'link-547');">machines</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L551"></a><tt class="py-lineno">551</tt>  <tt class="py-line">            <tt class="py-keyword">raise</tt> <tt id="link-548" class="py-name"><a title="lib.cuckoo.common.exceptions.CuckooCriticalError" class="py-name" href="#" onclick="return doclink('link-548', 'CuckooCriticalError', 'link-27');">CuckooCriticalError</a></tt><tt class="py-op">(</tt><tt class="py-string">"No machines available."</tt><tt class="py-op">)</tt> </tt>
<a name="L552"></a><tt class="py-lineno">552</tt>  <tt class="py-line">        <tt class="py-keyword">else</tt><tt class="py-op">:</tt> </tt>
<a name="L553"></a><tt class="py-lineno">553</tt>  <tt class="py-line">            <tt id="link-549" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-549', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">"Loaded %s machine/s"</tt><tt class="py-op">,</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-550" class="py-name"><a title="lib.cuckoo.core.scheduler.machinery
modules.machinery" class="py-name" href="#" onclick="return doclink('link-550', 'machinery', 'link-75');">machinery</a></tt><tt class="py-op">.</tt><tt id="link-551" class="py-name"><a title="lib.cuckoo.common.abstracts.Machinery.machines" class="py-name" href="#" onclick="return doclink('link-551', 'machines', 'link-547');">machines</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> </tt>
<a name="L554"></a><tt class="py-lineno">554</tt>  <tt class="py-line"> </tt>
<a name="L555"></a><tt class="py-lineno">555</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-552" class="py-name"><a title="lib.cuckoo.core.scheduler.machinery
modules.machinery" class="py-name" href="#" onclick="return doclink('link-552', 'machinery', 'link-75');">machinery</a></tt><tt class="py-op">.</tt><tt id="link-553" class="py-name"><a title="lib.cuckoo.common.abstracts.Machinery.machines" class="py-name" href="#" onclick="return doclink('link-553', 'machines', 'link-547');">machines</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> <tt class="py-op">&gt;</tt> <tt class="py-number">1</tt> <tt class="py-keyword">and</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-554" class="py-name"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-554', 'db', 'link-86');">db</a></tt><tt class="py-op">.</tt><tt class="py-name">engine</tt><tt class="py-op">.</tt><tt id="link-555" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-555', 'name', 'link-165');">name</a></tt> <tt class="py-op">==</tt> <tt class="py-string">"sqlite"</tt><tt class="py-op">:</tt> </tt>
<a name="L556"></a><tt class="py-lineno">556</tt>  <tt class="py-line">            <tt id="link-556" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-556', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">warning</tt><tt class="py-op">(</tt><tt class="py-string">"As you've configured Cuckoo to execute parallel "</tt> </tt>
<a name="L557"></a><tt class="py-lineno">557</tt>  <tt class="py-line">                        <tt class="py-string">"analyses, we recommend you to switch to a MySQL or"</tt> </tt>
<a name="L558"></a><tt class="py-lineno">558</tt>  <tt class="py-line">                        <tt class="py-string">"a PostgreSQL database as SQLite might cause some "</tt> </tt>
<a name="L559"></a><tt class="py-lineno">559</tt>  <tt class="py-line">                        <tt class="py-string">"issues."</tt><tt class="py-op">)</tt> </tt>
<a name="L560"></a><tt class="py-lineno">560</tt>  <tt class="py-line"> </tt>
<a name="L561"></a><tt class="py-lineno">561</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-557" class="py-name"><a title="lib.cuckoo.core.scheduler.machinery
modules.machinery" class="py-name" href="#" onclick="return doclink('link-557', 'machinery', 'link-75');">machinery</a></tt><tt class="py-op">.</tt><tt id="link-558" class="py-name"><a title="lib.cuckoo.common.abstracts.Machinery.machines" class="py-name" href="#" onclick="return doclink('link-558', 'machines', 'link-547');">machines</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> <tt class="py-op">&gt;</tt> <tt class="py-number">4</tt> <tt class="py-keyword">and</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-559" class="py-name"><a title="lib.cuckoo.core.rooter.cfg
modules.auxiliary.services.cfg
modules.processing.network.cfg" class="py-name" href="#" onclick="return doclink('link-559', 'cfg', 'link-83');">cfg</a></tt><tt class="py-op">.</tt><tt id="link-560" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-560', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt id="link-561" class="py-name"><a title="lib.cuckoo.core.scheduler.AnalysisManager.process_results" class="py-name" href="#" onclick="return doclink('link-561', 'process_results', 'link-502');">process_results</a></tt><tt class="py-op">:</tt> </tt>
<a name="L562"></a><tt class="py-lineno">562</tt>  <tt class="py-line">            <tt id="link-562" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-562', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">warning</tt><tt class="py-op">(</tt><tt class="py-string">"When running many virtual machines it is recommended "</tt> </tt>
<a name="L563"></a><tt class="py-lineno">563</tt>  <tt class="py-line">                        <tt class="py-string">"to process the results in a separate process.py to "</tt> </tt>
<a name="L564"></a><tt class="py-lineno">564</tt>  <tt class="py-line">                        <tt class="py-string">"increase throughput and stability. Please read the "</tt> </tt>
<a name="L565"></a><tt class="py-lineno">565</tt>  <tt class="py-line">                        <tt class="py-string">"documentation about the `Processing Utility`."</tt><tt class="py-op">)</tt> </tt>
<a name="L566"></a><tt class="py-lineno">566</tt>  <tt class="py-line"> </tt>
<a name="L567"></a><tt class="py-lineno">567</tt>  <tt class="py-line">        <tt class="py-comment"># Drop all existing packet forwarding rules for each VM. Just in case</tt> </tt>
<a name="L568"></a><tt class="py-lineno">568</tt>  <tt class="py-line">        <tt class="py-comment"># Cuckoo was terminated for some reason and various forwarding rules</tt> </tt>
<a name="L569"></a><tt class="py-lineno">569</tt>  <tt class="py-line">        <tt class="py-comment"># have thus not been dropped yet.</tt> </tt>
<a name="L570"></a><tt class="py-lineno">570</tt>  <tt class="py-line">        <tt class="py-keyword">for</tt> <tt id="link-563" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-563', 'machine', 'link-85');">machine</a></tt> <tt class="py-keyword">in</tt> <tt id="link-564" class="py-name"><a title="lib.cuckoo.core.scheduler.machinery
modules.machinery" class="py-name" href="#" onclick="return doclink('link-564', 'machinery', 'link-75');">machinery</a></tt><tt class="py-op">.</tt><tt id="link-565" class="py-name"><a title="lib.cuckoo.common.abstracts.Machinery.machines" class="py-name" href="#" onclick="return doclink('link-565', 'machines', 'link-547');">machines</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L571"></a><tt class="py-lineno">571</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-566" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-566', 'machine', 'link-85');">machine</a></tt><tt class="py-op">.</tt><tt id="link-567" class="py-name"><a title="lib.cuckoo.core.database.Machine.interface" class="py-name" href="#" onclick="return doclink('link-567', 'interface', 'link-248');">interface</a></tt><tt class="py-op">:</tt> </tt>
<a name="L572"></a><tt class="py-lineno">572</tt>  <tt class="py-line">                <tt id="link-568" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-568', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">"Unable to determine the network interface for VM "</tt> </tt>
<a name="L573"></a><tt class="py-lineno">573</tt>  <tt class="py-line">                         <tt class="py-string">"with name %s, Cuckoo will not be able to give it "</tt> </tt>
<a name="L574"></a><tt class="py-lineno">574</tt>  <tt class="py-line">                         <tt class="py-string">"full internet access or route it through a VPN! "</tt> </tt>
<a name="L575"></a><tt class="py-lineno">575</tt>  <tt class="py-line">                         <tt class="py-string">"Please define a default network interface for the "</tt> </tt>
<a name="L576"></a><tt class="py-lineno">576</tt>  <tt class="py-line">                         <tt class="py-string">"machinery or define a network interface for each "</tt> </tt>
<a name="L577"></a><tt class="py-lineno">577</tt>  <tt class="py-line">                         <tt class="py-string">"VM."</tt><tt class="py-op">,</tt> <tt id="link-569" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-569', 'machine', 'link-85');">machine</a></tt><tt class="py-op">.</tt><tt id="link-570" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-570', 'name', 'link-165');">name</a></tt><tt class="py-op">)</tt> </tt>
<a name="L578"></a><tt class="py-lineno">578</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L579"></a><tt class="py-lineno">579</tt>  <tt class="py-line"> </tt>
<a name="L580"></a><tt class="py-lineno">580</tt>  <tt class="py-line">            <tt class="py-comment"># Drop forwarding rule to each VPN.</tt> </tt>
<a name="L581"></a><tt class="py-lineno">581</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt class="py-name">vpn</tt> <tt class="py-keyword">in</tt> <tt id="link-571" class="py-name"><a title="lib.cuckoo.core.rooter.vpns" class="py-name" href="#" onclick="return doclink('link-571', 'vpns', 'link-73');">vpns</a></tt><tt class="py-op">.</tt><tt class="py-name">values</tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L582"></a><tt class="py-lineno">582</tt>  <tt class="py-line">                <tt id="link-572" class="py-name"><a title="lib.cuckoo.core.rooter
lib.cuckoo.core.rooter.rooter" class="py-name" href="#" onclick="return doclink('link-572', 'rooter', 'link-71');">rooter</a></tt><tt class="py-op">(</tt><tt class="py-string">"forward_disable"</tt><tt class="py-op">,</tt> <tt id="link-573" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-573', 'machine', 'link-85');">machine</a></tt><tt class="py-op">.</tt><tt id="link-574" class="py-name"><a title="lib.cuckoo.core.database.Machine.interface" class="py-name" href="#" onclick="return doclink('link-574', 'interface', 'link-248');">interface</a></tt><tt class="py-op">,</tt> </tt>
<a name="L583"></a><tt class="py-lineno">583</tt>  <tt class="py-line">                       <tt class="py-name">vpn</tt><tt class="py-op">[</tt><tt class="py-string">"interface"</tt><tt class="py-op">]</tt><tt class="py-op">,</tt> <tt id="link-575" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-575', 'machine', 'link-85');">machine</a></tt><tt class="py-op">.</tt><tt id="link-576" class="py-name"><a title="lib.cuckoo.core.database.Machine.ip" class="py-name" href="#" onclick="return doclink('link-576', 'ip', 'link-268');">ip</a></tt><tt class="py-op">)</tt> </tt>
<a name="L584"></a><tt class="py-lineno">584</tt>  <tt class="py-line"> </tt>
<a name="L585"></a><tt class="py-lineno">585</tt>  <tt class="py-line">            <tt class="py-comment"># Drop forwarding rule to the internet / dirty line.</tt> </tt>
<a name="L586"></a><tt class="py-lineno">586</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-577" class="py-name"><a title="lib.cuckoo.core.rooter.cfg
modules.auxiliary.services.cfg
modules.processing.network.cfg" class="py-name" href="#" onclick="return doclink('link-577', 'cfg', 'link-83');">cfg</a></tt><tt class="py-op">.</tt><tt class="py-name">routing</tt><tt class="py-op">.</tt><tt class="py-name">internet</tt> <tt class="py-op">!=</tt> <tt class="py-string">"none"</tt><tt class="py-op">:</tt> </tt>
<a name="L587"></a><tt class="py-lineno">587</tt>  <tt class="py-line">                <tt id="link-578" class="py-name"><a title="lib.cuckoo.core.rooter
lib.cuckoo.core.rooter.rooter" class="py-name" href="#" onclick="return doclink('link-578', 'rooter', 'link-71');">rooter</a></tt><tt class="py-op">(</tt><tt class="py-string">"forward_disable"</tt><tt class="py-op">,</tt> <tt id="link-579" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-579', 'machine', 'link-85');">machine</a></tt><tt class="py-op">.</tt><tt id="link-580" class="py-name"><a title="lib.cuckoo.core.database.Machine.interface" class="py-name" href="#" onclick="return doclink('link-580', 'interface', 'link-248');">interface</a></tt><tt class="py-op">,</tt> </tt>
<a name="L588"></a><tt class="py-lineno">588</tt>  <tt class="py-line">                       <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-581" class="py-name"><a title="lib.cuckoo.core.rooter.cfg
modules.auxiliary.services.cfg
modules.processing.network.cfg" class="py-name" href="#" onclick="return doclink('link-581', 'cfg', 'link-83');">cfg</a></tt><tt class="py-op">.</tt><tt class="py-name">routing</tt><tt class="py-op">.</tt><tt class="py-name">internet</tt><tt class="py-op">,</tt> <tt id="link-582" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-582', 'machine', 'link-85');">machine</a></tt><tt class="py-op">.</tt><tt id="link-583" class="py-name"><a title="lib.cuckoo.core.database.Machine.ip" class="py-name" href="#" onclick="return doclink('link-583', 'ip', 'link-268');">ip</a></tt><tt class="py-op">)</tt> </tt>
</div><a name="L589"></a><tt class="py-lineno">589</tt>  <tt class="py-line"> </tt>
<a name="Scheduler.stop"></a><div id="Scheduler.stop-def"><a name="L590"></a><tt class="py-lineno">590</tt> <a class="py-toggle" href="#" id="Scheduler.stop-toggle" onclick="return toggle('Scheduler.stop');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.scheduler.Scheduler-class.html#stop">stop</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Scheduler.stop-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="Scheduler.stop-expanded"><a name="L591"></a><tt class="py-lineno">591</tt>  <tt class="py-line">        <tt class="py-docstring">"""Stop scheduler."""</tt> </tt>
<a name="L592"></a><tt class="py-lineno">592</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-584" class="py-name"><a title="lib.cuckoo.common.abstracts.Machinery.running" class="py-name" href="#" onclick="return doclink('link-584', 'running', 'link-520');">running</a></tt> <tt class="py-op">=</tt> <tt class="py-name">False</tt> </tt>
<a name="L593"></a><tt class="py-lineno">593</tt>  <tt class="py-line">        <tt class="py-comment"># Shutdown machine manager (used to kill machines that still alive).</tt> </tt>
<a name="L594"></a><tt class="py-lineno">594</tt>  <tt class="py-line">        <tt id="link-585" class="py-name"><a title="lib.cuckoo.core.scheduler.machinery
modules.machinery" class="py-name" href="#" onclick="return doclink('link-585', 'machinery', 'link-75');">machinery</a></tt><tt class="py-op">.</tt><tt id="link-586" class="py-name" targets="Method lib.cuckoo.common.abstracts.LibVirtMachinery.shutdown()=lib.cuckoo.common.abstracts.LibVirtMachinery-class.html#shutdown,Method lib.cuckoo.common.abstracts.Machinery.shutdown()=lib.cuckoo.common.abstracts.Machinery-class.html#shutdown"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery.shutdown
lib.cuckoo.common.abstracts.Machinery.shutdown" class="py-name" href="#" onclick="return doclink('link-586', 'shutdown', 'link-586');">shutdown</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
</div><a name="L595"></a><tt class="py-lineno">595</tt>  <tt class="py-line"> </tt>
<a name="Scheduler.start"></a><div id="Scheduler.start-def"><a name="L596"></a><tt class="py-lineno">596</tt> <a class="py-toggle" href="#" id="Scheduler.start-toggle" onclick="return toggle('Scheduler.start');">-</a><tt class="py-line">    <tt class="py-keyword">def</tt> <a class="py-def-name" href="lib.cuckoo.core.scheduler.Scheduler-class.html#start">start</a><tt class="py-op">(</tt><tt class="py-param">self</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
</div><div id="Scheduler.start-collapsed" style="display:none;" pad="+++" indent="++++++++"></div><div id="Scheduler.start-expanded"><a name="L597"></a><tt class="py-lineno">597</tt>  <tt class="py-line">        <tt class="py-docstring">"""Start scheduler."""</tt> </tt>
<a name="L598"></a><tt class="py-lineno">598</tt>  <tt class="py-line">        <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-587" class="py-name"><a title="lib.cuckoo.common.abstracts.LibVirtMachinery.initialize
lib.cuckoo.common.abstracts.Machinery.initialize
lib.cuckoo.core.scheduler.Scheduler.initialize" class="py-name" href="#" onclick="return doclink('link-587', 'initialize', 'link-543');">initialize</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L599"></a><tt class="py-lineno">599</tt>  <tt class="py-line"> </tt>
<a name="L600"></a><tt class="py-lineno">600</tt>  <tt class="py-line">        <tt id="link-588" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-588', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">info</tt><tt class="py-op">(</tt><tt class="py-string">"Waiting for analysis tasks."</tt><tt class="py-op">)</tt> </tt>
<a name="L601"></a><tt class="py-lineno">601</tt>  <tt class="py-line"> </tt>
<a name="L602"></a><tt class="py-lineno">602</tt>  <tt class="py-line">        <tt class="py-comment"># Message queue with threads to transmit exceptions (used as IPC).</tt> </tt>
<a name="L603"></a><tt class="py-lineno">603</tt>  <tt class="py-line">        <tt id="link-589" class="py-name"><a title="lib.cuckoo.core.database.Task.errors" class="py-name" href="#" onclick="return doclink('link-589', 'errors', 'link-82');">errors</a></tt> <tt class="py-op">=</tt> <tt class="py-name">Queue</tt><tt class="py-op">.</tt><tt class="py-name">Queue</tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L604"></a><tt class="py-lineno">604</tt>  <tt class="py-line"> </tt>
<a name="L605"></a><tt class="py-lineno">605</tt>  <tt class="py-line">        <tt class="py-comment"># Command-line overrides the configuration file.</tt> </tt>
<a name="L606"></a><tt class="py-lineno">606</tt>  <tt class="py-line">        <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">maxcount</tt> <tt class="py-keyword">is</tt> <tt class="py-name">None</tt><tt class="py-op">:</tt> </tt>
<a name="L607"></a><tt class="py-lineno">607</tt>  <tt class="py-line">            <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">maxcount</tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-590" class="py-name"><a title="lib.cuckoo.core.rooter.cfg
modules.auxiliary.services.cfg
modules.processing.network.cfg" class="py-name" href="#" onclick="return doclink('link-590', 'cfg', 'link-83');">cfg</a></tt><tt class="py-op">.</tt><tt id="link-591" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-591', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt class="py-name">max_analysis_count</tt> </tt>
<a name="L608"></a><tt class="py-lineno">608</tt>  <tt class="py-line"> </tt>
<a name="L609"></a><tt class="py-lineno">609</tt>  <tt class="py-line">        <tt class="py-comment"># This loop runs forever.</tt> </tt>
<a name="L610"></a><tt class="py-lineno">610</tt>  <tt class="py-line">        <tt class="py-keyword">while</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-592" class="py-name"><a title="lib.cuckoo.common.abstracts.Machinery.running" class="py-name" href="#" onclick="return doclink('link-592', 'running', 'link-520');">running</a></tt><tt class="py-op">:</tt> </tt>
<a name="L611"></a><tt class="py-lineno">611</tt>  <tt class="py-line">            <tt class="py-name">time</tt><tt class="py-op">.</tt><tt class="py-name">sleep</tt><tt class="py-op">(</tt><tt class="py-number">1</tt><tt class="py-op">)</tt> </tt>
<a name="L612"></a><tt class="py-lineno">612</tt>  <tt class="py-line"> </tt>
<a name="L613"></a><tt class="py-lineno">613</tt>  <tt class="py-line">            <tt class="py-comment"># Wait until the machine lock is not locked. This is only the case</tt> </tt>
<a name="L614"></a><tt class="py-lineno">614</tt>  <tt class="py-line">            <tt class="py-comment"># when all machines are fully running, rather that about to start</tt> </tt>
<a name="L615"></a><tt class="py-lineno">615</tt>  <tt class="py-line">            <tt class="py-comment"># or still busy starting. This way we won't have race conditions</tt> </tt>
<a name="L616"></a><tt class="py-lineno">616</tt>  <tt class="py-line">            <tt class="py-comment"># with finding out there are no available machines in the analysis</tt> </tt>
<a name="L617"></a><tt class="py-lineno">617</tt>  <tt class="py-line">            <tt class="py-comment"># manager or having two analyses pick the same machine.</tt> </tt>
<a name="L618"></a><tt class="py-lineno">618</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-593" class="py-name"><a title="lib.cuckoo.core.scheduler.machine_lock" class="py-name" href="#" onclick="return doclink('link-593', 'machine_lock', 'link-76');">machine_lock</a></tt><tt class="py-op">.</tt><tt id="link-594" class="py-name"><a title="lib.cuckoo.common.abstracts.Machinery.acquire" class="py-name" href="#" onclick="return doclink('link-594', 'acquire', 'link-138');">acquire</a></tt><tt class="py-op">(</tt><tt class="py-name">False</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L619"></a><tt class="py-lineno">619</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L620"></a><tt class="py-lineno">620</tt>  <tt class="py-line"> </tt>
<a name="L621"></a><tt class="py-lineno">621</tt>  <tt class="py-line">            <tt id="link-595" class="py-name"><a title="lib.cuckoo.core.scheduler.machine_lock" class="py-name" href="#" onclick="return doclink('link-595', 'machine_lock', 'link-76');">machine_lock</a></tt><tt class="py-op">.</tt><tt id="link-596" class="py-name"><a title="lib.cuckoo.common.abstracts.Machinery.release" class="py-name" href="#" onclick="return doclink('link-596', 'release', 'link-142');">release</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L622"></a><tt class="py-lineno">622</tt>  <tt class="py-line"> </tt>
<a name="L623"></a><tt class="py-lineno">623</tt>  <tt class="py-line">            <tt class="py-comment"># If not enough free disk space is available, then we print an</tt> </tt>
<a name="L624"></a><tt class="py-lineno">624</tt>  <tt class="py-line">            <tt class="py-comment"># error message and wait another round (this check is ignored</tt> </tt>
<a name="L625"></a><tt class="py-lineno">625</tt>  <tt class="py-line">            <tt class="py-comment"># when the freespace configuration variable is set to zero).</tt> </tt>
<a name="L626"></a><tt class="py-lineno">626</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-597" class="py-name"><a title="lib.cuckoo.core.rooter.cfg
modules.auxiliary.services.cfg
modules.processing.network.cfg" class="py-name" href="#" onclick="return doclink('link-597', 'cfg', 'link-83');">cfg</a></tt><tt class="py-op">.</tt><tt id="link-598" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-598', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt class="py-name">freespace</tt><tt class="py-op">:</tt> </tt>
<a name="L627"></a><tt class="py-lineno">627</tt>  <tt class="py-line">                <tt class="py-comment"># Resolve the full base path to the analysis folder, just in</tt> </tt>
<a name="L628"></a><tt class="py-lineno">628</tt>  <tt class="py-line">                <tt class="py-comment"># case somebody decides to make a symbolic link out of it.</tt> </tt>
<a name="L629"></a><tt class="py-lineno">629</tt>  <tt class="py-line">                <tt class="py-name">dir_path</tt> <tt class="py-op">=</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">path</tt><tt class="py-op">.</tt><tt class="py-name">join</tt><tt class="py-op">(</tt><tt id="link-599" class="py-name"><a title="lib.cuckoo.common.constants.CUCKOO_ROOT" class="py-name" href="#" onclick="return doclink('link-599', 'CUCKOO_ROOT', 'link-11');">CUCKOO_ROOT</a></tt><tt class="py-op">,</tt> <tt class="py-string">"storage"</tt><tt class="py-op">,</tt> <tt class="py-string">"analyses"</tt><tt class="py-op">)</tt> </tt>
<a name="L630"></a><tt class="py-lineno">630</tt>  <tt class="py-line"> </tt>
<a name="L631"></a><tt class="py-lineno">631</tt>  <tt class="py-line">                <tt class="py-comment"># TODO: Windows support</tt> </tt>
<a name="L632"></a><tt class="py-lineno">632</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">hasattr</tt><tt class="py-op">(</tt><tt class="py-name">os</tt><tt class="py-op">,</tt> <tt class="py-string">"statvfs"</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L633"></a><tt class="py-lineno">633</tt>  <tt class="py-line">                    <tt class="py-name">dir_stats</tt> <tt class="py-op">=</tt> <tt class="py-name">os</tt><tt class="py-op">.</tt><tt class="py-name">statvfs</tt><tt class="py-op">(</tt><tt class="py-name">dir_path</tt><tt class="py-op">)</tt> </tt>
<a name="L634"></a><tt class="py-lineno">634</tt>  <tt class="py-line"> </tt>
<a name="L635"></a><tt class="py-lineno">635</tt>  <tt class="py-line">                    <tt class="py-comment"># Calculate the free disk space in megabytes.</tt> </tt>
<a name="L636"></a><tt class="py-lineno">636</tt>  <tt class="py-line">                    <tt class="py-name">space_available</tt> <tt class="py-op">=</tt> <tt class="py-name">dir_stats</tt><tt class="py-op">.</tt><tt class="py-name">f_bavail</tt> <tt class="py-op">*</tt> <tt class="py-name">dir_stats</tt><tt class="py-op">.</tt><tt class="py-name">f_frsize</tt> </tt>
<a name="L637"></a><tt class="py-lineno">637</tt>  <tt class="py-line">                    <tt class="py-name">space_available</tt> <tt class="py-op">/=</tt> <tt class="py-number">1024</tt> <tt class="py-op">*</tt> <tt class="py-number">1024</tt> </tt>
<a name="L638"></a><tt class="py-lineno">638</tt>  <tt class="py-line"> </tt>
<a name="L639"></a><tt class="py-lineno">639</tt>  <tt class="py-line">                    <tt class="py-keyword">if</tt> <tt class="py-name">space_available</tt> <tt class="py-op">&lt;</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-600" class="py-name"><a title="lib.cuckoo.core.rooter.cfg
modules.auxiliary.services.cfg
modules.processing.network.cfg" class="py-name" href="#" onclick="return doclink('link-600', 'cfg', 'link-83');">cfg</a></tt><tt class="py-op">.</tt><tt id="link-601" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-601', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt class="py-name">freespace</tt><tt class="py-op">:</tt> </tt>
<a name="L640"></a><tt class="py-lineno">640</tt>  <tt class="py-line">                        <tt id="link-602" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-602', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt class="py-name">error</tt><tt class="py-op">(</tt><tt class="py-string">"Not enough free disk space! (Only %d MB!)"</tt><tt class="py-op">,</tt> </tt>
<a name="L641"></a><tt class="py-lineno">641</tt>  <tt class="py-line">                                  <tt class="py-name">space_available</tt><tt class="py-op">)</tt> </tt>
<a name="L642"></a><tt class="py-lineno">642</tt>  <tt class="py-line">                        <tt class="py-keyword">continue</tt> </tt>
<a name="L643"></a><tt class="py-lineno">643</tt>  <tt class="py-line"> </tt>
<a name="L644"></a><tt class="py-lineno">644</tt>  <tt class="py-line">            <tt class="py-comment"># Have we limited the number of concurrently executing machines?</tt> </tt>
<a name="L645"></a><tt class="py-lineno">645</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-603" class="py-name"><a title="lib.cuckoo.core.rooter.cfg
modules.auxiliary.services.cfg
modules.processing.network.cfg" class="py-name" href="#" onclick="return doclink('link-603', 'cfg', 'link-83');">cfg</a></tt><tt class="py-op">.</tt><tt id="link-604" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-604', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt class="py-name">max_machines_count</tt><tt class="py-op">:</tt> </tt>
<a name="L646"></a><tt class="py-lineno">646</tt>  <tt class="py-line">                <tt class="py-comment"># Are too many running?</tt> </tt>
<a name="L647"></a><tt class="py-lineno">647</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt class="py-name">len</tt><tt class="py-op">(</tt><tt id="link-605" class="py-name"><a title="lib.cuckoo.core.scheduler.machinery
modules.machinery" class="py-name" href="#" onclick="return doclink('link-605', 'machinery', 'link-75');">machinery</a></tt><tt class="py-op">.</tt><tt id="link-606" class="py-name"><a title="lib.cuckoo.common.abstracts.Machinery.running" class="py-name" href="#" onclick="return doclink('link-606', 'running', 'link-520');">running</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">)</tt> <tt class="py-op">&gt;=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-607" class="py-name"><a title="lib.cuckoo.core.rooter.cfg
modules.auxiliary.services.cfg
modules.processing.network.cfg" class="py-name" href="#" onclick="return doclink('link-607', 'cfg', 'link-83');">cfg</a></tt><tt class="py-op">.</tt><tt id="link-608" class="py-name"><a title="lib.cuckoo" class="py-name" href="#" onclick="return doclink('link-608', 'cuckoo', 'link-1');">cuckoo</a></tt><tt class="py-op">.</tt><tt class="py-name">max_machines_count</tt><tt class="py-op">:</tt> </tt>
<a name="L648"></a><tt class="py-lineno">648</tt>  <tt class="py-line">                    <tt class="py-keyword">continue</tt> </tt>
<a name="L649"></a><tt class="py-lineno">649</tt>  <tt class="py-line"> </tt>
<a name="L650"></a><tt class="py-lineno">650</tt>  <tt class="py-line">            <tt class="py-comment"># If no machines are available, it's pointless to fetch for</tt> </tt>
<a name="L651"></a><tt class="py-lineno">651</tt>  <tt class="py-line">            <tt class="py-comment"># pending tasks. Loop over.</tt> </tt>
<a name="L652"></a><tt class="py-lineno">652</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-609" class="py-name"><a title="lib.cuckoo.core.scheduler.machinery
modules.machinery" class="py-name" href="#" onclick="return doclink('link-609', 'machinery', 'link-75');">machinery</a></tt><tt class="py-op">.</tt><tt id="link-610" class="py-name"><a title="lib.cuckoo.common.abstracts.Machinery.availables" class="py-name" href="#" onclick="return doclink('link-610', 'availables', 'link-140');">availables</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L653"></a><tt class="py-lineno">653</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L654"></a><tt class="py-lineno">654</tt>  <tt class="py-line"> </tt>
<a name="L655"></a><tt class="py-lineno">655</tt>  <tt class="py-line">            <tt class="py-comment"># Exits if max_analysis_count is defined in the configuration</tt> </tt>
<a name="L656"></a><tt class="py-lineno">656</tt>  <tt class="py-line">            <tt class="py-comment"># file and has been reached.</tt> </tt>
<a name="L657"></a><tt class="py-lineno">657</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">maxcount</tt> <tt class="py-keyword">and</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">total_analysis_count</tt> <tt class="py-op">&gt;=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">maxcount</tt><tt class="py-op">:</tt> </tt>
<a name="L658"></a><tt class="py-lineno">658</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt id="link-611" class="py-name"><a title="lib.cuckoo.core.scheduler.active_analysis_count" class="py-name" href="#" onclick="return doclink('link-611', 'active_analysis_count', 'link-78');">active_analysis_count</a></tt> <tt class="py-op">&lt;=</tt> <tt class="py-number">0</tt><tt class="py-op">:</tt> </tt>
<a name="L659"></a><tt class="py-lineno">659</tt>  <tt class="py-line">                    <tt id="link-612" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-612', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt id="link-613" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-613', 'debug', 'link-158');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"Reached max analysis count, exiting."</tt><tt class="py-op">)</tt> </tt>
<a name="L660"></a><tt class="py-lineno">660</tt>  <tt class="py-line">                    <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-614" class="py-name"><a title="lib.cuckoo.common.abstracts.Auxiliary.stop
lib.cuckoo.common.abstracts.LibVirtMachinery.stop
lib.cuckoo.common.abstracts.Machinery.stop
lib.cuckoo.core.plugins.RunAuxiliary.stop
lib.cuckoo.core.scheduler.Scheduler.stop
modules.auxiliary.mitm.MITM.stop
modules.auxiliary.services.Services.stop
modules.auxiliary.sniffer.Sniffer.stop
modules.machinery.avd.Avd.stop
modules.machinery.physical.Physical.stop
modules.machinery.qemu.QEMU.stop
modules.machinery.virtualbox.VirtualBox.stop
modules.machinery.vmware.VMware.stop
modules.machinery.vsphere.vSphere.stop
modules.machinery.xenserver.XenServerMachinery.stop
modules.signatures.generic_metrics.SystemMetrics.stop" class="py-name" href="#" onclick="return doclink('link-614', 'stop', 'link-407');">stop</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L661"></a><tt class="py-lineno">661</tt>  <tt class="py-line">                <tt class="py-keyword">continue</tt> </tt>
<a name="L662"></a><tt class="py-lineno">662</tt>  <tt class="py-line"> </tt>
<a name="L663"></a><tt class="py-lineno">663</tt>  <tt class="py-line">            <tt class="py-comment"># Fetch a pending analysis task.</tt> </tt>
<a name="L664"></a><tt class="py-lineno">664</tt>  <tt class="py-line">            <tt class="py-comment"># TODO This fixes only submissions by --machine, need to add</tt> </tt>
<a name="L665"></a><tt class="py-lineno">665</tt>  <tt class="py-line">            <tt class="py-comment"># other attributes (tags etc).</tt> </tt>
<a name="L666"></a><tt class="py-lineno">666</tt>  <tt class="py-line">            <tt class="py-comment"># TODO We should probably move the entire "acquire machine" logic</tt> </tt>
<a name="L667"></a><tt class="py-lineno">667</tt>  <tt class="py-line">            <tt class="py-comment"># from the Analysis Manager to the Scheduler and then pass the</tt> </tt>
<a name="L668"></a><tt class="py-lineno">668</tt>  <tt class="py-line">            <tt class="py-comment"># selected machine onto the Analysis Manager instance.</tt> </tt>
<a name="L669"></a><tt class="py-lineno">669</tt>  <tt class="py-line">            <tt id="link-615" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-615', 'task', 'link-80');">task</a></tt><tt class="py-op">,</tt> <tt class="py-name">available</tt> <tt class="py-op">=</tt> <tt class="py-name">None</tt><tt class="py-op">,</tt> <tt class="py-name">False</tt> </tt>
<a name="L670"></a><tt class="py-lineno">670</tt>  <tt class="py-line">            <tt class="py-keyword">for</tt> <tt id="link-616" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-616', 'machine', 'link-85');">machine</a></tt> <tt class="py-keyword">in</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-617" class="py-name"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-617', 'db', 'link-86');">db</a></tt><tt class="py-op">.</tt><tt id="link-618" class="py-name" targets="Method lib.cuckoo.core.database.Database.get_available_machines()=lib.cuckoo.core.database.Database-class.html#get_available_machines"><a title="lib.cuckoo.core.database.Database.get_available_machines" class="py-name" href="#" onclick="return doclink('link-618', 'get_available_machines', 'link-618');">get_available_machines</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L671"></a><tt class="py-lineno">671</tt>  <tt class="py-line">                <tt id="link-619" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-619', 'task', 'link-80');">task</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-620" class="py-name"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-620', 'db', 'link-86');">db</a></tt><tt class="py-op">.</tt><tt id="link-621" class="py-name" targets="Method lib.cuckoo.core.database.Database.fetch()=lib.cuckoo.core.database.Database-class.html#fetch"><a title="lib.cuckoo.core.database.Database.fetch" class="py-name" href="#" onclick="return doclink('link-621', 'fetch', 'link-621');">fetch</a></tt><tt class="py-op">(</tt><tt id="link-622" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-622', 'machine', 'link-85');">machine</a></tt><tt class="py-op">=</tt><tt id="link-623" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-623', 'machine', 'link-85');">machine</a></tt><tt class="py-op">.</tt><tt id="link-624" class="py-name"><a title="lib.cuckoo.common.abstracts.Signature.name
lib.cuckoo.core.database.Guest.name
lib.cuckoo.core.database.Machine.name
lib.cuckoo.core.database.Tag.name
modules.signatures.creates_exe.CreatesExe.name
modules.signatures.generic_metrics.SystemMetrics.name" class="py-name" href="#" onclick="return doclink('link-624', 'name', 'link-165');">name</a></tt><tt class="py-op">)</tt> </tt>
<a name="L672"></a><tt class="py-lineno">672</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt id="link-625" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-625', 'task', 'link-80');">task</a></tt><tt class="py-op">:</tt> </tt>
<a name="L673"></a><tt class="py-lineno">673</tt>  <tt class="py-line">                    <tt class="py-keyword">break</tt> </tt>
<a name="L674"></a><tt class="py-lineno">674</tt>  <tt class="py-line"> </tt>
<a name="L675"></a><tt class="py-lineno">675</tt>  <tt class="py-line">                <tt class="py-keyword">if</tt> <tt id="link-626" class="py-name"><a title="lib.cuckoo.core.database.Tag.machine
lib.cuckoo.core.database.Task.machine" class="py-name" href="#" onclick="return doclink('link-626', 'machine', 'link-85');">machine</a></tt><tt class="py-op">.</tt><tt id="link-627" class="py-name" targets="Method lib.cuckoo.core.database.Machine.is_analysis()=lib.cuckoo.core.database.Machine-class.html#is_analysis"><a title="lib.cuckoo.core.database.Machine.is_analysis" class="py-name" href="#" onclick="return doclink('link-627', 'is_analysis', 'link-627');">is_analysis</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt><tt class="py-op">:</tt> </tt>
<a name="L676"></a><tt class="py-lineno">676</tt>  <tt class="py-line">                    <tt class="py-name">available</tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L677"></a><tt class="py-lineno">677</tt>  <tt class="py-line"> </tt>
<a name="L678"></a><tt class="py-lineno">678</tt>  <tt class="py-line">            <tt class="py-comment"># We only fetch a new task if at least one of the available</tt> </tt>
<a name="L679"></a><tt class="py-lineno">679</tt>  <tt class="py-line">            <tt class="py-comment"># machines is not a "service" machine (again, please refer to the</tt> </tt>
<a name="L680"></a><tt class="py-lineno">680</tt>  <tt class="py-line">            <tt class="py-comment"># services auxiliary module for more information on service VMs).</tt> </tt>
<a name="L681"></a><tt class="py-lineno">681</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt class="py-keyword">not</tt> <tt id="link-628" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-628', 'task', 'link-80');">task</a></tt> <tt class="py-keyword">and</tt> <tt class="py-name">available</tt><tt class="py-op">:</tt> </tt>
<a name="L682"></a><tt class="py-lineno">682</tt>  <tt class="py-line">                <tt id="link-629" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-629', 'task', 'link-80');">task</a></tt> <tt class="py-op">=</tt> <tt class="py-name">self</tt><tt class="py-op">.</tt><tt id="link-630" class="py-name"><a title="lib.cuckoo.core.guest.db
modules.auxiliary.services.db" class="py-name" href="#" onclick="return doclink('link-630', 'db', 'link-86');">db</a></tt><tt class="py-op">.</tt><tt id="link-631" class="py-name"><a title="lib.cuckoo.core.database.Database.fetch" class="py-name" href="#" onclick="return doclink('link-631', 'fetch', 'link-621');">fetch</a></tt><tt class="py-op">(</tt><tt class="py-name">service</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt> </tt>
<a name="L683"></a><tt class="py-lineno">683</tt>  <tt class="py-line"> </tt>
<a name="L684"></a><tt class="py-lineno">684</tt>  <tt class="py-line">            <tt class="py-keyword">if</tt> <tt id="link-632" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-632', 'task', 'link-80');">task</a></tt><tt class="py-op">:</tt> </tt>
<a name="L685"></a><tt class="py-lineno">685</tt>  <tt class="py-line">                <tt id="link-633" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-633', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt id="link-634" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-634', 'debug', 'link-158');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"Processing task #%s"</tt><tt class="py-op">,</tt> <tt id="link-635" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-635', 'task', 'link-80');">task</a></tt><tt class="py-op">.</tt><tt id="link-636" class="py-name"><a title="lib.cuckoo.core.database.Error.id
lib.cuckoo.core.database.Guest.id
lib.cuckoo.core.database.Machine.id
lib.cuckoo.core.database.Sample.id
lib.cuckoo.core.database.Tag.id
lib.cuckoo.core.database.Task.id" class="py-name" href="#" onclick="return doclink('link-636', 'id', 'link-95');">id</a></tt><tt class="py-op">)</tt> </tt>
<a name="L686"></a><tt class="py-lineno">686</tt>  <tt class="py-line">                <tt class="py-name">self</tt><tt class="py-op">.</tt><tt class="py-name">total_analysis_count</tt> <tt class="py-op">+=</tt> <tt class="py-number">1</tt> </tt>
<a name="L687"></a><tt class="py-lineno">687</tt>  <tt class="py-line"> </tt>
<a name="L688"></a><tt class="py-lineno">688</tt>  <tt class="py-line">                <tt class="py-comment"># Initialize and start the analysis manager.</tt> </tt>
<a name="L689"></a><tt class="py-lineno">689</tt>  <tt class="py-line">                <tt class="py-name">analysis</tt> <tt class="py-op">=</tt> <tt id="link-637" class="py-name" targets="Class lib.cuckoo.core.scheduler.AnalysisManager=lib.cuckoo.core.scheduler.AnalysisManager-class.html"><a title="lib.cuckoo.core.scheduler.AnalysisManager" class="py-name" href="#" onclick="return doclink('link-637', 'AnalysisManager', 'link-637');">AnalysisManager</a></tt><tt class="py-op">(</tt><tt id="link-638" class="py-name"><a title="lib.cuckoo.core.database.Tag.task" class="py-name" href="#" onclick="return doclink('link-638', 'task', 'link-80');">task</a></tt><tt class="py-op">,</tt> <tt id="link-639" class="py-name"><a title="lib.cuckoo.core.database.Task.errors" class="py-name" href="#" onclick="return doclink('link-639', 'errors', 'link-82');">errors</a></tt><tt class="py-op">)</tt> </tt>
<a name="L690"></a><tt class="py-lineno">690</tt>  <tt class="py-line">                <tt class="py-name">analysis</tt><tt class="py-op">.</tt><tt class="py-name">daemon</tt> <tt class="py-op">=</tt> <tt class="py-name">True</tt> </tt>
<a name="L691"></a><tt class="py-lineno">691</tt>  <tt class="py-line">                <tt class="py-name">analysis</tt><tt class="py-op">.</tt><tt id="link-640" class="py-name"><a title="lib.cuckoo.common.abstracts.Auxiliary.start
lib.cuckoo.common.abstracts.LibVirtMachinery.start
lib.cuckoo.common.abstracts.Machinery.start
lib.cuckoo.core.plugins.RunAuxiliary.start
lib.cuckoo.core.scheduler.Scheduler.start
modules.auxiliary.mitm.MITM.start
modules.auxiliary.services.Services.start
modules.auxiliary.sniffer.Sniffer.start
modules.machinery.avd.Avd.start
modules.machinery.physical.Physical.start
modules.machinery.qemu.QEMU.start
modules.machinery.virtualbox.VirtualBox.start
modules.machinery.vmware.VMware.start
modules.machinery.vsphere.vSphere.start
modules.machinery.xenserver.XenServerMachinery.start" class="py-name" href="#" onclick="return doclink('link-640', 'start', 'link-366');">start</a></tt><tt class="py-op">(</tt><tt class="py-op">)</tt> </tt>
<a name="L692"></a><tt class="py-lineno">692</tt>  <tt class="py-line"> </tt>
<a name="L693"></a><tt class="py-lineno">693</tt>  <tt class="py-line">            <tt class="py-comment"># Deal with errors.</tt> </tt>
<a name="L694"></a><tt class="py-lineno">694</tt>  <tt class="py-line">            <tt class="py-keyword">try</tt><tt class="py-op">:</tt> </tt>
<a name="L695"></a><tt class="py-lineno">695</tt>  <tt class="py-line">                <tt class="py-keyword">raise</tt> <tt id="link-641" class="py-name"><a title="lib.cuckoo.core.database.Task.errors" class="py-name" href="#" onclick="return doclink('link-641', 'errors', 'link-82');">errors</a></tt><tt class="py-op">.</tt><tt id="link-642" class="py-name"><a title="lib.cuckoo.common.config.Config.get
lib.cuckoo.core.guest.GuestManager.get" class="py-name" href="#" onclick="return doclink('link-642', 'get', 'link-244');">get</a></tt><tt class="py-op">(</tt><tt class="py-name">block</tt><tt class="py-op">=</tt><tt class="py-name">False</tt><tt class="py-op">)</tt> </tt>
<a name="L696"></a><tt class="py-lineno">696</tt>  <tt class="py-line">            <tt class="py-keyword">except</tt> <tt class="py-name">Queue</tt><tt class="py-op">.</tt><tt class="py-name">Empty</tt><tt class="py-op">:</tt> </tt>
<a name="L697"></a><tt class="py-lineno">697</tt>  <tt class="py-line">                <tt class="py-keyword">pass</tt> </tt>
<a name="L698"></a><tt class="py-lineno">698</tt>  <tt class="py-line"> </tt>
<a name="L699"></a><tt class="py-lineno">699</tt>  <tt class="py-line">        <tt id="link-643" class="py-name"><a title="lib.cuckoo.common.abstracts.log
lib.cuckoo.common.irc.log
lib.cuckoo.common.netlog.log
lib.cuckoo.common.objects.log
lib.cuckoo.core.database.log
lib.cuckoo.core.guest.log
lib.cuckoo.core.plugins.log
lib.cuckoo.core.resultserver.log
lib.cuckoo.core.rooter.log
lib.cuckoo.core.scheduler.log
lib.cuckoo.core.startup.log
modules.auxiliary.mitm.log
modules.auxiliary.services.log
modules.auxiliary.sniffer.log
modules.machinery.avd.log
modules.machinery.physical.log
modules.machinery.qemu.log
modules.machinery.virtualbox.log
modules.machinery.vmware.log
modules.machinery.vsphere.log
modules.machinery.xenserver.log
modules.processing.analysisinfo.log
modules.processing.apkinfo.log
modules.processing.baseline.log
modules.processing.behavior.log
modules.processing.droidmon.log
modules.processing.dumptls.log
modules.processing.googleplay.log
modules.processing.memory.log
modules.processing.network.log
modules.processing.platform.linux.log
modules.processing.platform.windows.log
modules.processing.screenshots.log
modules.processing.snort.log
modules.processing.static.log
modules.processing.suricata.log
modules.processing.virustotal.log
modules.reporting.moloch.log" class="py-name" href="#" onclick="return doclink('link-643', 'log', 'link-74');">log</a></tt><tt class="py-op">.</tt><tt id="link-644" class="py-name"><a title="modules.processing.debug" class="py-name" href="#" onclick="return doclink('link-644', 'debug', 'link-158');">debug</a></tt><tt class="py-op">(</tt><tt class="py-string">"End of analyses."</tt><tt class="py-op">)</tt> </tt>
</div></div><a name="L700"></a><tt class="py-lineno">700</tt>  <tt class="py-line"> </tt><script type="text/javascript">
<!--
expandto(location.href);
// -->
</script>
</pre>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a class="navbar" target="_top" href="http://cuckoosandbox.org">Cuckoo Sandbox</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Mon Jan 11 19:29:07 2016
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
