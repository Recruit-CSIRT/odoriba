<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Analysis Packages &mdash; Cuckoo Sandbox v2.0-rc1 Book</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.0-rc1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Cuckoo Sandbox v2.0-rc1 Book" href="../index.html" />
    <link rel="up" title="Usage" href="index.html" />
    <link rel="next" title="Analysis Results" href="results.html" />
    <link rel="prev" title="Distributed Cuckoo" href="dist.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="results.html" title="Analysis Results"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="dist.html" title="Distributed Cuckoo"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Cuckoo Sandbox v2.0-rc1 Book</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Usage</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="analysis-packages">
<h1>Analysis Packages<a class="headerlink" href="#analysis-packages" title="Permalink to this headline">Â¶</a></h1>
<p>The <strong>analysis packages</strong> are a core component of Cuckoo Sandbox.
They consist in structured Python classes which, when executed in the guest machines,
describe how Cuckoo&#8217;s analyzer component should conduct the analysis.</p>
<p>Cuckoo provides some default analysis packages that you can use, but you are
able to create your own or modify the existing ones.
You can find them at <em>analyzer/windows/modules/packages/</em>.</p>
<p>As described in <a class="reference internal" href="submit.html"><em>Submit an Analysis</em></a>, you can specify some options to the
analysis packages in the form of <tt class="docutils literal"><span class="pre">key1=value1,key2=value2</span></tt>. The existing analysis
packages already include some default options that can be enabled.</p>
<p>Following is the list of existing packages in alphabetical order:</p>
<blockquote>
<div><ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">applet</span></tt>: used to analyze <strong>Java applets</strong>.</p>
<blockquote>
<div><dl class="docutils">
<dt><strong>Options</strong>:</dt>
<dd><ul class="first last simple">
<li><tt class="docutils literal"><span class="pre">free</span></tt> <em>[yes/no]</em>: if enabled, no behavioral logs will be produced and the malware will be executed freely.</li>
<li><tt class="docutils literal"><span class="pre">class</span></tt>: specify the name of the class to be executed. This option is mandatory for a correct execution.</li>
<li><tt class="docutils literal"><span class="pre">procmemdump</span></tt> <em>[yes/no]</em>: if enabled, take memory dumps of all actively monitored processes.</li>
<li><tt class="docutils literal"><span class="pre">dll</span></tt>: specify the name of an optional DLL to be used as a replacement for cuckoomon.dll.</li>
</ul>
</dd>
</dl>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">bin</span></tt>: used to analyze generic binary data, such as <strong>shellcodes</strong>.</p>
<blockquote>
<div><dl class="docutils">
<dt><strong>Options</strong>:</dt>
<dd><ul class="first last simple">
<li><tt class="docutils literal"><span class="pre">free</span></tt> <em>[yes/no]</em>: if enabled, no behavioral logs will be produced and the malware will be executed freely.</li>
<li><tt class="docutils literal"><span class="pre">procmemdump</span></tt> <em>[yes/no]</em>: if enabled, take memory dumps of all actively monitored processes.</li>
<li><tt class="docutils literal"><span class="pre">dll</span></tt>: specify the name of an optional DLL to be used as a replacement for cuckoomon.dll.</li>
</ul>
</dd>
</dl>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">cpl</span></tt>: used to analyze <strong>Control Panel Applets</strong>.</p>
<blockquote>
<div><dl class="docutils">
<dt><strong>Options</strong>:</dt>
<dd><ul class="first last simple">
<li><tt class="docutils literal"><span class="pre">free</span></tt> <em>[yes/no]</em>: if enabled, no behavioral logs will be produced and the malware will be executed freely.</li>
<li><tt class="docutils literal"><span class="pre">procmemdump</span></tt> <em>[yes/no]</em>: if enabled, take memory dumps of all actively monitored processes.</li>
<li><tt class="docutils literal"><span class="pre">dll</span></tt>: specify the name of an optional DLL to be used as a replacement for cuckoomon.dll.</li>
</ul>
</dd>
</dl>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">dll</span></tt>: used to run and analyze <strong>Dynamically Linked Libraries</strong>.</p>
<blockquote>
<div><dl class="docutils">
<dt><strong>Options</strong>:</dt>
<dd><ul class="first last simple">
<li><tt class="docutils literal"><span class="pre">free</span></tt> <em>[yes/no]</em>: if enabled, no behavioral logs will be produced and the malware will be executed freely.</li>
<li><tt class="docutils literal"><span class="pre">function</span></tt>: specify the function to be executed. If none is specified, Cuckoo will try to run <tt class="docutils literal"><span class="pre">DllMain</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">arguments</span></tt>: specify arguments to pass to the DLL through commandline.</li>
<li><tt class="docutils literal"><span class="pre">loader</span></tt>: specify a process name to use to fake the DLL launcher name instead of rundll32.exe (this is used to fool possible anti-sandboxing tricks of certain malware)</li>
<li><tt class="docutils literal"><span class="pre">procmemdump</span></tt> <em>[yes/no]</em>: if enabled, take memory dumps of all actively monitored processes.</li>
<li><tt class="docutils literal"><span class="pre">dll</span></tt>: specify the name of an optional DLL to be used as a replacement for cuckoomon.dll.</li>
</ul>
</dd>
</dl>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">doc</span></tt>: used to run and analyze <strong>Microsoft Word documents</strong>.</p>
<blockquote>
<div><dl class="docutils">
<dt><strong>Options</strong>:</dt>
<dd><ul class="first last simple">
<li><tt class="docutils literal"><span class="pre">free</span></tt> <em>[yes/no]</em>: if enabled, no behavioral logs will be produced and the malware will be executed freely.</li>
<li><tt class="docutils literal"><span class="pre">procmemdump</span></tt> <em>[yes/no]</em>: if enabled, take memory dumps of all actively monitored processes.</li>
<li><tt class="docutils literal"><span class="pre">dll</span></tt>: specify the name of an optional DLL to be used as a replacement for cuckoomon.dll.</li>
</ul>
</dd>
</dl>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">exe</span></tt>: default analysis package used to analyze generic <strong>Windows executables</strong>.</p>
<blockquote>
<div><dl class="docutils">
<dt><strong>Options</strong>:</dt>
<dd><ul class="first last simple">
<li><tt class="docutils literal"><span class="pre">free</span></tt> <em>[yes/no]</em>: if enabled, no behavioral logs will be produced and the malware will be executed freely.</li>
<li><tt class="docutils literal"><span class="pre">arguments</span></tt>: specify any command line argument to pass to the initial process of the submitted malware.</li>
<li><tt class="docutils literal"><span class="pre">procmemdump</span></tt> <em>[yes/no]</em>: if enabled, take memory dumps of all actively monitored processes.</li>
<li><tt class="docutils literal"><span class="pre">dll</span></tt>: specify the name of an optional DLL to be used as a replacement for cuckoomon.dll.</li>
</ul>
</dd>
</dl>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">generic</span></tt>: used to run and analyze <strong>generic samples</strong> via cmd.exe.</p>
<blockquote>
<div><dl class="docutils">
<dt><strong>Options</strong>:</dt>
<dd><ul class="first last simple">
<li><tt class="docutils literal"><span class="pre">free</span></tt> <em>[yes/no]</em>: if enabled, no behavioral logs will be produced and the malware will be executed freely.</li>
<li><tt class="docutils literal"><span class="pre">procmemdump</span></tt> <em>[yes/no]</em>: if enabled, take memory dumps of all actively monitored processes.</li>
<li><tt class="docutils literal"><span class="pre">dll</span></tt>: specify the name of an optional DLL to be used as a replacement for cuckoomon.dll.</li>
</ul>
</dd>
</dl>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">html</span></tt>: used to analyze <strong>Internet Explorer</strong>&#8216;s behavior when opening the given HTML file.</p>
<blockquote>
<div><dl class="docutils">
<dt><strong>Options</strong>:</dt>
<dd><ul class="first last simple">
<li><tt class="docutils literal"><span class="pre">free</span></tt> <em>[yes/no]</em>: if enabled, no behavioral logs will be produced and the malware will be executed freely.</li>
<li><tt class="docutils literal"><span class="pre">procmemdump</span></tt> <em>[yes/no]</em>: if enabled, take memory dumps of all actively monitored processes.</li>
<li><tt class="docutils literal"><span class="pre">dll</span></tt>: specify the name of an optional DLL to be used as a replacement for cuckoomon.dll.</li>
</ul>
</dd>
</dl>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">ie</span></tt>: used to analyze <strong>Internet Explorer</strong>&#8216;s behavior when opening the given URL.</p>
<blockquote>
<div><dl class="docutils">
<dt><strong>Options</strong>:</dt>
<dd><ul class="first last simple">
<li><tt class="docutils literal"><span class="pre">free</span></tt> <em>[yes/no]</em>: if enabled, no behavioral logs will be produced and the malware will be executed freely.</li>
<li><tt class="docutils literal"><span class="pre">procmemdump</span></tt> <em>[yes/no]</em>: if enabled, take memory dumps of all actively monitored processes.</li>
<li><tt class="docutils literal"><span class="pre">dll</span></tt>: specify the name of an optional DLL to be used as a replacement for cuckoomon.dll.</li>
</ul>
</dd>
</dl>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">jar</span></tt>: used to analyze <strong>Java JAR</strong> containers.</p>
<blockquote>
<div><dl class="docutils">
<dt><strong>Options</strong>:</dt>
<dd><ul class="first last simple">
<li><tt class="docutils literal"><span class="pre">free</span></tt> <em>[yes/no]</em>: if enabled, no behavioral logs will be produced and the malware will be executed freely.</li>
<li><tt class="docutils literal"><span class="pre">class</span></tt>: specify the path of the class to be executed. If none is specified, Cuckoo will try to execute the main function specified in the Jar&#8217;s MANIFEST file.</li>
<li><tt class="docutils literal"><span class="pre">procmemdump</span></tt> <em>[yes/no]</em>: if enabled, take memory dumps of all actively monitored processes.</li>
<li><tt class="docutils literal"><span class="pre">dll</span></tt>: specify the name of an optional DLL to be used as a replacement for cuckoomon.dll.</li>
</ul>
</dd>
</dl>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">msi</span></tt>: used to run and analyze <strong>MSI windows installer</strong>.</p>
<blockquote>
<div><dl class="docutils">
<dt><strong>Options</strong>:</dt>
<dd><ul class="first last simple">
<li><tt class="docutils literal"><span class="pre">free</span></tt> <em>[yes/no]</em>: if enabled, no behavioral logs will be produced and the malware will be executed freely.</li>
<li><tt class="docutils literal"><span class="pre">procmemdump</span></tt> <em>[yes/no]</em>: if enabled, take memory dumps of all actively monitored processes.</li>
<li><tt class="docutils literal"><span class="pre">dll</span></tt>: specify the name of an optional DLL to be used as a replacement for cuckoomon.dll.</li>
</ul>
</dd>
</dl>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">pdf</span></tt>: used to run and analyze <strong>PDF documents</strong>.</p>
<blockquote>
<div><dl class="docutils">
<dt><strong>Options</strong>:</dt>
<dd><ul class="first last simple">
<li><tt class="docutils literal"><span class="pre">free</span></tt> <em>[yes/no]</em>: if enabled, no behavioral logs will be produced and the malware will be executed freely.</li>
<li><tt class="docutils literal"><span class="pre">procmemdump</span></tt> <em>[yes/no]</em>: if enabled, take memory dumps of all actively monitored processes.</li>
<li><tt class="docutils literal"><span class="pre">dll</span></tt>: specify the name of an optional DLL to be used as a replacement for cuckoomon.dll.</li>
</ul>
</dd>
</dl>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">ppt</span></tt>: used to run and analyze <strong>Microsoft PowerPoint documents</strong>.</p>
<blockquote>
<div><dl class="docutils">
<dt><strong>Options</strong>:</dt>
<dd><ul class="first last simple">
<li><tt class="docutils literal"><span class="pre">free</span></tt> <em>[yes/no]</em>: if enabled, no behavioral logs will be produced and the malware will be executed freely.</li>
<li><tt class="docutils literal"><span class="pre">procmemdump</span></tt> <em>[yes/no]</em>: if enabled, take memory dumps of all actively monitored processes.</li>
<li><tt class="docutils literal"><span class="pre">dll</span></tt>: specify the name of an optional DLL to be used as a replacement for cuckoomon.dll.</li>
</ul>
</dd>
</dl>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">ps1</span></tt>: used to run and analyze <strong>PowerShell scripts</strong>.</p>
<blockquote>
<div><dl class="docutils">
<dt><strong>Options</strong>:</dt>
<dd><ul class="first last simple">
<li><tt class="docutils literal"><span class="pre">free</span></tt> <em>[yes/no]</em>: if enabled, no behavioral logs will be produced and the malware will be executed freely.</li>
<li><tt class="docutils literal"><span class="pre">procmemdump</span></tt> <em>[yes/no]</em>: if enabled, take memory dumps of all actively monitored processes.</li>
<li><tt class="docutils literal"><span class="pre">dll</span></tt>: specify the name of an optional DLL to be used as a replacement for cuckoomon.dll.</li>
</ul>
</dd>
</dl>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">python</span></tt>: used to run and analyze <strong>Python scripts</strong>.</p>
<blockquote>
<div><dl class="docutils">
<dt><strong>Options</strong>:</dt>
<dd><ul class="first last simple">
<li><tt class="docutils literal"><span class="pre">free</span></tt> <em>[yes/no]</em>: if enabled, no behavioral logs will be produced and the malware will be executed freely.</li>
<li><tt class="docutils literal"><span class="pre">procmemdump</span></tt> <em>[yes/no]</em>: if enabled, take memory dumps of all actively monitored processes.</li>
<li><tt class="docutils literal"><span class="pre">dll</span></tt>: specify the name of an optional DLL to be used as a replacement for cuckoomon.dll.</li>
</ul>
</dd>
</dl>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">vbs</span></tt>: used to run and analysis <strong>VBScript files</strong>.</p>
<blockquote>
<div><dl class="docutils">
<dt><strong>Options</strong>:</dt>
<dd><ul class="first last simple">
<li><tt class="docutils literal"><span class="pre">free</span></tt> <em>[yes/no]</em>: if enabled, no behavioral logs will be produced and the malware will be executed freely.</li>
<li><tt class="docutils literal"><span class="pre">procmemdump</span></tt> <em>[yes/no]</em>: if enabled, take memory dumps of all actively monitored processes.</li>
<li><tt class="docutils literal"><span class="pre">dll</span></tt>: specify the name of an optional DLL to be used as a replacement for cuckoomon.dll.</li>
</ul>
</dd>
</dl>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">xls</span></tt>: used to run and analyze <strong>Microsoft Excel documents</strong>.</p>
<blockquote>
<div><dl class="docutils">
<dt><strong>Options</strong>:</dt>
<dd><ul class="first last simple">
<li><tt class="docutils literal"><span class="pre">free</span></tt> <em>[yes/no]</em>: if enabled, no behavioral logs will be produced and the malware will be executed freely.</li>
<li><tt class="docutils literal"><span class="pre">procmemdump</span></tt> <em>[yes/no]</em>: if enabled, take memory dumps of all actively monitored processes.</li>
<li><tt class="docutils literal"><span class="pre">dll</span></tt>: specify the name of an optional DLL to be used as a replacement for cuckoomon.dll.</li>
</ul>
</dd>
</dl>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">zip</span></tt>: used to run and analyze <strong>Zip archives</strong>.</p>
<blockquote>
<div><dl class="docutils">
<dt><strong>Options</strong>:</dt>
<dd><ul class="first last simple">
<li><tt class="docutils literal"><span class="pre">file</span></tt>: specify the name of the file contained in the archive to execute. If none is specified, Cuckoo will try to execute <em>sample.exe</em>.</li>
<li><tt class="docutils literal"><span class="pre">free</span></tt> <em>[yes/no]</em>: if enabled, no behavioral logs will be produced and the malware will be executed freely.</li>
<li><tt class="docutils literal"><span class="pre">arguments</span></tt>: specify any command line argument to pass to the initial process of the submitted malware.</li>
<li><tt class="docutils literal"><span class="pre">password</span></tt>: specify the password of the archive. If none is specified, Cuckoo will try to extract the archive without password or use the password &#8220;<em>infected</em>&#8221;.</li>
<li><tt class="docutils literal"><span class="pre">procmemdump</span></tt> <em>[yes/no]</em>: if enabled, take memory dumps of all actively monitored processes.</li>
<li><tt class="docutils literal"><span class="pre">dll</span></tt>: specify the name of an optional DLL to be used as a replacement for cuckoomon.dll.</li>
</ul>
</dd>
</dl>
</div></blockquote>
</li>
</ul>
</div></blockquote>
<p>You can find more details on how to start creating new analysis packages in the
<a class="reference internal" href="../customization/packages.html"><em>Analysis Packages</em></a> customization chapter.</p>
<p>As you already know, you can select which analysis package to use by specifying
its name at submission time (see <a class="reference internal" href="submit.html"><em>Submit an Analysis</em></a>) as follows:</p>
<div class="highlight-python"><div class="highlight"><pre>$ ./utils/submit.py --package &lt;package name&gt; /path/to/malware
</pre></div>
</div>
<p>If none is specified, Cuckoo will try to detect the file type and select
the correct analysis package accordingly. If the file type is not supported by
default the analysis will be aborted, therefore we encourage to
specify the package name whenever possible.</p>
<p>For example, to launch a malware and specify some options you can do:</p>
<div class="highlight-python"><div class="highlight"><pre>$ ./utils/submit.py --package dll --options function=FunctionName,loader=explorer.exe /path/to/malware.dll
</pre></div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/cuckoo.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="dist.html"
                        title="previous chapter">Distributed Cuckoo</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="results.html"
                        title="next chapter">Analysis Results</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/usage/packages.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="results.html" title="Analysis Results"
             >next</a></li>
        <li class="right" >
          <a href="dist.html" title="Distributed Cuckoo"
             >previous</a> |</li>
        <li><a href="../index.html">Cuckoo Sandbox v2.0-rc1 Book</a> &raquo;</li>
          <li><a href="index.html" >Usage</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2010-2015, Cuckoo Foundation.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>